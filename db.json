{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"source/baidu-verify-9BFFE2B7F8.txt","path":"baidu-verify-9BFFE2B7F8.txt","modified":0,"renderable":0},{"_id":"source/robots.txt","path":"robots.txt","modified":0,"renderable":0},{"_id":"source/root.txt","path":"root.txt","modified":0,"renderable":0},{"_id":"source/images/nrmuse.png","path":"images/nrmuse.png","modified":0,"renderable":0},{"_id":"source/images/nrmls.png","path":"images/nrmls.png","modified":0,"renderable":0},{"_id":"source/images/vuecreate.png","path":"images/vuecreate.png","modified":0,"renderable":0},{"_id":"source/images/vuecreate2.png","path":"images/vuecreate2.png","modified":0,"renderable":0},{"_id":"themes/pure/source/favicon.ico","path":"favicon.ico","modified":0,"renderable":1},{"_id":"source/images/vuecreate3.png","path":"images/vuecreate3.png","modified":0,"renderable":0},{"_id":"themes/pure/source/images/avatar.jpg","path":"images/avatar.jpg","modified":0,"renderable":1},{"_id":"themes/pure/source/images/thumb-default.png","path":"images/thumb-default.png","modified":0,"renderable":1},{"_id":"themes/pure/source/images/xingqiu-qrcode.jpg","path":"images/xingqiu-qrcode.jpg","modified":0,"renderable":1},{"_id":"themes/pure/source/js/application.js","path":"js/application.js","modified":0,"renderable":1},{"_id":"themes/pure/source/js/insight.js","path":"js/insight.js","modified":0,"renderable":1},{"_id":"themes/pure/source/js/application.min.js","path":"js/application.min.js","modified":0,"renderable":1},{"_id":"themes/pure/source/fonts/README.md","path":"fonts/README.md","modified":0,"renderable":1},{"_id":"themes/pure/source/fonts/iconfont.eot","path":"fonts/iconfont.eot","modified":0,"renderable":1},{"_id":"themes/pure/source/fonts/iconfont.ttf","path":"fonts/iconfont.ttf","modified":0,"renderable":1},{"_id":"themes/pure/source/fonts/iconfont.woff","path":"fonts/iconfont.woff","modified":0,"renderable":1},{"_id":"themes/pure/source/js/plugin.min.js","path":"js/plugin.min.js","modified":0,"renderable":1},{"_id":"themes/pure/source/css/style.min.css","path":"css/style.min.css","modified":0,"renderable":1},{"_id":"themes/pure/source/images/donate/wechatpayimg.jpg","path":"images/donate/wechatpayimg.jpg","modified":0,"renderable":1},{"_id":"themes/pure/source/images/favatar/SzsFox-logo.png","path":"images/favatar/SzsFox-logo.png","modified":0,"renderable":1},{"_id":"themes/pure/source/images/favatar/chuangzaoshi-logo.png","path":"images/favatar/chuangzaoshi-logo.png","modified":0,"renderable":1},{"_id":"themes/pure/source/images/favatar/idesign-logo.png","path":"images/favatar/idesign-logo.png","modified":0,"renderable":1},{"_id":"themes/pure/source/js/plugin.js","path":"js/plugin.js","modified":0,"renderable":1},{"_id":"themes/pure/source/js/jquery.min.js","path":"js/jquery.min.js","modified":0,"renderable":1},{"_id":"themes/pure/source/js/plugin.js.map","path":"js/plugin.js.map","modified":0,"renderable":1},{"_id":"themes/pure/source/fonts/iconfont.svg","path":"fonts/iconfont.svg","modified":0,"renderable":1},{"_id":"themes/pure/source/css/style.css","path":"css/style.css","modified":0,"renderable":1},{"_id":"themes/pure/source/images/donate/alipayimg.jpg","path":"images/donate/alipayimg.jpg","modified":0,"renderable":1}],"Cache":[{"_id":"source/404.md","hash":"9e6f55d7c01343e1ffd36d55860587fd269d6cb6","modified":1611654543570},{"_id":"source/CNAME","hash":"6ac1a441d26185b407703ab9ffa5959860e49773","modified":1611654543570},{"_id":"source/baidu-verify-9BFFE2B7F8.txt","hash":"50cc3c23409426c3e28cf8800423ecda502f1eb8","modified":1611654543574},{"_id":"source/clock.html","hash":"f379a0cd10b6140ff06122473aa0d9d3fc69c742","modified":1614567580895},{"_id":"source/ea667b0f708cd4ded0b79ebbdd99373a.html","hash":"8285746bede8562c1bc26a88041d01ca82127d20","modified":1611654543574},{"_id":"source/robots.txt","hash":"c18cc8be26a5c74b1c2f6ee7775647c07197ab67","modified":1611654543574},{"_id":"source/root.txt","hash":"51c99f66271aedfff930264c82fdbe9b4d05b67e","modified":1611654543574},{"_id":"themes/pure/.git","hash":"9f53ea4e2b5b6853d2fc079a4835da7541ec14ed","modified":1615270385836},{"_id":"themes/pure/.gitignore","hash":"dbb41a2f30c98cb9de173d82736c46266c901cda","modified":1615270385840},{"_id":"themes/pure/LICENSE","hash":"c480fce396b23997ee23cc535518ffaaf7f458f8","modified":1615270385840},{"_id":"themes/pure/README.cn.md","hash":"a634af4addbb57088935e060e8ec6035ea7bab76","modified":1615270385840},{"_id":"themes/pure/README.md","hash":"5861cec81712af9197a210fd5212d007aad8b0de","modified":1615270385840},{"_id":"themes/pure/_config-bak.yml","hash":"7d70a817972b671014ce44b9058792d15ba65471","modified":1615270545760},{"_id":"themes/pure/_config.yml","hash":"cd62816f8dca1ffdc3b46799c4c4c83b45d00dba","modified":1615277505289},{"_id":"themes/pure/_config.yml.example","hash":"4714f87fdb6d4a6ea5ece84f4fe37f922337f14d","modified":1615270385840},{"_id":"themes/pure/package.json","hash":"a61723eead5cae2c4d9f0f05cf40d2de7c286fee","modified":1615270385844},{"_id":"source/_data/url.yml","hash":"130b11df7a8a42f800e103e994c948f2130785e3","modified":1611654543570},{"_id":"source/_data/musics.json","hash":"e205288617138d5497dad58e5a87a9b2fe548e75","modified":1611654543570},{"_id":"source/_data/friends.json","hash":"0657ec148a17a70b05da83ebf4e96d9ad50dea07","modified":1615276630871},{"_id":"source/about/index.html","hash":"90f4efe042049101ac6f01317697a6e3c6297fb4","modified":1615275148893},{"_id":"source/categories/index.md","hash":"5c03e8bf8ebfd90090c540be943e1433aadb685a","modified":1611654543574},{"_id":"source/friends/index.md","hash":"75fb0e0cea8341302f9dd72c6cdab156ead139d3","modified":1611654543574},{"_id":"source/images/nrmuse.png","hash":"c7bc96979ddcd9e1c9b7de09d98f510b76c89940","modified":1611654543574},{"_id":"source/images/nrmls.png","hash":"4b5016f2b844e38a61bd1fb44cc6dd7c44be123e","modified":1611654543574},{"_id":"source/images/vuecreate.png","hash":"f85fb6b87192b4bb5521c29a3e1932888c18609b","modified":1611654543574},{"_id":"source/tags/index.md","hash":"0f067daff94309177dc8d71f9ecbf4a7c8d616e8","modified":1611654543574},{"_id":"source/images/vuecreate2.png","hash":"b270c1135532825f1be47c229fa78eb14bcfa499","modified":1611654543574},{"_id":"themes/pure/languages/default.yml","hash":"167ea0db98f4db156ea68c4644f64c0287ae2b6f","modified":1615270385840},{"_id":"themes/pure/languages/en.yml","hash":"167ea0db98f4db156ea68c4644f64c0287ae2b6f","modified":1615270385840},{"_id":"themes/pure/languages/zh-CN.yml","hash":"a081750a1fc20c7c1192937a253d2716e2ce0c07","modified":1615276019976},{"_id":"themes/pure/languages/zh-TW.yml","hash":"6d27c3114be539b8783ffce944f68b2e26a8c3b9","modified":1615270385840},{"_id":"themes/pure/layout/archive.ejs","hash":"ded5d953b35666e30f4c6e48e2d2c62af8d95ebf","modified":1615270385844},{"_id":"themes/pure/layout/about.ejs","hash":"4f5c769e183249b12eb9d3141432bc0039519730","modified":1615270385844},{"_id":"themes/pure/layout/books.ejs","hash":"6c64719cd7071b5319b01339aa524fdaab391385","modified":1615270385844},{"_id":"themes/pure/layout/category.ejs","hash":"3ca5651bbce7b0c280c906468f2eb18c2e55ebcb","modified":1615270385844},{"_id":"themes/pure/layout/index.ejs","hash":"07825d8d8b21eb7b694f5585567b9df5c5a91a60","modified":1615270385844},{"_id":"themes/pure/layout/layout.ejs","hash":"a29ab2e881954a252bfc0dc1a7eb5aa52768dd2a","modified":1615270385844},{"_id":"themes/pure/layout/categories.ejs","hash":"22a2bc1712dd9ba1a3027e875d636132d334fb00","modified":1615270385844},{"_id":"themes/pure/layout/links.ejs","hash":"77c5d1561e2c606c5b3bb39610133d84324074df","modified":1615270385844},{"_id":"themes/pure/layout/page.ejs","hash":"5c27475c176627e6e2e6a16172eb6980e56bcaff","modified":1615270385844},{"_id":"themes/pure/layout/post.ejs","hash":"5c27475c176627e6e2e6a16172eb6980e56bcaff","modified":1615270385844},{"_id":"themes/pure/layout/repository.ejs","hash":"fe4b3e051a8b0debe9ee22c2cc2cc935d92ee23f","modified":1615270385844},{"_id":"themes/pure/layout/tag.ejs","hash":"df60564c162f7ad3422f8959dfea19351857a7cd","modified":1615270385844},{"_id":"themes/pure/layout/tags.ejs","hash":"29f19a6ed10f8b1f069259a7aeaaacddcfaa2ed4","modified":1615270385844},{"_id":"themes/pure/scripts/thumbnail.js","hash":"e667a611f9baac270281b765832020d50bf8fb7f","modified":1615270385860},{"_id":"themes/pure/source/favicon.ico","hash":"3956dd3ab6bc323801ab3a6dbd1c818d601bdab0","modified":1615243730000},{"_id":"source/images/vuecreate3.png","hash":"18ad1a8dba3920753ec8b0441cbc057b99cade1f","modified":1611654543574},{"_id":"themes/pure/screenshot/pure.png","hash":"8f4cfd8d7edfa4fbffdf375291302d9807f5cc1c","modified":1615270385848},{"_id":"themes/pure/screenshot/pure-theme-green.png","hash":"12ec0c6033cb2762839fdf75434bbb4fbf946022","modified":1615270385848},{"_id":"themes/pure/screenshot/pure-theme-black.png","hash":"10b40f398af7eb7e8ba2bf2f2a959d8779fc1fe1","modified":1615270385848},{"_id":"themes/pure/screenshot/pure-theme-blue.png","hash":"6146890a68d5ea9d343c48d50151ddd5a2a1872c","modified":1615270385848},{"_id":"themes/pure/screenshot/pure-theme-purple.png","hash":"9855d2eb0acd23370209354f232471df8f4f72e2","modified":1615270385848},{"_id":"source/_posts/algorithm/algorithm-recursive-01.md","hash":"2b286fda02c79701d7218bd33293bc7ba9c4b84e","modified":1611654543570},{"_id":"source/_posts/algorithm/algorithm-avltree-01.md","hash":"48620687d6d75e5070fbfcd139325fe078472d3e","modified":1611654543570},{"_id":"source/_posts/docker/docker-mysql.md","hash":"d0b3d7e1c847fa4a8728203feadb975b8802ed26","modified":1611654543570},{"_id":"source/_posts/docker/docker-transfer-pit.md","hash":"78e04b3538a80ce9af20bed0eecef83c508f59f9","modified":1611654543570},{"_id":"source/_posts/algorithm/array-vs-linked.md","hash":"1102bc9e9cd78edff77fa5f612603f7d62e992a2","modified":1611654543570},{"_id":"source/_posts/gof/gof-abstract-factory.md","hash":"87b48eef4490fd5c5dbee34f9651624531aa124a","modified":1611654543570},{"_id":"source/_posts/gof/gof-factory-method.md","hash":"1367794e7558fd6bf1ed5750a3ae21c8bba801d7","modified":1611654543570},{"_id":"source/_posts/gof/gof-oop-7-all.md","hash":"7a5e5066b37cc65bfa44b32a95d5be7f6bdd9e0e","modified":1611654543570},{"_id":"source/_posts/gof/gof-prototype.md","hash":"f2a9837a51ef94933cd63e25c6e4488c8008838d","modified":1611654543570},{"_id":"source/_posts/gof/gof-builder.md","hash":"760b4b626b4bfab7be07963a6d3155769b282f50","modified":1611654543570},{"_id":"source/_posts/java/java-8-stream-method.md","hash":"936349a4acbeb50c1dc2c8040a94abd75f77249c","modified":1611654543570},{"_id":"source/_posts/gof/gof-singleton.md","hash":"30cddcd0bdf124aead85342e868072024f99b3d4","modified":1611654543570},{"_id":"source/_posts/dubbo/dcf9d2d8-9c11-404a-874d-57834303dcac.md","hash":"1c56e6469e3273367498436f6649b3721782c0f3","modified":1612505217827},{"_id":"source/_posts/gof/gof-taemplate-method.md","hash":"d4ff1127b447bb0eea5fa0ebcd2fa7b004eb16e4","modified":1611654543570},{"_id":"source/_posts/java/java-array-init.md","hash":"85995b4a0a9f03679016e42477d168982857ca74","modified":1611654543570},{"_id":"source/_posts/java/java-arraylist-source-1.md","hash":"19d0ba0b743a177ff244627e6c46ab0fdad036bb","modified":1611654543570},{"_id":"source/_posts/java/java-base-data-pack.md","hash":"afdd3d3fcebead8cdb8ec7e39fb7002194899f4c","modified":1611654543570},{"_id":"source/_posts/java/java-base-wei.md","hash":"d1d9ee1e211d73b63e29260ef9146b570a20e254","modified":1611654543570},{"_id":"source/_posts/java/java-equals.md","hash":"6a3f4d08afb15480038263aa8624369f2596bd3b","modified":1611654543570},{"_id":"source/_posts/java/java-isnull-four.md","hash":"b3393fcb504a687fb782728ec0723256ac1ba115","modified":1611654543570},{"_id":"source/_posts/java/jdkproxy-cglib.md","hash":"886e419f0ac2588859a104d4b527e4a3cda0bbf5","modified":1611654543570},{"_id":"source/_posts/java/nacos-post-error.md","hash":"fac1d611ab4471ad417450457868bac7fb1a4098","modified":1611654543574},{"_id":"source/_posts/java/mdc-test.md","hash":"9ab339b4c3f949492db4e57366b2097d7bb6b374","modified":1611654543570},{"_id":"source/_posts/java/problem-java-base64.md","hash":"423d236fa289c5bd0f1f9a185c6a6a10cff941ef","modified":1611654543574},{"_id":"source/_posts/jenkins/build-jenkins-docker.md","hash":"90e805bcf5bdba885da4824112145d3de838df30","modified":1611654543574},{"_id":"source/_posts/jenkins/build-jenkins-ci-cd.md","hash":"eb111fa32374e4a542b4d0a06f6c78332524255b","modified":1611654543574},{"_id":"source/_posts/jenkins/build-jenkins-mavne.md","hash":"c0b09c7ccc1b363989357c3bdfd031e544a2e0d0","modified":1611654543574},{"_id":"source/_posts/jenkins/problem-jenkins-01.md","hash":"5eb6cf6e419ee52b76ee5b703de4ed9ebb2654bb","modified":1611654543574},{"_id":"source/_posts/jenkins/build-jenkins-sonarqube.md","hash":"f37b7caa11ba4265dcfeab4263132b18f1d6b994","modified":1611654543574},{"_id":"source/_posts/linux/build-docker-pi.md","hash":"f7bd3e6cf1b94a922c350abe8c0224f0893f6c05","modified":1611654543574},{"_id":"source/_posts/jenkins/problem-jenkins-02.md","hash":"94bc6c81cf6e16d618afa674ec99abf266c6c73e","modified":1611654543574},{"_id":"source/_posts/linux/79b5fe12-9c60-4b93-be92-dffb00fa39c7.md","hash":"ed9f6e119b6e123971bfa409d8aac27253868300","modified":1611742007267},{"_id":"source/_posts/linux/problem-jdk-timezone.md","hash":"3170b50dea6e6c832306747b81885c2ae921832d","modified":1611654543574},{"_id":"source/_posts/linux/github-actions-build-pi-kernerl.md","hash":"9223715e25c154e73b95b253e6ca827152d32fa3","modified":1611734015918},{"_id":"source/_posts/mysql/mysql-update-driver-connector-8.md","hash":"1719dcaa6795575545c096178b92a7b31ca3d65a","modified":1611654543574},{"_id":"source/_posts/mysql/mysql-utf8mb4-error.md","hash":"55f1a794f1044c147585a9a06d459b1a7a607f21","modified":1611654543574},{"_id":"source/_posts/linux/linux-fastdfs-install.md","hash":"daace46c24bbbaec5bc8b94dd80dc4a0ee20b7fc","modified":1611654543574},{"_id":"source/_posts/recommend/git-commend-note.md","hash":"ec644b774eaa829a8b06d9af3f4c1e622d65ec38","modified":1611654543574},{"_id":"source/_posts/spring/apring-aop-ann.md","hash":"0f3b2f35cee9918a7a1247cd3577e9ee7dbb3013","modified":1611654543574},{"_id":"source/_posts/rocketmq/rocketmq-cluster-build.md","hash":"5d992b8e9bb016fd09bdf811cbe81fa70b39b635","modified":1611654543574},{"_id":"source/_posts/recommend/recommend-tool-1.md","hash":"729a616d8609112ed8da3be1ff67adfa91763b05","modified":1611654543574},{"_id":"source/_posts/spring/fegin-resttemplate-addheard.md","hash":"3d05ce1296dcff27e37b177e35032868e168a16a","modified":1611654543574},{"_id":"source/_posts/tool/438b5300-ffcf-443b-a1fa-2d2dbb6ea113.md","hash":"b112328b5002ebc7e68885b05bfbc1391b80da46","modified":1611815464098},{"_id":"source/_posts/tool/git-tool-command.md","hash":"b4b933910731ed3b7f4900e01b896adfa33c2205","modified":1611654543574},{"_id":"source/_posts/vue/vue-cli3-11-problem.md","hash":"6c4f20413d88487d55371da3e119a0d938d08bec","modified":1611654543574},{"_id":"source/_posts/spring/spring-boot-resttemplate-example.md","hash":"fbfb25931165c3596f31806bbe4dd78337d214df","modified":1611654543574},{"_id":"themes/pure/.github/ISSUE_TEMPLATE/custom.md","hash":"84208538d48505ee8e49812cb336eb9882e08dc7","modified":1615270385840},{"_id":"themes/pure/.github/ISSUE_TEMPLATE/bug_report.md","hash":"83d211c67c12e8c1f6e9f796cfd0cecbf5160e15","modified":1615270385840},{"_id":"themes/pure/.github/ISSUE_TEMPLATE/feature_request.md","hash":"f6867a2f0417fe89a0f2008730ee19dd38422021","modified":1615270385840},{"_id":"themes/pure/_source/404/index.md","hash":"8d493f624fdd29c8d0266767e56f343d549e16d8","modified":1615270385840},{"_id":"themes/pure/_source/_data/gallery.yml","hash":"e2b3fad87be3d1cfde1effa655d39678ee90907e","modified":1615270385840},{"_id":"themes/pure/_source/_data/links.yml","hash":"aa443a4508550820c77c2a4f6abff1d38ad85054","modified":1615270385840},{"_id":"themes/pure/_source/about/index.md","hash":"9c95cabb533409d06daefc4295021ad199761efc","modified":1615270385840},{"_id":"themes/pure/_source/categories/index.md","hash":"5d2a4f103d27bebbe3eef1604649d0f5c6d86ac6","modified":1615270385840},{"_id":"themes/pure/_source/books/index.md","hash":"cf4163959c23244059cbbbc1c0fe379cc3b2cb73","modified":1615270385840},{"_id":"themes/pure/_source/tags/index.md","hash":"42e9c904ea63b0a7dd4033e2e8f153225bc5cda5","modified":1615270385840},{"_id":"themes/pure/_source/links/index.md","hash":"febcf87eb0ab3c5080578275d25f3970bba39625","modified":1615270385840},{"_id":"themes/pure/_source/repository/index.md","hash":"ed0e082c30f233dd5c140d188f1e4bce44bdbf79","modified":1615270385840},{"_id":"themes/pure/layout/_common/footer.ejs","hash":"d8ae2e453532131f41a6b8df05fc651a10253fa5","modified":1615270513253},{"_id":"themes/pure/layout/_common/head.ejs","hash":"a48ef0fa22712b29ec044b9e5134461f3a21c10d","modified":1615270385844},{"_id":"themes/pure/layout/_common/header.ejs","hash":"3d739d1e2b2991927c08ec222db123830a44a519","modified":1615270385844},{"_id":"themes/pure/layout/_common/script.ejs","hash":"0031114d2a58f8601c2869f78ceedc75a10be90d","modified":1615270385844},{"_id":"themes/pure/layout/_common/social.ejs","hash":"a35a2610e9da762df96587b76b51470507a88cad","modified":1615270385844},{"_id":"themes/pure/layout/_partial/archive-category.ejs","hash":"9c364fd6b5172890784141802f5f466241d233fd","modified":1615270385844},{"_id":"themes/pure/layout/_partial/archive-book.ejs","hash":"977f97f3636947006ad738e502858c46d4cd5ec7","modified":1615270385844},{"_id":"themes/pure/layout/_partial/archive-link.ejs","hash":"fe4d9bf526d8176683cea89b8561ced571374db0","modified":1615270385844},{"_id":"themes/pure/layout/_partial/archive.ejs","hash":"4d6793f50d41fbd47dc50aa36b24d496006bba6c","modified":1615270385844},{"_id":"themes/pure/layout/_partial/archive-tag.ejs","hash":"5de90244c3cedad531cccc03c40e5f9a3aef3c61","modified":1615270385844},{"_id":"themes/pure/layout/_partial/article-about.ejs","hash":"7b80319daeb63401d1745b81cd9a6d1d21a4fb60","modified":1615270385844},{"_id":"themes/pure/layout/_partial/item-post.ejs","hash":"9f755b0da1ea928dece32c2050d8a04b3a9fb13b","modified":1615270385844},{"_id":"themes/pure/layout/_partial/article.ejs","hash":"0f9b71de0087d1f777d92c5a0f3873971aec5a5b","modified":1615270385844},{"_id":"themes/pure/layout/_partial/pagination.ejs","hash":"41a319642da5af07d6cfb8525796aa610b721879","modified":1615270385844},{"_id":"themes/pure/layout/_partial/sidebar-about.ejs","hash":"e10ea0176ba87e64888234bafedc01c92544352c","modified":1615270385844},{"_id":"themes/pure/layout/_partial/archive-list.ejs","hash":"c66c86d6a6a90e00494c380603426fc0f4006311","modified":1615270385844},{"_id":"themes/pure/layout/_partial/archive-repository.ejs","hash":"e39dc762d9fe238cede462532e40eaa3d8651122","modified":1615270385844},{"_id":"themes/pure/layout/_partial/sidebar-toc.ejs","hash":"152538ceceb0fdef65c46470ebf0189f7b891c5b","modified":1615270385844},{"_id":"themes/pure/layout/_partial/archive-post.ejs","hash":"13039fec017332029122ef99901755fcecbfc8ea","modified":1615270385844},{"_id":"themes/pure/layout/_partial/sidebar.ejs","hash":"2aa8a9f90838e7c105e75e6d3d03cbf860bb1239","modified":1615270385844},{"_id":"themes/pure/layout/_script/analytics.ejs","hash":"e756a81f8c20a187fb863b9689f2f1fa15e2f4e1","modified":1615270385844},{"_id":"themes/pure/layout/_script/comment.ejs","hash":"6f951510bab9dc15474b6664e0329defccf29a30","modified":1615270385844},{"_id":"themes/pure/layout/_script/douban.ejs","hash":"143087db0573772b0bdaf7f93312553158942ec7","modified":1615270385844},{"_id":"themes/pure/layout/_script/mathjax.ejs","hash":"f618393ab971b2faa80d541f2e6a553d9ace9816","modified":1615270385844},{"_id":"themes/pure/layout/_script/fancybox.ejs","hash":"8f1be01e70a15b2c31ae57d8c6bce54622ebf8a7","modified":1615270385844},{"_id":"themes/pure/layout/_script/pv.ejs","hash":"fb9b5f16029f2ccef4b83cf4facfdcdd748b65b4","modified":1615270385844},{"_id":"themes/pure/layout/_script/search.ejs","hash":"7be33dc260ce788aa1a2cd3bd0386d95057533cb","modified":1615270385844},{"_id":"themes/pure/layout/_script/repository.ejs","hash":"14f2e7d4c1055ff6a5f5867dc0e9a9f6f4c28fe1","modified":1615270385844},{"_id":"themes/pure/layout/_search/index.ejs","hash":"f8d5a9c3f777250f5fb6512bba585307f784d5cd","modified":1615270385844},{"_id":"themes/pure/layout/_search/index-mobile.ejs","hash":"c726e234c0166da69fdfbd3dd613a5eaf4c80258","modified":1615270385844},{"_id":"themes/pure/layout/_search/baidu.ejs","hash":"67aab280a3ea34429f086cc5c3de7de17727c567","modified":1615270385844},{"_id":"themes/pure/layout/_search/insight.ejs","hash":"4af3e92ef98bedba9680d45699cb04dde4640536","modified":1615270385844},{"_id":"themes/pure/layout/_widget/archive.ejs","hash":"af8ad7f62877764b75d5272d9d899fd6c8e3845c","modified":1615270385844},{"_id":"themes/pure/layout/_search/swiftype.ejs","hash":"4baeca36e410181300ae7d47ba1fb4755bcfcff0","modified":1615270385844},{"_id":"themes/pure/layout/_widget/board.ejs","hash":"acd27451be52703e670ce0b313f2da6fa24071e4","modified":1615270385844},{"_id":"themes/pure/layout/_widget/recent_posts.ejs","hash":"8942d60311797a591ba2d157c5cdd23e85ceb694","modified":1615270385844},{"_id":"themes/pure/layout/_widget/category.ejs","hash":"331b7642a0f58b9088b937436ab39076a4c5dd7e","modified":1615270385844},{"_id":"themes/pure/layout/_widget/tag.ejs","hash":"487628925da5fcac91463cdad3d9e55d071bd5ed","modified":1615270385844},{"_id":"themes/pure/layout/_widget/tagcloud.ejs","hash":"3291108e5411c48b2c5b3e17adace6ffa90d1c29","modified":1615270385844},{"_id":"themes/pure/source/images/avatar.jpg","hash":"0ff2cc3e912314f83a0a1182c8c7827c8e42ea49","modified":1615272070128},{"_id":"themes/pure/source/images/thumb-default.png","hash":"e8403b97ed9251f9f5207765b0ce796c5000b4ba","modified":1615270385864},{"_id":"themes/pure/source/images/xingqiu-qrcode.jpg","hash":"ef2c2848dc79db6df7c752510651ed8ba57f2daf","modified":1615270385864},{"_id":"themes/pure/source/js/application.js","hash":"46d1fb207ce5f0acb83803f927985dfcea86f9ef","modified":1615270385864},{"_id":"themes/pure/source/js/insight.js","hash":"298e8ca42517984bd26f34caa4c45560b0e909ad","modified":1615270385864},{"_id":"themes/pure/source/js/application.min.js","hash":"34d765e982c7d6360c37f82202d99f63ac40e408","modified":1615270385864},{"_id":"themes/pure/source/fonts/README.md","hash":"c5772b99ad81291fb137b330813f866bdceea0a3","modified":1615270385860},{"_id":"themes/pure/source/fonts/iconfont.eot","hash":"6819d9bb643bdeafc17bfecb0746ae641b018fdf","modified":1615270385860},{"_id":"themes/pure/source/fonts/iconfont.ttf","hash":"9b8837f9f79cf6ab794736301d0665345183a20c","modified":1615270385864},{"_id":"themes/pure/source/fonts/iconfont.woff","hash":"78d29194287b8885d25212048c4f787705212a6e","modified":1615270385864},{"_id":"source/_posts/java/java-arraydeque-source-1.md","hash":"1d22582e8dd47601fe96375bdaf293bf2297245d","modified":1611654543570},{"_id":"source/_posts/java/java-linkedlist-source-1.md","hash":"9e604d119ee025b0b46b2d58e5ddadf31b08dcb7","modified":1611654543570},{"_id":"themes/pure/source/js/plugin.min.js","hash":"07fe34638f9832702c5f81d8583c5e4e8b3d9659","modified":1615270385868},{"_id":"source/_posts/archive/web-security/oauth-and-jwt.md","hash":"b7dd2c5a28a9aeff4dc15629407f8f59f357fac1","modified":1611654543570},{"_id":"source/_posts/archive/web-security/spring-security-oauth-server-demo.md","hash":"ec1d9bbae88c707906aa2926a65967016bc23d9f","modified":1611654543570},{"_id":"source/_posts/archive/web-security/sso-and-cas.md","hash":"8f932d84dd73e1f32be32d91db78b5941015bec7","modified":1611654543570},{"_id":"source/_posts/java/disruptor/926f33f0-651d-471a-ad0c-b632fcce8c0f.md","hash":"404a46a04d1be6cd864be664d74bbda887f4bc9a","modified":1614564051507},{"_id":"source/_posts/java/disruptor/18e3fbd6-ff4b-4a0a-b82f-a547dbef8d0c.md","hash":"6dc09c5eb118cd114be8691deee4083560301726","modified":1614564275707},{"_id":"source/_posts/java/disruptor/9a1bdb74-8ed3-4905-88bc-7b3b4e0a4af2.md","hash":"d37a5898b37c8cc9b4414d8457fec6cb06c4b28b","modified":1614564116778},{"_id":"source/_posts/java/disruptor/c16646bf-1474-42a7-a5cd-84b99669062c.md","hash":"ff6757d61ef5b996aa3c91d1340e516da30b35ac","modified":1614564188433},{"_id":"source/_posts/java/disruptor/b3025291-ae52-4d26-a70c-66a79bda07d7.md","hash":"b9452a01a0279c16dea8c7a869e7a1032a750ac7","modified":1614564006429},{"_id":"source/_posts/java/disruptor/a552f7f0-4cbe-4628-8fcf-02f8b8730b56.md","hash":"2ae13803e24871f27decc79379cd95a8a26c2354","modified":1614563956063},{"_id":"source/_posts/java/disruptor/ff51336d-70d4-449c-9214-fff2542bef1f.md","hash":"f6e03ee8e91b1c5298b3699c20e5016be89bf88f","modified":1614564228723},{"_id":"source/_posts/java/jvm/java-class-init.md","hash":"77d5b6b3f049da10d8f95bbee36a79ec5b666ba7","modified":1611654543570},{"_id":"source/_posts/java/jvm/java-class-load-2.md","hash":"dfa4dd6b6b2636ab8a9a7a57fbd8e53c6f234098","modified":1611654543570},{"_id":"source/_posts/java/jvm/java-class-load-1.md","hash":"2dd13e5e51fd9c3a2f6e8109ab247179ba6228f1","modified":1611654543570},{"_id":"source/_posts/java/jvm/java-jvm-stack-1.md","hash":"6ba3cbf60689af7b31c20070d695036e50a1e4c1","modified":1611654543570},{"_id":"source/_posts/java/jvm/jvm-gc-alg.md","hash":"a87f611afdc9bd82b1cee108f4837bf8560181ec","modified":1611654543570},{"_id":"source/_posts/java/jvm/jvm-javastack-EscapeAnalysis.md","hash":"7f43219d4f898a991be24b1f4fe319b406ee7069","modified":1611654543570},{"_id":"source/_posts/java/jvm/jvm-object-four-quote.md","hash":"3e7fd831ab9eec00a2699420bae6ee603cc30774","modified":1611654543570},{"_id":"source/_posts/java/jvm/jvm-object-is-alive.md","hash":"08f890ecd4ac52fc80168f44963b1531f039af55","modified":1611654543570},{"_id":"source/_posts/java/jvm/jvm-running-data-area.md","hash":"0baf10d9701756b375e3b49e9fc7e3001a08cbad","modified":1611654543570},{"_id":"source/_posts/java/nio/0702ff46-16cd-4520-9d33-0794cfda4b09.md","hash":"30cdb07b557632c7ed8acee6e2beca9766a81561","modified":1614564564058},{"_id":"source/_posts/java/nio/2571330c-67ef-4d4c-8717-6c96768009c7.md","hash":"14a6c10459fdb25ccd8bd3cfda4eb69d69ad5135","modified":1614564592898},{"_id":"source/_posts/java/nio/534d0985-a4a0-4239-ae81-d76378f64552.md","hash":"c9b15c3c4d869df7a5f2fd3d685a4a4bb5d91b80","modified":1614564597842},{"_id":"source/_posts/java/nio/8d2049e3-3eb1-46ed-a44b-57398964eb21.md","hash":"fe9a181e6b5ce58f5c15ae546c578423cad72dc2","modified":1614564602410},{"_id":"source/_posts/java/thread/create-thread-3.md","hash":"ed63e4997aa618e8444947ea92221c1e59db9feb","modified":1611654543574},{"_id":"themes/pure/layout/_script/_analytics/baidu-analytics.ejs","hash":"f314be7860c1d5930f1600d010e3120ba5c85325","modified":1615270385844},{"_id":"themes/pure/layout/_script/_analytics/google-analytics.ejs","hash":"54f1dc9375cbdb65464e0ac1b58847aa5e8bc6a5","modified":1615270385844},{"_id":"themes/pure/layout/_script/_analytics/tencent-analytics.ejs","hash":"77defb41a1613a758ff5a6a5128c6107fc584190","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/category.ejs","hash":"fcee6b4aef8b6c4627831ff8dbb2d73478511426","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/comment.ejs","hash":"3c0da69fcea6ccfd97b82d50e740107a88eec5c4","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/copyright.ejs","hash":"a9d3d05428e5844a07706c7fcfeb842e44a36a64","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/date.ejs","hash":"7d4979652998abf92a64bfae8157b70d6e514057","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/donate.ejs","hash":"a251dc34d660601a2e8b7d98b3bfe2b9023dbbce","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/gallery.ejs","hash":"3d9d81a3c693ff2378ef06ddb6810254e509de5b","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/nav.ejs","hash":"95eabc0fe4033ec61b240a16eeaf7dc62a9e3da1","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/pv.ejs","hash":"ec3ccf322432afc2761f860c5a3000ac34d46e4c","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/tag.ejs","hash":"39f53ead07f75c181a7ba93e586dd1b8171620f1","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/thumbnail.ejs","hash":"080d5c5f3e95accf51893a7092695fe32d34a087","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/title.ejs","hash":"2f275739b6f1193c123646a5a31f37d48644c667","modified":1615270385844},{"_id":"themes/pure/layout/_partial/post/wordcount.ejs","hash":"bd06c4c8449ed96aabf655fe1ae3be1f0707b81e","modified":1615270385844},{"_id":"themes/pure/layout/_script/_search/baidu.ejs","hash":"9b60ffa2e2725a993e9cecfb81ddedd9b9361011","modified":1615270385844},{"_id":"themes/pure/layout/_script/_search/insight.ejs","hash":"3543c11d060feaf9381b5d87564b01ffef0e0a59","modified":1615270385844},{"_id":"themes/pure/layout/_script/_comment/disqus.ejs","hash":"a051e3eddc75586e69131c29ab8c89d69626e0fd","modified":1615270385844},{"_id":"themes/pure/layout/_script/_comment/gitalk.ejs","hash":"fb01f1631c3ae7fe6211dc03233506cb344229be","modified":1615270385844},{"_id":"themes/pure/layout/_script/_comment/gitment.ejs","hash":"a64852076483395738a398deb4c10bdb0f3b7b71","modified":1615270385844},{"_id":"themes/pure/layout/_script/_comment/livere.ejs","hash":"5ab997d5ee4475d2f89f882fab4a52648dbe0e30","modified":1615270385844},{"_id":"themes/pure/layout/_script/_comment/youyan.ejs","hash":"095649a173573d03b5845c2e331ec7be976b152a","modified":1615270385844},{"_id":"themes/pure/layout/_script/_comment/valine.ejs","hash":"acf81f9a59dc45f197d723f70484de5fcd166577","modified":1615270385844},{"_id":"themes/pure/source/css/style.min.css","hash":"1d23abc76726ebe042f7df4749f00f8f73338444","modified":1615270385860},{"_id":"themes/pure/source/images/donate/wechatpayimg.jpg","hash":"f45b77d6149d598f9e0a5fbaa96baae6a0a50586","modified":1615271571902},{"_id":"themes/pure/source/images/favatar/SzsFox-logo.png","hash":"d71fcc73b7bc2a439d8c7ba461137856d190bd76","modified":1615270385864},{"_id":"themes/pure/source/images/favatar/chuangzaoshi-logo.png","hash":"7fa5734072050952159a02d330bbc008b5a99122","modified":1615270385864},{"_id":"themes/pure/source/images/favatar/idesign-logo.png","hash":"6b150a2dbb9912b7a7662255c27e4d4baaecee71","modified":1615270385864},{"_id":"themes/pure/source/js/plugin.js","hash":"a8524d42b8621bfaa06602a163c6a1f82702b91d","modified":1615270385864},{"_id":"themes/pure/source/js/jquery.min.js","hash":"5a9dcfbef655a2668e78baebeaa8dc6f41d8dabb","modified":1615270385864},{"_id":"themes/pure/source/js/plugin.js.map","hash":"1730c0cc660f863120aca0a439d7264e2e245fc5","modified":1615270385864},{"_id":"themes/pure/source/fonts/iconfont.svg","hash":"25929e6e74f7027acd1f6467a67e95b153bcd8d5","modified":1615270385864},{"_id":"themes/pure/source/css/style.css","hash":"3b693ce41c2e35ece4773593e94b4c17aeaee02f","modified":1615270385860},{"_id":"themes/pure/source/images/donate/alipayimg.jpg","hash":"f8ab44263345f50f4a3c2772cf45d5c1a19edcac","modified":1615271654070},{"_id":"themes/pure/screenshot/pure.psd","hash":"a31cea40b45bdc31f051fca2f1e2f4ecbaee1a94","modified":1615270385860},{"_id":"public/baidusitemap.xml","hash":"8d780eb7a44546f415e2aa08fc70f399f98fac69","modified":1615275200928},{"_id":"public/search.xml","hash":"1444f658abb8f8159058ec772955781c12207841","modified":1615275200979},{"_id":"public/atom.xml","hash":"4f362fe4decc28000fb1ac7d90956d98eb05717c","modified":1615275201046},{"_id":"public/sitemap.xml","hash":"18b47df017359505b5554c3d0f484ea9ac22abaf","modified":1615275201047},{"_id":"public/clock.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1615275202815},{"_id":"public/about/index.html","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1615275202816},{"_id":"public/404.html","hash":"b40eb0565209fcb677c995a4bbdbcddd5cc752f8","modified":1615275202816},{"_id":"public/ea667b0f708cd4ded0b79ebbdd99373a.html","hash":"dc58247ccb37ba79de6f00b3ec15c6eb636280ad","modified":1615275202816},{"_id":"public/categories/index.html","hash":"ab266bd79a21ae7df639b81f62e608ca9b749571","modified":1615275202816},{"_id":"public/friends/index.html","hash":"547045ada4ebb8af6a5d6cd5f8a53fd6878301ae","modified":1615275202816},{"_id":"public/tags/index.html","hash":"87b212fba8d961f9e2c6188814cc2ec1c71e9061","modified":1615275202816},{"_id":"public/java/nio/534d0985-a4a0-4239-ae81-d76378f64552/index.html","hash":"9ac7908f843a241bd1981df9f0b3f47469a0e81f","modified":1615275202816},{"_id":"public/java/nio/2571330c-67ef-4d4c-8717-6c96768009c7/index.html","hash":"a3fa1e7264085cb6da98a7bcc63ae3f5b7406c26","modified":1615275202816},{"_id":"public/java/nio/8d2049e3-3eb1-46ed-a44b-57398964eb21/index.html","hash":"cae3401b81f33c393fcc46aafa68ef46415d56ca","modified":1615275202816},{"_id":"public/java/nio/0702ff46-16cd-4520-9d33-0794cfda4b09/index.html","hash":"bc7dcd0776a09c17872c20ae210995e741dd128d","modified":1615275202816},{"_id":"public/java/disruptor/c16646bf-1474-42a7-a5cd-84b99669062c/index.html","hash":"ad0f709317832d3784a9ad9f65b16c2a96be7051","modified":1615275202816},{"_id":"public/java/disruptor/18e3fbd6-ff4b-4a0a-b82f-a547dbef8d0c/index.html","hash":"b1068c1b7cf41ff4dd21ff41c6f293fd23ea84a6","modified":1615275202816},{"_id":"public/java/disruptor/ff51336d-70d4-449c-9214-fff2542bef1f/index.html","hash":"09ed62c514900212912ea9fb64e5332630c1e31d","modified":1615275202816},{"_id":"public/java/disruptor/9a1bdb74-8ed3-4905-88bc-7b3b4e0a4af2/index.html","hash":"80138f57a301f72261e0481a28ad4f5c787c084b","modified":1615275202816},{"_id":"public/java/disruptor/b3025291-ae52-4d26-a70c-66a79bda07d7/index.html","hash":"421cba7a7676f55b1a693a2ff50726de7e3363ed","modified":1615275202816},{"_id":"public/java/disruptor/a552f7f0-4cbe-4628-8fcf-02f8b8730b56/index.html","hash":"54e85e1816cb39a6f6c73de4f4fcfb10206d83ad","modified":1615275202816},{"_id":"public/java/disruptor/926f33f0-651d-471a-ad0c-b632fcce8c0f/index.html","hash":"21ccfc7896889a01f5b380f615ee1a1d36db28f6","modified":1615275202816},{"_id":"public/dubbo/dcf9d2d8-9c11-404a-874d-57834303dcac/index.html","hash":"66a6844d7b975807ca74420ceef043b5b5e2944a","modified":1615275202816},{"_id":"public/tool/438b5300-ffcf-443b-a1fa-2d2dbb6ea113/index.html","hash":"1289976fba566e416d6ce5c7c3106d074baf4430","modified":1615275202816},{"_id":"public/linux/79b5fe12-9c60-4b93-be92-dffb00fa39c7/index.html","hash":"405fa13018bbd7a532558198b96cd5994bc9948b","modified":1615275202816},{"_id":"public/linux/github-actions-build-pi-kernerl/index.html","hash":"8270cd5747d44a565c7e83a6ea80bc30451cfc94","modified":1615275202816},{"_id":"public/recommend/git-commend-note/index.html","hash":"c011d6c982642e8152f30ce5b371c899bb72f7ac","modified":1615275202816},{"_id":"public/spring/fegin-resttemplate-addheard/index.html","hash":"830dedcadf1c2b4e10d540c03afede7379a7a2ca","modified":1615275202816},{"_id":"public/java/mdc-test/index.html","hash":"e258040e77a6e35bf2f1203daa2887e8a1c362d7","modified":1615275202816},{"_id":"public/java/jdkproxy-cglib/index.html","hash":"d4b4c5d113d4f2ae80bd5f25cd5baa37a6f29e42","modified":1615275202816},{"_id":"public/java/java-base-data-pack/index.html","hash":"579914f11836add5cc15212216811049fb888376","modified":1615275202816},{"_id":"public/java/jvm/java-jvm-stack-1/index.html","hash":"7a15c7c3fa276726ba34399ff28849f31195c044","modified":1615275202816},{"_id":"public/java/jvm/java-class-load-2/index.html","hash":"4a6c8270e31c12c365dd9b54e8fe0ada7e950d11","modified":1615275202816},{"_id":"public/java/jvm/java-class-load-1/index.html","hash":"de90d60c533c614417cf655d4b32811a7d462cfe","modified":1615275202817},{"_id":"public/java/jvm/java-class-init/index.html","hash":"6dcf61b013ffd5055fbd492be4fec676c332be94","modified":1615275202817},{"_id":"public/java/thread/create-thread-3/index.html","hash":"d25de224ba4aa686d0d0ad85e9f19466143b424c","modified":1615275202817},{"_id":"public/tool/git-tool-command/index.html","hash":"acb2093509aad8ca9ea40978bff10718851cdea5","modified":1615275202817},{"_id":"public/spring/apring-aop-ann/index.html","hash":"342b6c8b7e9411b02eb38cd3ebe849ad030e589c","modified":1615275202817},{"_id":"public/java/jvm/jvm-gc-alg/index.html","hash":"1c95ce5ae9256f45a0f4b2eb0657102ff686e010","modified":1615275202817},{"_id":"public/java/jvm/jvm-object-four-quote/index.html","hash":"59c4423aa546ac8fd63ae14d86cfe3e14d2a25fb","modified":1615275202817},{"_id":"public/java/jvm/jvm-object-is-alive/index.html","hash":"465be37870215018e55d8e02de994c0f250d28f0","modified":1615275202817},{"_id":"public/java/jvm/jvm-running-data-area/index.html","hash":"6d44a6b5b7ad164a89461147cf55f2b8e815edfa","modified":1615275202817},{"_id":"public/java/jvm/jvm-javastack-EscapeAnalysis/index.html","hash":"5828284dbc9616ff84a66aaa0252d2e5577e828f","modified":1615275202817},{"_id":"public/archive/web-security/spring-security-oauth-server-demo/index.html","hash":"ae9ca04ca8c40e2879e54798d677600307ad657c","modified":1615275202817},{"_id":"public/archive/web-security/sso-and-cas/index.html","hash":"0570cc4dfd2da4cc7be6d7f509108a31d94a5c64","modified":1615275202817},{"_id":"public/archive/web-security/oauth-and-jwt/index.html","hash":"86d633597f93bf9bfe847776de0d834cb86809a7","modified":1615275202817},{"_id":"public/linux/linux-fastdfs-install/index.html","hash":"b34501f306644da7df8c613cdc8a81f9cde5a39b","modified":1615275202817},{"_id":"public/mysql/mysql-utf8mb4-error/index.html","hash":"36a2dd0f20982213caeecfeb5243b091031eb668","modified":1615275202817},{"_id":"public/algorithm/algorithm-avltree-01/index.html","hash":"dd03b9b7066626b531f7a18131941425cb8752cc","modified":1615275202817},{"_id":"public/recommend/recommend-tool-1/index.html","hash":"5b989e1ba1aaa3a50be03b26f34cbbea627184db","modified":1615275202817},{"_id":"public/java/java-arraydeque-source-1/index.html","hash":"eaccbf35f8945f46347197f0b29af68a0e571663","modified":1615275202817},{"_id":"public/java/java-linkedlist-source-1/index.html","hash":"e8bc98b0c2ac18d3ebca969e3b2c41b5a2df1d80","modified":1615275202817},{"_id":"public/java/java-arraylist-source-1/index.html","hash":"c9969e8c7fea7c447422dd71065ea407a6169390","modified":1615275202817},{"_id":"public/java/java-base-wei/index.html","hash":"cfd30f7c1d8d5e0260fcdb2e783aefa4dfc8b14d","modified":1615275202817},{"_id":"public/gof/gof-builder/index.html","hash":"58b21d6b904cf5653f54eb56ff0bb691026cffc4","modified":1615275202817},{"_id":"public/gof/gof-prototype/index.html","hash":"902fed001510fdb931b68723a48796c240750e87","modified":1615275202817},{"_id":"public/mysql/mysql-update-driver-connector-8/index.html","hash":"e99163a9db9281ed9754b2452b962afc71eb1f83","modified":1615275202817},{"_id":"public/docker/docker-transfer-pit/index.html","hash":"5bd65138df02603f7f6ad47d81ebcb4d352b23a9","modified":1615275202817},{"_id":"public/gof/gof-taemplate-method/index.html","hash":"290f1393b94c3e89620c6c4ae4789a4214e7aa86","modified":1615275202817},{"_id":"public/algorithm/array-vs-linked/index.html","hash":"39034545cc910e3072473c21f5052af92c12b81f","modified":1615275202817},{"_id":"public/gof/gof-abstract-factory/index.html","hash":"1a5c45e8eba0e8ec73ae0682eab95759431bfb7e","modified":1615275202817},{"_id":"public/gof/gof-factory-method/index.html","hash":"58ad66a3fcee42ad169fa71543ca7b016b33e77f","modified":1615275202817},{"_id":"public/gof/gof-oop-7-all/index.html","hash":"b9aeafbac2caace218687ea6095707e55fdd2208","modified":1615275202817},{"_id":"public/jenkins/build-jenkins-sonarqube/index.html","hash":"1cd4841bc19a8e08d52bd5fccc32fe2a968d9567","modified":1615275202817},{"_id":"public/java/java-8-stream-method/index.html","hash":"0c5a23b49f741bb0e44c6622c46e61b685fdaa3f","modified":1615275202818},{"_id":"public/java/java-array-init/index.html","hash":"27bc306844f64fe6e3cf8e1648b317f78c1aa73e","modified":1615275202818},{"_id":"public/spring/spring-boot-resttemplate-example/index.html","hash":"814f3905e0354c69ee23d6096ce7fd38f288cebd","modified":1615275202818},{"_id":"public/java/nacos-post-error/index.html","hash":"bae78d99db32f1bc1f7c968e99f8c904086718b8","modified":1615275202818},{"_id":"public/jenkins/problem-jenkins-01/index.html","hash":"7411d129f80e7c0ec92710a2e923b96ff20a8c02","modified":1615275202818},{"_id":"public/jenkins/build-jenkins-ci-cd/index.html","hash":"12a7cea0cd04b4953f364c2b04264cf8cf571444","modified":1615275202818},{"_id":"public/jenkins/build-jenkins-mavne/index.html","hash":"ae4a3ea121cae6e002103f3a1e4d6d3c2b55582c","modified":1615275202818},{"_id":"public/jenkins/problem-jenkins-02/index.html","hash":"604fa0fbc9c098a180d0b8a689d8d439a6f36e9a","modified":1615275202818},{"_id":"public/jenkins/build-jenkins-docker/index.html","hash":"2b1736cc704baa01cbf09262c9b92d2975857fa2","modified":1615275202818},{"_id":"public/gof/gof-singleton/index.html","hash":"0eb6879e3c50f2e83c5efce7fc471ba8d1eda2be","modified":1615275202818},{"_id":"public/rocketmq/rocketmq-cluster-build/index.html","hash":"86ed2e6da8d6f11ca13c82687ec1f0fe9716e59f","modified":1615275202818},{"_id":"public/vue/vue-cli3-11-problem/index.html","hash":"be1f920d9485b016ad080dddffdccf1b989246a8","modified":1615275202818},{"_id":"public/docker/docker-mysql/index.html","hash":"affaf785860eb376fc99512be561ba28aca83b2f","modified":1615275202818},{"_id":"public/linux/build-docker-pi/index.html","hash":"a4decf16f243b45360fba3f29b4ecc051102fe78","modified":1615275202818},{"_id":"public/linux/problem-jdk-timezone/index.html","hash":"f4824fe3a9a53219bafed6a53f880efa0a0cebac","modified":1615275202818},{"_id":"public/java/java-equals/index.html","hash":"15113e393c3e392892728f5f30f28fab4016ffed","modified":1615275202818},{"_id":"public/java/java-isnull-four/index.html","hash":"47e40eced4e41ec9c0e3f88205a2140e112c955d","modified":1615275202818},{"_id":"public/algorithm/algorithm-recursive-01/index.html","hash":"8d33eebb9e271895c55c1c729655a7b6a785bd3a","modified":1615275202818},{"_id":"public/java/problem-java-base64/index.html","hash":"17fdb7f66354383940ec12fa96bdc8c9ea931a45","modified":1615275202818},{"_id":"public/archives/index.html","hash":"1bc26b20596107bcaead558df1d7ae8c57571ddb","modified":1615275202818},{"_id":"public/archives/page/2/index.html","hash":"8fcc2255ce142d5d07ae44d5a2792cffc882625b","modified":1615275202818},{"_id":"public/archives/page/3/index.html","hash":"2313ef80c6ab82311f37f796850a53cfa7e10d7a","modified":1615275202818},{"_id":"public/archives/page/4/index.html","hash":"822a078dab4198d41bc5b3a9bb07ab08144ee91f","modified":1615275202818},{"_id":"public/archives/page/5/index.html","hash":"69c845ab910835e99fe36e324130e79f48528bc3","modified":1615275202818},{"_id":"public/archives/page/6/index.html","hash":"a5daafeda5c4739cd6cf1b65795a40aaa7e51cc3","modified":1615275202818},{"_id":"public/archives/page/7/index.html","hash":"c65945c5b06d36b9589323a991474165b3910d7d","modified":1615275202818},{"_id":"public/archives/page/8/index.html","hash":"9f0b1cae33edc9b389edb5b086cd7ead29245dc1","modified":1615275202818},{"_id":"public/archives/2019/index.html","hash":"177d6139581f4761bf45cf6fe646a45f90096222","modified":1615275202818},{"_id":"public/archives/2019/page/2/index.html","hash":"56882306e2f97d1aead9a32768f3781caedcb223","modified":1615275202818},{"_id":"public/archives/2019/page/3/index.html","hash":"a60ed419d54f78f5c2b8fd1a1c6c906483869f1b","modified":1615275202818},{"_id":"public/archives/2019/08/index.html","hash":"53160575cbbd3464f5c3c01a94f56a2d48dc6810","modified":1615275202818},{"_id":"public/archives/2019/09/index.html","hash":"3859c2a75b77a580a047055e811821335790f810","modified":1615275202818},{"_id":"public/archives/2019/10/index.html","hash":"314406d24e07f7d3d24063f8e970fa0a752818f7","modified":1615275202819},{"_id":"public/archives/2019/11/index.html","hash":"fe6b6b2e0fae3b1d87c513ccd067daa79cb398b3","modified":1615275202819},{"_id":"public/archives/2019/12/index.html","hash":"a23aee077b46365191997a414553150b5f0451fc","modified":1615275202819},{"_id":"public/archives/2019/12/page/2/index.html","hash":"d7bc7847cd63428dc26d7500282f53a732e26508","modified":1615275202819},{"_id":"public/archives/2020/index.html","hash":"6334bdd35e4fda5ac5f93f8a9dbe3c90a3c339ea","modified":1615275202819},{"_id":"public/archives/2020/page/2/index.html","hash":"611ba29c1974c479516f6db4319061d11940ff3e","modified":1615275202819},{"_id":"public/archives/2020/page/3/index.html","hash":"6f2d7b7cc6b0f5d61bf289b6f7f17c6b7e6a8a6b","modified":1615275202819},{"_id":"public/archives/2020/01/index.html","hash":"b8d39f66accdf4a264e3ef8903fb988903030727","modified":1615275202819},{"_id":"public/archives/2020/02/index.html","hash":"7cdf50dc1f959bd3995f787de14b3e11a405c113","modified":1615275202819},{"_id":"public/archives/2020/04/index.html","hash":"03e3aeae93daa24d8c27f22c93d1c0a64a8e287e","modified":1615275202819},{"_id":"public/archives/2020/05/index.html","hash":"ed01e1d7c0b3a9ed62e991972de780cec19075d0","modified":1615275202819},{"_id":"public/archives/2020/06/index.html","hash":"45e3d8e232926b292551d021703ab0a80f5c6da8","modified":1615275202819},{"_id":"public/archives/2020/09/index.html","hash":"aef575d443d8533f3ef36067b31f703e89298bf3","modified":1615275202819},{"_id":"public/archives/2021/index.html","hash":"67aadbe1bb56c836fa6c330f78213f29edef08a4","modified":1615275202819},{"_id":"public/archives/2021/page/2/index.html","hash":"b6df914ee75bf84c1115e36b385194f5fd1653a9","modified":1615275202819},{"_id":"public/archives/2021/01/index.html","hash":"6f03dd146a0efd82f18c5a3355de3b315a30c7a5","modified":1615275202819},{"_id":"public/archives/2021/02/index.html","hash":"9a88feeb3e14010b29f0e62fe597f00e289193c0","modified":1615275202819},{"_id":"public/archives/2021/03/index.html","hash":"ef156f39933a71a055f5f17145a9d0ff65defff3","modified":1615275202819},{"_id":"public/archives/2021/03/page/2/index.html","hash":"c380ec97894fddc527fe3d1e4329dff33dc63a98","modified":1615275202819},{"_id":"public/categories/Algorithm/index.html","hash":"191f34a1538068f32fbbf7541e3017f6ca91f7c2","modified":1615275202819},{"_id":"public/categories/Docker/index.html","hash":"772d2bcecf5411523a9b9204b36fddd8edb342b0","modified":1615275202819},{"_id":"public/categories/GOF/index.html","hash":"1a40ac0ea91328d7297759970edc42575daa398d","modified":1615275202819},{"_id":"public/categories/Java/index.html","hash":"56ebc05882aef850a17a1d23a3ef53bc87e042b3","modified":1615275202819},{"_id":"public/categories/Java/page/2/index.html","hash":"c8921d2fd56ff2fa08300b20db902e89b9d47557","modified":1615275202819},{"_id":"public/categories/Java/page/3/index.html","hash":"fcbfa67f8ac768bbdf1a17c862c351098ad2f5f4","modified":1615275202819},{"_id":"public/categories/Dubbo/index.html","hash":"66c713c35a5deb4897366f740666e8729531c8fe","modified":1615275202819},{"_id":"public/categories/Jenkins/index.html","hash":"03980ed1a4213ce525cb672aab14927d4d9b0abd","modified":1615275202819},{"_id":"public/categories/Linux/index.html","hash":"b217de1698dc2a08166738befc87b41c89b4b624","modified":1615275202819},{"_id":"public/categories/MySQL/index.html","hash":"7d18c3ce4c5b854f5f19f10e0252824e5650beef","modified":1615275202819},{"_id":"public/categories/Spring/index.html","hash":"7a009f7ef424f956fb0c23b0aeda558197f16c33","modified":1615275202819},{"_id":"public/categories/RocketMq/index.html","hash":"782f299277883a4746e4950bc19b3f20911c8a1a","modified":1615275202819},{"_id":"public/categories/Recommend/index.html","hash":"1f4ff9bebb9cca004d035d316ab292b28c69416b","modified":1615275202819},{"_id":"public/categories/Tool/index.html","hash":"c31c0e5be6dbf2c2c66a1060df044f3dbcd3aec9","modified":1615275202819},{"_id":"public/categories/Vue/index.html","hash":"094a8a577459ad1e1c2b374afa374ace2b392fe8","modified":1615275202820},{"_id":"public/categories/WebSecurity/index.html","hash":"cbfdecff2384d8a3d9702bdd86cfbe8b0ecd300f","modified":1615275202820},{"_id":"public/categories/JVM/index.html","hash":"6b49d05aa0c1e7ad31c8b9ed1208172bc905f569","modified":1615275202820},{"_id":"public/categories/JVM/JAVA/index.html","hash":"58723dce3517736989f8d5d51626450f6e4f5ea5","modified":1615275202820},{"_id":"public/categories/JAVA/index.html","hash":"5dbc89359d644edc66dc628efd51759253fce9e7","modified":1615275202820},{"_id":"public/index.html","hash":"b2d8088db9f8c422699b500faff3d29d89d6a145","modified":1615275202820},{"_id":"public/page/2/index.html","hash":"fc253aaa741a8fc98d20aa5d295e69c44f016e9b","modified":1615275202820},{"_id":"public/page/3/index.html","hash":"ded616fe50ba56cf188d3c1b26f29f9bafdc7a1f","modified":1615275202820},{"_id":"public/page/4/index.html","hash":"9e3bb90ddc68e3af0fac46bdc7a845f49bfcae22","modified":1615275202820},{"_id":"public/page/5/index.html","hash":"542300cd8b4926b9aca4e3d7dcaa2aff14aa2f5e","modified":1615275202820},{"_id":"public/page/6/index.html","hash":"4a05fc853022654666e03eeab9a3c4470b2e5c17","modified":1615275202820},{"_id":"public/page/7/index.html","hash":"bca00a9223cdd71bf5665e1d8758f642caae6060","modified":1615275202820},{"_id":"public/page/8/index.html","hash":"5cf8e944712291108611492a79d41291554f00f0","modified":1615275202820},{"_id":"public/tags/Java/index.html","hash":"70abc10dbebd44e3ba66029c5954d9bbca609e56","modified":1615275202820},{"_id":"public/tags/Java/page/2/index.html","hash":"9a7f4c989f7d1d79d95ecf7d868a778e09a89fb5","modified":1615275202820},{"_id":"public/tags/Java/page/3/index.html","hash":"9184c9e92ff8417a9573c3b54ee59309b6c3f32c","modified":1615275202820},{"_id":"public/tags/Recursive/index.html","hash":"9b25e8c013904eba4a89af2347110634fe821108","modified":1615275202820},{"_id":"public/tags/Algorithm/index.html","hash":"6b24b575a082306923680376385abe5ba507ae15","modified":1615275202820},{"_id":"public/tags/Json/index.html","hash":"9b390cf41d2d5bc4e19c17fde36dcae1230ff272","modified":1615275202820},{"_id":"public/tags/AVL/index.html","hash":"c43eba38a64c1f86af5766dee886a2015afabfa5","modified":1615275202821},{"_id":"public/tags/数据结构/index.html","hash":"25c8b06898313416da6fafa172b8d000953a31b8","modified":1615275202821},{"_id":"public/tags/平衡二叉树/index.html","hash":"758f6badc3997e29c6c364d7611f541298d2ef50","modified":1615275202821},{"_id":"public/tags/二叉树/index.html","hash":"f0a4bc53cc5d7f187328c41b2199e1ff66daad02","modified":1615275202821},{"_id":"public/tags/Docker/index.html","hash":"a3a9a71518250b2212a4c19a0306d682ec0a9c75","modified":1615275202821},{"_id":"public/tags/Mysql/index.html","hash":"162cfcca8eb2c277713d1389a18134b0677f2319","modified":1615275202821},{"_id":"public/tags/Linux/index.html","hash":"ca61c26b7d7620161d1454d0bc29b65ad30ad63f","modified":1615275202821},{"_id":"public/tags/Pit/index.html","hash":"5ca094329aa80a8885d30b2bb44c13bd95c9068b","modified":1615275202821},{"_id":"public/tags/设计模式/index.html","hash":"dec172dcf50178254a9e6063a649e9cd6bc89647","modified":1615275202821},{"_id":"public/tags/抽象工厂模式/index.html","hash":"f79db9eea96ff801ea26adebf62968be35c6eb48","modified":1615275202821},{"_id":"public/tags/工厂方法模式/index.html","hash":"379c2210b30948f049eeb821dd79b73d9f58f4cb","modified":1615275202821},{"_id":"public/tags/GOF/index.html","hash":"6a04f9ffa0bf2f5dc5f485cc250ef12722960402","modified":1615275202821},{"_id":"public/tags/OOP/index.html","hash":"fba2b962e8e76959cf7f61a275c32dd27c0d6970","modified":1615275202821},{"_id":"public/tags/原型模式/index.html","hash":"df8ebf4c24ada00571ef3756b90a4fb541c0ea43","modified":1615275202821},{"_id":"public/tags/建造者模式/index.html","hash":"3def687e3088f38ddc175d5cdaa76111b9627a2c","modified":1615275202821},{"_id":"public/tags/Singleton/index.html","hash":"9506acc8cba58ecb8227ca5f350b9f7f8c895d4a","modified":1615275202821},{"_id":"public/tags/Dubbo/index.html","hash":"6cc81ab987b7a14d2bda6f6ed3c46a8e4478a301","modified":1615275202821},{"_id":"public/tags/模板方法模式/index.html","hash":"0efccb4fd9ea9ca1e6530ba3bf54cfe6473dee5f","modified":1615275202821},{"_id":"public/tags/ArrayList/index.html","hash":"ea7c351772770058d66b276cefc964bee63e55c7","modified":1615275202821},{"_id":"public/tags/源码解析/index.html","hash":"7c505ec24bc21333e7e9b646a4be1b041dcda4cc","modified":1615275202821},{"_id":"public/tags/Nacos/index.html","hash":"3366ed187ab0a27520c727c1ad1467acd3987d68","modified":1615275202821},{"_id":"public/tags/Base64/index.html","hash":"f2fc6f95807ac6b6eb1cfc814dfdeb2a8adb02f8","modified":1615275202821},{"_id":"public/tags/Jenkins/index.html","hash":"d1423e44b8e8313a3ce76cc7f99fa72389dc6086","modified":1615275202821},{"_id":"public/tags/Logback/index.html","hash":"4522d27dba78005157f5a97cb652ba91be00018d","modified":1615275202821},{"_id":"public/tags/MDC/index.html","hash":"bf5c68812061fab6ce9c4760750cbe65490f19cc","modified":1615275202821},{"_id":"public/tags/RaspberryPi/index.html","hash":"3e3addb0339254c55b75922f7443b854f305f8f3","modified":1615275202821},{"_id":"public/tags/Shell/index.html","hash":"ba8f82f60ae65dd8720131cc6e0f07dc80aee254","modified":1615275202821},{"_id":"public/tags/SonarQube/index.html","hash":"7a3e2083e8cddf226173bc905f28dc1fc81fa87b","modified":1615275202821},{"_id":"public/tags/Github-Actions/index.html","hash":"9517e13ec228a874e5895656ce7d7d262484b62b","modified":1615275202821},{"_id":"public/tags/MySQL/index.html","hash":"b45325f5359bbfcc62d3571fab367d630b831d7d","modified":1615275202821},{"_id":"public/tags/fastDFS/index.html","hash":"d14ef741ec1dbb6d684b6d864035d190870b1cba","modified":1615275202821},{"_id":"public/tags/Git/index.html","hash":"a5b5c233f50d7888086fe0a7321322d5cccea709","modified":1615275202821},{"_id":"public/tags/Spring-AOP/index.html","hash":"ae53d6009e024514dd483f012975174ec9967dff","modified":1615275202821},{"_id":"public/tags/注解/index.html","hash":"6bb73ff3b2f6278069774223517cbf8a3ca590e9","modified":1615275202822},{"_id":"public/tags/RocketMQ/index.html","hash":"ea3e158deee0a60d976e1b8de66eafc5d3027024","modified":1615275202822},{"_id":"public/tags/UI/index.html","hash":"2105bfceb4062edf9dfbda0d0038c2cd2814bc86","modified":1615275202822},{"_id":"public/tags/推荐/index.html","hash":"7bdac275041eea2379a69c6e4904538349690e36","modified":1615275202822},{"_id":"public/tags/Fegin/index.html","hash":"40944d8746c7cd05edf9d0f97e9fc516e8f5f678","modified":1615275202822},{"_id":"public/tags/Resttemplate/index.html","hash":"1876f24292f2d89c5e8b6c2819dbec37d5d2e8a3","modified":1615275202822},{"_id":"public/tags/Vue/index.html","hash":"2b97f2be82894d3968efaf8ea891d132f6175fa1","modified":1615275202822},{"_id":"public/tags/SpringBoot/index.html","hash":"f5fcb7e90e434f467868011b1d822904b0b73b77","modified":1615275202822},{"_id":"public/tags/ArrayDeque/index.html","hash":"bbda40dda7aad8dde07df3795625049723c75b1a","modified":1615275202822},{"_id":"public/tags/源码分析/index.html","hash":"6bf1e2fb9c502690f5c77e7dfb8b0e5a9d3a815b","modified":1615275202822},{"_id":"public/tags/LinkedList/index.html","hash":"a1adf55e2900370a5aa16d471fa972656fde0d12","modified":1615275202822},{"_id":"public/tags/OAuth2-0/index.html","hash":"aaa363de43ea8a7ba040a43e61c0b49d4eb6091a","modified":1615275202822},{"_id":"public/tags/JWT/index.html","hash":"33a31dfe50c022fc76a62dcc0346bb90dac22604","modified":1615275202822},{"_id":"public/tags/OAuth/index.html","hash":"c3d430413ff3a320b0bf9980566aa574026ec2a5","modified":1615275202822},{"_id":"public/tags/spring-security/index.html","hash":"9ea8652da19880cc9954312ca3a81f7f15a7bb1a","modified":1615275202822},{"_id":"public/tags/SSO/index.html","hash":"1fdafa97b815f57b95a86a4af9e86debb384e33c","modified":1615275202822},{"_id":"public/tags/CAS框架/index.html","hash":"1e605eff6a187ad9db7d515cfed7c3344bf3b433","modified":1615275202822},{"_id":"public/tags/Disruptor/index.html","hash":"0ea9d98a066cffe69b1a763347c75d387d93fc26","modified":1615275202822},{"_id":"public/tags/JVM/index.html","hash":"9f570f99f0cf21c68894bcecd8f835b40f60fde0","modified":1615275202822},{"_id":"public/tags/JAVA/index.html","hash":"2ff81906730f884919efba17e6320ac68a08ade7","modified":1615275202822},{"_id":"public/tags/Nio/index.html","hash":"bcdbd1a473dc2df2839f8beb78776491dc4ad172","modified":1615275202822},{"_id":"public/tags/多线程/index.html","hash":"557181acdd5f9a137053a4e85ec3edf8c4be5948","modified":1615275202822},{"_id":"public/CNAME","hash":"6ac1a441d26185b407703ab9ffa5959860e49773","modified":1615275202828},{"_id":"public/baidu-verify-9BFFE2B7F8.txt","hash":"50cc3c23409426c3e28cf8800423ecda502f1eb8","modified":1615275202828},{"_id":"public/root.txt","hash":"51c99f66271aedfff930264c82fdbe9b4d05b67e","modified":1615275202828},{"_id":"public/robots.txt","hash":"c18cc8be26a5c74b1c2f6ee7775647c07197ab67","modified":1615275202828},{"_id":"public/images/nrmuse.png","hash":"c7bc96979ddcd9e1c9b7de09d98f510b76c89940","modified":1615275202828},{"_id":"public/images/nrmls.png","hash":"4b5016f2b844e38a61bd1fb44cc6dd7c44be123e","modified":1615275202828},{"_id":"public/images/vuecreate.png","hash":"f85fb6b87192b4bb5521c29a3e1932888c18609b","modified":1615275202828},{"_id":"public/favicon.ico","hash":"3956dd3ab6bc323801ab3a6dbd1c818d601bdab0","modified":1615275202828},{"_id":"public/images/thumb-default.png","hash":"e8403b97ed9251f9f5207765b0ce796c5000b4ba","modified":1615275202828},{"_id":"public/images/avatar.jpg","hash":"0ff2cc3e912314f83a0a1182c8c7827c8e42ea49","modified":1615275202828},{"_id":"public/images/vuecreate2.png","hash":"b270c1135532825f1be47c229fa78eb14bcfa499","modified":1615275202828},{"_id":"public/images/xingqiu-qrcode.jpg","hash":"ef2c2848dc79db6df7c752510651ed8ba57f2daf","modified":1615275202829},{"_id":"public/fonts/iconfont.eot","hash":"6819d9bb643bdeafc17bfecb0746ae641b018fdf","modified":1615275202829},{"_id":"public/fonts/iconfont.ttf","hash":"9b8837f9f79cf6ab794736301d0665345183a20c","modified":1615275202829},{"_id":"public/fonts/iconfont.woff","hash":"78d29194287b8885d25212048c4f787705212a6e","modified":1615275202829},{"_id":"public/images/favatar/SzsFox-logo.png","hash":"d71fcc73b7bc2a439d8c7ba461137856d190bd76","modified":1615275202829},{"_id":"public/images/favatar/chuangzaoshi-logo.png","hash":"7fa5734072050952159a02d330bbc008b5a99122","modified":1615275202829},{"_id":"public/images/donate/wechatpayimg.jpg","hash":"f45b77d6149d598f9e0a5fbaa96baae6a0a50586","modified":1615275202829},{"_id":"public/images/favatar/idesign-logo.png","hash":"6b150a2dbb9912b7a7662255c27e4d4baaecee71","modified":1615275202829},{"_id":"public/css/prism-tomorrow.css","hash":"3b99487dfc9b4e51e9105a93743b92a761840e34","modified":1615275202829},{"_id":"public/images/vuecreate3.png","hash":"18ad1a8dba3920753ec8b0441cbc057b99cade1f","modified":1615275202838},{"_id":"public/images/donate/alipayimg.jpg","hash":"f8ab44263345f50f4a3c2772cf45d5c1a19edcac","modified":1615275202839},{"_id":"public/js/application.js","hash":"46d1fb207ce5f0acb83803f927985dfcea86f9ef","modified":1615275202845},{"_id":"public/js/insight.js","hash":"298e8ca42517984bd26f34caa4c45560b0e909ad","modified":1615275202845},{"_id":"public/js/application.min.js","hash":"34d765e982c7d6360c37f82202d99f63ac40e408","modified":1615275202845},{"_id":"public/js/plugin.min.js","hash":"07fe34638f9832702c5f81d8583c5e4e8b3d9659","modified":1615275202845},{"_id":"public/css/style.min.css","hash":"1d23abc76726ebe042f7df4749f00f8f73338444","modified":1615275202845},{"_id":"public/js/jquery.min.js","hash":"5a9dcfbef655a2668e78baebeaa8dc6f41d8dabb","modified":1615275202845},{"_id":"public/js/plugin.js","hash":"a8524d42b8621bfaa06602a163c6a1f82702b91d","modified":1615275202845},{"_id":"public/css/style.css","hash":"3b693ce41c2e35ece4773593e94b4c17aeaee02f","modified":1615275202845},{"_id":"public/fonts/README.html","hash":"7c1128fed284d2fb7fee743e8a739da99385b358","modified":1615275202845},{"_id":"public/js/plugin.js.map","hash":"1730c0cc660f863120aca0a439d7264e2e245fc5","modified":1615275202845},{"_id":"public/fonts/iconfont.svg","hash":"25929e6e74f7027acd1f6467a67e95b153bcd8d5","modified":1615275202845},{"_id":"source/repository/index.md","hash":"ed0e082c30f233dd5c140d188f1e4bce44bdbf79","modified":1615275726161},{"_id":"source/links/index.md","hash":"febcf87eb0ab3c5080578275d25f3970bba39625","modified":1615275796844},{"_id":"source/about/index.md","hash":"00fdb8a199469c822eb0ed1772f5098608652f5f","modified":1615275392769},{"_id":"source/_data/links.yml","hash":"5143b7786d4516950ccd5635bfe61b0fde63f38b","modified":1615278289393}],"Category":[{"name":"Algorithm","_id":"ckm1p5bj700092mg5v66x2m5b"},{"name":"Docker","_id":"ckm1p5bjf000i2mg5swbh576t"},{"name":"GOF","_id":"ckm1p5bjj000t2mg5261viau2"},{"name":"Java","_id":"ckm1p5bju001t2mg5fta1gj72"},{"name":"Dubbo","_id":"ckm1p5bjw00222mg50rcx1ago"},{"name":"Jenkins","_id":"ckm1p5bke003k2mg5yvm6nrip"},{"name":"Linux","_id":"ckm1p5bkn004b2mg55kj1lm5a"},{"name":"MySQL","_id":"ckm1p5bkt004v2mg5r8qf1uj9"},{"name":"Spring","_id":"ckm1p5bkv00572mg5dij0yyzj"},{"name":"RocketMq","_id":"ckm1p5bkv005c2mg5duxy0swp"},{"name":"Recommend","_id":"ckm1p5bkw005g2mg5ujj111wl"},{"name":"Tool","_id":"ckm1p5bkx005m2mg5z3s0a2on"},{"name":"Vue","_id":"ckm1p5bky005t2mg5jmzetk30"},{"name":"WebSecurity","_id":"ckm1p5blw008b2mg5w4mmgxy4"},{"name":"JVM","_id":"ckm1p5bm700922mg5z5dydrz5"},{"name":"JAVA","parent":"ckm1p5bm700922mg5z5dydrz5","_id":"ckm1p5bme009o2mg58z3y7xph"},{"name":"JAVA","_id":"ckm1p5bml00ab2mg55clyqx3y"}],"Data":[{"_id":"links","data":{"创造狮":{"link":"http://chuangzaoshi.com/","avatar":"/images/favatar/chuangzaoshi-logo.png","desc":"为创意工作者而设计"},"腾讯设计导航":{"link":"http://idesign.qq.com/","avatar":"/images/favatar/idesign-logo.png","desc":"网罗全网高逼格的设计站点"},"灰色World":{"link":"http://mjava.top/","avatar":"http://mjava.top/images/avatar.jpg","desc":"浅水是喧哗的，深水是沉默的"}}}],"Page":[{"title":"404","date":"2019-07-19T08:41:10.000Z","type":"404","layout":"404","description":"你来到了没有知识的荒原 :(","_content":"","source":"404.md","raw":"---\ntitle: 404\ndate: 2019-07-19 16:41:10\ntype: \"404\"\nlayout: \"404\"\ndescription: \"你来到了没有知识的荒原 :(\"\n---\n","updated":"2021-01-26T09:49:03.570Z","path":"404.html","comments":1,"_id":"ckm1p5bhn00002mg5fvck81cz","content":"","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":""},{"_content":"<!DOCTYPE html>\n<html>\n    <head>\n        <meta charset=\"utf-8\">\n        <title>时钟</title>\n        <script src=\"https://cdn.jsdelivr.net/npm/echarts@5.0.2/dist/echarts.min.js\"></script>\n    </head>\n    <body>\n        <div id=\"main\" style=\"width: 1000px;height:1000px; margin: 0 auto;\"></div>\n        <script type=\"text/javascript\">\n            var chartDom = document.getElementById('main');\n            var myChart = echarts.init(chartDom);\n            var option;\n\n            option = {\n                series: [{\n                    name: 'hour',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 12,\n                    splitNumber: 12,\n                    axisLine: {\n                        lineStyle: {\n                            width: 15,\n                            color: [\n                                [1, 'rgba(0,0,0,0.7)']\n                            ],\n                            shadowColor: 'rgba(0, 0, 0, 0.5)',\n                            shadowBlur: 15\n                        }\n                    },\n                    splitLine: {\n                        lineStyle: {\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 3,\n                            shadowOffsetX: 1,\n                            shadowOffsetY: 2\n                        }\n                    },\n                    axisLabel: {\n                        fontSize: 50,\n                        distance: 25,\n                        formatter: function (value) {\n                            if (value === 0) {\n                                return '';\n                            }\n                            return value;\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        icon: 'path://M532.8,70.8C532.8,70.8,532.8,70.8,532.8,70.8L532.8,70.8C532.7,70.8,532.8,70.8,532.8,70.8z M456.1,49.6c-2.2-6.2-8.1-10.6-15-10.6h-37.5v10.6h37.5l0,0c2.9,0,5.3,2.4,5.3,5.3c0,2.9-2.4,5.3-5.3,5.3v0h-22.5c-1.5,0.1-3,0.4-4.3,0.9c-4.5,1.6-8.1,5.2-9.7,9.8c-0.6,1.7-0.9,3.4-0.9,5.3v16h10.6v-16l0,0l0,0c0-2.7,2.1-5,4.7-5.3h10.3l10.4,21.2h11.8l-10.4-21.2h0c6.9,0,12.8-4.4,15-10.6c0.6-1.7,0.9-3.5,0.9-5.3C457,53,456.7,51.2,456.1,49.6z M388.9,92.1h11.3L381,39h-3.6h-11.3L346.8,92v0h11.3l3.9-10.7h7.3h7.7l3.9-10.6h-7.7h-7.3l7.7-21.2v0L388.9,92.1z M301,38.9h-10.6v53.1H301V70.8h28.4l3.7-10.6H301V38.9zM333.2,38.9v10.6v10.7v31.9h10.6V38.9H333.2z M249.5,81.4L249.5,81.4L249.5,81.4c-2.9,0-5.3-2.4-5.3-5.3h0V54.9h0l0,0c0-2.9,2.4-5.3,5.3-5.3l0,0l0,0h33.6l3.9-10.6h-37.5c-1.9,0-3.6,0.3-5.3,0.9c-4.5,1.6-8.1,5.2-9.7,9.7c-0.6,1.7-0.9,3.5-0.9,5.3l0,0v21.3c0,1.9,0.3,3.6,0.9,5.3c1.6,4.5,5.2,8.1,9.7,9.7c1.7,0.6,3.5,0.9,5.3,0.9h33.6l3.9-10.6H249.5z M176.8,38.9v10.6h49.6l3.9-10.6H176.8z M192.7,81.4L192.7,81.4L192.7,81.4c-2.9,0-5.3-2.4-5.3-5.3l0,0v-5.3h38.9l3.9-10.6h-53.4v10.6v5.3l0,0c0,1.9,0.3,3.6,0.9,5.3c1.6,4.5,5.2,8.1,9.7,9.7c1.7,0.6,3.4,0.9,5.3,0.9h23.4h10.2l3.9-10.6l0,0H192.7z M460.1,38.9v10.6h21.4v42.5h10.6V49.6h17.5l3.8-10.6H460.1z M541.6,68.2c-0.2,0.1-0.4,0.3-0.7,0.4C541.1,68.4,541.4,68.3,541.6,68.2L541.6,68.2z M554.3,60.2h-21.6v0l0,0c-2.9,0-5.3-2.4-5.3-5.3c0-2.9,2.4-5.3,5.3-5.3l0,0l0,0h33.6l3.8-10.6h-37.5l0,0c-6.9,0-12.8,4.4-15,10.6c-0.6,1.7-0.9,3.5-0.9,5.3c0,1.9,0.3,3.7,0.9,5.3c2.2,6.2,8.1,10.6,15,10.6h21.6l0,0c2.9,0,5.3,2.4,5.3,5.3c0,2.9-2.4,5.3-5.3,5.3l0,0h-37.5v10.6h37.5c6.9,0,12.8-4.4,15-10.6c0.6-1.7,0.9-3.5,0.9-5.3c0-1.9-0.3-3.7-0.9-5.3C567.2,64.6,561.3,60.2,554.3,60.2z',\n                        showAbove: false,\n                        offsetCenter: [0, '-35%'],\n                        size: 120,\n                        keepAspect: true,\n                        itemStyle: {\n                            color: '#707177'\n                        }\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 12,\n                        length: '55%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: [0, '30%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                },\n                {\n                    name: 'minute',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 60,\n                    axisLine: {\n                        show: false\n                    },\n                    splitLine: {\n                        show: false\n                    },\n                    axisTick: {\n                        show: false\n                    },\n                    axisLabel: {\n                        show: false\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 8,\n                        length: '70%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        size: 20,\n                        showAbove: false,\n                        itemStyle: {\n                            borderWidth: 15,\n                            borderColor: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: ['0%', '-40%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                },\n                {\n                    name: 'second',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 60,\n                    animationEasingUpdate: 'bounceOut',\n                    axisLine: {\n                        show: false\n                    },\n                    splitLine: {\n                        show: false\n                    },\n                    axisTick: {\n                        show: false\n                    },\n                    axisLabel: {\n                        show: false\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 4,\n                        length: '85%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        size: 15,\n                        showAbove: true,\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: ['0%', '-40%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                }]\n            };\n\n            var timeUpdatedStatus = {\n                second: false,\n                minute: false,\n                hour: false\n            };\n\n            function updateSeries(time, series, type) {\n                var isCritical = (Math.floor(time) === 0) || (type === 'second' && time === 1);\n                if (isCritical && timeUpdatedStatus[type] === true) {\n                    timeUpdatedStatus[type] = false;\n                    series.data[0].value = 0;\n                    series.clockwise = true;\n                    option.animationDurationUpdate = 0;\n                    myChart.setOption(option, true);\n                }\n                series.data[0].value = time;\n                series.clockwise = true;\n                if (time === 0) {\n                    timeUpdatedStatus[type] = true;\n                    series.clockwise = false;\n                }\n            }\n\n            setInterval(function () {\n                var date = new Date();\n                var second = date.getSeconds();\n                var minute = date.getMinutes() + second / 60;\n                var hour = date.getHours() % 12 + minute / 60;\n\n                updateSeries(second, option.series[2], 'second');\n                updateSeries(minute, option.series[1], 'minute');\n                updateSeries(hour, option.series[0], 'hour');\n\n                option.animationDurationUpdate = 300;\n                myChart.setOption(option, true);\n                date = null;\n            }, 1000);\n\n            option && myChart.setOption(option);\n        </script>\n    </body>\n</html>","source":"clock.html","raw":"<!DOCTYPE html>\n<html>\n    <head>\n        <meta charset=\"utf-8\">\n        <title>时钟</title>\n        <script src=\"https://cdn.jsdelivr.net/npm/echarts@5.0.2/dist/echarts.min.js\"></script>\n    </head>\n    <body>\n        <div id=\"main\" style=\"width: 1000px;height:1000px; margin: 0 auto;\"></div>\n        <script type=\"text/javascript\">\n            var chartDom = document.getElementById('main');\n            var myChart = echarts.init(chartDom);\n            var option;\n\n            option = {\n                series: [{\n                    name: 'hour',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 12,\n                    splitNumber: 12,\n                    axisLine: {\n                        lineStyle: {\n                            width: 15,\n                            color: [\n                                [1, 'rgba(0,0,0,0.7)']\n                            ],\n                            shadowColor: 'rgba(0, 0, 0, 0.5)',\n                            shadowBlur: 15\n                        }\n                    },\n                    splitLine: {\n                        lineStyle: {\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 3,\n                            shadowOffsetX: 1,\n                            shadowOffsetY: 2\n                        }\n                    },\n                    axisLabel: {\n                        fontSize: 50,\n                        distance: 25,\n                        formatter: function (value) {\n                            if (value === 0) {\n                                return '';\n                            }\n                            return value;\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        icon: 'path://M532.8,70.8C532.8,70.8,532.8,70.8,532.8,70.8L532.8,70.8C532.7,70.8,532.8,70.8,532.8,70.8z M456.1,49.6c-2.2-6.2-8.1-10.6-15-10.6h-37.5v10.6h37.5l0,0c2.9,0,5.3,2.4,5.3,5.3c0,2.9-2.4,5.3-5.3,5.3v0h-22.5c-1.5,0.1-3,0.4-4.3,0.9c-4.5,1.6-8.1,5.2-9.7,9.8c-0.6,1.7-0.9,3.4-0.9,5.3v16h10.6v-16l0,0l0,0c0-2.7,2.1-5,4.7-5.3h10.3l10.4,21.2h11.8l-10.4-21.2h0c6.9,0,12.8-4.4,15-10.6c0.6-1.7,0.9-3.5,0.9-5.3C457,53,456.7,51.2,456.1,49.6z M388.9,92.1h11.3L381,39h-3.6h-11.3L346.8,92v0h11.3l3.9-10.7h7.3h7.7l3.9-10.6h-7.7h-7.3l7.7-21.2v0L388.9,92.1z M301,38.9h-10.6v53.1H301V70.8h28.4l3.7-10.6H301V38.9zM333.2,38.9v10.6v10.7v31.9h10.6V38.9H333.2z M249.5,81.4L249.5,81.4L249.5,81.4c-2.9,0-5.3-2.4-5.3-5.3h0V54.9h0l0,0c0-2.9,2.4-5.3,5.3-5.3l0,0l0,0h33.6l3.9-10.6h-37.5c-1.9,0-3.6,0.3-5.3,0.9c-4.5,1.6-8.1,5.2-9.7,9.7c-0.6,1.7-0.9,3.5-0.9,5.3l0,0v21.3c0,1.9,0.3,3.6,0.9,5.3c1.6,4.5,5.2,8.1,9.7,9.7c1.7,0.6,3.5,0.9,5.3,0.9h33.6l3.9-10.6H249.5z M176.8,38.9v10.6h49.6l3.9-10.6H176.8z M192.7,81.4L192.7,81.4L192.7,81.4c-2.9,0-5.3-2.4-5.3-5.3l0,0v-5.3h38.9l3.9-10.6h-53.4v10.6v5.3l0,0c0,1.9,0.3,3.6,0.9,5.3c1.6,4.5,5.2,8.1,9.7,9.7c1.7,0.6,3.4,0.9,5.3,0.9h23.4h10.2l3.9-10.6l0,0H192.7z M460.1,38.9v10.6h21.4v42.5h10.6V49.6h17.5l3.8-10.6H460.1z M541.6,68.2c-0.2,0.1-0.4,0.3-0.7,0.4C541.1,68.4,541.4,68.3,541.6,68.2L541.6,68.2z M554.3,60.2h-21.6v0l0,0c-2.9,0-5.3-2.4-5.3-5.3c0-2.9,2.4-5.3,5.3-5.3l0,0l0,0h33.6l3.8-10.6h-37.5l0,0c-6.9,0-12.8,4.4-15,10.6c-0.6,1.7-0.9,3.5-0.9,5.3c0,1.9,0.3,3.7,0.9,5.3c2.2,6.2,8.1,10.6,15,10.6h21.6l0,0c2.9,0,5.3,2.4,5.3,5.3c0,2.9-2.4,5.3-5.3,5.3l0,0h-37.5v10.6h37.5c6.9,0,12.8-4.4,15-10.6c0.6-1.7,0.9-3.5,0.9-5.3c0-1.9-0.3-3.7-0.9-5.3C567.2,64.6,561.3,60.2,554.3,60.2z',\n                        showAbove: false,\n                        offsetCenter: [0, '-35%'],\n                        size: 120,\n                        keepAspect: true,\n                        itemStyle: {\n                            color: '#707177'\n                        }\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 12,\n                        length: '55%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: [0, '30%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                },\n                {\n                    name: 'minute',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 60,\n                    axisLine: {\n                        show: false\n                    },\n                    splitLine: {\n                        show: false\n                    },\n                    axisTick: {\n                        show: false\n                    },\n                    axisLabel: {\n                        show: false\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 8,\n                        length: '70%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        size: 20,\n                        showAbove: false,\n                        itemStyle: {\n                            borderWidth: 15,\n                            borderColor: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: ['0%', '-40%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                },\n                {\n                    name: 'second',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 60,\n                    animationEasingUpdate: 'bounceOut',\n                    axisLine: {\n                        show: false\n                    },\n                    splitLine: {\n                        show: false\n                    },\n                    axisTick: {\n                        show: false\n                    },\n                    axisLabel: {\n                        show: false\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 4,\n                        length: '85%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        size: 15,\n                        showAbove: true,\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: ['0%', '-40%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                }]\n            };\n\n            var timeUpdatedStatus = {\n                second: false,\n                minute: false,\n                hour: false\n            };\n\n            function updateSeries(time, series, type) {\n                var isCritical = (Math.floor(time) === 0) || (type === 'second' && time === 1);\n                if (isCritical && timeUpdatedStatus[type] === true) {\n                    timeUpdatedStatus[type] = false;\n                    series.data[0].value = 0;\n                    series.clockwise = true;\n                    option.animationDurationUpdate = 0;\n                    myChart.setOption(option, true);\n                }\n                series.data[0].value = time;\n                series.clockwise = true;\n                if (time === 0) {\n                    timeUpdatedStatus[type] = true;\n                    series.clockwise = false;\n                }\n            }\n\n            setInterval(function () {\n                var date = new Date();\n                var second = date.getSeconds();\n                var minute = date.getMinutes() + second / 60;\n                var hour = date.getHours() % 12 + minute / 60;\n\n                updateSeries(second, option.series[2], 'second');\n                updateSeries(minute, option.series[1], 'minute');\n                updateSeries(hour, option.series[0], 'hour');\n\n                option.animationDurationUpdate = 300;\n                myChart.setOption(option, true);\n                date = null;\n            }, 1000);\n\n            option && myChart.setOption(option);\n        </script>\n    </body>\n</html>","date":"2021-03-01T02:59:40.895Z","updated":"2021-03-01T02:59:40.895Z","path":"clock.html","title":"","comments":1,"layout":"page","_id":"ckm1p5bho00012mg5hugqeakh","content":"<!DOCTYPE html>\n<html>\n    <head><meta name=\"generator\" content=\"Hexo 3.9.0\">\n        <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset=\"utf-8\">\n        <title>时钟</title>\n        <script src=\"https://cdn.jsdelivr.net/npm/echarts@5.0.2/dist/echarts.min.js\"></script>\n    <link rel=\"alternate\" href=\"/atom.xml\" title=\"灰色World\" type=\"application/atom+xml\"><!-- hexo-inject:begin --><!-- hexo-inject:end -->\n<link rel=\"stylesheet\" href=\"/css/prism-tomorrow.css\" type=\"text/css\"></head>\n    <body>\n        <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id=\"main\" style=\"width: 1000px;height:1000px; margin: 0 auto;\"></div>\n        <script type=\"text/javascript\">\n            var chartDom = document.getElementById('main');\n            var myChart = echarts.init(chartDom);\n            var option;\n\n            option = {\n                series: [{\n                    name: 'hour',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 12,\n                    splitNumber: 12,\n                    axisLine: {\n                        lineStyle: {\n                            width: 15,\n                            color: [\n                                [1, 'rgba(0,0,0,0.7)']\n                            ],\n                            shadowColor: 'rgba(0, 0, 0, 0.5)',\n                            shadowBlur: 15\n                        }\n                    },\n                    splitLine: {\n                        lineStyle: {\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 3,\n                            shadowOffsetX: 1,\n                            shadowOffsetY: 2\n                        }\n                    },\n                    axisLabel: {\n                        fontSize: 50,\n                        distance: 25,\n                        formatter: function (value) {\n                            if (value === 0) {\n                                return '';\n                            }\n                            return value;\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        icon: 'path://M532.8,70.8C532.8,70.8,532.8,70.8,532.8,70.8L532.8,70.8C532.7,70.8,532.8,70.8,532.8,70.8z M456.1,49.6c-2.2-6.2-8.1-10.6-15-10.6h-37.5v10.6h37.5l0,0c2.9,0,5.3,2.4,5.3,5.3c0,2.9-2.4,5.3-5.3,5.3v0h-22.5c-1.5,0.1-3,0.4-4.3,0.9c-4.5,1.6-8.1,5.2-9.7,9.8c-0.6,1.7-0.9,3.4-0.9,5.3v16h10.6v-16l0,0l0,0c0-2.7,2.1-5,4.7-5.3h10.3l10.4,21.2h11.8l-10.4-21.2h0c6.9,0,12.8-4.4,15-10.6c0.6-1.7,0.9-3.5,0.9-5.3C457,53,456.7,51.2,456.1,49.6z M388.9,92.1h11.3L381,39h-3.6h-11.3L346.8,92v0h11.3l3.9-10.7h7.3h7.7l3.9-10.6h-7.7h-7.3l7.7-21.2v0L388.9,92.1z M301,38.9h-10.6v53.1H301V70.8h28.4l3.7-10.6H301V38.9zM333.2,38.9v10.6v10.7v31.9h10.6V38.9H333.2z M249.5,81.4L249.5,81.4L249.5,81.4c-2.9,0-5.3-2.4-5.3-5.3h0V54.9h0l0,0c0-2.9,2.4-5.3,5.3-5.3l0,0l0,0h33.6l3.9-10.6h-37.5c-1.9,0-3.6,0.3-5.3,0.9c-4.5,1.6-8.1,5.2-9.7,9.7c-0.6,1.7-0.9,3.5-0.9,5.3l0,0v21.3c0,1.9,0.3,3.6,0.9,5.3c1.6,4.5,5.2,8.1,9.7,9.7c1.7,0.6,3.5,0.9,5.3,0.9h33.6l3.9-10.6H249.5z M176.8,38.9v10.6h49.6l3.9-10.6H176.8z M192.7,81.4L192.7,81.4L192.7,81.4c-2.9,0-5.3-2.4-5.3-5.3l0,0v-5.3h38.9l3.9-10.6h-53.4v10.6v5.3l0,0c0,1.9,0.3,3.6,0.9,5.3c1.6,4.5,5.2,8.1,9.7,9.7c1.7,0.6,3.4,0.9,5.3,0.9h23.4h10.2l3.9-10.6l0,0H192.7z M460.1,38.9v10.6h21.4v42.5h10.6V49.6h17.5l3.8-10.6H460.1z M541.6,68.2c-0.2,0.1-0.4,0.3-0.7,0.4C541.1,68.4,541.4,68.3,541.6,68.2L541.6,68.2z M554.3,60.2h-21.6v0l0,0c-2.9,0-5.3-2.4-5.3-5.3c0-2.9,2.4-5.3,5.3-5.3l0,0l0,0h33.6l3.8-10.6h-37.5l0,0c-6.9,0-12.8,4.4-15,10.6c-0.6,1.7-0.9,3.5-0.9,5.3c0,1.9,0.3,3.7,0.9,5.3c2.2,6.2,8.1,10.6,15,10.6h21.6l0,0c2.9,0,5.3,2.4,5.3,5.3c0,2.9-2.4,5.3-5.3,5.3l0,0h-37.5v10.6h37.5c6.9,0,12.8-4.4,15-10.6c0.6-1.7,0.9-3.5,0.9-5.3c0-1.9-0.3-3.7-0.9-5.3C567.2,64.6,561.3,60.2,554.3,60.2z',\n                        showAbove: false,\n                        offsetCenter: [0, '-35%'],\n                        size: 120,\n                        keepAspect: true,\n                        itemStyle: {\n                            color: '#707177'\n                        }\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 12,\n                        length: '55%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: [0, '30%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                },\n                {\n                    name: 'minute',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 60,\n                    axisLine: {\n                        show: false\n                    },\n                    splitLine: {\n                        show: false\n                    },\n                    axisTick: {\n                        show: false\n                    },\n                    axisLabel: {\n                        show: false\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 8,\n                        length: '70%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        size: 20,\n                        showAbove: false,\n                        itemStyle: {\n                            borderWidth: 15,\n                            borderColor: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: ['0%', '-40%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                },\n                {\n                    name: 'second',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 60,\n                    animationEasingUpdate: 'bounceOut',\n                    axisLine: {\n                        show: false\n                    },\n                    splitLine: {\n                        show: false\n                    },\n                    axisTick: {\n                        show: false\n                    },\n                    axisLabel: {\n                        show: false\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 4,\n                        length: '85%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        size: 15,\n                        showAbove: true,\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: ['0%', '-40%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                }]\n            };\n\n            var timeUpdatedStatus = {\n                second: false,\n                minute: false,\n                hour: false\n            };\n\n            function updateSeries(time, series, type) {\n                var isCritical = (Math.floor(time) === 0) || (type === 'second' && time === 1);\n                if (isCritical && timeUpdatedStatus[type] === true) {\n                    timeUpdatedStatus[type] = false;\n                    series.data[0].value = 0;\n                    series.clockwise = true;\n                    option.animationDurationUpdate = 0;\n                    myChart.setOption(option, true);\n                }\n                series.data[0].value = time;\n                series.clockwise = true;\n                if (time === 0) {\n                    timeUpdatedStatus[type] = true;\n                    series.clockwise = false;\n                }\n            }\n\n            setInterval(function () {\n                var date = new Date();\n                var second = date.getSeconds();\n                var minute = date.getMinutes() + second / 60;\n                var hour = date.getHours() % 12 + minute / 60;\n\n                updateSeries(second, option.series[2], 'second');\n                updateSeries(minute, option.series[1], 'minute');\n                updateSeries(hour, option.series[0], 'hour');\n\n                option.animationDurationUpdate = 300;\n                myChart.setOption(option, true);\n                date = null;\n            }, 1000);\n\n            option && myChart.setOption(option);\n        </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->\n    </body>\n</html>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<!DOCTYPE html>\n<html>\n    <head><meta name=\"generator\" content=\"Hexo 3.9.0\">\n        <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset=\"utf-8\">\n        <title>时钟</title>\n        <script src=\"https://cdn.jsdelivr.net/npm/echarts@5.0.2/dist/echarts.min.js\"></script>\n    <link rel=\"alternate\" href=\"/atom.xml\" title=\"灰色World\" type=\"application/atom+xml\"><!-- hexo-inject:begin --><!-- hexo-inject:end -->\n<link rel=\"stylesheet\" href=\"/css/prism-tomorrow.css\" type=\"text/css\"></head>\n    <body>\n        <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id=\"main\" style=\"width: 1000px;height:1000px; margin: 0 auto;\"></div>\n        <script type=\"text/javascript\">\n            var chartDom = document.getElementById('main');\n            var myChart = echarts.init(chartDom);\n            var option;\n\n            option = {\n                series: [{\n                    name: 'hour',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 12,\n                    splitNumber: 12,\n                    axisLine: {\n                        lineStyle: {\n                            width: 15,\n                            color: [\n                                [1, 'rgba(0,0,0,0.7)']\n                            ],\n                            shadowColor: 'rgba(0, 0, 0, 0.5)',\n                            shadowBlur: 15\n                        }\n                    },\n                    splitLine: {\n                        lineStyle: {\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 3,\n                            shadowOffsetX: 1,\n                            shadowOffsetY: 2\n                        }\n                    },\n                    axisLabel: {\n                        fontSize: 50,\n                        distance: 25,\n                        formatter: function (value) {\n                            if (value === 0) {\n                                return '';\n                            }\n                            return value;\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        icon: 'path://M532.8,70.8C532.8,70.8,532.8,70.8,532.8,70.8L532.8,70.8C532.7,70.8,532.8,70.8,532.8,70.8z M456.1,49.6c-2.2-6.2-8.1-10.6-15-10.6h-37.5v10.6h37.5l0,0c2.9,0,5.3,2.4,5.3,5.3c0,2.9-2.4,5.3-5.3,5.3v0h-22.5c-1.5,0.1-3,0.4-4.3,0.9c-4.5,1.6-8.1,5.2-9.7,9.8c-0.6,1.7-0.9,3.4-0.9,5.3v16h10.6v-16l0,0l0,0c0-2.7,2.1-5,4.7-5.3h10.3l10.4,21.2h11.8l-10.4-21.2h0c6.9,0,12.8-4.4,15-10.6c0.6-1.7,0.9-3.5,0.9-5.3C457,53,456.7,51.2,456.1,49.6z M388.9,92.1h11.3L381,39h-3.6h-11.3L346.8,92v0h11.3l3.9-10.7h7.3h7.7l3.9-10.6h-7.7h-7.3l7.7-21.2v0L388.9,92.1z M301,38.9h-10.6v53.1H301V70.8h28.4l3.7-10.6H301V38.9zM333.2,38.9v10.6v10.7v31.9h10.6V38.9H333.2z M249.5,81.4L249.5,81.4L249.5,81.4c-2.9,0-5.3-2.4-5.3-5.3h0V54.9h0l0,0c0-2.9,2.4-5.3,5.3-5.3l0,0l0,0h33.6l3.9-10.6h-37.5c-1.9,0-3.6,0.3-5.3,0.9c-4.5,1.6-8.1,5.2-9.7,9.7c-0.6,1.7-0.9,3.5-0.9,5.3l0,0v21.3c0,1.9,0.3,3.6,0.9,5.3c1.6,4.5,5.2,8.1,9.7,9.7c1.7,0.6,3.5,0.9,5.3,0.9h33.6l3.9-10.6H249.5z M176.8,38.9v10.6h49.6l3.9-10.6H176.8z M192.7,81.4L192.7,81.4L192.7,81.4c-2.9,0-5.3-2.4-5.3-5.3l0,0v-5.3h38.9l3.9-10.6h-53.4v10.6v5.3l0,0c0,1.9,0.3,3.6,0.9,5.3c1.6,4.5,5.2,8.1,9.7,9.7c1.7,0.6,3.4,0.9,5.3,0.9h23.4h10.2l3.9-10.6l0,0H192.7z M460.1,38.9v10.6h21.4v42.5h10.6V49.6h17.5l3.8-10.6H460.1z M541.6,68.2c-0.2,0.1-0.4,0.3-0.7,0.4C541.1,68.4,541.4,68.3,541.6,68.2L541.6,68.2z M554.3,60.2h-21.6v0l0,0c-2.9,0-5.3-2.4-5.3-5.3c0-2.9,2.4-5.3,5.3-5.3l0,0l0,0h33.6l3.8-10.6h-37.5l0,0c-6.9,0-12.8,4.4-15,10.6c-0.6,1.7-0.9,3.5-0.9,5.3c0,1.9,0.3,3.7,0.9,5.3c2.2,6.2,8.1,10.6,15,10.6h21.6l0,0c2.9,0,5.3,2.4,5.3,5.3c0,2.9-2.4,5.3-5.3,5.3l0,0h-37.5v10.6h37.5c6.9,0,12.8-4.4,15-10.6c0.6-1.7,0.9-3.5,0.9-5.3c0-1.9-0.3-3.7-0.9-5.3C567.2,64.6,561.3,60.2,554.3,60.2z',\n                        showAbove: false,\n                        offsetCenter: [0, '-35%'],\n                        size: 120,\n                        keepAspect: true,\n                        itemStyle: {\n                            color: '#707177'\n                        }\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 12,\n                        length: '55%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: [0, '30%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                },\n                {\n                    name: 'minute',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 60,\n                    axisLine: {\n                        show: false\n                    },\n                    splitLine: {\n                        show: false\n                    },\n                    axisTick: {\n                        show: false\n                    },\n                    axisLabel: {\n                        show: false\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 8,\n                        length: '70%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        size: 20,\n                        showAbove: false,\n                        itemStyle: {\n                            borderWidth: 15,\n                            borderColor: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: ['0%', '-40%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                },\n                {\n                    name: 'second',\n                    type: 'gauge',\n                    startAngle: 90,\n                    endAngle: -270,\n                    min: 0,\n                    max: 60,\n                    animationEasingUpdate: 'bounceOut',\n                    axisLine: {\n                        show: false\n                    },\n                    splitLine: {\n                        show: false\n                    },\n                    axisTick: {\n                        show: false\n                    },\n                    axisLabel: {\n                        show: false\n                    },\n                    pointer: {\n                        icon: 'path://M2.9,0.7L2.9,0.7c1.4,0,2.6,1.2,2.6,2.6v115c0,1.4-1.2,2.6-2.6,2.6l0,0c-1.4,0-2.6-1.2-2.6-2.6V3.3C0.3,1.9,1.4,0.7,2.9,0.7z',\n                        width: 4,\n                        length: '85%',\n                        offsetCenter: [0, '8%'],\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    anchor: {\n                        show: true,\n                        size: 15,\n                        showAbove: true,\n                        itemStyle: {\n                            color: '#C0911F',\n                            shadowColor: 'rgba(0, 0, 0, 0.3)',\n                            shadowBlur: 8,\n                            shadowOffsetX: 2,\n                            shadowOffsetY: 4\n                        }\n                    },\n                    detail: {\n                        show: false\n                    },\n                    title: {\n                        offsetCenter: ['0%', '-40%']\n                    },\n                    data: [{\n                        value: 0\n                    }]\n                }]\n            };\n\n            var timeUpdatedStatus = {\n                second: false,\n                minute: false,\n                hour: false\n            };\n\n            function updateSeries(time, series, type) {\n                var isCritical = (Math.floor(time) === 0) || (type === 'second' && time === 1);\n                if (isCritical && timeUpdatedStatus[type] === true) {\n                    timeUpdatedStatus[type] = false;\n                    series.data[0].value = 0;\n                    series.clockwise = true;\n                    option.animationDurationUpdate = 0;\n                    myChart.setOption(option, true);\n                }\n                series.data[0].value = time;\n                series.clockwise = true;\n                if (time === 0) {\n                    timeUpdatedStatus[type] = true;\n                    series.clockwise = false;\n                }\n            }\n\n            setInterval(function () {\n                var date = new Date();\n                var second = date.getSeconds();\n                var minute = date.getMinutes() + second / 60;\n                var hour = date.getHours() % 12 + minute / 60;\n\n                updateSeries(second, option.series[2], 'second');\n                updateSeries(minute, option.series[1], 'minute');\n                updateSeries(hour, option.series[0], 'hour');\n\n                option.animationDurationUpdate = 300;\n                myChart.setOption(option, true);\n                date = null;\n            }, 1000);\n\n            option && myChart.setOption(option);\n        </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->\n    </body>\n</html>"},{"_content":"ea667b0f708cd4ded0b79ebbdd99373a","source":"ea667b0f708cd4ded0b79ebbdd99373a.html","raw":"ea667b0f708cd4ded0b79ebbdd99373a","date":"2021-01-26T09:49:03.574Z","updated":"2021-01-26T09:49:03.574Z","path":"ea667b0f708cd4ded0b79ebbdd99373a.html","title":"","comments":1,"layout":"page","_id":"ckm1p5bhp00022mg5oi1j4l11","content":"ea667b0f708cd4ded0b79ebbdd99373a","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"ea667b0f708cd4ded0b79ebbdd99373a"},{"title":"分类","date":"2019-08-04T14:50:38.000Z","type":"categories","layout":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: 分类\ndate: 2019-08-04 22:50:38\ntype: \"categories\"\nlayout: \"categories\"\ncomments: false\n---\n","updated":"2021-01-26T09:49:03.574Z","path":"categories/index.html","_id":"ckm1p5bim00042mg5r1ea443y","content":"","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":""},{"title":"friends","date":"2019-08-04T14:53:14.000Z","type":"friends","layout":"friends","_content":"","source":"friends/index.md","raw":"---\ntitle: friends\ndate: 2019-08-04 22:53:14\ntype: \"friends\"\nlayout: \"friends\"\n---\n","updated":"2021-01-26T09:49:03.574Z","path":"friends/index.html","comments":1,"_id":"ckm1p5bin00052mg558t1mk3r","content":"","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":""},{"title":"标签","date":"2019-08-04T14:52:11.000Z","type":"tags","layout":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: 标签\ndate: 2019-08-04 22:52:11\ntype: \"tags\"\nlayout: \"tags\"\ncomments: false\n---\n","updated":"2021-01-26T09:49:03.574Z","path":"tags/index.html","_id":"ckm1p5bio00062mg5ietzddh2","content":"","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":""},{"title":"自我介绍","date":"2019-08-04T14:52:47.000Z","type":"about","layout":"about","_content":"## 📢 打工人","source":"about/index.md","raw":"---\ntitle: 自我介绍\ndate: 2019-08-04 22:52:47\ntype: \"about\"\nlayout: \"about\"\n---\n## 📢 打工人","updated":"2021-03-09T07:36:32.769Z","path":"about/index.html","_id":"ckm1p7d7h00008ug57xwfmvjy","comments":1,"content":"<h2 id=\"📢-打工人\"><a href=\"#📢-打工人\" class=\"headerlink\" title=\"📢 打工人\"></a>📢 打工人</h2>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[{"name":"hh","link":"https://baidu.com","logo":"/images/avatar.jpg"}]}},"excerpt":"","more":"<h2 id=\"📢-打工人\"><a href=\"#📢-打工人\" class=\"headerlink\" title=\"📢 打工人\"></a>📢 打工人</h2>"},{"title":"Repositories","layout":"repository","comments":0,"sidebar":"none","_content":"","source":"repository/index.md","raw":"---\ntitle: Repositories\nlayout: repository\ncomments: false\nsidebar: none\n---\n","date":"2021-03-09T07:42:06.165Z","updated":"2021-03-09T07:42:06.161Z","path":"repository/index.html","_id":"ckm1pgmzg00018ug59g1ktqza","content":"","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":""},{"title":"友情链接","layout":"links","comments":1,"sidebar":"none","_content":"","source":"links/index.md","raw":"---\ntitle: 友情链接\nlayout: links\ncomments: true\nsidebar: none\n---","date":"2021-03-09T07:43:16.848Z","updated":"2021-03-09T07:43:16.844Z","path":"links/index.html","_id":"ckm1pi5j600028ug5v7kirrbc","content":"","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":""}],"Post":[{"title":"递归算法-获取json中指定key的所有值","top":true,"cover":true,"toc":true,"mathjax":true,"date":"2019-08-17T04:38:52.000Z","password":null,"summary":null,"_content":"\n今天在工作中遇到要解析json并获取json里所有指定key的值，再把key的值插入对应的数据映射表。于是写了一个递归算法来取值。\n\n## 1.首先导入alibaba的fastjson，用来解析json。当然也可以用其他的解析包\n```java\n<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>fastjson</artifactId>\n    <version>1.2.58</version>\n</dependency>\n```\n## 2.创建两个工具类方法，用来判断传入的是不是json对象或json数组\n```java\npublic static boolean isJSONObj(Object json){\n   return json instanceof JSONObject;\n}\npublic static boolean isJSONArray(Object json){\n   return json instanceof JSONArray;\n}\n```\n> java中的instanceof也称为类型比较运算符，因为它将实例与类型进行比较。它返回true或false。\n\n## 3.建立核心重载方法\n```java\n    public static void getJSONValue(JSONObject json,String k,List<String> list){\n        for (Object j:json.keySet()){\n            if(isJSONObj(json.get(j))){\n                //是对象\n                JSONObject j2= JSON.parseObject(json.get(j).toString());\n                getJSONValue(j2,k,list);\n            }else if(isJSONArray(json.get(j))){\n                JSONArray j3=JSON.parseArray(json.get(j).toString());\n                //是数组\n                getJSONValue(j3,k,list);\n            }else if(j==k){\n                //是字符串\n                list.add(json.get(j).toString());\n            }\n        }\n    }\n\n    public static void getJSONValue(JSONArray json,String k,List<String> list){\n        for (Object j:json){\n            if(isJSONObj(j)){\n                //是对象\n                JSONObject j2= JSON.parseObject(j.toString());\n                getJSONValue(j2,k,list);\n            }else if(isJSONArray(j)){\n                //是数组\n                JSONArray j3=JSON.parseArray(j.toString());\n                getJSONValue(j3,k,list);\n            }\n        }\n    }\n\n```\n## 4.接下来写一个比较复杂的json，里面有对象嵌套数组的，数组嵌套对象的，数组嵌套数组的\n[示例json](http://cdn.mjava.top/blog/demojson.txt)\n\n## 5.调用方法\n```java\ntry {\n    File file=new File(demo1.class.getResource(\"/2.json\").getPath());\n    FileInputStream fileInputStream=new FileInputStream(file);\n    InputStreamReader inputStreamReader=new InputStreamReader(fileInputStream);\n    BufferedReader bufferedReader=new BufferedReader(inputStreamReader);\n    String line=\"\";\n    StringBuffer json=new StringBuffer();\n    while ((line=bufferedReader.readLine())!=null){\n        json.append(line);\n    }\n\n    JSONObject j3=JSON.parseObject(json.toString());\n    List<String> mid=new ArrayList<>();\n    getJSONValue(j3,\"interfaceId\",mid);\n    System.out.println(mid.toString());\n}catch (Exception e){\n    System.out.println(e.getMessage());\n}\n```\n## 6.成功获取\n![控制台返回](http://cdn.mjava.top/blog/json2.png)\n\n>demo源码地址：https://github.com/z573419235/studyDemo\n","source":"_posts/algorithm/algorithm-recursive-01.md","raw":"---\ntitle: 递归算法-获取json中指定key的所有值\ntop: true\ncover: true\ntoc: true\nmathjax: true\ntags:\n  - Java\n  - Recursive\n  - Algorithm\n  - Json\ncategories:\n  - Algorithm\ndate: 2019-08-17 12:38:52\npassword:\nsummary:\n---\n\n今天在工作中遇到要解析json并获取json里所有指定key的值，再把key的值插入对应的数据映射表。于是写了一个递归算法来取值。\n\n## 1.首先导入alibaba的fastjson，用来解析json。当然也可以用其他的解析包\n```java\n<dependency>\n    <groupId>com.alibaba</groupId>\n    <artifactId>fastjson</artifactId>\n    <version>1.2.58</version>\n</dependency>\n```\n## 2.创建两个工具类方法，用来判断传入的是不是json对象或json数组\n```java\npublic static boolean isJSONObj(Object json){\n   return json instanceof JSONObject;\n}\npublic static boolean isJSONArray(Object json){\n   return json instanceof JSONArray;\n}\n```\n> java中的instanceof也称为类型比较运算符，因为它将实例与类型进行比较。它返回true或false。\n\n## 3.建立核心重载方法\n```java\n    public static void getJSONValue(JSONObject json,String k,List<String> list){\n        for (Object j:json.keySet()){\n            if(isJSONObj(json.get(j))){\n                //是对象\n                JSONObject j2= JSON.parseObject(json.get(j).toString());\n                getJSONValue(j2,k,list);\n            }else if(isJSONArray(json.get(j))){\n                JSONArray j3=JSON.parseArray(json.get(j).toString());\n                //是数组\n                getJSONValue(j3,k,list);\n            }else if(j==k){\n                //是字符串\n                list.add(json.get(j).toString());\n            }\n        }\n    }\n\n    public static void getJSONValue(JSONArray json,String k,List<String> list){\n        for (Object j:json){\n            if(isJSONObj(j)){\n                //是对象\n                JSONObject j2= JSON.parseObject(j.toString());\n                getJSONValue(j2,k,list);\n            }else if(isJSONArray(j)){\n                //是数组\n                JSONArray j3=JSON.parseArray(j.toString());\n                getJSONValue(j3,k,list);\n            }\n        }\n    }\n\n```\n## 4.接下来写一个比较复杂的json，里面有对象嵌套数组的，数组嵌套对象的，数组嵌套数组的\n[示例json](http://cdn.mjava.top/blog/demojson.txt)\n\n## 5.调用方法\n```java\ntry {\n    File file=new File(demo1.class.getResource(\"/2.json\").getPath());\n    FileInputStream fileInputStream=new FileInputStream(file);\n    InputStreamReader inputStreamReader=new InputStreamReader(fileInputStream);\n    BufferedReader bufferedReader=new BufferedReader(inputStreamReader);\n    String line=\"\";\n    StringBuffer json=new StringBuffer();\n    while ((line=bufferedReader.readLine())!=null){\n        json.append(line);\n    }\n\n    JSONObject j3=JSON.parseObject(json.toString());\n    List<String> mid=new ArrayList<>();\n    getJSONValue(j3,\"interfaceId\",mid);\n    System.out.println(mid.toString());\n}catch (Exception e){\n    System.out.println(e.getMessage());\n}\n```\n## 6.成功获取\n![控制台返回](http://cdn.mjava.top/blog/json2.png)\n\n>demo源码地址：https://github.com/z573419235/studyDemo\n","slug":"algorithm/algorithm-recursive-01","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bj300072mg5t4zk63o1","content":"<p>今天在工作中遇到要解析json并获取json里所有指定key的值，再把key的值插入对应的数据映射表。于是写了一个递归算法来取值。</p>\n<h2 id=\"1-首先导入alibaba的fastjson，用来解析json。当然也可以用其他的解析包\"><a href=\"#1-首先导入alibaba的fastjson，用来解析json。当然也可以用其他的解析包\" class=\"headerlink\" title=\"1.首先导入alibaba的fastjson，用来解析json。当然也可以用其他的解析包\"></a>1.首先导入alibaba的fastjson，用来解析json。当然也可以用其他的解析包</h2><figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.2.58&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-创建两个工具类方法，用来判断传入的是不是json对象或json数组\"><a href=\"#2-创建两个工具类方法，用来判断传入的是不是json对象或json数组\" class=\"headerlink\" title=\"2.创建两个工具类方法，用来判断传入的是不是json对象或json数组\"></a>2.创建两个工具类方法，用来判断传入的是不是json对象或json数组</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isJSONObj</span><span class=\"params\">(Object json)</span></span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">return</span> json <span class=\"keyword\">instanceof</span> JSONObject;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isJSONArray</span><span class=\"params\">(Object json)</span></span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">return</span> json <span class=\"keyword\">instanceof</span> JSONArray;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>java中的instanceof也称为类型比较运算符，因为它将实例与类型进行比较。它返回true或false。</p>\n</blockquote>\n<h2 id=\"3-建立核心重载方法\"><a href=\"#3-建立核心重载方法\" class=\"headerlink\" title=\"3.建立核心重载方法\"></a>3.建立核心重载方法</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">getJSONValue</span><span class=\"params\">(JSONObject json,String k,List&lt;String&gt; list)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Object j:json.keySet())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(isJSONObj(json.get(j)))&#123;</span><br><span class=\"line\">            <span class=\"comment\">//是对象</span></span><br><span class=\"line\">            JSONObject j2= JSON.parseObject(json.get(j).toString());</span><br><span class=\"line\">            getJSONValue(j2,k,list);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(isJSONArray(json.get(j)))&#123;</span><br><span class=\"line\">            JSONArray j3=JSON.parseArray(json.get(j).toString());</span><br><span class=\"line\">            <span class=\"comment\">//是数组</span></span><br><span class=\"line\">            getJSONValue(j3,k,list);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(j==k)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//是字符串</span></span><br><span class=\"line\">            list.add(json.get(j).toString());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">getJSONValue</span><span class=\"params\">(JSONArray json,String k,List&lt;String&gt; list)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Object j:json)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(isJSONObj(j))&#123;</span><br><span class=\"line\">            <span class=\"comment\">//是对象</span></span><br><span class=\"line\">            JSONObject j2= JSON.parseObject(j.toString());</span><br><span class=\"line\">            getJSONValue(j2,k,list);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(isJSONArray(j))&#123;</span><br><span class=\"line\">            <span class=\"comment\">//是数组</span></span><br><span class=\"line\">            JSONArray j3=JSON.parseArray(j.toString());</span><br><span class=\"line\">            getJSONValue(j3,k,list);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-接下来写一个比较复杂的json，里面有对象嵌套数组的，数组嵌套对象的，数组嵌套数组的\"><a href=\"#4-接下来写一个比较复杂的json，里面有对象嵌套数组的，数组嵌套对象的，数组嵌套数组的\" class=\"headerlink\" title=\"4.接下来写一个比较复杂的json，里面有对象嵌套数组的，数组嵌套对象的，数组嵌套数组的\"></a>4.接下来写一个比较复杂的json，里面有对象嵌套数组的，数组嵌套对象的，数组嵌套数组的</h2><p><a href=\"http://cdn.mjava.top/blog/demojson.txt\" rel=\"noopener\" target=\"_blank\">示例json</a></p>\n<h2 id=\"5-调用方法\"><a href=\"#5-调用方法\" class=\"headerlink\" title=\"5.调用方法\"></a>5.调用方法</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    File file=<span class=\"keyword\">new</span> File(demo1.class.getResource(<span class=\"string\">\"/2.json\"</span>).getPath());</span><br><span class=\"line\">    FileInputStream fileInputStream=<span class=\"keyword\">new</span> FileInputStream(file);</span><br><span class=\"line\">    InputStreamReader inputStreamReader=<span class=\"keyword\">new</span> InputStreamReader(fileInputStream);</span><br><span class=\"line\">    BufferedReader bufferedReader=<span class=\"keyword\">new</span> BufferedReader(inputStreamReader);</span><br><span class=\"line\">    String line=<span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    StringBuffer json=<span class=\"keyword\">new</span> StringBuffer();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> ((line=bufferedReader.readLine())!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        json.append(line);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    JSONObject j3=JSON.parseObject(json.toString());</span><br><span class=\"line\">    List&lt;String&gt; mid=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    getJSONValue(j3,<span class=\"string\">\"interfaceId\"</span>,mid);</span><br><span class=\"line\">    System.out.println(mid.toString());</span><br><span class=\"line\">&#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</span><br><span class=\"line\">    System.out.println(e.getMessage());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6-成功获取\"><a href=\"#6-成功获取\" class=\"headerlink\" title=\"6.成功获取\"></a>6.成功获取</h2><p><img src=\"http://cdn.mjava.top/blog/json2.png\" alt=\"控制台返回\"></p>\n<blockquote>\n<p>demo源码地址：<a href=\"https://github.com/z573419235/studyDemo\" rel=\"noopener\" target=\"_blank\">https://github.com/z573419235/studyDemo</a></p>\n</blockquote>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p>今天在工作中遇到要解析json并获取json里所有指定key的值，再把key的值插入对应的数据映射表。于是写了一个递归算法来取值。</p>\n<h2 id=\"1-首先导入alibaba的fastjson，用来解析json。当然也可以用其他的解析包\"><a href=\"#1-首先导入alibaba的fastjson，用来解析json。当然也可以用其他的解析包\" class=\"headerlink\" title=\"1.首先导入alibaba的fastjson，用来解析json。当然也可以用其他的解析包\"></a>1.首先导入alibaba的fastjson，用来解析json。当然也可以用其他的解析包</h2><figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;1.2.58&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-创建两个工具类方法，用来判断传入的是不是json对象或json数组\"><a href=\"#2-创建两个工具类方法，用来判断传入的是不是json对象或json数组\" class=\"headerlink\" title=\"2.创建两个工具类方法，用来判断传入的是不是json对象或json数组\"></a>2.创建两个工具类方法，用来判断传入的是不是json对象或json数组</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isJSONObj</span><span class=\"params\">(Object json)</span></span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">return</span> json <span class=\"keyword\">instanceof</span> JSONObject;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isJSONArray</span><span class=\"params\">(Object json)</span></span>&#123;</span><br><span class=\"line\">   <span class=\"keyword\">return</span> json <span class=\"keyword\">instanceof</span> JSONArray;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>java中的instanceof也称为类型比较运算符，因为它将实例与类型进行比较。它返回true或false。</p>\n</blockquote>\n<h2 id=\"3-建立核心重载方法\"><a href=\"#3-建立核心重载方法\" class=\"headerlink\" title=\"3.建立核心重载方法\"></a>3.建立核心重载方法</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">getJSONValue</span><span class=\"params\">(JSONObject json,String k,List&lt;String&gt; list)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Object j:json.keySet())&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(isJSONObj(json.get(j)))&#123;</span><br><span class=\"line\">            <span class=\"comment\">//是对象</span></span><br><span class=\"line\">            JSONObject j2= JSON.parseObject(json.get(j).toString());</span><br><span class=\"line\">            getJSONValue(j2,k,list);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(isJSONArray(json.get(j)))&#123;</span><br><span class=\"line\">            JSONArray j3=JSON.parseArray(json.get(j).toString());</span><br><span class=\"line\">            <span class=\"comment\">//是数组</span></span><br><span class=\"line\">            getJSONValue(j3,k,list);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(j==k)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//是字符串</span></span><br><span class=\"line\">            list.add(json.get(j).toString());</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">getJSONValue</span><span class=\"params\">(JSONArray json,String k,List&lt;String&gt; list)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (Object j:json)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(isJSONObj(j))&#123;</span><br><span class=\"line\">            <span class=\"comment\">//是对象</span></span><br><span class=\"line\">            JSONObject j2= JSON.parseObject(j.toString());</span><br><span class=\"line\">            getJSONValue(j2,k,list);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(isJSONArray(j))&#123;</span><br><span class=\"line\">            <span class=\"comment\">//是数组</span></span><br><span class=\"line\">            JSONArray j3=JSON.parseArray(j.toString());</span><br><span class=\"line\">            getJSONValue(j3,k,list);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"4-接下来写一个比较复杂的json，里面有对象嵌套数组的，数组嵌套对象的，数组嵌套数组的\"><a href=\"#4-接下来写一个比较复杂的json，里面有对象嵌套数组的，数组嵌套对象的，数组嵌套数组的\" class=\"headerlink\" title=\"4.接下来写一个比较复杂的json，里面有对象嵌套数组的，数组嵌套对象的，数组嵌套数组的\"></a>4.接下来写一个比较复杂的json，里面有对象嵌套数组的，数组嵌套对象的，数组嵌套数组的</h2><p><a href=\"http://cdn.mjava.top/blog/demojson.txt\" rel=\"noopener\" target=\"_blank\">示例json</a></p>\n<h2 id=\"5-调用方法\"><a href=\"#5-调用方法\" class=\"headerlink\" title=\"5.调用方法\"></a>5.调用方法</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">    File file=<span class=\"keyword\">new</span> File(demo1.class.getResource(<span class=\"string\">\"/2.json\"</span>).getPath());</span><br><span class=\"line\">    FileInputStream fileInputStream=<span class=\"keyword\">new</span> FileInputStream(file);</span><br><span class=\"line\">    InputStreamReader inputStreamReader=<span class=\"keyword\">new</span> InputStreamReader(fileInputStream);</span><br><span class=\"line\">    BufferedReader bufferedReader=<span class=\"keyword\">new</span> BufferedReader(inputStreamReader);</span><br><span class=\"line\">    String line=<span class=\"string\">\"\"</span>;</span><br><span class=\"line\">    StringBuffer json=<span class=\"keyword\">new</span> StringBuffer();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> ((line=bufferedReader.readLine())!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        json.append(line);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    JSONObject j3=JSON.parseObject(json.toString());</span><br><span class=\"line\">    List&lt;String&gt; mid=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    getJSONValue(j3,<span class=\"string\">\"interfaceId\"</span>,mid);</span><br><span class=\"line\">    System.out.println(mid.toString());</span><br><span class=\"line\">&#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</span><br><span class=\"line\">    System.out.println(e.getMessage());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"6-成功获取\"><a href=\"#6-成功获取\" class=\"headerlink\" title=\"6.成功获取\"></a>6.成功获取</h2><p><img src=\"http://cdn.mjava.top/blog/json2.png\" alt=\"控制台返回\"></p>\n<blockquote>\n<p>demo源码地址：<a href=\"https://github.com/z573419235/studyDemo\" rel=\"noopener\" target=\"_blank\">https://github.com/z573419235/studyDemo</a></p>\n</blockquote>\n"},{"title":"【数据结构】手写平衡二叉树（AVL）","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-02-01T07:56:00.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n# 【数据结构】手写平衡二叉树（AVL）\n\n![](http://cdn.mjava.top/blog/20200201165139.jpg)\n\n> 积千里跬步，汇万里江河。每天进步一点点，终有一天将成大佬\n>\n> 本文源代码：[手写AVL树](https://github.com/z573419235/studyDemo/blob/master/BaseJava/src/dataStructure/AVLTree.java)\n\n## 什么是平衡二叉树？\n\n平衡二叉树，又称为AVL树，当树不是空树时，它的左右两个子树的高度差的绝对值不超过1，并且左右两个子树都是一棵[平衡二叉树](https://baike.baidu.com/item/平衡二叉树/10421057)。AVL树查找的时间复杂度为O(logN)。\n\n### 平衡二叉树基本特点\n\n- 左右子树深度差不能大于1\n- 左边子树永远比根节点小\n- 右边子树永远比根节点大\n\n### 平衡二叉树基本结构及操作\n\n- 左左结构——右旋\n\n![左左结构](http://cdn.mjava.top/blog/20200201153234.jpg)\n\n- 右右结构——左旋\n\n![右右结构](http://cdn.mjava.top/blog/20200201153301.jpg)\n\n- 左右结构——左子先左旋，然后整体右旋\n\n![左右结构](http://cdn.mjava.top/blog/20200201153329.jpg)\n\n- 右左结构——右子先右旋，然后整体左旋\n\n![右左结构](http://cdn.mjava.top/blog/20200201153403.jpg)\n\n## 代码实现\n\n先创建一个内部类Node，来表示树的每个节点\n\n```java\npublic class AVLTree {\n    private Node rootNode;\n\n    //二叉树节点\n    private class Node{\n        public Node parent; //父\n        public Node left;\t//左子树\n        public Node right;\t//右子树\n        @NotNull\n        public int data;\t//存放的数据\n        private int depth;\t//深度\n        private int balance;\t//平衡因子\n\t\t//有参构造方法\n        public Node(int data){\n            this.data=data;\n            this.depth=1;\n            this.balance=0;\n        }\n    }\n}\n```\n\n### 插入数据\n\n暴露一个方法给外部调用\n\n```java\n/**添加数据方法*/\npublic void add(int data){\n    if (this.rootNode==null){\n        this.rootNode=new Node(data);\n    }else {\n        this.insert(rootNode,data);\n        //判断根节点是否有父  有的话说明有旋转操作，更新根节点\n        if (this.rootNode.parent!=null){\n            this.rootNode=this.rootNode.parent;\n        }\n    }\n}\n```\n\n实际内部是调用另一个`insert`方法：\n\n```java\nprivate void insert(Node root,int data){\n    //插入的数据比根小\n    if (data<root.data){\n        if (root.left==null){\n            root.left=new Node(data);\n            root.left.parent=root;\n        }else {\n            this.insert(root.left,data);\n        }\n    }\n    //插入的数据比根大\n    if (data>root.data){\n        if (root.right==null) {\n            root.right=new Node(data);\n            root.right.parent=root;\n        }else{\n            this.insert(root.right,data);\n        }\n    }\n    root.balance=this.getBalance(root);\n\n    if (root.balance>1){\n        //判断左子的平衡因子\n        if (root.left.balance<0){\n            this.leftTurn(root.left);\n        }\n        this.rightTurn(root);\n    }\n    if (root.balance<-1){\n        //判断右子的平衡因子\n        if (root.right.balance>0){\n            this.rightTurn(root.right);\n        }\n        this.leftTurn(root);\n    }\n    root.depth=this.getDepth(root);\n    root.balance=this.getBalance(root);\n}\n```\n\n### 右旋\n> 右旋的操作如下\n- 我父变成左子的父\n- 左子变成我的父\n- 我变成左子的右子\n- 左子的右子变成我的左子\n- (当左子的右子存在时)我变成左子的右子的父\n- 计算左右节点的深度\n- 计算深度差\n\n```java\nprivate void rightTurn(@NotNull Node node){\n    Node parent=node.parent;\n    Node leftSon=node.left;\n    Node leftSon_rightSon=leftSon.right;\n\n    //如果父不为空，判断我是在父的左节点还是右节点\n    if (parent!=null){\n        if (node==parent.left){\n            //我在父的左节点上，把我的左子变成父的左子\n            parent.left=leftSon;\n        }\n        if (node==parent.right){\n            //我在父的右节点上，把我的左子变成父的右子\n            parent.right=leftSon;\n        }\n    }\n    leftSon.parent=parent;\n    node.parent=leftSon;\n    leftSon.right=node;\n    node.left=leftSon_rightSon;\n    //如果左子的右子确实存在的\n    if (leftSon_rightSon!=null){\n        //我变成左子的右子的父\n        leftSon_rightSon.parent=node;\n    }\n    //重新计算深度和平衡因子\n    node.depth=this.getDepth(node);\n    node.balance=this.getBalance(node);\n    leftSon.depth=this.getDepth(leftSon);\n    leftSon.balance=this.getBalance(leftSon);\n}\n```\n\n\n### 左旋\n> 左旋的操作如下\n- 我的父变右子的父\n- 右子变成我的父\n- 我变成右子的左子\n- 右子的左子变成我的右子\n- (当右子的左子存在时)我变成右子的左子的父\n- 计算左右节点的深度\n- 计算深度差\n\n```java\nprivate void leftTurn(@NotNull Node node){\n    Node parent=node.parent;\n    Node rightSon=node.right;\n    Node rightSon_leftSon=rightSon.left;\n\n    if (parent!=null){\n        if (node==parent.left){\n            parent.left=rightSon;\n        }\n        if (node==parent.right){\n            parent.right=rightSon;\n        }\n    }\n    rightSon.parent=parent;\n    node.parent=rightSon;\n    rightSon.left=node;\n    node.right=rightSon_leftSon;\n    if (rightSon_leftSon!=null){\n        rightSon_leftSon.parent=node;\n    }\n    node.depth=this.getDepth(node);\n    node.balance=this.getBalance(node);\n    rightSon.depth=this.getDepth(rightSon);\n    rightSon.balance=this.getBalance(rightSon);\n}\n```\n\n### 计算深度\n\n```java\n/**计算深度*/\nprivate int getDepth(Node node){\n    int depth = 0;\n    if(node.left==null && node.right!=null) {\n        depth=node.right.depth;\n    }\n    if(node.right==null && node.left!=null) {\n        depth=node.left.depth;\n    }\n    if (node.right!=null && node.left!=null) {\n        depth=Math.max(node.left.depth,node.right.depth);\n    }\n    depth++;\n    return depth;\n}\n```\n\n### 计算平衡因子\n\n```java\n/**计算左右深度差*/\nprivate int getBalance(Node node){\n    int leftDepth = 0;\n    int rightDepth = 0;\n    if(node.left!=null){\n        leftDepth=node.left.depth;\n    }\n    if(node.right!=null){\n        rightDepth=node.right.depth;\n    }\n    /**\n         *      左减右\n         * 为负数：右边子树高\n         * 为正数: 左边子树高\n         * */\n    return leftDepth-rightDepth;\n}\n```\n\n## 附言\n\n如果代码和静态图看不太明白的话，这边推荐几个动画演示的网站(可能需要科学上网)：\n\n- [visualgo在线](https://visualgo.net/zh)\n\n- [数据结构可视化](https://www.cs.usfca.edu/~galles/visualization/Algorithms.html)","source":"_posts/algorithm/algorithm-avltree-01.md","raw":"---\ntitle: 【数据结构】手写平衡二叉树（AVL）\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-02-01 15:56:00\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- AVL\n- 数据结构\n- 平衡二叉树\n- 二叉树\ncategories:\n- Algorithm\n---\n\n\n# 【数据结构】手写平衡二叉树（AVL）\n\n![](http://cdn.mjava.top/blog/20200201165139.jpg)\n\n> 积千里跬步，汇万里江河。每天进步一点点，终有一天将成大佬\n>\n> 本文源代码：[手写AVL树](https://github.com/z573419235/studyDemo/blob/master/BaseJava/src/dataStructure/AVLTree.java)\n\n## 什么是平衡二叉树？\n\n平衡二叉树，又称为AVL树，当树不是空树时，它的左右两个子树的高度差的绝对值不超过1，并且左右两个子树都是一棵[平衡二叉树](https://baike.baidu.com/item/平衡二叉树/10421057)。AVL树查找的时间复杂度为O(logN)。\n\n### 平衡二叉树基本特点\n\n- 左右子树深度差不能大于1\n- 左边子树永远比根节点小\n- 右边子树永远比根节点大\n\n### 平衡二叉树基本结构及操作\n\n- 左左结构——右旋\n\n![左左结构](http://cdn.mjava.top/blog/20200201153234.jpg)\n\n- 右右结构——左旋\n\n![右右结构](http://cdn.mjava.top/blog/20200201153301.jpg)\n\n- 左右结构——左子先左旋，然后整体右旋\n\n![左右结构](http://cdn.mjava.top/blog/20200201153329.jpg)\n\n- 右左结构——右子先右旋，然后整体左旋\n\n![右左结构](http://cdn.mjava.top/blog/20200201153403.jpg)\n\n## 代码实现\n\n先创建一个内部类Node，来表示树的每个节点\n\n```java\npublic class AVLTree {\n    private Node rootNode;\n\n    //二叉树节点\n    private class Node{\n        public Node parent; //父\n        public Node left;\t//左子树\n        public Node right;\t//右子树\n        @NotNull\n        public int data;\t//存放的数据\n        private int depth;\t//深度\n        private int balance;\t//平衡因子\n\t\t//有参构造方法\n        public Node(int data){\n            this.data=data;\n            this.depth=1;\n            this.balance=0;\n        }\n    }\n}\n```\n\n### 插入数据\n\n暴露一个方法给外部调用\n\n```java\n/**添加数据方法*/\npublic void add(int data){\n    if (this.rootNode==null){\n        this.rootNode=new Node(data);\n    }else {\n        this.insert(rootNode,data);\n        //判断根节点是否有父  有的话说明有旋转操作，更新根节点\n        if (this.rootNode.parent!=null){\n            this.rootNode=this.rootNode.parent;\n        }\n    }\n}\n```\n\n实际内部是调用另一个`insert`方法：\n\n```java\nprivate void insert(Node root,int data){\n    //插入的数据比根小\n    if (data<root.data){\n        if (root.left==null){\n            root.left=new Node(data);\n            root.left.parent=root;\n        }else {\n            this.insert(root.left,data);\n        }\n    }\n    //插入的数据比根大\n    if (data>root.data){\n        if (root.right==null) {\n            root.right=new Node(data);\n            root.right.parent=root;\n        }else{\n            this.insert(root.right,data);\n        }\n    }\n    root.balance=this.getBalance(root);\n\n    if (root.balance>1){\n        //判断左子的平衡因子\n        if (root.left.balance<0){\n            this.leftTurn(root.left);\n        }\n        this.rightTurn(root);\n    }\n    if (root.balance<-1){\n        //判断右子的平衡因子\n        if (root.right.balance>0){\n            this.rightTurn(root.right);\n        }\n        this.leftTurn(root);\n    }\n    root.depth=this.getDepth(root);\n    root.balance=this.getBalance(root);\n}\n```\n\n### 右旋\n> 右旋的操作如下\n- 我父变成左子的父\n- 左子变成我的父\n- 我变成左子的右子\n- 左子的右子变成我的左子\n- (当左子的右子存在时)我变成左子的右子的父\n- 计算左右节点的深度\n- 计算深度差\n\n```java\nprivate void rightTurn(@NotNull Node node){\n    Node parent=node.parent;\n    Node leftSon=node.left;\n    Node leftSon_rightSon=leftSon.right;\n\n    //如果父不为空，判断我是在父的左节点还是右节点\n    if (parent!=null){\n        if (node==parent.left){\n            //我在父的左节点上，把我的左子变成父的左子\n            parent.left=leftSon;\n        }\n        if (node==parent.right){\n            //我在父的右节点上，把我的左子变成父的右子\n            parent.right=leftSon;\n        }\n    }\n    leftSon.parent=parent;\n    node.parent=leftSon;\n    leftSon.right=node;\n    node.left=leftSon_rightSon;\n    //如果左子的右子确实存在的\n    if (leftSon_rightSon!=null){\n        //我变成左子的右子的父\n        leftSon_rightSon.parent=node;\n    }\n    //重新计算深度和平衡因子\n    node.depth=this.getDepth(node);\n    node.balance=this.getBalance(node);\n    leftSon.depth=this.getDepth(leftSon);\n    leftSon.balance=this.getBalance(leftSon);\n}\n```\n\n\n### 左旋\n> 左旋的操作如下\n- 我的父变右子的父\n- 右子变成我的父\n- 我变成右子的左子\n- 右子的左子变成我的右子\n- (当右子的左子存在时)我变成右子的左子的父\n- 计算左右节点的深度\n- 计算深度差\n\n```java\nprivate void leftTurn(@NotNull Node node){\n    Node parent=node.parent;\n    Node rightSon=node.right;\n    Node rightSon_leftSon=rightSon.left;\n\n    if (parent!=null){\n        if (node==parent.left){\n            parent.left=rightSon;\n        }\n        if (node==parent.right){\n            parent.right=rightSon;\n        }\n    }\n    rightSon.parent=parent;\n    node.parent=rightSon;\n    rightSon.left=node;\n    node.right=rightSon_leftSon;\n    if (rightSon_leftSon!=null){\n        rightSon_leftSon.parent=node;\n    }\n    node.depth=this.getDepth(node);\n    node.balance=this.getBalance(node);\n    rightSon.depth=this.getDepth(rightSon);\n    rightSon.balance=this.getBalance(rightSon);\n}\n```\n\n### 计算深度\n\n```java\n/**计算深度*/\nprivate int getDepth(Node node){\n    int depth = 0;\n    if(node.left==null && node.right!=null) {\n        depth=node.right.depth;\n    }\n    if(node.right==null && node.left!=null) {\n        depth=node.left.depth;\n    }\n    if (node.right!=null && node.left!=null) {\n        depth=Math.max(node.left.depth,node.right.depth);\n    }\n    depth++;\n    return depth;\n}\n```\n\n### 计算平衡因子\n\n```java\n/**计算左右深度差*/\nprivate int getBalance(Node node){\n    int leftDepth = 0;\n    int rightDepth = 0;\n    if(node.left!=null){\n        leftDepth=node.left.depth;\n    }\n    if(node.right!=null){\n        rightDepth=node.right.depth;\n    }\n    /**\n         *      左减右\n         * 为负数：右边子树高\n         * 为正数: 左边子树高\n         * */\n    return leftDepth-rightDepth;\n}\n```\n\n## 附言\n\n如果代码和静态图看不太明白的话，这边推荐几个动画演示的网站(可能需要科学上网)：\n\n- [visualgo在线](https://visualgo.net/zh)\n\n- [数据结构可视化](https://www.cs.usfca.edu/~galles/visualization/Algorithms.html)","slug":"algorithm/algorithm-avltree-01","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bj600082mg5vcp7vn59","content":"<h1 id=\"【数据结构】手写平衡二叉树（AVL）\"><a href=\"#【数据结构】手写平衡二叉树（AVL）\" class=\"headerlink\" title=\"【数据结构】手写平衡二叉树（AVL）\"></a>【数据结构】手写平衡二叉树（AVL）</h1><p><img src=\"http://cdn.mjava.top/blog/20200201165139.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河。每天进步一点点，终有一天将成大佬</p>\n<p>本文源代码：<a href=\"https://github.com/z573419235/studyDemo/blob/master/BaseJava/src/dataStructure/AVLTree.java\" rel=\"noopener\" target=\"_blank\">手写AVL树</a></p>\n</blockquote>\n<h2 id=\"什么是平衡二叉树？\"><a href=\"#什么是平衡二叉树？\" class=\"headerlink\" title=\"什么是平衡二叉树？\"></a>什么是平衡二叉树？</h2><p>平衡二叉树，又称为AVL树，当树不是空树时，它的左右两个子树的高度差的绝对值不超过1，并且左右两个子树都是一棵<a href=\"https://baike.baidu.com/item/平衡二叉树/10421057\" rel=\"noopener\" target=\"_blank\">平衡二叉树</a>。AVL树查找的时间复杂度为O(logN)。</p>\n<h3 id=\"平衡二叉树基本特点\"><a href=\"#平衡二叉树基本特点\" class=\"headerlink\" title=\"平衡二叉树基本特点\"></a>平衡二叉树基本特点</h3><ul>\n<li>左右子树深度差不能大于1</li>\n<li>左边子树永远比根节点小</li>\n<li>右边子树永远比根节点大</li>\n</ul>\n<h3 id=\"平衡二叉树基本结构及操作\"><a href=\"#平衡二叉树基本结构及操作\" class=\"headerlink\" title=\"平衡二叉树基本结构及操作\"></a>平衡二叉树基本结构及操作</h3><ul>\n<li>左左结构——右旋</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200201153234.jpg\" alt=\"左左结构\"></p>\n<ul>\n<li>右右结构——左旋</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200201153301.jpg\" alt=\"右右结构\"></p>\n<ul>\n<li>左右结构——左子先左旋，然后整体右旋</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200201153329.jpg\" alt=\"左右结构\"></p>\n<ul>\n<li>右左结构——右子先右旋，然后整体左旋</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200201153403.jpg\" alt=\"右左结构\"></p>\n<h2 id=\"代码实现\"><a href=\"#代码实现\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h2><p>先创建一个内部类Node，来表示树的每个节点</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AVLTree</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Node rootNode;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//二叉树节点</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Node</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">public</span> Node parent; <span class=\"comment\">//父</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Node left;\t<span class=\"comment\">//左子树</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Node right;\t<span class=\"comment\">//右子树</span></span><br><span class=\"line\">        <span class=\"meta\">@NotNull</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> data;\t<span class=\"comment\">//存放的数据</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> depth;\t<span class=\"comment\">//深度</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> balance;\t<span class=\"comment\">//平衡因子</span></span><br><span class=\"line\">\t\t<span class=\"comment\">//有参构造方法</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Node</span><span class=\"params\">(<span class=\"keyword\">int</span> data)</span></span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.data=data;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.depth=<span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.balance=<span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"插入数据\"><a href=\"#插入数据\" class=\"headerlink\" title=\"插入数据\"></a>插入数据</h3><p>暴露一个方法给外部调用</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**添加数据方法*/</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> data)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.rootNode==<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.rootNode=<span class=\"keyword\">new</span> Node(data);</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.insert(rootNode,data);</span><br><span class=\"line\">        <span class=\"comment\">//判断根节点是否有父  有的话说明有旋转操作，更新根节点</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.rootNode.parent!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.rootNode=<span class=\"keyword\">this</span>.rootNode.parent;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>实际内部是调用另一个<code>insert</code>方法：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">insert</span><span class=\"params\">(Node root,<span class=\"keyword\">int</span> data)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//插入的数据比根小</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (data&lt;root.data)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root.left==<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            root.left=<span class=\"keyword\">new</span> Node(data);</span><br><span class=\"line\">            root.left.parent=root;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.insert(root.left,data);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//插入的数据比根大</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (data&gt;root.data)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root.right==<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            root.right=<span class=\"keyword\">new</span> Node(data);</span><br><span class=\"line\">            root.right.parent=root;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.insert(root.right,data);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    root.balance=<span class=\"keyword\">this</span>.getBalance(root);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root.balance&gt;<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//判断左子的平衡因子</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root.left.balance&lt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.leftTurn(root.left);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.rightTurn(root);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root.balance&lt;-<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//判断右子的平衡因子</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root.right.balance&gt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.rightTurn(root.right);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.leftTurn(root);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    root.depth=<span class=\"keyword\">this</span>.getDepth(root);</span><br><span class=\"line\">    root.balance=<span class=\"keyword\">this</span>.getBalance(root);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"右旋\"><a href=\"#右旋\" class=\"headerlink\" title=\"右旋\"></a>右旋</h3><blockquote>\n<p>右旋的操作如下</p>\n<ul>\n<li>我父变成左子的父</li>\n<li>左子变成我的父</li>\n<li>我变成左子的右子</li>\n<li>左子的右子变成我的左子</li>\n<li>(当左子的右子存在时)我变成左子的右子的父</li>\n<li>计算左右节点的深度</li>\n<li>计算深度差</li>\n</ul>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">rightTurn</span><span class=\"params\">(@NotNull Node node)</span></span>&#123;</span><br><span class=\"line\">    Node parent=node.parent;</span><br><span class=\"line\">    Node leftSon=node.left;</span><br><span class=\"line\">    Node leftSon_rightSon=leftSon.right;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//如果父不为空，判断我是在父的左节点还是右节点</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (parent!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node==parent.left)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//我在父的左节点上，把我的左子变成父的左子</span></span><br><span class=\"line\">            parent.left=leftSon;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node==parent.right)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//我在父的右节点上，把我的左子变成父的右子</span></span><br><span class=\"line\">            parent.right=leftSon;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    leftSon.parent=parent;</span><br><span class=\"line\">    node.parent=leftSon;</span><br><span class=\"line\">    leftSon.right=node;</span><br><span class=\"line\">    node.left=leftSon_rightSon;</span><br><span class=\"line\">    <span class=\"comment\">//如果左子的右子确实存在的</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (leftSon_rightSon!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//我变成左子的右子的父</span></span><br><span class=\"line\">        leftSon_rightSon.parent=node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//重新计算深度和平衡因子</span></span><br><span class=\"line\">    node.depth=<span class=\"keyword\">this</span>.getDepth(node);</span><br><span class=\"line\">    node.balance=<span class=\"keyword\">this</span>.getBalance(node);</span><br><span class=\"line\">    leftSon.depth=<span class=\"keyword\">this</span>.getDepth(leftSon);</span><br><span class=\"line\">    leftSon.balance=<span class=\"keyword\">this</span>.getBalance(leftSon);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"左旋\"><a href=\"#左旋\" class=\"headerlink\" title=\"左旋\"></a>左旋</h3><blockquote>\n<p>左旋的操作如下</p>\n<ul>\n<li>我的父变右子的父</li>\n<li>右子变成我的父</li>\n<li>我变成右子的左子</li>\n<li>右子的左子变成我的右子</li>\n<li>(当右子的左子存在时)我变成右子的左子的父</li>\n<li>计算左右节点的深度</li>\n<li>计算深度差</li>\n</ul>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">leftTurn</span><span class=\"params\">(@NotNull Node node)</span></span>&#123;</span><br><span class=\"line\">    Node parent=node.parent;</span><br><span class=\"line\">    Node rightSon=node.right;</span><br><span class=\"line\">    Node rightSon_leftSon=rightSon.left;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (parent!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node==parent.left)&#123;</span><br><span class=\"line\">            parent.left=rightSon;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node==parent.right)&#123;</span><br><span class=\"line\">            parent.right=rightSon;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    rightSon.parent=parent;</span><br><span class=\"line\">    node.parent=rightSon;</span><br><span class=\"line\">    rightSon.left=node;</span><br><span class=\"line\">    node.right=rightSon_leftSon;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (rightSon_leftSon!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        rightSon_leftSon.parent=node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    node.depth=<span class=\"keyword\">this</span>.getDepth(node);</span><br><span class=\"line\">    node.balance=<span class=\"keyword\">this</span>.getBalance(node);</span><br><span class=\"line\">    rightSon.depth=<span class=\"keyword\">this</span>.getDepth(rightSon);</span><br><span class=\"line\">    rightSon.balance=<span class=\"keyword\">this</span>.getBalance(rightSon);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"计算深度\"><a href=\"#计算深度\" class=\"headerlink\" title=\"计算深度\"></a>计算深度</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**计算深度*/</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">getDepth</span><span class=\"params\">(Node node)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> depth = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(node.left==<span class=\"keyword\">null</span> &amp;&amp; node.right!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        depth=node.right.depth;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(node.right==<span class=\"keyword\">null</span> &amp;&amp; node.left!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        depth=node.left.depth;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node.right!=<span class=\"keyword\">null</span> &amp;&amp; node.left!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        depth=Math.max(node.left.depth,node.right.depth);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    depth++;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> depth;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"计算平衡因子\"><a href=\"#计算平衡因子\" class=\"headerlink\" title=\"计算平衡因子\"></a>计算平衡因子</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**计算左右深度差*/</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">getBalance</span><span class=\"params\">(Node node)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> leftDepth = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> rightDepth = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(node.left!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        leftDepth=node.left.depth;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(node.right!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        rightDepth=node.right.depth;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         *      左减右</span></span><br><span class=\"line\"><span class=\"comment\">         * 为负数：右边子树高</span></span><br><span class=\"line\"><span class=\"comment\">         * 为正数: 左边子树高</span></span><br><span class=\"line\"><span class=\"comment\">         * */</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> leftDepth-rightDepth;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"附言\"><a href=\"#附言\" class=\"headerlink\" title=\"附言\"></a>附言</h2><p>如果代码和静态图看不太明白的话，这边推荐几个动画演示的网站(可能需要科学上网)：</p>\n<ul>\n<li><p><a href=\"https://visualgo.net/zh\" rel=\"noopener\" target=\"_blank\">visualgo在线</a></p>\n</li>\n<li><p><a href=\"https://www.cs.usfca.edu/~galles/visualization/Algorithms.html\" rel=\"noopener\" target=\"_blank\">数据结构可视化</a></p>\n</li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h1 id=\"【数据结构】手写平衡二叉树（AVL）\"><a href=\"#【数据结构】手写平衡二叉树（AVL）\" class=\"headerlink\" title=\"【数据结构】手写平衡二叉树（AVL）\"></a>【数据结构】手写平衡二叉树（AVL）</h1><p><img src=\"http://cdn.mjava.top/blog/20200201165139.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河。每天进步一点点，终有一天将成大佬</p>\n<p>本文源代码：<a href=\"https://github.com/z573419235/studyDemo/blob/master/BaseJava/src/dataStructure/AVLTree.java\" rel=\"noopener\" target=\"_blank\">手写AVL树</a></p>\n</blockquote>\n<h2 id=\"什么是平衡二叉树？\"><a href=\"#什么是平衡二叉树？\" class=\"headerlink\" title=\"什么是平衡二叉树？\"></a>什么是平衡二叉树？</h2><p>平衡二叉树，又称为AVL树，当树不是空树时，它的左右两个子树的高度差的绝对值不超过1，并且左右两个子树都是一棵<a href=\"https://baike.baidu.com/item/平衡二叉树/10421057\" rel=\"noopener\" target=\"_blank\">平衡二叉树</a>。AVL树查找的时间复杂度为O(logN)。</p>\n<h3 id=\"平衡二叉树基本特点\"><a href=\"#平衡二叉树基本特点\" class=\"headerlink\" title=\"平衡二叉树基本特点\"></a>平衡二叉树基本特点</h3><ul>\n<li>左右子树深度差不能大于1</li>\n<li>左边子树永远比根节点小</li>\n<li>右边子树永远比根节点大</li>\n</ul>\n<h3 id=\"平衡二叉树基本结构及操作\"><a href=\"#平衡二叉树基本结构及操作\" class=\"headerlink\" title=\"平衡二叉树基本结构及操作\"></a>平衡二叉树基本结构及操作</h3><ul>\n<li>左左结构——右旋</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200201153234.jpg\" alt=\"左左结构\"></p>\n<ul>\n<li>右右结构——左旋</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200201153301.jpg\" alt=\"右右结构\"></p>\n<ul>\n<li>左右结构——左子先左旋，然后整体右旋</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200201153329.jpg\" alt=\"左右结构\"></p>\n<ul>\n<li>右左结构——右子先右旋，然后整体左旋</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200201153403.jpg\" alt=\"右左结构\"></p>\n<h2 id=\"代码实现\"><a href=\"#代码实现\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h2><p>先创建一个内部类Node，来表示树的每个节点</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AVLTree</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Node rootNode;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//二叉树节点</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Node</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">public</span> Node parent; <span class=\"comment\">//父</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Node left;\t<span class=\"comment\">//左子树</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> Node right;\t<span class=\"comment\">//右子树</span></span><br><span class=\"line\">        <span class=\"meta\">@NotNull</span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">int</span> data;\t<span class=\"comment\">//存放的数据</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> depth;\t<span class=\"comment\">//深度</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> balance;\t<span class=\"comment\">//平衡因子</span></span><br><span class=\"line\">\t\t<span class=\"comment\">//有参构造方法</span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Node</span><span class=\"params\">(<span class=\"keyword\">int</span> data)</span></span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.data=data;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.depth=<span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.balance=<span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"插入数据\"><a href=\"#插入数据\" class=\"headerlink\" title=\"插入数据\"></a>插入数据</h3><p>暴露一个方法给外部调用</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**添加数据方法*/</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> data)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.rootNode==<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.rootNode=<span class=\"keyword\">new</span> Node(data);</span><br><span class=\"line\">    &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.insert(rootNode,data);</span><br><span class=\"line\">        <span class=\"comment\">//判断根节点是否有父  有的话说明有旋转操作，更新根节点</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span>.rootNode.parent!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.rootNode=<span class=\"keyword\">this</span>.rootNode.parent;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>实际内部是调用另一个<code>insert</code>方法：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">insert</span><span class=\"params\">(Node root,<span class=\"keyword\">int</span> data)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">//插入的数据比根小</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (data&lt;root.data)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root.left==<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            root.left=<span class=\"keyword\">new</span> Node(data);</span><br><span class=\"line\">            root.left.parent=root;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.insert(root.left,data);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//插入的数据比根大</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (data&gt;root.data)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root.right==<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            root.right=<span class=\"keyword\">new</span> Node(data);</span><br><span class=\"line\">            root.right.parent=root;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.insert(root.right,data);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    root.balance=<span class=\"keyword\">this</span>.getBalance(root);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root.balance&gt;<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//判断左子的平衡因子</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root.left.balance&lt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.leftTurn(root.left);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.rightTurn(root);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (root.balance&lt;-<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//判断右子的平衡因子</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (root.right.balance&gt;<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.rightTurn(root.right);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.leftTurn(root);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    root.depth=<span class=\"keyword\">this</span>.getDepth(root);</span><br><span class=\"line\">    root.balance=<span class=\"keyword\">this</span>.getBalance(root);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"右旋\"><a href=\"#右旋\" class=\"headerlink\" title=\"右旋\"></a>右旋</h3><blockquote>\n<p>右旋的操作如下</p>\n<ul>\n<li>我父变成左子的父</li>\n<li>左子变成我的父</li>\n<li>我变成左子的右子</li>\n<li>左子的右子变成我的左子</li>\n<li>(当左子的右子存在时)我变成左子的右子的父</li>\n<li>计算左右节点的深度</li>\n<li>计算深度差</li>\n</ul>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">rightTurn</span><span class=\"params\">(@NotNull Node node)</span></span>&#123;</span><br><span class=\"line\">    Node parent=node.parent;</span><br><span class=\"line\">    Node leftSon=node.left;</span><br><span class=\"line\">    Node leftSon_rightSon=leftSon.right;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//如果父不为空，判断我是在父的左节点还是右节点</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (parent!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node==parent.left)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//我在父的左节点上，把我的左子变成父的左子</span></span><br><span class=\"line\">            parent.left=leftSon;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node==parent.right)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//我在父的右节点上，把我的左子变成父的右子</span></span><br><span class=\"line\">            parent.right=leftSon;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    leftSon.parent=parent;</span><br><span class=\"line\">    node.parent=leftSon;</span><br><span class=\"line\">    leftSon.right=node;</span><br><span class=\"line\">    node.left=leftSon_rightSon;</span><br><span class=\"line\">    <span class=\"comment\">//如果左子的右子确实存在的</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (leftSon_rightSon!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        <span class=\"comment\">//我变成左子的右子的父</span></span><br><span class=\"line\">        leftSon_rightSon.parent=node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//重新计算深度和平衡因子</span></span><br><span class=\"line\">    node.depth=<span class=\"keyword\">this</span>.getDepth(node);</span><br><span class=\"line\">    node.balance=<span class=\"keyword\">this</span>.getBalance(node);</span><br><span class=\"line\">    leftSon.depth=<span class=\"keyword\">this</span>.getDepth(leftSon);</span><br><span class=\"line\">    leftSon.balance=<span class=\"keyword\">this</span>.getBalance(leftSon);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"左旋\"><a href=\"#左旋\" class=\"headerlink\" title=\"左旋\"></a>左旋</h3><blockquote>\n<p>左旋的操作如下</p>\n<ul>\n<li>我的父变右子的父</li>\n<li>右子变成我的父</li>\n<li>我变成右子的左子</li>\n<li>右子的左子变成我的右子</li>\n<li>(当右子的左子存在时)我变成右子的左子的父</li>\n<li>计算左右节点的深度</li>\n<li>计算深度差</li>\n</ul>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">leftTurn</span><span class=\"params\">(@NotNull Node node)</span></span>&#123;</span><br><span class=\"line\">    Node parent=node.parent;</span><br><span class=\"line\">    Node rightSon=node.right;</span><br><span class=\"line\">    Node rightSon_leftSon=rightSon.left;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (parent!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node==parent.left)&#123;</span><br><span class=\"line\">            parent.left=rightSon;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node==parent.right)&#123;</span><br><span class=\"line\">            parent.right=rightSon;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    rightSon.parent=parent;</span><br><span class=\"line\">    node.parent=rightSon;</span><br><span class=\"line\">    rightSon.left=node;</span><br><span class=\"line\">    node.right=rightSon_leftSon;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (rightSon_leftSon!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        rightSon_leftSon.parent=node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    node.depth=<span class=\"keyword\">this</span>.getDepth(node);</span><br><span class=\"line\">    node.balance=<span class=\"keyword\">this</span>.getBalance(node);</span><br><span class=\"line\">    rightSon.depth=<span class=\"keyword\">this</span>.getDepth(rightSon);</span><br><span class=\"line\">    rightSon.balance=<span class=\"keyword\">this</span>.getBalance(rightSon);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"计算深度\"><a href=\"#计算深度\" class=\"headerlink\" title=\"计算深度\"></a>计算深度</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**计算深度*/</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">getDepth</span><span class=\"params\">(Node node)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> depth = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(node.left==<span class=\"keyword\">null</span> &amp;&amp; node.right!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        depth=node.right.depth;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(node.right==<span class=\"keyword\">null</span> &amp;&amp; node.left!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        depth=node.left.depth;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node.right!=<span class=\"keyword\">null</span> &amp;&amp; node.left!=<span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        depth=Math.max(node.left.depth,node.right.depth);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    depth++;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> depth;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"计算平衡因子\"><a href=\"#计算平衡因子\" class=\"headerlink\" title=\"计算平衡因子\"></a>计算平衡因子</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**计算左右深度差*/</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">getBalance</span><span class=\"params\">(Node node)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> leftDepth = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> rightDepth = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(node.left!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        leftDepth=node.left.depth;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(node.right!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">        rightDepth=node.right.depth;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         *      左减右</span></span><br><span class=\"line\"><span class=\"comment\">         * 为负数：右边子树高</span></span><br><span class=\"line\"><span class=\"comment\">         * 为正数: 左边子树高</span></span><br><span class=\"line\"><span class=\"comment\">         * */</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> leftDepth-rightDepth;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"附言\"><a href=\"#附言\" class=\"headerlink\" title=\"附言\"></a>附言</h2><p>如果代码和静态图看不太明白的话，这边推荐几个动画演示的网站(可能需要科学上网)：</p>\n<ul>\n<li><p><a href=\"https://visualgo.net/zh\" rel=\"noopener\" target=\"_blank\">visualgo在线</a></p>\n</li>\n<li><p><a href=\"https://www.cs.usfca.edu/~galles/visualization/Algorithms.html\" rel=\"noopener\" target=\"_blank\">数据结构可视化</a></p>\n</li>\n</ul>\n"},{"title":"Docker下安装mysql并设置用户权限","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-09-03T07:58:46.000Z","password":null,"summary":null,"_content":"\n## 环境\n\n* Ubuntu18.04\n\n* Docker19.03.1\n\n* Mysql5.7\n\n  \n\n## Docker\n\n### 拉取镜像\n\n  Docker拉取镜像默认是从DockerHub上面拉取，上面有各厂商提供的优质官方镜像，可以直接拉取使用。或者也可以用DockerFile自定义构建你自己的镜像。\n\n```shell\nsudo docker pull mysql:5.7\t\t\t//拉取镜像到本地\n```\n\n注：上面mysql:5.7指的是拉取5.7版本的mysql，如果不加直接写mysql的话默认是拉取mysql的最新版本。\n\n![拉取镜像](http://cdn.mjava.top/blog/dockerpullmysql.png)\n\n如果显示上面这样，说明已经拉取好了。\n\n### 查看镜像\n\n```shell\nsudo docker images\t\t//查看本地镜像\n```\n\n![查看本地镜像](http://cdn.mjava.top/blog/dockerimages.png)\n\n\n\n### 创建容器\n\n#### 创建\n\n```shell\nsudo docker run -d -p 3306:3306 --name mysql5.7 -e MYSQL_ROOT_PASSWORD=root mysql:5.7\n```\n\n* -d       指定容器运行于后台\n* -p       端口映射   主机端口:容器端口\n* --name    自定义容器名字，方便记忆，不设置的话会随机生产\n* -e        容器环境变量\n\n![创建容器](http://cdn.mjava.top/blog/dockerrun.png)\n\n创建好的话会显示一串随机生产的id\n\n#### 查看创建好的容器\n\n```shell\nsudo docker ps -a\n```\n\n* -a        显示所有创建好的容器，如果不加只显示正在运行的容器\n\n![查看容器](http://cdn.mjava.top/blog/dockerps.png)\n\n## Mysql\n\n### 进入容器\n\n```shell\nsudo docker exec -it mysql5.7 bash\n```\n\n* -i        打开STDIN，用于控制台交互\n* -t        分配tty设备，该可以支持终端登录\n\n![进入容器](http://cdn.mjava.top/blog/dockerexec.png)\n\n### 登录mysql\n\n```shell\nmysql -uroot -p\n```\n\n注：然后输入刚才创建容器时的密码，就是MYSQL_ROOT_PASSWORD这个参数\n\n### 创建测试数据库\n\n```sql\ncreate database test;\n```\n\n### 创建mysql用户\n\n```sql\ncreate user 'zmh'@'%' identified by 'zmh';\n```\n\n注：\"%\"表示可以任意ip访问\n\n### 切换mysql用户\n\n```sql\nalter user 'zmh' identified by 'zmh';\n```\n\n### 授权\n\n授权test库的所有表的所有权限给zmh用户\n\n```sql\ngrant all privileges on test.* to 'zmh'@'%';\n```\n\n### 刷新权限\n\n```sql\nflush privileges;\n```\n\n退出mysql命令行\n\n```sql\nexit\n```\n\n### 客户端连接测试\n\n![进入容器](http://cdn.mjava.top/blog/sqlclient.png)\n\n成功！\n\n\n\n## 附加\n\n如果要重启mysql的话，不用进容器里面，直接重启容器就可以\n\n* sudo docker start mysql5.7       启动mysql5.7容器\n* sudo docker stop mysql5.7        停止mysql5.7容器\n* sudo docker restart mysql5.7   重启mysql5.7容器","source":"_posts/docker/docker-mysql.md","raw":"---\ntitle: Docker下安装mysql并设置用户权限\ntop: false\ncover: false\ntoc: true\nmathjax: true\ncategories:\n  - Docker\ntags:\n  - Docker\n  - Mysql\n  - Linux\ndate: 2019-09-03 15:58:46\npassword:\nsummary:\n---\n\n## 环境\n\n* Ubuntu18.04\n\n* Docker19.03.1\n\n* Mysql5.7\n\n  \n\n## Docker\n\n### 拉取镜像\n\n  Docker拉取镜像默认是从DockerHub上面拉取，上面有各厂商提供的优质官方镜像，可以直接拉取使用。或者也可以用DockerFile自定义构建你自己的镜像。\n\n```shell\nsudo docker pull mysql:5.7\t\t\t//拉取镜像到本地\n```\n\n注：上面mysql:5.7指的是拉取5.7版本的mysql，如果不加直接写mysql的话默认是拉取mysql的最新版本。\n\n![拉取镜像](http://cdn.mjava.top/blog/dockerpullmysql.png)\n\n如果显示上面这样，说明已经拉取好了。\n\n### 查看镜像\n\n```shell\nsudo docker images\t\t//查看本地镜像\n```\n\n![查看本地镜像](http://cdn.mjava.top/blog/dockerimages.png)\n\n\n\n### 创建容器\n\n#### 创建\n\n```shell\nsudo docker run -d -p 3306:3306 --name mysql5.7 -e MYSQL_ROOT_PASSWORD=root mysql:5.7\n```\n\n* -d       指定容器运行于后台\n* -p       端口映射   主机端口:容器端口\n* --name    自定义容器名字，方便记忆，不设置的话会随机生产\n* -e        容器环境变量\n\n![创建容器](http://cdn.mjava.top/blog/dockerrun.png)\n\n创建好的话会显示一串随机生产的id\n\n#### 查看创建好的容器\n\n```shell\nsudo docker ps -a\n```\n\n* -a        显示所有创建好的容器，如果不加只显示正在运行的容器\n\n![查看容器](http://cdn.mjava.top/blog/dockerps.png)\n\n## Mysql\n\n### 进入容器\n\n```shell\nsudo docker exec -it mysql5.7 bash\n```\n\n* -i        打开STDIN，用于控制台交互\n* -t        分配tty设备，该可以支持终端登录\n\n![进入容器](http://cdn.mjava.top/blog/dockerexec.png)\n\n### 登录mysql\n\n```shell\nmysql -uroot -p\n```\n\n注：然后输入刚才创建容器时的密码，就是MYSQL_ROOT_PASSWORD这个参数\n\n### 创建测试数据库\n\n```sql\ncreate database test;\n```\n\n### 创建mysql用户\n\n```sql\ncreate user 'zmh'@'%' identified by 'zmh';\n```\n\n注：\"%\"表示可以任意ip访问\n\n### 切换mysql用户\n\n```sql\nalter user 'zmh' identified by 'zmh';\n```\n\n### 授权\n\n授权test库的所有表的所有权限给zmh用户\n\n```sql\ngrant all privileges on test.* to 'zmh'@'%';\n```\n\n### 刷新权限\n\n```sql\nflush privileges;\n```\n\n退出mysql命令行\n\n```sql\nexit\n```\n\n### 客户端连接测试\n\n![进入容器](http://cdn.mjava.top/blog/sqlclient.png)\n\n成功！\n\n\n\n## 附加\n\n如果要重启mysql的话，不用进容器里面，直接重启容器就可以\n\n* sudo docker start mysql5.7       启动mysql5.7容器\n* sudo docker stop mysql5.7        停止mysql5.7容器\n* sudo docker restart mysql5.7   重启mysql5.7容器","slug":"docker/docker-mysql","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bja000b2mg5e2py8t26","content":"<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><ul>\n<li><p>Ubuntu18.04</p>\n</li>\n<li><p>Docker19.03.1</p>\n</li>\n<li><p>Mysql5.7</p>\n</li>\n</ul>\n<h2 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h2><h3 id=\"拉取镜像\"><a href=\"#拉取镜像\" class=\"headerlink\" title=\"拉取镜像\"></a>拉取镜像</h3><p>  Docker拉取镜像默认是从DockerHub上面拉取，上面有各厂商提供的优质官方镜像，可以直接拉取使用。或者也可以用DockerFile自定义构建你自己的镜像。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo docker pull mysql:5.7\t\t\t//拉取镜像到本地</span><br></pre></td></tr></table></figure>\n\n<p>注：上面mysql:5.7指的是拉取5.7版本的mysql，如果不加直接写mysql的话默认是拉取mysql的最新版本。</p>\n<p><img src=\"http://cdn.mjava.top/blog/dockerpullmysql.png\" alt=\"拉取镜像\"></p>\n<p>如果显示上面这样，说明已经拉取好了。</p>\n<h3 id=\"查看镜像\"><a href=\"#查看镜像\" class=\"headerlink\" title=\"查看镜像\"></a>查看镜像</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo docker images\t\t//查看本地镜像</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/dockerimages.png\" alt=\"查看本地镜像\"></p>\n<h3 id=\"创建容器\"><a href=\"#创建容器\" class=\"headerlink\" title=\"创建容器\"></a>创建容器</h3><h4 id=\"创建\"><a href=\"#创建\" class=\"headerlink\" title=\"创建\"></a>创建</h4><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo docker run -d -p 3306:3306 --name mysql5.7 -e MYSQL_ROOT_PASSWORD=root mysql:5.7</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>-d       指定容器运行于后台</li>\n<li>-p       端口映射   主机端口:容器端口</li>\n<li>–name    自定义容器名字，方便记忆，不设置的话会随机生产</li>\n<li>-e        容器环境变量</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/dockerrun.png\" alt=\"创建容器\"></p>\n<p>创建好的话会显示一串随机生产的id</p>\n<h4 id=\"查看创建好的容器\"><a href=\"#查看创建好的容器\" class=\"headerlink\" title=\"查看创建好的容器\"></a>查看创建好的容器</h4><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo docker ps -a</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>-a        显示所有创建好的容器，如果不加只显示正在运行的容器</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/dockerps.png\" alt=\"查看容器\"></p>\n<h2 id=\"Mysql\"><a href=\"#Mysql\" class=\"headerlink\" title=\"Mysql\"></a>Mysql</h2><h3 id=\"进入容器\"><a href=\"#进入容器\" class=\"headerlink\" title=\"进入容器\"></a>进入容器</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo docker exec -it mysql5.7 bash</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>-i        打开STDIN，用于控制台交互</li>\n<li>-t        分配tty设备，该可以支持终端登录</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/dockerexec.png\" alt=\"进入容器\"></p>\n<h3 id=\"登录mysql\"><a href=\"#登录mysql\" class=\"headerlink\" title=\"登录mysql\"></a>登录mysql</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mysql -uroot -p</span><br></pre></td></tr></table></figure>\n\n<p>注：然后输入刚才创建容器时的密码，就是MYSQL_ROOT_PASSWORD这个参数</p>\n<h3 id=\"创建测试数据库\"><a href=\"#创建测试数据库\" class=\"headerlink\" title=\"创建测试数据库\"></a>创建测试数据库</h3><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">database</span> <span class=\"keyword\">test</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建mysql用户\"><a href=\"#创建mysql用户\" class=\"headerlink\" title=\"创建mysql用户\"></a>创建mysql用户</h3><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">user</span> <span class=\"string\">'zmh'</span>@<span class=\"string\">'%'</span> <span class=\"keyword\">identified</span> <span class=\"keyword\">by</span> <span class=\"string\">'zmh'</span>;</span><br></pre></td></tr></table></figure>\n\n<p>注：”%”表示可以任意ip访问</p>\n<h3 id=\"切换mysql用户\"><a href=\"#切换mysql用户\" class=\"headerlink\" title=\"切换mysql用户\"></a>切换mysql用户</h3><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">user</span> <span class=\"string\">'zmh'</span> <span class=\"keyword\">identified</span> <span class=\"keyword\">by</span> <span class=\"string\">'zmh'</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"授权\"><a href=\"#授权\" class=\"headerlink\" title=\"授权\"></a>授权</h3><p>授权test库的所有表的所有权限给zmh用户</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">grant</span> <span class=\"keyword\">all</span> <span class=\"keyword\">privileges</span> <span class=\"keyword\">on</span> test.* <span class=\"keyword\">to</span> <span class=\"string\">'zmh'</span>@<span class=\"string\">'%'</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"刷新权限\"><a href=\"#刷新权限\" class=\"headerlink\" title=\"刷新权限\"></a>刷新权限</h3><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">flush</span> <span class=\"keyword\">privileges</span>;</span><br></pre></td></tr></table></figure>\n\n<p>退出mysql命令行</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">exit</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"客户端连接测试\"><a href=\"#客户端连接测试\" class=\"headerlink\" title=\"客户端连接测试\"></a>客户端连接测试</h3><p><img src=\"http://cdn.mjava.top/blog/sqlclient.png\" alt=\"进入容器\"></p>\n<p>成功！</p>\n<h2 id=\"附加\"><a href=\"#附加\" class=\"headerlink\" title=\"附加\"></a>附加</h2><p>如果要重启mysql的话，不用进容器里面，直接重启容器就可以</p>\n<ul>\n<li>sudo docker start mysql5.7       启动mysql5.7容器</li>\n<li>sudo docker stop mysql5.7        停止mysql5.7容器</li>\n<li>sudo docker restart mysql5.7   重启mysql5.7容器</li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><ul>\n<li><p>Ubuntu18.04</p>\n</li>\n<li><p>Docker19.03.1</p>\n</li>\n<li><p>Mysql5.7</p>\n</li>\n</ul>\n<h2 id=\"Docker\"><a href=\"#Docker\" class=\"headerlink\" title=\"Docker\"></a>Docker</h2><h3 id=\"拉取镜像\"><a href=\"#拉取镜像\" class=\"headerlink\" title=\"拉取镜像\"></a>拉取镜像</h3><p>  Docker拉取镜像默认是从DockerHub上面拉取，上面有各厂商提供的优质官方镜像，可以直接拉取使用。或者也可以用DockerFile自定义构建你自己的镜像。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo docker pull mysql:5.7\t\t\t//拉取镜像到本地</span><br></pre></td></tr></table></figure>\n\n<p>注：上面mysql:5.7指的是拉取5.7版本的mysql，如果不加直接写mysql的话默认是拉取mysql的最新版本。</p>\n<p><img src=\"http://cdn.mjava.top/blog/dockerpullmysql.png\" alt=\"拉取镜像\"></p>\n<p>如果显示上面这样，说明已经拉取好了。</p>\n<h3 id=\"查看镜像\"><a href=\"#查看镜像\" class=\"headerlink\" title=\"查看镜像\"></a>查看镜像</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo docker images\t\t//查看本地镜像</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/dockerimages.png\" alt=\"查看本地镜像\"></p>\n<h3 id=\"创建容器\"><a href=\"#创建容器\" class=\"headerlink\" title=\"创建容器\"></a>创建容器</h3><h4 id=\"创建\"><a href=\"#创建\" class=\"headerlink\" title=\"创建\"></a>创建</h4><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo docker run -d -p 3306:3306 --name mysql5.7 -e MYSQL_ROOT_PASSWORD=root mysql:5.7</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>-d       指定容器运行于后台</li>\n<li>-p       端口映射   主机端口:容器端口</li>\n<li>–name    自定义容器名字，方便记忆，不设置的话会随机生产</li>\n<li>-e        容器环境变量</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/dockerrun.png\" alt=\"创建容器\"></p>\n<p>创建好的话会显示一串随机生产的id</p>\n<h4 id=\"查看创建好的容器\"><a href=\"#查看创建好的容器\" class=\"headerlink\" title=\"查看创建好的容器\"></a>查看创建好的容器</h4><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo docker ps -a</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>-a        显示所有创建好的容器，如果不加只显示正在运行的容器</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/dockerps.png\" alt=\"查看容器\"></p>\n<h2 id=\"Mysql\"><a href=\"#Mysql\" class=\"headerlink\" title=\"Mysql\"></a>Mysql</h2><h3 id=\"进入容器\"><a href=\"#进入容器\" class=\"headerlink\" title=\"进入容器\"></a>进入容器</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo docker exec -it mysql5.7 bash</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>-i        打开STDIN，用于控制台交互</li>\n<li>-t        分配tty设备，该可以支持终端登录</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/dockerexec.png\" alt=\"进入容器\"></p>\n<h3 id=\"登录mysql\"><a href=\"#登录mysql\" class=\"headerlink\" title=\"登录mysql\"></a>登录mysql</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mysql -uroot -p</span><br></pre></td></tr></table></figure>\n\n<p>注：然后输入刚才创建容器时的密码，就是MYSQL_ROOT_PASSWORD这个参数</p>\n<h3 id=\"创建测试数据库\"><a href=\"#创建测试数据库\" class=\"headerlink\" title=\"创建测试数据库\"></a>创建测试数据库</h3><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">database</span> <span class=\"keyword\">test</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建mysql用户\"><a href=\"#创建mysql用户\" class=\"headerlink\" title=\"创建mysql用户\"></a>创建mysql用户</h3><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">user</span> <span class=\"string\">'zmh'</span>@<span class=\"string\">'%'</span> <span class=\"keyword\">identified</span> <span class=\"keyword\">by</span> <span class=\"string\">'zmh'</span>;</span><br></pre></td></tr></table></figure>\n\n<p>注：”%”表示可以任意ip访问</p>\n<h3 id=\"切换mysql用户\"><a href=\"#切换mysql用户\" class=\"headerlink\" title=\"切换mysql用户\"></a>切换mysql用户</h3><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">alter</span> <span class=\"keyword\">user</span> <span class=\"string\">'zmh'</span> <span class=\"keyword\">identified</span> <span class=\"keyword\">by</span> <span class=\"string\">'zmh'</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"授权\"><a href=\"#授权\" class=\"headerlink\" title=\"授权\"></a>授权</h3><p>授权test库的所有表的所有权限给zmh用户</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">grant</span> <span class=\"keyword\">all</span> <span class=\"keyword\">privileges</span> <span class=\"keyword\">on</span> test.* <span class=\"keyword\">to</span> <span class=\"string\">'zmh'</span>@<span class=\"string\">'%'</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"刷新权限\"><a href=\"#刷新权限\" class=\"headerlink\" title=\"刷新权限\"></a>刷新权限</h3><figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">flush</span> <span class=\"keyword\">privileges</span>;</span><br></pre></td></tr></table></figure>\n\n<p>退出mysql命令行</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\">exit</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"客户端连接测试\"><a href=\"#客户端连接测试\" class=\"headerlink\" title=\"客户端连接测试\"></a>客户端连接测试</h3><p><img src=\"http://cdn.mjava.top/blog/sqlclient.png\" alt=\"进入容器\"></p>\n<p>成功！</p>\n<h2 id=\"附加\"><a href=\"#附加\" class=\"headerlink\" title=\"附加\"></a>附加</h2><p>如果要重启mysql的话，不用进容器里面，直接重启容器就可以</p>\n<ul>\n<li>sudo docker start mysql5.7       启动mysql5.7容器</li>\n<li>sudo docker stop mysql5.7        停止mysql5.7容器</li>\n<li>sudo docker restart mysql5.7   重启mysql5.7容器</li>\n</ul>\n"},{"title":"Docker迁移根目录导致mysql权限问题","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-20T07:04:16.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 问题描述\n\n　　最近由于公司服务器硬盘老是爆满，导致经常要清硬盘空间．最后发现/var/lib/docker目录占了25G,以前分kvm分区的时候，他们分了两个区：根目录＂/＂,和＂/home＂目录，发现home目录使用几乎为零，于是准备迁移Docker的根目录：\n\n迁移根目录我看的是这个文章：[docker的存储目录迁移](https://www.cnblogs.com/insist-forever/p/11739207.html),　不过迁移的时候我没有使用<font color=orange>rsync</font>这个命令，而是使用<font color=orange>cp -R</font>;\n\n文件复制过去后，按照教程，重新启动docker服务，可是其中mysql容器跑不起来了，报mysqld: Can't create/write to file '/tmp/ibTCv7Rw' (Errcode: 13 - Permission denied)\n\n![](http://cdn.mjava.top/20191220143818.png)\n\n\n\n期间按照网上的方法：说docker容器启动是添加--privileged=true,设置/tmp目录的权限，关闭selinux，这些方法<font color=orange>都没用！！！！！！</font>\n\n> 其中设置/tmp文件权限这个方法，我把里面的/tmp文件挂载出来后，设置了权限，报这个的问题是解决了，可是又出现了新的问题，又报Version: '5.7.27'  socket: '/var/run/mysqld/mysqld.sock' \n>\n> ![](http://cdn.mjava.top/20191220144523.png)\n\n看来还是得从根源上解决问题啊！\n\n## 我的解决办法\n\n​        我想，既然是权限问题，那肯定是复制文件的时候权限丢失了，于是查了下cp命令保持权限的命令（cp -p）:\n\n![](http://cdn.mjava.top/20191220144841.png)\n\n于是我又重新关闭的docker服务，然后删除了所有复制到home文件的目录，重新用<font color=orange>cp -p -R /var/lib/docker /home/docker/lib/</font>来重新复制了文件；\n\n复制后，重启docker服务，启动docker容器，ok,一切正常；用docker info查看，看到已成功转移到/home下．![](http://cdn.mjava.top/20191220145849.png)\n\n","source":"_posts/docker/docker-transfer-pit.md","raw":"---\ntitle: Docker迁移根目录导致mysql权限问题\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-20 15:04:16\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Mysql\n- Pit\n- Docker\n- Linux\ncategories:\n- Docker\n---\n\n## 问题描述\n\n　　最近由于公司服务器硬盘老是爆满，导致经常要清硬盘空间．最后发现/var/lib/docker目录占了25G,以前分kvm分区的时候，他们分了两个区：根目录＂/＂,和＂/home＂目录，发现home目录使用几乎为零，于是准备迁移Docker的根目录：\n\n迁移根目录我看的是这个文章：[docker的存储目录迁移](https://www.cnblogs.com/insist-forever/p/11739207.html),　不过迁移的时候我没有使用<font color=orange>rsync</font>这个命令，而是使用<font color=orange>cp -R</font>;\n\n文件复制过去后，按照教程，重新启动docker服务，可是其中mysql容器跑不起来了，报mysqld: Can't create/write to file '/tmp/ibTCv7Rw' (Errcode: 13 - Permission denied)\n\n![](http://cdn.mjava.top/20191220143818.png)\n\n\n\n期间按照网上的方法：说docker容器启动是添加--privileged=true,设置/tmp目录的权限，关闭selinux，这些方法<font color=orange>都没用！！！！！！</font>\n\n> 其中设置/tmp文件权限这个方法，我把里面的/tmp文件挂载出来后，设置了权限，报这个的问题是解决了，可是又出现了新的问题，又报Version: '5.7.27'  socket: '/var/run/mysqld/mysqld.sock' \n>\n> ![](http://cdn.mjava.top/20191220144523.png)\n\n看来还是得从根源上解决问题啊！\n\n## 我的解决办法\n\n​        我想，既然是权限问题，那肯定是复制文件的时候权限丢失了，于是查了下cp命令保持权限的命令（cp -p）:\n\n![](http://cdn.mjava.top/20191220144841.png)\n\n于是我又重新关闭的docker服务，然后删除了所有复制到home文件的目录，重新用<font color=orange>cp -p -R /var/lib/docker /home/docker/lib/</font>来重新复制了文件；\n\n复制后，重启docker服务，启动docker容器，ok,一切正常；用docker info查看，看到已成功转移到/home下．![](http://cdn.mjava.top/20191220145849.png)\n\n","slug":"docker/docker-transfer-pit","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjb000c2mg5p3x0tajr","content":"<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>　　最近由于公司服务器硬盘老是爆满，导致经常要清硬盘空间．最后发现/var/lib/docker目录占了25G,以前分kvm分区的时候，他们分了两个区：根目录＂/＂,和＂/home＂目录，发现home目录使用几乎为零，于是准备迁移Docker的根目录：</p>\n<p>迁移根目录我看的是这个文章：<a href=\"https://www.cnblogs.com/insist-forever/p/11739207.html\" rel=\"noopener\" target=\"_blank\">docker的存储目录迁移</a>,　不过迁移的时候我没有使用<font color=\"orange\">rsync</font>这个命令，而是使用<font color=\"orange\">cp -R</font>;</p>\n<p>文件复制过去后，按照教程，重新启动docker服务，可是其中mysql容器跑不起来了，报mysqld: Can’t create/write to file ‘/tmp/ibTCv7Rw’ (Errcode: 13 - Permission denied)</p>\n<p><img src=\"http://cdn.mjava.top/20191220143818.png\" alt></p>\n<p>期间按照网上的方法：说docker容器启动是添加–privileged=true,设置/tmp目录的权限，关闭selinux，这些方法<font color=\"orange\">都没用！！！！！！</font></p>\n<blockquote>\n<p>其中设置/tmp文件权限这个方法，我把里面的/tmp文件挂载出来后，设置了权限，报这个的问题是解决了，可是又出现了新的问题，又报Version: ‘5.7.27’  socket: ‘/var/run/mysqld/mysqld.sock’ </p>\n<p><img src=\"http://cdn.mjava.top/20191220144523.png\" alt></p>\n</blockquote>\n<p>看来还是得从根源上解决问题啊！</p>\n<h2 id=\"我的解决办法\"><a href=\"#我的解决办法\" class=\"headerlink\" title=\"我的解决办法\"></a>我的解决办法</h2><p>​        我想，既然是权限问题，那肯定是复制文件的时候权限丢失了，于是查了下cp命令保持权限的命令（cp -p）:</p>\n<p><img src=\"http://cdn.mjava.top/20191220144841.png\" alt></p>\n<p>于是我又重新关闭的docker服务，然后删除了所有复制到home文件的目录，重新用<font color=\"orange\">cp -p -R /var/lib/docker /home/docker/lib/</font>来重新复制了文件；</p>\n<p>复制后，重启docker服务，启动docker容器，ok,一切正常；用docker info查看，看到已成功转移到/home下．<img src=\"http://cdn.mjava.top/20191220145849.png\" alt></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>　　最近由于公司服务器硬盘老是爆满，导致经常要清硬盘空间．最后发现/var/lib/docker目录占了25G,以前分kvm分区的时候，他们分了两个区：根目录＂/＂,和＂/home＂目录，发现home目录使用几乎为零，于是准备迁移Docker的根目录：</p>\n<p>迁移根目录我看的是这个文章：<a href=\"https://www.cnblogs.com/insist-forever/p/11739207.html\" rel=\"noopener\" target=\"_blank\">docker的存储目录迁移</a>,　不过迁移的时候我没有使用<font color=\"orange\">rsync</font>这个命令，而是使用<font color=\"orange\">cp -R</font>;</p>\n<p>文件复制过去后，按照教程，重新启动docker服务，可是其中mysql容器跑不起来了，报mysqld: Can’t create/write to file ‘/tmp/ibTCv7Rw’ (Errcode: 13 - Permission denied)</p>\n<p><img src=\"http://cdn.mjava.top/20191220143818.png\" alt></p>\n<p>期间按照网上的方法：说docker容器启动是添加–privileged=true,设置/tmp目录的权限，关闭selinux，这些方法<font color=\"orange\">都没用！！！！！！</font></p>\n<blockquote>\n<p>其中设置/tmp文件权限这个方法，我把里面的/tmp文件挂载出来后，设置了权限，报这个的问题是解决了，可是又出现了新的问题，又报Version: ‘5.7.27’  socket: ‘/var/run/mysqld/mysqld.sock’ </p>\n<p><img src=\"http://cdn.mjava.top/20191220144523.png\" alt></p>\n</blockquote>\n<p>看来还是得从根源上解决问题啊！</p>\n<h2 id=\"我的解决办法\"><a href=\"#我的解决办法\" class=\"headerlink\" title=\"我的解决办法\"></a>我的解决办法</h2><p>​        我想，既然是权限问题，那肯定是复制文件的时候权限丢失了，于是查了下cp命令保持权限的命令（cp -p）:</p>\n<p><img src=\"http://cdn.mjava.top/20191220144841.png\" alt></p>\n<p>于是我又重新关闭的docker服务，然后删除了所有复制到home文件的目录，重新用<font color=\"orange\">cp -p -R /var/lib/docker /home/docker/lib/</font>来重新复制了文件；</p>\n<p>复制后，重启docker服务，启动docker容器，ok,一切正常；用docker info查看，看到已成功转移到/home下．<img src=\"http://cdn.mjava.top/20191220145849.png\" alt></p>\n"},{"title":"恍然大悟，数组和链表的区别","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-18T05:50:52.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n![](http://cdn.mjava.top/20191218134901.jpg)\n\n> 积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬\n\n## 文前发言\n\n　　在Java中，很多地方都使用了数组和链表，还有两种组合的叫<font color=orange>数组链表</font>结构，就是常说的<font color=orange>哈希表</font>，HashMap底层的数据结构就是哈希表．远了，远了，这里不讲HashMap,这里讲数组和链表；\n\n![](http://cdn.mjava.top/20191218104007.jpg)\n\n## 数组\n\n> 数组是我们平时用的最多的数据结构，它的特点是<font color=orange>查询数据快，插入数据慢</font>，查询的时间复杂度是<font color=orange>O(1)</font>,插入的时间复杂度是<font color=orange>O(n)</font>.\n\n\n\n牛＊一族去学校读书，学校有四人寝和五人寝，大牛，二牛，三牛，四牛一同住进了四人寝里，每天都五缺一；有一天，他们在游戏里认识了小牛，得知小牛也是他们学校的，于是邀请小牛和他们一起住，可是他们们寝室只能住四个人，这个怎么办呢？于是他们向学校(<font color=orange>系统</font>)申请，要求学校给他们一个新的六人寝(<font color=orange>新的内存空间</font>)，于是学校就给了他们新的六人寝，于是他们全部都搬去了六人寝里，小牛也办了进去，之后每天五黑，好不快活；\n\n![](http://cdn.mjava.top/20191218113521.png)\n\n> 之后有其他学生看到牛＊他们的做法，于是也通通向学校申请；最后学校发现了一个问题：就是学生们为了住进新寝室，花费了大量的时间在从旧寝室到新寝室的路上(<font color=orange>插入数据慢</font>)\n\n \n\n有的人会说，那一开始就安排大牛，二牛，三牛，四牛住５人寝不就好了吗？这样他们就不用搬了(这就相当于我们初始化数组时，给数组指定了一个大小)；这样的想法是好的，但是如果他们没有没有认识小牛，小牛也不会搬进去，这样他们四个人就一直住着５人寝，就造成了空间资源浪费；\n\n\n\n有一天，老师去找进入新寝室的小牛谈话，一看得知小牛在４号床，一下就找到了小牛（<font color=orange>查询数据快</font>），问他在这个寝室住的习不习惯，小牛心想，每天都五黑，你说我习不习惯！！\n\n![](http://cdn.mjava.top/20191218114115.gif)\n\n## 链表\n\n> 链表我们平时用的比较少，它的特点是:<font color=orange>插入数据快，查询数据慢</font>，查询的时间复杂度是：<font color=orange>O(n)</font>，插入的时间复杂度是：<font color=orange>O(1)</font>，它的特点是和数组相反的；\n\n\n\n　　经过无数日夜的奋战，牛＊一寝人觉得是时候该出去玩玩了，自从小牛搬过来后，就一直没日没夜的五黑，都快不知道外面的世界长什么样子了；他们一行人准备去游乐园转转．\n\n　　来到游乐园后，一群人像刚放出来的一样，对一切都充满了新鲜感，到处转悠．就在转悠的时候，细心的大牛发现了地上有一张纸条，打开一看，上面写着：<font color=orange>＂少年，你渴望力量吗？想获得力量就来海盗船找我！＂</font>，大牛赶紧找来其他小伙伴，一同前往；到了海盗船的地方，发现船上写着：<font color=orange>＂力量源自摩天轮，请前往摩天轮＂</font>，于是一群人就又前往摩天轮，在那里，终于过得了神秘力量－－－<font color=orange>毒鸡汤：你的内心有多强大，你的力量就有多强大</font>；小牛他们为了寻找这个力量，可谓费尽九牛二虎之力啊（<font color=orange>查询数据慢</font>）；\n\n![](http://cdn.mjava.top/20191218132932.png)\n\n> 可以发现，<font color=orange>每个元素存着下个元素的地址</font>，所以如果要查找其中某个元素，就必须要从头开始，才能找到．这就比较慢了．但是，他们<font color=orange>添加元素很快</font>,元素可以随机出现在游乐园的某个地方，只要在新添加元素的前一个元素指明新元素的地址在哪里就可以了；\n\n\n\n## 发个对比表格吧\n\n### 时间复杂度对比表\n\n| |数组 | 链表|\n| :--: | :--------------: | ---- |\n| 插入 | O(n) 慢 | O(1) 快 |\n| 删除 | O(n) 慢 | O(1) 快 |\n| 查询 | O(1) 快 | O(n) 慢 |\n\n","source":"_posts/algorithm/array-vs-linked.md","raw":"---\ntitle: 恍然大悟，数组和链表的区别\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-18 13:50:52\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- 数据结构\ncategories:\n- Algorithm\n---\n\n\n\n![](http://cdn.mjava.top/20191218134901.jpg)\n\n> 积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬\n\n## 文前发言\n\n　　在Java中，很多地方都使用了数组和链表，还有两种组合的叫<font color=orange>数组链表</font>结构，就是常说的<font color=orange>哈希表</font>，HashMap底层的数据结构就是哈希表．远了，远了，这里不讲HashMap,这里讲数组和链表；\n\n![](http://cdn.mjava.top/20191218104007.jpg)\n\n## 数组\n\n> 数组是我们平时用的最多的数据结构，它的特点是<font color=orange>查询数据快，插入数据慢</font>，查询的时间复杂度是<font color=orange>O(1)</font>,插入的时间复杂度是<font color=orange>O(n)</font>.\n\n\n\n牛＊一族去学校读书，学校有四人寝和五人寝，大牛，二牛，三牛，四牛一同住进了四人寝里，每天都五缺一；有一天，他们在游戏里认识了小牛，得知小牛也是他们学校的，于是邀请小牛和他们一起住，可是他们们寝室只能住四个人，这个怎么办呢？于是他们向学校(<font color=orange>系统</font>)申请，要求学校给他们一个新的六人寝(<font color=orange>新的内存空间</font>)，于是学校就给了他们新的六人寝，于是他们全部都搬去了六人寝里，小牛也办了进去，之后每天五黑，好不快活；\n\n![](http://cdn.mjava.top/20191218113521.png)\n\n> 之后有其他学生看到牛＊他们的做法，于是也通通向学校申请；最后学校发现了一个问题：就是学生们为了住进新寝室，花费了大量的时间在从旧寝室到新寝室的路上(<font color=orange>插入数据慢</font>)\n\n \n\n有的人会说，那一开始就安排大牛，二牛，三牛，四牛住５人寝不就好了吗？这样他们就不用搬了(这就相当于我们初始化数组时，给数组指定了一个大小)；这样的想法是好的，但是如果他们没有没有认识小牛，小牛也不会搬进去，这样他们四个人就一直住着５人寝，就造成了空间资源浪费；\n\n\n\n有一天，老师去找进入新寝室的小牛谈话，一看得知小牛在４号床，一下就找到了小牛（<font color=orange>查询数据快</font>），问他在这个寝室住的习不习惯，小牛心想，每天都五黑，你说我习不习惯！！\n\n![](http://cdn.mjava.top/20191218114115.gif)\n\n## 链表\n\n> 链表我们平时用的比较少，它的特点是:<font color=orange>插入数据快，查询数据慢</font>，查询的时间复杂度是：<font color=orange>O(n)</font>，插入的时间复杂度是：<font color=orange>O(1)</font>，它的特点是和数组相反的；\n\n\n\n　　经过无数日夜的奋战，牛＊一寝人觉得是时候该出去玩玩了，自从小牛搬过来后，就一直没日没夜的五黑，都快不知道外面的世界长什么样子了；他们一行人准备去游乐园转转．\n\n　　来到游乐园后，一群人像刚放出来的一样，对一切都充满了新鲜感，到处转悠．就在转悠的时候，细心的大牛发现了地上有一张纸条，打开一看，上面写着：<font color=orange>＂少年，你渴望力量吗？想获得力量就来海盗船找我！＂</font>，大牛赶紧找来其他小伙伴，一同前往；到了海盗船的地方，发现船上写着：<font color=orange>＂力量源自摩天轮，请前往摩天轮＂</font>，于是一群人就又前往摩天轮，在那里，终于过得了神秘力量－－－<font color=orange>毒鸡汤：你的内心有多强大，你的力量就有多强大</font>；小牛他们为了寻找这个力量，可谓费尽九牛二虎之力啊（<font color=orange>查询数据慢</font>）；\n\n![](http://cdn.mjava.top/20191218132932.png)\n\n> 可以发现，<font color=orange>每个元素存着下个元素的地址</font>，所以如果要查找其中某个元素，就必须要从头开始，才能找到．这就比较慢了．但是，他们<font color=orange>添加元素很快</font>,元素可以随机出现在游乐园的某个地方，只要在新添加元素的前一个元素指明新元素的地址在哪里就可以了；\n\n\n\n## 发个对比表格吧\n\n### 时间复杂度对比表\n\n| |数组 | 链表|\n| :--: | :--------------: | ---- |\n| 插入 | O(n) 慢 | O(1) 快 |\n| 删除 | O(n) 慢 | O(1) 快 |\n| 查询 | O(1) 快 | O(n) 慢 |\n\n","slug":"algorithm/array-vs-linked","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjb000d2mg512470703","content":"<p><img src=\"http://cdn.mjava.top/20191218134901.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"文前发言\"><a href=\"#文前发言\" class=\"headerlink\" title=\"文前发言\"></a>文前发言</h2><p>　　在Java中，很多地方都使用了数组和链表，还有两种组合的叫<font color=\"orange\">数组链表</font>结构，就是常说的<font color=\"orange\">哈希表</font>，HashMap底层的数据结构就是哈希表．远了，远了，这里不讲HashMap,这里讲数组和链表；</p>\n<p><img src=\"http://cdn.mjava.top/20191218104007.jpg\" alt></p>\n<h2 id=\"数组\"><a href=\"#数组\" class=\"headerlink\" title=\"数组\"></a>数组</h2><blockquote>\n<p>数组是我们平时用的最多的数据结构，它的特点是<font color=\"orange\">查询数据快，插入数据慢</font>，查询的时间复杂度是<font color=\"orange\">O(1)</font>,插入的时间复杂度是<font color=\"orange\">O(n)</font>.</p>\n</blockquote>\n<p>牛＊一族去学校读书，学校有四人寝和五人寝，大牛，二牛，三牛，四牛一同住进了四人寝里，每天都五缺一；有一天，他们在游戏里认识了小牛，得知小牛也是他们学校的，于是邀请小牛和他们一起住，可是他们们寝室只能住四个人，这个怎么办呢？于是他们向学校(<font color=\"orange\">系统</font>)申请，要求学校给他们一个新的六人寝(<font color=\"orange\">新的内存空间</font>)，于是学校就给了他们新的六人寝，于是他们全部都搬去了六人寝里，小牛也办了进去，之后每天五黑，好不快活；</p>\n<p><img src=\"http://cdn.mjava.top/20191218113521.png\" alt></p>\n<blockquote>\n<p>之后有其他学生看到牛＊他们的做法，于是也通通向学校申请；最后学校发现了一个问题：就是学生们为了住进新寝室，花费了大量的时间在从旧寝室到新寝室的路上(<font color=\"orange\">插入数据慢</font>)</p>\n</blockquote>\n<p>有的人会说，那一开始就安排大牛，二牛，三牛，四牛住５人寝不就好了吗？这样他们就不用搬了(这就相当于我们初始化数组时，给数组指定了一个大小)；这样的想法是好的，但是如果他们没有没有认识小牛，小牛也不会搬进去，这样他们四个人就一直住着５人寝，就造成了空间资源浪费；</p>\n<p>有一天，老师去找进入新寝室的小牛谈话，一看得知小牛在４号床，一下就找到了小牛（<font color=\"orange\">查询数据快</font>），问他在这个寝室住的习不习惯，小牛心想，每天都五黑，你说我习不习惯！！</p>\n<p><img src=\"http://cdn.mjava.top/20191218114115.gif\" alt></p>\n<h2 id=\"链表\"><a href=\"#链表\" class=\"headerlink\" title=\"链表\"></a>链表</h2><blockquote>\n<p>链表我们平时用的比较少，它的特点是:<font color=\"orange\">插入数据快，查询数据慢</font>，查询的时间复杂度是：<font color=\"orange\">O(n)</font>，插入的时间复杂度是：<font color=\"orange\">O(1)</font>，它的特点是和数组相反的；</p>\n</blockquote>\n<p>　　经过无数日夜的奋战，牛＊一寝人觉得是时候该出去玩玩了，自从小牛搬过来后，就一直没日没夜的五黑，都快不知道外面的世界长什么样子了；他们一行人准备去游乐园转转．</p>\n<p>　　来到游乐园后，一群人像刚放出来的一样，对一切都充满了新鲜感，到处转悠．就在转悠的时候，细心的大牛发现了地上有一张纸条，打开一看，上面写着：<font color=\"orange\">＂少年，你渴望力量吗？想获得力量就来海盗船找我！＂</font>，大牛赶紧找来其他小伙伴，一同前往；到了海盗船的地方，发现船上写着：<font color=\"orange\">＂力量源自摩天轮，请前往摩天轮＂</font>，于是一群人就又前往摩天轮，在那里，终于过得了神秘力量－－－<font color=\"orange\">毒鸡汤：你的内心有多强大，你的力量就有多强大</font>；小牛他们为了寻找这个力量，可谓费尽九牛二虎之力啊（<font color=\"orange\">查询数据慢</font>）；</p>\n<p><img src=\"http://cdn.mjava.top/20191218132932.png\" alt></p>\n<blockquote>\n<p>可以发现，<font color=\"orange\">每个元素存着下个元素的地址</font>，所以如果要查找其中某个元素，就必须要从头开始，才能找到．这就比较慢了．但是，他们<font color=\"orange\">添加元素很快</font>,元素可以随机出现在游乐园的某个地方，只要在新添加元素的前一个元素指明新元素的地址在哪里就可以了；</p>\n</blockquote>\n<h2 id=\"发个对比表格吧\"><a href=\"#发个对比表格吧\" class=\"headerlink\" title=\"发个对比表格吧\"></a>发个对比表格吧</h2><h3 id=\"时间复杂度对比表\"><a href=\"#时间复杂度对比表\" class=\"headerlink\" title=\"时间复杂度对比表\"></a>时间复杂度对比表</h3><table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\">数组</th>\n<th>链表</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">插入</td>\n<td align=\"center\">O(n) 慢</td>\n<td>O(1) 快</td>\n</tr>\n<tr>\n<td align=\"center\">删除</td>\n<td align=\"center\">O(n) 慢</td>\n<td>O(1) 快</td>\n</tr>\n<tr>\n<td align=\"center\">查询</td>\n<td align=\"center\">O(1) 快</td>\n<td>O(n) 慢</td>\n</tr>\n</tbody></table>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p><img src=\"http://cdn.mjava.top/20191218134901.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"文前发言\"><a href=\"#文前发言\" class=\"headerlink\" title=\"文前发言\"></a>文前发言</h2><p>　　在Java中，很多地方都使用了数组和链表，还有两种组合的叫<font color=\"orange\">数组链表</font>结构，就是常说的<font color=\"orange\">哈希表</font>，HashMap底层的数据结构就是哈希表．远了，远了，这里不讲HashMap,这里讲数组和链表；</p>\n<p><img src=\"http://cdn.mjava.top/20191218104007.jpg\" alt></p>\n<h2 id=\"数组\"><a href=\"#数组\" class=\"headerlink\" title=\"数组\"></a>数组</h2><blockquote>\n<p>数组是我们平时用的最多的数据结构，它的特点是<font color=\"orange\">查询数据快，插入数据慢</font>，查询的时间复杂度是<font color=\"orange\">O(1)</font>,插入的时间复杂度是<font color=\"orange\">O(n)</font>.</p>\n</blockquote>\n<p>牛＊一族去学校读书，学校有四人寝和五人寝，大牛，二牛，三牛，四牛一同住进了四人寝里，每天都五缺一；有一天，他们在游戏里认识了小牛，得知小牛也是他们学校的，于是邀请小牛和他们一起住，可是他们们寝室只能住四个人，这个怎么办呢？于是他们向学校(<font color=\"orange\">系统</font>)申请，要求学校给他们一个新的六人寝(<font color=\"orange\">新的内存空间</font>)，于是学校就给了他们新的六人寝，于是他们全部都搬去了六人寝里，小牛也办了进去，之后每天五黑，好不快活；</p>\n<p><img src=\"http://cdn.mjava.top/20191218113521.png\" alt></p>\n<blockquote>\n<p>之后有其他学生看到牛＊他们的做法，于是也通通向学校申请；最后学校发现了一个问题：就是学生们为了住进新寝室，花费了大量的时间在从旧寝室到新寝室的路上(<font color=\"orange\">插入数据慢</font>)</p>\n</blockquote>\n<p>有的人会说，那一开始就安排大牛，二牛，三牛，四牛住５人寝不就好了吗？这样他们就不用搬了(这就相当于我们初始化数组时，给数组指定了一个大小)；这样的想法是好的，但是如果他们没有没有认识小牛，小牛也不会搬进去，这样他们四个人就一直住着５人寝，就造成了空间资源浪费；</p>\n<p>有一天，老师去找进入新寝室的小牛谈话，一看得知小牛在４号床，一下就找到了小牛（<font color=\"orange\">查询数据快</font>），问他在这个寝室住的习不习惯，小牛心想，每天都五黑，你说我习不习惯！！</p>\n<p><img src=\"http://cdn.mjava.top/20191218114115.gif\" alt></p>\n<h2 id=\"链表\"><a href=\"#链表\" class=\"headerlink\" title=\"链表\"></a>链表</h2><blockquote>\n<p>链表我们平时用的比较少，它的特点是:<font color=\"orange\">插入数据快，查询数据慢</font>，查询的时间复杂度是：<font color=\"orange\">O(n)</font>，插入的时间复杂度是：<font color=\"orange\">O(1)</font>，它的特点是和数组相反的；</p>\n</blockquote>\n<p>　　经过无数日夜的奋战，牛＊一寝人觉得是时候该出去玩玩了，自从小牛搬过来后，就一直没日没夜的五黑，都快不知道外面的世界长什么样子了；他们一行人准备去游乐园转转．</p>\n<p>　　来到游乐园后，一群人像刚放出来的一样，对一切都充满了新鲜感，到处转悠．就在转悠的时候，细心的大牛发现了地上有一张纸条，打开一看，上面写着：<font color=\"orange\">＂少年，你渴望力量吗？想获得力量就来海盗船找我！＂</font>，大牛赶紧找来其他小伙伴，一同前往；到了海盗船的地方，发现船上写着：<font color=\"orange\">＂力量源自摩天轮，请前往摩天轮＂</font>，于是一群人就又前往摩天轮，在那里，终于过得了神秘力量－－－<font color=\"orange\">毒鸡汤：你的内心有多强大，你的力量就有多强大</font>；小牛他们为了寻找这个力量，可谓费尽九牛二虎之力啊（<font color=\"orange\">查询数据慢</font>）；</p>\n<p><img src=\"http://cdn.mjava.top/20191218132932.png\" alt></p>\n<blockquote>\n<p>可以发现，<font color=\"orange\">每个元素存着下个元素的地址</font>，所以如果要查找其中某个元素，就必须要从头开始，才能找到．这就比较慢了．但是，他们<font color=\"orange\">添加元素很快</font>,元素可以随机出现在游乐园的某个地方，只要在新添加元素的前一个元素指明新元素的地址在哪里就可以了；</p>\n</blockquote>\n<h2 id=\"发个对比表格吧\"><a href=\"#发个对比表格吧\" class=\"headerlink\" title=\"发个对比表格吧\"></a>发个对比表格吧</h2><h3 id=\"时间复杂度对比表\"><a href=\"#时间复杂度对比表\" class=\"headerlink\" title=\"时间复杂度对比表\"></a>时间复杂度对比表</h3><table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\">数组</th>\n<th>链表</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">插入</td>\n<td align=\"center\">O(n) 慢</td>\n<td>O(1) 快</td>\n</tr>\n<tr>\n<td align=\"center\">删除</td>\n<td align=\"center\">O(n) 慢</td>\n<td>O(1) 快</td>\n</tr>\n<tr>\n<td align=\"center\">查询</td>\n<td align=\"center\">O(1) 快</td>\n<td>O(n) 慢</td>\n</tr>\n</tbody></table>\n"},{"title":"设计模式系列-抽象工厂模式","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-16T13:17:23.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n![](http://cdn.mjava.top/20191216212929.jpg)\n\n> 积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬\n\n## 突然开始的正文\n\n紧接着上一章的[工厂方法模式](https://mjava.top/gof/gof-factory-method)，其实抽象工厂的概念和工厂方法的概念都是差不多的，抽象工厂模式是对工厂方法模式的更高级，比如上次我们说的那个汽车工厂总部类<font color=orange>AllCarFactory</font>，本来他只定义了生产汽车这个方法，下面的各个品牌的汽车厂也只能生产这个汽车，现在由于市场需求，需要生产摩托车，然后<font color=orange>AllCarFactory</font>定义了一个生产摩托车的接口，这样这个接口下面的汽车厂就可以生产摩托车了．就在这时他们的生产模式也从<font color=orange>工厂方法模式</font>升级到了<font color=orange>抽象工厂模式</font>；\n\n\n\n话不多说，看两个模式的类图你就明白了：\n\n### 原本的工厂方法模式类图：\n\n![工厂方法模式](http://cdn.mjava.top/20191216202720.png)\n\n### 升级后的抽象工厂模式：\n\n![抽象工厂模式](http://cdn.mjava.top/20191216203329.png)\n\n可以看到，抽象工厂只是比工厂方法模式多生产了一个产品，当<font color=orange>抽象工厂模式</font>的产品减到<font color=orange>只有一个</font>的时候，他就又回到了<font color=orange>工厂方法模式</font>；\n\n## 好色的朋友买车了\n\n上次我朋友看见我买车之后，得知是个小姐姐带我区买车的，于是他叫我联系了下那个小姐姐，说他也要买车，点名要叫小姐姐带他去，由于资金有限，他只卖了奔驰和五菱系列的产品，没有买莱斯莱斯的；看看他是怎么买的吧：\n\n![](http://cdn.mjava.top/20191216205803.png)\n\n可以看到，由于要在一个工厂买两个东西，他是先找到了工厂，然后再一件一件的从工厂买．我们上次是一个工厂买一件东西，所以是直接去工厂买的；\n\n## 措不及防的结束了\n\n![](http://cdn.mjava.top/20191216205427.gif)\n\n不是我不想讲，而是抽象工厂就是这样的东西．从上面可以看出，抽象工厂每当增加一个产品时，后面相关的的<font color=orange>品牌工厂</font>也全部要实现他这个产品，这就违背了开闭原则了．所以，在实际设计中，一个<font color=orange>业务场景是稳定的</font>,用抽象工厂是比较好的，因为一次设计,后面就不用改了,这样就不会违反开闭原则了．但是如果一个<font color=orange>业务场景是稳定的</font>是不稳定的，那么就不适合使用这个模式了，因为后期需要多次修改，这就违反了开闭原则，同时也及其难维护，应为你不知道修改了代码，到底会影响哪些功能；","source":"_posts/gof/gof-abstract-factory.md","raw":"---\ntitle: 设计模式系列-抽象工厂模式\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-16 21:17:23\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- 设计模式\n- 抽象工厂模式\ncategories:\n- GOF\n---\n\n![](http://cdn.mjava.top/20191216212929.jpg)\n\n> 积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬\n\n## 突然开始的正文\n\n紧接着上一章的[工厂方法模式](https://mjava.top/gof/gof-factory-method)，其实抽象工厂的概念和工厂方法的概念都是差不多的，抽象工厂模式是对工厂方法模式的更高级，比如上次我们说的那个汽车工厂总部类<font color=orange>AllCarFactory</font>，本来他只定义了生产汽车这个方法，下面的各个品牌的汽车厂也只能生产这个汽车，现在由于市场需求，需要生产摩托车，然后<font color=orange>AllCarFactory</font>定义了一个生产摩托车的接口，这样这个接口下面的汽车厂就可以生产摩托车了．就在这时他们的生产模式也从<font color=orange>工厂方法模式</font>升级到了<font color=orange>抽象工厂模式</font>；\n\n\n\n话不多说，看两个模式的类图你就明白了：\n\n### 原本的工厂方法模式类图：\n\n![工厂方法模式](http://cdn.mjava.top/20191216202720.png)\n\n### 升级后的抽象工厂模式：\n\n![抽象工厂模式](http://cdn.mjava.top/20191216203329.png)\n\n可以看到，抽象工厂只是比工厂方法模式多生产了一个产品，当<font color=orange>抽象工厂模式</font>的产品减到<font color=orange>只有一个</font>的时候，他就又回到了<font color=orange>工厂方法模式</font>；\n\n## 好色的朋友买车了\n\n上次我朋友看见我买车之后，得知是个小姐姐带我区买车的，于是他叫我联系了下那个小姐姐，说他也要买车，点名要叫小姐姐带他去，由于资金有限，他只卖了奔驰和五菱系列的产品，没有买莱斯莱斯的；看看他是怎么买的吧：\n\n![](http://cdn.mjava.top/20191216205803.png)\n\n可以看到，由于要在一个工厂买两个东西，他是先找到了工厂，然后再一件一件的从工厂买．我们上次是一个工厂买一件东西，所以是直接去工厂买的；\n\n## 措不及防的结束了\n\n![](http://cdn.mjava.top/20191216205427.gif)\n\n不是我不想讲，而是抽象工厂就是这样的东西．从上面可以看出，抽象工厂每当增加一个产品时，后面相关的的<font color=orange>品牌工厂</font>也全部要实现他这个产品，这就违背了开闭原则了．所以，在实际设计中，一个<font color=orange>业务场景是稳定的</font>,用抽象工厂是比较好的，因为一次设计,后面就不用改了,这样就不会违反开闭原则了．但是如果一个<font color=orange>业务场景是稳定的</font>是不稳定的，那么就不适合使用这个模式了，因为后期需要多次修改，这就违反了开闭原则，同时也及其难维护，应为你不知道修改了代码，到底会影响哪些功能；","slug":"gof/gof-abstract-factory","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjd000g2mg5dw2cvqzh","content":"<p><img src=\"http://cdn.mjava.top/20191216212929.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"突然开始的正文\"><a href=\"#突然开始的正文\" class=\"headerlink\" title=\"突然开始的正文\"></a>突然开始的正文</h2><p>紧接着上一章的<a href=\"https://mjava.top/gof/gof-factory-method\">工厂方法模式</a>，其实抽象工厂的概念和工厂方法的概念都是差不多的，抽象工厂模式是对工厂方法模式的更高级，比如上次我们说的那个汽车工厂总部类<font color=\"orange\">AllCarFactory</font>，本来他只定义了生产汽车这个方法，下面的各个品牌的汽车厂也只能生产这个汽车，现在由于市场需求，需要生产摩托车，然后<font color=\"orange\">AllCarFactory</font>定义了一个生产摩托车的接口，这样这个接口下面的汽车厂就可以生产摩托车了．就在这时他们的生产模式也从<font color=\"orange\">工厂方法模式</font>升级到了<font color=\"orange\">抽象工厂模式</font>；</p>\n<p>话不多说，看两个模式的类图你就明白了：</p>\n<h3 id=\"原本的工厂方法模式类图：\"><a href=\"#原本的工厂方法模式类图：\" class=\"headerlink\" title=\"原本的工厂方法模式类图：\"></a>原本的工厂方法模式类图：</h3><p><img src=\"http://cdn.mjava.top/20191216202720.png\" alt=\"工厂方法模式\"></p>\n<h3 id=\"升级后的抽象工厂模式：\"><a href=\"#升级后的抽象工厂模式：\" class=\"headerlink\" title=\"升级后的抽象工厂模式：\"></a>升级后的抽象工厂模式：</h3><p><img src=\"http://cdn.mjava.top/20191216203329.png\" alt=\"抽象工厂模式\"></p>\n<p>可以看到，抽象工厂只是比工厂方法模式多生产了一个产品，当<font color=\"orange\">抽象工厂模式</font>的产品减到<font color=\"orange\">只有一个</font>的时候，他就又回到了<font color=\"orange\">工厂方法模式</font>；</p>\n<h2 id=\"好色的朋友买车了\"><a href=\"#好色的朋友买车了\" class=\"headerlink\" title=\"好色的朋友买车了\"></a>好色的朋友买车了</h2><p>上次我朋友看见我买车之后，得知是个小姐姐带我区买车的，于是他叫我联系了下那个小姐姐，说他也要买车，点名要叫小姐姐带他去，由于资金有限，他只卖了奔驰和五菱系列的产品，没有买莱斯莱斯的；看看他是怎么买的吧：</p>\n<p><img src=\"http://cdn.mjava.top/20191216205803.png\" alt></p>\n<p>可以看到，由于要在一个工厂买两个东西，他是先找到了工厂，然后再一件一件的从工厂买．我们上次是一个工厂买一件东西，所以是直接去工厂买的；</p>\n<h2 id=\"措不及防的结束了\"><a href=\"#措不及防的结束了\" class=\"headerlink\" title=\"措不及防的结束了\"></a>措不及防的结束了</h2><p><img src=\"http://cdn.mjava.top/20191216205427.gif\" alt></p>\n<p>不是我不想讲，而是抽象工厂就是这样的东西．从上面可以看出，抽象工厂每当增加一个产品时，后面相关的的<font color=\"orange\">品牌工厂</font>也全部要实现他这个产品，这就违背了开闭原则了．所以，在实际设计中，一个<font color=\"orange\">业务场景是稳定的</font>,用抽象工厂是比较好的，因为一次设计,后面就不用改了,这样就不会违反开闭原则了．但是如果一个<font color=\"orange\">业务场景是稳定的</font>是不稳定的，那么就不适合使用这个模式了，因为后期需要多次修改，这就违反了开闭原则，同时也及其难维护，应为你不知道修改了代码，到底会影响哪些功能；</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p><img src=\"http://cdn.mjava.top/20191216212929.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"突然开始的正文\"><a href=\"#突然开始的正文\" class=\"headerlink\" title=\"突然开始的正文\"></a>突然开始的正文</h2><p>紧接着上一章的<a href=\"https://mjava.top/gof/gof-factory-method\">工厂方法模式</a>，其实抽象工厂的概念和工厂方法的概念都是差不多的，抽象工厂模式是对工厂方法模式的更高级，比如上次我们说的那个汽车工厂总部类<font color=\"orange\">AllCarFactory</font>，本来他只定义了生产汽车这个方法，下面的各个品牌的汽车厂也只能生产这个汽车，现在由于市场需求，需要生产摩托车，然后<font color=\"orange\">AllCarFactory</font>定义了一个生产摩托车的接口，这样这个接口下面的汽车厂就可以生产摩托车了．就在这时他们的生产模式也从<font color=\"orange\">工厂方法模式</font>升级到了<font color=\"orange\">抽象工厂模式</font>；</p>\n<p>话不多说，看两个模式的类图你就明白了：</p>\n<h3 id=\"原本的工厂方法模式类图：\"><a href=\"#原本的工厂方法模式类图：\" class=\"headerlink\" title=\"原本的工厂方法模式类图：\"></a>原本的工厂方法模式类图：</h3><p><img src=\"http://cdn.mjava.top/20191216202720.png\" alt=\"工厂方法模式\"></p>\n<h3 id=\"升级后的抽象工厂模式：\"><a href=\"#升级后的抽象工厂模式：\" class=\"headerlink\" title=\"升级后的抽象工厂模式：\"></a>升级后的抽象工厂模式：</h3><p><img src=\"http://cdn.mjava.top/20191216203329.png\" alt=\"抽象工厂模式\"></p>\n<p>可以看到，抽象工厂只是比工厂方法模式多生产了一个产品，当<font color=\"orange\">抽象工厂模式</font>的产品减到<font color=\"orange\">只有一个</font>的时候，他就又回到了<font color=\"orange\">工厂方法模式</font>；</p>\n<h2 id=\"好色的朋友买车了\"><a href=\"#好色的朋友买车了\" class=\"headerlink\" title=\"好色的朋友买车了\"></a>好色的朋友买车了</h2><p>上次我朋友看见我买车之后，得知是个小姐姐带我区买车的，于是他叫我联系了下那个小姐姐，说他也要买车，点名要叫小姐姐带他去，由于资金有限，他只卖了奔驰和五菱系列的产品，没有买莱斯莱斯的；看看他是怎么买的吧：</p>\n<p><img src=\"http://cdn.mjava.top/20191216205803.png\" alt></p>\n<p>可以看到，由于要在一个工厂买两个东西，他是先找到了工厂，然后再一件一件的从工厂买．我们上次是一个工厂买一件东西，所以是直接去工厂买的；</p>\n<h2 id=\"措不及防的结束了\"><a href=\"#措不及防的结束了\" class=\"headerlink\" title=\"措不及防的结束了\"></a>措不及防的结束了</h2><p><img src=\"http://cdn.mjava.top/20191216205427.gif\" alt></p>\n<p>不是我不想讲，而是抽象工厂就是这样的东西．从上面可以看出，抽象工厂每当增加一个产品时，后面相关的的<font color=\"orange\">品牌工厂</font>也全部要实现他这个产品，这就违背了开闭原则了．所以，在实际设计中，一个<font color=\"orange\">业务场景是稳定的</font>,用抽象工厂是比较好的，因为一次设计,后面就不用改了,这样就不会违反开闭原则了．但是如果一个<font color=\"orange\">业务场景是稳定的</font>是不稳定的，那么就不适合使用这个模式了，因为后期需要多次修改，这就违反了开闭原则，同时也及其难维护，应为你不知道修改了代码，到底会影响哪些功能；</p>\n"},{"title":"设计模式系列-工厂模式","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-15T09:25:00.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n![](http://cdn.mjava.top/gof-factory-method.jpg)\n\n\n> 积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬\n\n## 前言\n\n工厂模式有一下三种\n\n- 简单工厂模式\n- 工厂方法模式\n- 抽象工厂模式\n\n其中简单工厂模式不在23中模式之中，更多的是一种编程习惯，而我们平常所说的工厂模式一般指的是工厂方法模式，抽象工厂在实际的业务开发中也用的比较少，因为它有时候违背了开闭原则．由于篇幅有限，抽象工厂本文就不讲了，以后单独讲；\n\n## 简单工厂模式\n\n简单工厂到底有多简单呢？简单到只有一个工厂，这个工厂相当于是万能工厂，你想要什么，只要和它说一声，它就会想方设法的去抱你创建，然后给你；举个买车的简单的例子：\n\n当我要买车的时候，我选了这两种车．\n\n```java\n/**\n * 创建一个汽车接口\n * */\npublic interface Car {\n    /**\n     * 汽车能动\n     * */\n    void run();\n}\n```\n\n```java\n/**\n * 奔驰车\n * */\npublic class Benz implements Car {\n    @Override\n    public void run() {\n        System.out.println(\"大奔开动了\");\n    }\n}\n```\n\n```java\n/**\n * 五菱神车\n * */\npublic class Wuling implements Car {\n    @Override\n    public void run() {\n        System.out.println(\"五菱神车开动了\");\n    }\n}\n\n```\n\n选是选好了，可是要怎么得到呢？是不是下意识的<font color=orange>new</font>一个出来？\n\n```java\n//我要奔驰车\nBenz　myCar=new Benz();\n```\n\n如果是这样的话，就相当于自己亲手造了一辆奔驰车出来，因为是你自己<font color=orange>new</font>出来的嘛！！！！！\n\n![](http://cdn.mjava.top/20191215162632.gif)\n\n这种事情当然是交给工厂去做嘛，叫工厂去<font color=orange>new</font>就可以了，我只要交钱给工厂就可以了．诶，有钱真好！\n\n```java\n/**\n * 汽车工厂\n *\n * 静态工厂\n *\n * 简单工厂\n * */\npublic class CarFactory {\n    public static Car getCar(String type){\n        if(\"我要五菱神车\".equals(type)){\n            return new Wuling();\n        }\n        if (\"我要大奔驰\".equals(type)){\n            return new Benz();\n        }\n        return null;\n    }\n}\n```\n\n找到了这个工厂之后，我只要直接告诉它我要什么车就可以了，工厂就会帮我造好给我；\n\n```java\n/**\n * 买车\n * */\npublic class CostumerMain {\n    public static void main(String[] args) {\n        //跟车厂说一声我要五菱神车\n        Car wuling=CarFactory.getCar(\"我要五菱神车\");\n        //跟车厂说一声我要大奔驰\n        Car Benz=CarFactory.getCar(\"我要大奔驰\");\n\n        //开着五菱神车去兜兜风\n        wuling.run();\n        //开着大奔去兜兜风\n        Benz.run();\n    }\n}\n\n//五菱神车开动了\n//大奔开动了\n```\n\n这样子，买车就结束了，果然钱可以解决一切，哈哈，开个玩笑～\n\n![](http://cdn.mjava.top/20191215163319.jpg)\n\n## 工厂方法模式\n\n上次买了两辆车之后，白天开着大奔去街上撩妹，晚上开着五菱神车去秋名山飙车，从此走向了人生巅峰．可是好景不长，大奔开着开着就漏油了，五菱神车终于也翻车了．\n\n![](http://cdn.mjava.top/20191215163907.gif)\n\n找到了上次买车的工厂，准备换个低调点的劳斯莱斯．可是那家工厂竟然告诉我说他们那边还没有造过劳斯莱斯，需要改造一下工厂，然后才能生产劳斯莱斯，叫我等他们改造好之后再来买．听他们这麽说后，我心想，我这分分钟几百万上下的人，时间就是金钱．我可等不了．\n\n\n\n于是几番寻找之后，发现英国有个劳斯莱斯车场，专门来生产劳斯莱斯．于是和接待我的中介小姐姐聊了一下，发现他们的生产模式是这样的：\n\n```java\n/**\n * 他们有个汽车工厂总部，用来定义车厂该干什么\n * */\npublic interface AllCarFactory {\n    /**\n    * 生产汽车\n    */\n    Car getCar();\n}\n```\n\n```java\n/**\n*　有个汽车规则，用来定义汽车能干什么\n*/\npublic interface Car {\n    /**\n    *　汽车能跑\n    */\n    void run();\n}\n```\n\n```java\n/**\n * 劳斯莱斯汽车\n * */\npublic class RollsRoyce implements Car {\n    /**\n    * 劳斯莱斯能跑起来\n    */\n    @Override\n    public void run() {\n        System.out.println(\"劳斯莱斯开起来了！！\");\n    }\n}\n\n```\n\n```java\n/**\n * 劳斯莱斯汽车工厂\n * */\npublic class RollsRoyceFactory implements AllCarFactory {\n    /**\n    * 生产一辆劳斯莱斯\n    */\n    @Override\n    public Car getCar() {\n        return new RollsRoyce();\n    }\n}\n```\n\n找到车厂后，我毫不犹豫和接待我的小姐姐说给我来一辆，小姐姐见我这么豪爽，准备再忽悠我买几辆车，不推荐我几辆车．．．．她知道我之前买了奔驰和五菱神车,和我说他们这边还有还有五菱车厂和奔驰车厂，都是专门用来造同一种车的．于是我就去参观了一下：\n\n```java\n/**\n* 五菱神车\n*/\npublic class Wuling implements Car {\n    /**\n    * 五菱神车能飙车\n    */\n    @Override\n    public void run() {\n        System.out.println(\"五菱神车开动了\");\n    }\n}\n```\n\n```java\n/**\n * 五菱神车工厂\n * */\npublic class WulingFactory implements AllCarFactory {\n    /**\n    * 生产一辆五菱神车\n    */\n    @Override\n    public Car getCar() {\n        return new Wuling();\n    }\n}\n```\n\n再区看看奔驰车厂：\n\n```java\n/**\n* 奔驰汽车\n*/\npublic class Benz implements Car {\n    /**\n    * 奔驰汽车能跑\n    */\n    @Override\n    public void run() {\n        System.out.println(\"大奔开动了\");\n    }\n}\n```\n\n```java\n/**\n * 奔驰汽车工厂\n * */\npublic class BenzFactory implements AllCarFactory {\n    /**\n    * 生产一辆奔驰汽车\n    */\n    @Override\n    public Car getCar() {\n        return new Benz();\n    }\n}\n```\n\n看完之后，感觉还可以，于是分别到三个工厂买了三辆车，然后高高兴兴的回家了：\n\n![](http://cdn.mjava.top/20191215170620.jpg)\n\n看看我买车的过程：\n\n```java\n/**\n * 土豪买车记\n * */\npublic class CostumerMain {\n    public static void main(String[] args) {\n        //去五菱车厂买车\n        Car wuling=new WulingFactory().getCar();\n        //去奔驰车厂买车\n        Car benz=new BenzFactory().getCar();\n        //去劳斯莱斯车厂买车\n        Car rollsRoyce=new RollsRoyceFactory().getCar();\n        \n        //开着三辆车去兜兜风\n        wuling.run();\n        benz.run();\n        rollsRoyce.run();\n    }\n}\n\n\n//五菱神车开动了\n//大奔开动了\n//劳斯莱斯开起来了！！\n```\n\n\n\n## 总结\n\n​\t买完车后，小姐姐还和我说他们这样的模式生产车的话有好多好处，比如一个车厂只要负责一种车的生产和售后，这样的话，生产效率就会比较高，赚的钱自然也多，同时每个车厂还可以举行不同活动，来吸引消费者，同时，你如果哪个品牌的车出现了问题了，直接去那辆车的工厂，基本上都能帮你解决问题，毕竟<font color=orange>术业有专攻</font>，对比前一个工厂什么都造的万金油来说，深入一项技术比什么技术都懂好；\n\n​\t不过有时候，万金油工厂也挺好的，就是一站式服务，你要什么它都有，不用到处乱跑，省心省力．所以还是要根据什么行业来执行什么模式，这样才能利益最大化；","source":"_posts/gof/gof-factory-method.md","raw":"---\ntitle: 设计模式系列-工厂模式\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-15 17:25:00\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- 设计模式\n- 工厂方法模式\ncategories:\n- GOF\n---\n\n![](http://cdn.mjava.top/gof-factory-method.jpg)\n\n\n> 积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬\n\n## 前言\n\n工厂模式有一下三种\n\n- 简单工厂模式\n- 工厂方法模式\n- 抽象工厂模式\n\n其中简单工厂模式不在23中模式之中，更多的是一种编程习惯，而我们平常所说的工厂模式一般指的是工厂方法模式，抽象工厂在实际的业务开发中也用的比较少，因为它有时候违背了开闭原则．由于篇幅有限，抽象工厂本文就不讲了，以后单独讲；\n\n## 简单工厂模式\n\n简单工厂到底有多简单呢？简单到只有一个工厂，这个工厂相当于是万能工厂，你想要什么，只要和它说一声，它就会想方设法的去抱你创建，然后给你；举个买车的简单的例子：\n\n当我要买车的时候，我选了这两种车．\n\n```java\n/**\n * 创建一个汽车接口\n * */\npublic interface Car {\n    /**\n     * 汽车能动\n     * */\n    void run();\n}\n```\n\n```java\n/**\n * 奔驰车\n * */\npublic class Benz implements Car {\n    @Override\n    public void run() {\n        System.out.println(\"大奔开动了\");\n    }\n}\n```\n\n```java\n/**\n * 五菱神车\n * */\npublic class Wuling implements Car {\n    @Override\n    public void run() {\n        System.out.println(\"五菱神车开动了\");\n    }\n}\n\n```\n\n选是选好了，可是要怎么得到呢？是不是下意识的<font color=orange>new</font>一个出来？\n\n```java\n//我要奔驰车\nBenz　myCar=new Benz();\n```\n\n如果是这样的话，就相当于自己亲手造了一辆奔驰车出来，因为是你自己<font color=orange>new</font>出来的嘛！！！！！\n\n![](http://cdn.mjava.top/20191215162632.gif)\n\n这种事情当然是交给工厂去做嘛，叫工厂去<font color=orange>new</font>就可以了，我只要交钱给工厂就可以了．诶，有钱真好！\n\n```java\n/**\n * 汽车工厂\n *\n * 静态工厂\n *\n * 简单工厂\n * */\npublic class CarFactory {\n    public static Car getCar(String type){\n        if(\"我要五菱神车\".equals(type)){\n            return new Wuling();\n        }\n        if (\"我要大奔驰\".equals(type)){\n            return new Benz();\n        }\n        return null;\n    }\n}\n```\n\n找到了这个工厂之后，我只要直接告诉它我要什么车就可以了，工厂就会帮我造好给我；\n\n```java\n/**\n * 买车\n * */\npublic class CostumerMain {\n    public static void main(String[] args) {\n        //跟车厂说一声我要五菱神车\n        Car wuling=CarFactory.getCar(\"我要五菱神车\");\n        //跟车厂说一声我要大奔驰\n        Car Benz=CarFactory.getCar(\"我要大奔驰\");\n\n        //开着五菱神车去兜兜风\n        wuling.run();\n        //开着大奔去兜兜风\n        Benz.run();\n    }\n}\n\n//五菱神车开动了\n//大奔开动了\n```\n\n这样子，买车就结束了，果然钱可以解决一切，哈哈，开个玩笑～\n\n![](http://cdn.mjava.top/20191215163319.jpg)\n\n## 工厂方法模式\n\n上次买了两辆车之后，白天开着大奔去街上撩妹，晚上开着五菱神车去秋名山飙车，从此走向了人生巅峰．可是好景不长，大奔开着开着就漏油了，五菱神车终于也翻车了．\n\n![](http://cdn.mjava.top/20191215163907.gif)\n\n找到了上次买车的工厂，准备换个低调点的劳斯莱斯．可是那家工厂竟然告诉我说他们那边还没有造过劳斯莱斯，需要改造一下工厂，然后才能生产劳斯莱斯，叫我等他们改造好之后再来买．听他们这麽说后，我心想，我这分分钟几百万上下的人，时间就是金钱．我可等不了．\n\n\n\n于是几番寻找之后，发现英国有个劳斯莱斯车场，专门来生产劳斯莱斯．于是和接待我的中介小姐姐聊了一下，发现他们的生产模式是这样的：\n\n```java\n/**\n * 他们有个汽车工厂总部，用来定义车厂该干什么\n * */\npublic interface AllCarFactory {\n    /**\n    * 生产汽车\n    */\n    Car getCar();\n}\n```\n\n```java\n/**\n*　有个汽车规则，用来定义汽车能干什么\n*/\npublic interface Car {\n    /**\n    *　汽车能跑\n    */\n    void run();\n}\n```\n\n```java\n/**\n * 劳斯莱斯汽车\n * */\npublic class RollsRoyce implements Car {\n    /**\n    * 劳斯莱斯能跑起来\n    */\n    @Override\n    public void run() {\n        System.out.println(\"劳斯莱斯开起来了！！\");\n    }\n}\n\n```\n\n```java\n/**\n * 劳斯莱斯汽车工厂\n * */\npublic class RollsRoyceFactory implements AllCarFactory {\n    /**\n    * 生产一辆劳斯莱斯\n    */\n    @Override\n    public Car getCar() {\n        return new RollsRoyce();\n    }\n}\n```\n\n找到车厂后，我毫不犹豫和接待我的小姐姐说给我来一辆，小姐姐见我这么豪爽，准备再忽悠我买几辆车，不推荐我几辆车．．．．她知道我之前买了奔驰和五菱神车,和我说他们这边还有还有五菱车厂和奔驰车厂，都是专门用来造同一种车的．于是我就去参观了一下：\n\n```java\n/**\n* 五菱神车\n*/\npublic class Wuling implements Car {\n    /**\n    * 五菱神车能飙车\n    */\n    @Override\n    public void run() {\n        System.out.println(\"五菱神车开动了\");\n    }\n}\n```\n\n```java\n/**\n * 五菱神车工厂\n * */\npublic class WulingFactory implements AllCarFactory {\n    /**\n    * 生产一辆五菱神车\n    */\n    @Override\n    public Car getCar() {\n        return new Wuling();\n    }\n}\n```\n\n再区看看奔驰车厂：\n\n```java\n/**\n* 奔驰汽车\n*/\npublic class Benz implements Car {\n    /**\n    * 奔驰汽车能跑\n    */\n    @Override\n    public void run() {\n        System.out.println(\"大奔开动了\");\n    }\n}\n```\n\n```java\n/**\n * 奔驰汽车工厂\n * */\npublic class BenzFactory implements AllCarFactory {\n    /**\n    * 生产一辆奔驰汽车\n    */\n    @Override\n    public Car getCar() {\n        return new Benz();\n    }\n}\n```\n\n看完之后，感觉还可以，于是分别到三个工厂买了三辆车，然后高高兴兴的回家了：\n\n![](http://cdn.mjava.top/20191215170620.jpg)\n\n看看我买车的过程：\n\n```java\n/**\n * 土豪买车记\n * */\npublic class CostumerMain {\n    public static void main(String[] args) {\n        //去五菱车厂买车\n        Car wuling=new WulingFactory().getCar();\n        //去奔驰车厂买车\n        Car benz=new BenzFactory().getCar();\n        //去劳斯莱斯车厂买车\n        Car rollsRoyce=new RollsRoyceFactory().getCar();\n        \n        //开着三辆车去兜兜风\n        wuling.run();\n        benz.run();\n        rollsRoyce.run();\n    }\n}\n\n\n//五菱神车开动了\n//大奔开动了\n//劳斯莱斯开起来了！！\n```\n\n\n\n## 总结\n\n​\t买完车后，小姐姐还和我说他们这样的模式生产车的话有好多好处，比如一个车厂只要负责一种车的生产和售后，这样的话，生产效率就会比较高，赚的钱自然也多，同时每个车厂还可以举行不同活动，来吸引消费者，同时，你如果哪个品牌的车出现了问题了，直接去那辆车的工厂，基本上都能帮你解决问题，毕竟<font color=orange>术业有专攻</font>，对比前一个工厂什么都造的万金油来说，深入一项技术比什么技术都懂好；\n\n​\t不过有时候，万金油工厂也挺好的，就是一站式服务，你要什么它都有，不用到处乱跑，省心省力．所以还是要根据什么行业来执行什么模式，这样才能利益最大化；","slug":"gof/gof-factory-method","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bje000h2mg5f2v54qxd","content":"<p><img src=\"http://cdn.mjava.top/gof-factory-method.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>工厂模式有一下三种</p>\n<ul>\n<li>简单工厂模式</li>\n<li>工厂方法模式</li>\n<li>抽象工厂模式</li>\n</ul>\n<p>其中简单工厂模式不在23中模式之中，更多的是一种编程习惯，而我们平常所说的工厂模式一般指的是工厂方法模式，抽象工厂在实际的业务开发中也用的比较少，因为它有时候违背了开闭原则．由于篇幅有限，抽象工厂本文就不讲了，以后单独讲；</p>\n<h2 id=\"简单工厂模式\"><a href=\"#简单工厂模式\" class=\"headerlink\" title=\"简单工厂模式\"></a>简单工厂模式</h2><p>简单工厂到底有多简单呢？简单到只有一个工厂，这个工厂相当于是万能工厂，你想要什么，只要和它说一声，它就会想方设法的去抱你创建，然后给你；举个买车的简单的例子：</p>\n<p>当我要买车的时候，我选了这两种车．</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 创建一个汽车接口</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 汽车能动</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 奔驰车</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Benz</span> <span class=\"keyword\">implements</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"大奔开动了\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 五菱神车</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Wuling</span> <span class=\"keyword\">implements</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"五菱神车开动了\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>选是选好了，可是要怎么得到呢？是不是下意识的<font color=\"orange\">new</font>一个出来？</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//我要奔驰车</span></span><br><span class=\"line\">Benz　myCar=<span class=\"keyword\">new</span> Benz();</span><br></pre></td></tr></table></figure>\n\n<p>如果是这样的话，就相当于自己亲手造了一辆奔驰车出来，因为是你自己<font color=\"orange\">new</font>出来的嘛！！！！！</p>\n<p><img src=\"http://cdn.mjava.top/20191215162632.gif\" alt></p>\n<p>这种事情当然是交给工厂去做嘛，叫工厂去<font color=\"orange\">new</font>就可以了，我只要交钱给工厂就可以了．诶，有钱真好！</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 汽车工厂</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * 静态工厂</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * 简单工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CarFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Car <span class=\"title\">getCar</span><span class=\"params\">(String type)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"string\">\"我要五菱神车\"</span>.equals(type))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Wuling();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"string\">\"我要大奔驰\"</span>.equals(type))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Benz();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>找到了这个工厂之后，我只要直接告诉它我要什么车就可以了，工厂就会帮我造好给我；</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 买车</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CostumerMain</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//跟车厂说一声我要五菱神车</span></span><br><span class=\"line\">        Car wuling=CarFactory.getCar(<span class=\"string\">\"我要五菱神车\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">//跟车厂说一声我要大奔驰</span></span><br><span class=\"line\">        Car Benz=CarFactory.getCar(<span class=\"string\">\"我要大奔驰\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//开着五菱神车去兜兜风</span></span><br><span class=\"line\">        wuling.run();</span><br><span class=\"line\">        <span class=\"comment\">//开着大奔去兜兜风</span></span><br><span class=\"line\">        Benz.run();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//五菱神车开动了</span></span><br><span class=\"line\"><span class=\"comment\">//大奔开动了</span></span><br></pre></td></tr></table></figure>\n\n<p>这样子，买车就结束了，果然钱可以解决一切，哈哈，开个玩笑～</p>\n<p><img src=\"http://cdn.mjava.top/20191215163319.jpg\" alt></p>\n<h2 id=\"工厂方法模式\"><a href=\"#工厂方法模式\" class=\"headerlink\" title=\"工厂方法模式\"></a>工厂方法模式</h2><p>上次买了两辆车之后，白天开着大奔去街上撩妹，晚上开着五菱神车去秋名山飙车，从此走向了人生巅峰．可是好景不长，大奔开着开着就漏油了，五菱神车终于也翻车了．</p>\n<p><img src=\"http://cdn.mjava.top/20191215163907.gif\" alt></p>\n<p>找到了上次买车的工厂，准备换个低调点的劳斯莱斯．可是那家工厂竟然告诉我说他们那边还没有造过劳斯莱斯，需要改造一下工厂，然后才能生产劳斯莱斯，叫我等他们改造好之后再来买．听他们这麽说后，我心想，我这分分钟几百万上下的人，时间就是金钱．我可等不了．</p>\n<p>于是几番寻找之后，发现英国有个劳斯莱斯车场，专门来生产劳斯莱斯．于是和接待我的中介小姐姐聊了一下，发现他们的生产模式是这样的：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 他们有个汽车工厂总部，用来定义车厂该干什么</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">AllCarFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 生产汽车</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"function\">Car <span class=\"title\">getCar</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">*　有个汽车规则，用来定义汽车能干什么</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    *　汽车能跑</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 劳斯莱斯汽车</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RollsRoyce</span> <span class=\"keyword\">implements</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 劳斯莱斯能跑起来</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"劳斯莱斯开起来了！！\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 劳斯莱斯汽车工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RollsRoyceFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">AllCarFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 生产一辆劳斯莱斯</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Car <span class=\"title\">getCar</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> RollsRoyce();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>找到车厂后，我毫不犹豫和接待我的小姐姐说给我来一辆，小姐姐见我这么豪爽，准备再忽悠我买几辆车，不推荐我几辆车．．．．她知道我之前买了奔驰和五菱神车,和我说他们这边还有还有五菱车厂和奔驰车厂，都是专门用来造同一种车的．于是我就去参观了一下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 五菱神车</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Wuling</span> <span class=\"keyword\">implements</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 五菱神车能飙车</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"五菱神车开动了\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 五菱神车工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WulingFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">AllCarFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 生产一辆五菱神车</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Car <span class=\"title\">getCar</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Wuling();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>再区看看奔驰车厂：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 奔驰汽车</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Benz</span> <span class=\"keyword\">implements</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 奔驰汽车能跑</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"大奔开动了\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 奔驰汽车工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BenzFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">AllCarFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 生产一辆奔驰汽车</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Car <span class=\"title\">getCar</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Benz();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>看完之后，感觉还可以，于是分别到三个工厂买了三辆车，然后高高兴兴的回家了：</p>\n<p><img src=\"http://cdn.mjava.top/20191215170620.jpg\" alt></p>\n<p>看看我买车的过程：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 土豪买车记</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CostumerMain</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//去五菱车厂买车</span></span><br><span class=\"line\">        Car wuling=<span class=\"keyword\">new</span> WulingFactory().getCar();</span><br><span class=\"line\">        <span class=\"comment\">//去奔驰车厂买车</span></span><br><span class=\"line\">        Car benz=<span class=\"keyword\">new</span> BenzFactory().getCar();</span><br><span class=\"line\">        <span class=\"comment\">//去劳斯莱斯车厂买车</span></span><br><span class=\"line\">        Car rollsRoyce=<span class=\"keyword\">new</span> RollsRoyceFactory().getCar();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">//开着三辆车去兜兜风</span></span><br><span class=\"line\">        wuling.run();</span><br><span class=\"line\">        benz.run();</span><br><span class=\"line\">        rollsRoyce.run();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//五菱神车开动了</span></span><br><span class=\"line\"><span class=\"comment\">//大奔开动了</span></span><br><span class=\"line\"><span class=\"comment\">//劳斯莱斯开起来了！！</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>​    买完车后，小姐姐还和我说他们这样的模式生产车的话有好多好处，比如一个车厂只要负责一种车的生产和售后，这样的话，生产效率就会比较高，赚的钱自然也多，同时每个车厂还可以举行不同活动，来吸引消费者，同时，你如果哪个品牌的车出现了问题了，直接去那辆车的工厂，基本上都能帮你解决问题，毕竟<font color=\"orange\">术业有专攻</font>，对比前一个工厂什么都造的万金油来说，深入一项技术比什么技术都懂好；</p>\n<p>​    不过有时候，万金油工厂也挺好的，就是一站式服务，你要什么它都有，不用到处乱跑，省心省力．所以还是要根据什么行业来执行什么模式，这样才能利益最大化；</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p><img src=\"http://cdn.mjava.top/gof-factory-method.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>工厂模式有一下三种</p>\n<ul>\n<li>简单工厂模式</li>\n<li>工厂方法模式</li>\n<li>抽象工厂模式</li>\n</ul>\n<p>其中简单工厂模式不在23中模式之中，更多的是一种编程习惯，而我们平常所说的工厂模式一般指的是工厂方法模式，抽象工厂在实际的业务开发中也用的比较少，因为它有时候违背了开闭原则．由于篇幅有限，抽象工厂本文就不讲了，以后单独讲；</p>\n<h2 id=\"简单工厂模式\"><a href=\"#简单工厂模式\" class=\"headerlink\" title=\"简单工厂模式\"></a>简单工厂模式</h2><p>简单工厂到底有多简单呢？简单到只有一个工厂，这个工厂相当于是万能工厂，你想要什么，只要和它说一声，它就会想方设法的去抱你创建，然后给你；举个买车的简单的例子：</p>\n<p>当我要买车的时候，我选了这两种车．</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 创建一个汽车接口</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 汽车能动</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 奔驰车</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Benz</span> <span class=\"keyword\">implements</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"大奔开动了\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 五菱神车</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Wuling</span> <span class=\"keyword\">implements</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"五菱神车开动了\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>选是选好了，可是要怎么得到呢？是不是下意识的<font color=\"orange\">new</font>一个出来？</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//我要奔驰车</span></span><br><span class=\"line\">Benz　myCar=<span class=\"keyword\">new</span> Benz();</span><br></pre></td></tr></table></figure>\n\n<p>如果是这样的话，就相当于自己亲手造了一辆奔驰车出来，因为是你自己<font color=\"orange\">new</font>出来的嘛！！！！！</p>\n<p><img src=\"http://cdn.mjava.top/20191215162632.gif\" alt></p>\n<p>这种事情当然是交给工厂去做嘛，叫工厂去<font color=\"orange\">new</font>就可以了，我只要交钱给工厂就可以了．诶，有钱真好！</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 汽车工厂</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * 静态工厂</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * 简单工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CarFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Car <span class=\"title\">getCar</span><span class=\"params\">(String type)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"string\">\"我要五菱神车\"</span>.equals(type))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Wuling();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"string\">\"我要大奔驰\"</span>.equals(type))&#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Benz();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>找到了这个工厂之后，我只要直接告诉它我要什么车就可以了，工厂就会帮我造好给我；</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 买车</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CostumerMain</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//跟车厂说一声我要五菱神车</span></span><br><span class=\"line\">        Car wuling=CarFactory.getCar(<span class=\"string\">\"我要五菱神车\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">//跟车厂说一声我要大奔驰</span></span><br><span class=\"line\">        Car Benz=CarFactory.getCar(<span class=\"string\">\"我要大奔驰\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//开着五菱神车去兜兜风</span></span><br><span class=\"line\">        wuling.run();</span><br><span class=\"line\">        <span class=\"comment\">//开着大奔去兜兜风</span></span><br><span class=\"line\">        Benz.run();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//五菱神车开动了</span></span><br><span class=\"line\"><span class=\"comment\">//大奔开动了</span></span><br></pre></td></tr></table></figure>\n\n<p>这样子，买车就结束了，果然钱可以解决一切，哈哈，开个玩笑～</p>\n<p><img src=\"http://cdn.mjava.top/20191215163319.jpg\" alt></p>\n<h2 id=\"工厂方法模式\"><a href=\"#工厂方法模式\" class=\"headerlink\" title=\"工厂方法模式\"></a>工厂方法模式</h2><p>上次买了两辆车之后，白天开着大奔去街上撩妹，晚上开着五菱神车去秋名山飙车，从此走向了人生巅峰．可是好景不长，大奔开着开着就漏油了，五菱神车终于也翻车了．</p>\n<p><img src=\"http://cdn.mjava.top/20191215163907.gif\" alt></p>\n<p>找到了上次买车的工厂，准备换个低调点的劳斯莱斯．可是那家工厂竟然告诉我说他们那边还没有造过劳斯莱斯，需要改造一下工厂，然后才能生产劳斯莱斯，叫我等他们改造好之后再来买．听他们这麽说后，我心想，我这分分钟几百万上下的人，时间就是金钱．我可等不了．</p>\n<p>于是几番寻找之后，发现英国有个劳斯莱斯车场，专门来生产劳斯莱斯．于是和接待我的中介小姐姐聊了一下，发现他们的生产模式是这样的：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 他们有个汽车工厂总部，用来定义车厂该干什么</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">AllCarFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 生产汽车</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"function\">Car <span class=\"title\">getCar</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">*　有个汽车规则，用来定义汽车能干什么</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    *　汽车能跑</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 劳斯莱斯汽车</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RollsRoyce</span> <span class=\"keyword\">implements</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 劳斯莱斯能跑起来</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"劳斯莱斯开起来了！！\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 劳斯莱斯汽车工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RollsRoyceFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">AllCarFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 生产一辆劳斯莱斯</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Car <span class=\"title\">getCar</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> RollsRoyce();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>找到车厂后，我毫不犹豫和接待我的小姐姐说给我来一辆，小姐姐见我这么豪爽，准备再忽悠我买几辆车，不推荐我几辆车．．．．她知道我之前买了奔驰和五菱神车,和我说他们这边还有还有五菱车厂和奔驰车厂，都是专门用来造同一种车的．于是我就去参观了一下：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 五菱神车</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Wuling</span> <span class=\"keyword\">implements</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 五菱神车能飙车</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"五菱神车开动了\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 五菱神车工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WulingFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">AllCarFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 生产一辆五菱神车</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Car <span class=\"title\">getCar</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Wuling();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>再区看看奔驰车厂：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 奔驰汽车</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Benz</span> <span class=\"keyword\">implements</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 奔驰汽车能跑</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"大奔开动了\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 奔驰汽车工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BenzFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">AllCarFactory</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * 生产一辆奔驰汽车</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Car <span class=\"title\">getCar</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Benz();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>看完之后，感觉还可以，于是分别到三个工厂买了三辆车，然后高高兴兴的回家了：</p>\n<p><img src=\"http://cdn.mjava.top/20191215170620.jpg\" alt></p>\n<p>看看我买车的过程：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 土豪买车记</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CostumerMain</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//去五菱车厂买车</span></span><br><span class=\"line\">        Car wuling=<span class=\"keyword\">new</span> WulingFactory().getCar();</span><br><span class=\"line\">        <span class=\"comment\">//去奔驰车厂买车</span></span><br><span class=\"line\">        Car benz=<span class=\"keyword\">new</span> BenzFactory().getCar();</span><br><span class=\"line\">        <span class=\"comment\">//去劳斯莱斯车厂买车</span></span><br><span class=\"line\">        Car rollsRoyce=<span class=\"keyword\">new</span> RollsRoyceFactory().getCar();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">//开着三辆车去兜兜风</span></span><br><span class=\"line\">        wuling.run();</span><br><span class=\"line\">        benz.run();</span><br><span class=\"line\">        rollsRoyce.run();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//五菱神车开动了</span></span><br><span class=\"line\"><span class=\"comment\">//大奔开动了</span></span><br><span class=\"line\"><span class=\"comment\">//劳斯莱斯开起来了！！</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>​    买完车后，小姐姐还和我说他们这样的模式生产车的话有好多好处，比如一个车厂只要负责一种车的生产和售后，这样的话，生产效率就会比较高，赚的钱自然也多，同时每个车厂还可以举行不同活动，来吸引消费者，同时，你如果哪个品牌的车出现了问题了，直接去那辆车的工厂，基本上都能帮你解决问题，毕竟<font color=\"orange\">术业有专攻</font>，对比前一个工厂什么都造的万金油来说，深入一项技术比什么技术都懂好；</p>\n<p>​    不过有时候，万金油工厂也挺好的，就是一站式服务，你要什么它都有，不用到处乱跑，省心省力．所以还是要根据什么行业来执行什么模式，这样才能利益最大化；</p>\n"},{"title":"OOP程序七大原则","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-15T02:45:04.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n![](http://cdn.mjava.top/autumn-4656877_1920.png)\n\n\n\n## 开闭原则\n\n开闭原则相当于所有原则的祖先，主张对修改关闭，对拓展开放．\n\n\n\n## 里氏替换原则\n\n<font color=orange>当两个类有继承关系时，子类不能修改父类的方法和变量.  </font>里氏替换中的<font color=orange>替换</font>指的是：当有父类出现的地方，这个父类可以<font color=orange>替换</font>成子类，而且对程序没有影响，这就遵循了里氏替换原则；当替换成子类时对程序有影响，说明子类修改了父类的方法，就没有遵循里氏替换原则了；\n\n## 依赖倒置原则\n\n依赖倒置原则是对开闭原则的一个实现，也是主张对拓展开放，对修改关闭．它的核心思想是<font color=orange>面对接口编程，不要面对具体实现编程</font>．\n\n![来自C语言中文网](http://cdn.mjava.top/3-1Q113131610L7.gif)\n\n这是一个遵守依赖倒置原则的UML图，原来的话当客户购买商品时,shopping这个方法要传入相应的网店进去，当要更改店铺时，就要修改Cusromer这个类里的shopping方法，而现在，只要定义一个Shop接口，所有的店铺都实现这个接口的方法，顾客类的shopping方法只要传入Shop这个接口类就可以了．然后具体实现的时候，要到哪里买，就传入哪一个网店就可以了，而不用修改Cusromer这个类的方法；\n\n```java\n//代码来之＇C语言中文网＇\npublic class DIPtest\n{\n    public static void main(String[] args)\n    {\n        Customer wang=new Customer();\n        System.out.println(\"顾客购买以下商品：\"); \n        wang.shopping(new ShaoguanShop()); \n        wang.shopping(new WuyuanShop());\n    }\n}\n//商店\ninterface Shop\n{\n    public String sell(); //卖\n}\n//韶关网店\nclass ShaoguanShop implements Shop\n{\n    public String sell()\n    {\n        return \"韶关土特产：香菇、木耳……\"; \n    } \n}\n//婺源网店\nclass WuyuanShop implements Shop\n{\n    public String sell()\n    {\n        return \"婺源土特产：绿茶、酒糟鱼……\"; \n    }\n} \n//顾客\nclass Customer\n{\n    public void shopping(Shop shop)\n    {\n        //购物\n        System.out.println(shop.sell()); \n    }\n}\n\n//输出\n顾客购买以下商品：\n韶关土特产：香菇、木耳……\n婺源土特产：绿茶、酒糟鱼……\n```\n\n## 单一职责\n\n<font color=orange>单一职责要求一个类只负责一项职责.  </font>这个听起来很简单，但是实际应用上却非常的难把握．因为这个职责在中国是非常抽象的概念，中国是一个文化底蕴非常丰富的国家，就像<<设计模式之禅>> 这本书里所说的例子：比如说中国的筷子，他既可以当刀来分割食物，也可以当叉子来叉取食物，而在国外，叉子就是叉子，用来取食物的，刀就是用来分割食物的；所以这个单一职责要求软件开发人员有非常丰富的实践经验．不然很难把握；\n\n## 迪米特法则\n\n<font color=orange>迪米特法则也称最小知道原则，一个类对外暴露的东西越少越好．</font>\n\n1. 从依赖者的角度来说，只依赖应该依赖的对象。\n2. 从被依赖者的角度说，只暴露应该暴露的方法。\n\n个人理解：当A类需要调用B类的三个方法才能实现的功能时,B类可以对这三个方法进行一个封装，然后只暴露封装的这个方法给A,这样A就只需要调用B的这个封装的方法就可以了，当B的三个方法中有修改的时候，只要修改B这个对外封装的方法就可以，而Ａ调用者却不用改变，因为Ａ只知道调用这个方法可以实现功能，而不用具体管Ｂ内部是怎么实现的，降低了程序的耦合度；\n\n## 接口隔离原则\n\n这个和单一职责有点类似，不过还是不一样的．\n\n- 单一职责原则注重的是职责，而接口隔离原则注重的是对接口依赖的隔离。\n- 单一职责原则主要是约束类，它针对的是程序中的实现和细节；接口隔离原则主要约束接口，主要针对抽象和程序整体框架的构建。\n\n官方定义：<font color=orange>要求程序员尽量将臃肿庞大的接口拆分成更小的和更具体的接口，让接口中只包含客户感兴趣的方法，降低程序耦合度。</font>\n\n这个法则也要根据实际的业务场景来应用，如果粒度控制的太小，就会导致类的急剧增加，明明一个功能只要三四个类，如果粒度小的话，就会变成十几个，甚至几十个，虽然这样程序耦合度低，比较灵活，但是维护难啊．如果粒度大，耦合度就会高，程序不灵活．所以这个原则要求技术人员有足够的实践，经验和领悟；\n\n## 合成复用原则\n\n它要求在软件复用时，要尽量先使用组合或者聚合等关联关系来实现，其次才考虑使用继承关系来实现。如果要使用继承关系，则必须严格遵循<font color=orange>里氏替换原则</font>。合成复用原则同里氏替换原则相辅相成的，两者都是开闭原则的具体实现规范。\n\n如果不了解什么是组合和聚合的话可以看看这个篇文章[<<组合、聚合与继承的爱恨情仇>>](https://blog.csdn.net/qq_31655965/article/details/54645220),讲的挺好的\n\n\n\n## 总结\n\n在程序设计中，尽量遵循OOP七大原则．不过有句话说的好，<font color=orange>规则是死的，人是活的</font>．意思是这七大原则有时候也不是万能的，有时候有的业务场景如果遵循了这些原则，反而变得难维护，所以一切都要从实际出发，23种设计模式也是一样，不要按死规则来．","source":"_posts/gof/gof-oop-7-all.md","raw":"---\ntitle: OOP程序七大原则\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-15 10:45:04\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- GOF\n- OOP\ncategories:\n- GOF\n---\n\n\n\n![](http://cdn.mjava.top/autumn-4656877_1920.png)\n\n\n\n## 开闭原则\n\n开闭原则相当于所有原则的祖先，主张对修改关闭，对拓展开放．\n\n\n\n## 里氏替换原则\n\n<font color=orange>当两个类有继承关系时，子类不能修改父类的方法和变量.  </font>里氏替换中的<font color=orange>替换</font>指的是：当有父类出现的地方，这个父类可以<font color=orange>替换</font>成子类，而且对程序没有影响，这就遵循了里氏替换原则；当替换成子类时对程序有影响，说明子类修改了父类的方法，就没有遵循里氏替换原则了；\n\n## 依赖倒置原则\n\n依赖倒置原则是对开闭原则的一个实现，也是主张对拓展开放，对修改关闭．它的核心思想是<font color=orange>面对接口编程，不要面对具体实现编程</font>．\n\n![来自C语言中文网](http://cdn.mjava.top/3-1Q113131610L7.gif)\n\n这是一个遵守依赖倒置原则的UML图，原来的话当客户购买商品时,shopping这个方法要传入相应的网店进去，当要更改店铺时，就要修改Cusromer这个类里的shopping方法，而现在，只要定义一个Shop接口，所有的店铺都实现这个接口的方法，顾客类的shopping方法只要传入Shop这个接口类就可以了．然后具体实现的时候，要到哪里买，就传入哪一个网店就可以了，而不用修改Cusromer这个类的方法；\n\n```java\n//代码来之＇C语言中文网＇\npublic class DIPtest\n{\n    public static void main(String[] args)\n    {\n        Customer wang=new Customer();\n        System.out.println(\"顾客购买以下商品：\"); \n        wang.shopping(new ShaoguanShop()); \n        wang.shopping(new WuyuanShop());\n    }\n}\n//商店\ninterface Shop\n{\n    public String sell(); //卖\n}\n//韶关网店\nclass ShaoguanShop implements Shop\n{\n    public String sell()\n    {\n        return \"韶关土特产：香菇、木耳……\"; \n    } \n}\n//婺源网店\nclass WuyuanShop implements Shop\n{\n    public String sell()\n    {\n        return \"婺源土特产：绿茶、酒糟鱼……\"; \n    }\n} \n//顾客\nclass Customer\n{\n    public void shopping(Shop shop)\n    {\n        //购物\n        System.out.println(shop.sell()); \n    }\n}\n\n//输出\n顾客购买以下商品：\n韶关土特产：香菇、木耳……\n婺源土特产：绿茶、酒糟鱼……\n```\n\n## 单一职责\n\n<font color=orange>单一职责要求一个类只负责一项职责.  </font>这个听起来很简单，但是实际应用上却非常的难把握．因为这个职责在中国是非常抽象的概念，中国是一个文化底蕴非常丰富的国家，就像<<设计模式之禅>> 这本书里所说的例子：比如说中国的筷子，他既可以当刀来分割食物，也可以当叉子来叉取食物，而在国外，叉子就是叉子，用来取食物的，刀就是用来分割食物的；所以这个单一职责要求软件开发人员有非常丰富的实践经验．不然很难把握；\n\n## 迪米特法则\n\n<font color=orange>迪米特法则也称最小知道原则，一个类对外暴露的东西越少越好．</font>\n\n1. 从依赖者的角度来说，只依赖应该依赖的对象。\n2. 从被依赖者的角度说，只暴露应该暴露的方法。\n\n个人理解：当A类需要调用B类的三个方法才能实现的功能时,B类可以对这三个方法进行一个封装，然后只暴露封装的这个方法给A,这样A就只需要调用B的这个封装的方法就可以了，当B的三个方法中有修改的时候，只要修改B这个对外封装的方法就可以，而Ａ调用者却不用改变，因为Ａ只知道调用这个方法可以实现功能，而不用具体管Ｂ内部是怎么实现的，降低了程序的耦合度；\n\n## 接口隔离原则\n\n这个和单一职责有点类似，不过还是不一样的．\n\n- 单一职责原则注重的是职责，而接口隔离原则注重的是对接口依赖的隔离。\n- 单一职责原则主要是约束类，它针对的是程序中的实现和细节；接口隔离原则主要约束接口，主要针对抽象和程序整体框架的构建。\n\n官方定义：<font color=orange>要求程序员尽量将臃肿庞大的接口拆分成更小的和更具体的接口，让接口中只包含客户感兴趣的方法，降低程序耦合度。</font>\n\n这个法则也要根据实际的业务场景来应用，如果粒度控制的太小，就会导致类的急剧增加，明明一个功能只要三四个类，如果粒度小的话，就会变成十几个，甚至几十个，虽然这样程序耦合度低，比较灵活，但是维护难啊．如果粒度大，耦合度就会高，程序不灵活．所以这个原则要求技术人员有足够的实践，经验和领悟；\n\n## 合成复用原则\n\n它要求在软件复用时，要尽量先使用组合或者聚合等关联关系来实现，其次才考虑使用继承关系来实现。如果要使用继承关系，则必须严格遵循<font color=orange>里氏替换原则</font>。合成复用原则同里氏替换原则相辅相成的，两者都是开闭原则的具体实现规范。\n\n如果不了解什么是组合和聚合的话可以看看这个篇文章[<<组合、聚合与继承的爱恨情仇>>](https://blog.csdn.net/qq_31655965/article/details/54645220),讲的挺好的\n\n\n\n## 总结\n\n在程序设计中，尽量遵循OOP七大原则．不过有句话说的好，<font color=orange>规则是死的，人是活的</font>．意思是这七大原则有时候也不是万能的，有时候有的业务场景如果遵循了这些原则，反而变得难维护，所以一切都要从实际出发，23种设计模式也是一样，不要按死规则来．","slug":"gof/gof-oop-7-all","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjf000l2mg5d8yrwxji","content":"<p><img src=\"http://cdn.mjava.top/autumn-4656877_1920.png\" alt></p>\n<h2 id=\"开闭原则\"><a href=\"#开闭原则\" class=\"headerlink\" title=\"开闭原则\"></a>开闭原则</h2><p>开闭原则相当于所有原则的祖先，主张对修改关闭，对拓展开放．</p>\n<h2 id=\"里氏替换原则\"><a href=\"#里氏替换原则\" class=\"headerlink\" title=\"里氏替换原则\"></a>里氏替换原则</h2><p><font color=\"orange\">当两个类有继承关系时，子类不能修改父类的方法和变量.  </font>里氏替换中的<font color=\"orange\">替换</font>指的是：当有父类出现的地方，这个父类可以<font color=\"orange\">替换</font>成子类，而且对程序没有影响，这就遵循了里氏替换原则；当替换成子类时对程序有影响，说明子类修改了父类的方法，就没有遵循里氏替换原则了；</p>\n<h2 id=\"依赖倒置原则\"><a href=\"#依赖倒置原则\" class=\"headerlink\" title=\"依赖倒置原则\"></a>依赖倒置原则</h2><p>依赖倒置原则是对开闭原则的一个实现，也是主张对拓展开放，对修改关闭．它的核心思想是<font color=\"orange\">面对接口编程，不要面对具体实现编程</font>．</p>\n<p><img src=\"http://cdn.mjava.top/3-1Q113131610L7.gif\" alt=\"来自C语言中文网\"></p>\n<p>这是一个遵守依赖倒置原则的UML图，原来的话当客户购买商品时,shopping这个方法要传入相应的网店进去，当要更改店铺时，就要修改Cusromer这个类里的shopping方法，而现在，只要定义一个Shop接口，所有的店铺都实现这个接口的方法，顾客类的shopping方法只要传入Shop这个接口类就可以了．然后具体实现的时候，要到哪里买，就传入哪一个网店就可以了，而不用修改Cusromer这个类的方法；</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//代码来之＇C语言中文网＇</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DIPtest</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Customer wang=<span class=\"keyword\">new</span> Customer();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"顾客购买以下商品：\"</span>); </span><br><span class=\"line\">        wang.shopping(<span class=\"keyword\">new</span> ShaoguanShop()); </span><br><span class=\"line\">        wang.shopping(<span class=\"keyword\">new</span> WuyuanShop());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//商店</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Shop</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">sell</span><span class=\"params\">()</span></span>; <span class=\"comment\">//卖</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//韶关网店</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShaoguanShop</span> <span class=\"keyword\">implements</span> <span class=\"title\">Shop</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">sell</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"韶关土特产：香菇、木耳……\"</span>; </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//婺源网店</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WuyuanShop</span> <span class=\"keyword\">implements</span> <span class=\"title\">Shop</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">sell</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"婺源土特产：绿茶、酒糟鱼……\"</span>; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br><span class=\"line\"><span class=\"comment\">//顾客</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">shopping</span><span class=\"params\">(Shop shop)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//购物</span></span><br><span class=\"line\">        System.out.println(shop.sell()); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//输出</span></span><br><span class=\"line\">顾客购买以下商品：</span><br><span class=\"line\">韶关土特产：香菇、木耳……</span><br><span class=\"line\">婺源土特产：绿茶、酒糟鱼……</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"单一职责\"><a href=\"#单一职责\" class=\"headerlink\" title=\"单一职责\"></a>单一职责</h2><p><font color=\"orange\">单一职责要求一个类只负责一项职责.  </font>这个听起来很简单，但是实际应用上却非常的难把握．因为这个职责在中国是非常抽象的概念，中国是一个文化底蕴非常丰富的国家，就像&lt;&lt;设计模式之禅&gt;&gt; 这本书里所说的例子：比如说中国的筷子，他既可以当刀来分割食物，也可以当叉子来叉取食物，而在国外，叉子就是叉子，用来取食物的，刀就是用来分割食物的；所以这个单一职责要求软件开发人员有非常丰富的实践经验．不然很难把握；</p>\n<h2 id=\"迪米特法则\"><a href=\"#迪米特法则\" class=\"headerlink\" title=\"迪米特法则\"></a>迪米特法则</h2><p><font color=\"orange\">迪米特法则也称最小知道原则，一个类对外暴露的东西越少越好．</font></p>\n<ol>\n<li>从依赖者的角度来说，只依赖应该依赖的对象。</li>\n<li>从被依赖者的角度说，只暴露应该暴露的方法。</li>\n</ol>\n<p>个人理解：当A类需要调用B类的三个方法才能实现的功能时,B类可以对这三个方法进行一个封装，然后只暴露封装的这个方法给A,这样A就只需要调用B的这个封装的方法就可以了，当B的三个方法中有修改的时候，只要修改B这个对外封装的方法就可以，而Ａ调用者却不用改变，因为Ａ只知道调用这个方法可以实现功能，而不用具体管Ｂ内部是怎么实现的，降低了程序的耦合度；</p>\n<h2 id=\"接口隔离原则\"><a href=\"#接口隔离原则\" class=\"headerlink\" title=\"接口隔离原则\"></a>接口隔离原则</h2><p>这个和单一职责有点类似，不过还是不一样的．</p>\n<ul>\n<li>单一职责原则注重的是职责，而接口隔离原则注重的是对接口依赖的隔离。</li>\n<li>单一职责原则主要是约束类，它针对的是程序中的实现和细节；接口隔离原则主要约束接口，主要针对抽象和程序整体框架的构建。</li>\n</ul>\n<p>官方定义：<font color=\"orange\">要求程序员尽量将臃肿庞大的接口拆分成更小的和更具体的接口，让接口中只包含客户感兴趣的方法，降低程序耦合度。</font></p>\n<p>这个法则也要根据实际的业务场景来应用，如果粒度控制的太小，就会导致类的急剧增加，明明一个功能只要三四个类，如果粒度小的话，就会变成十几个，甚至几十个，虽然这样程序耦合度低，比较灵活，但是维护难啊．如果粒度大，耦合度就会高，程序不灵活．所以这个原则要求技术人员有足够的实践，经验和领悟；</p>\n<h2 id=\"合成复用原则\"><a href=\"#合成复用原则\" class=\"headerlink\" title=\"合成复用原则\"></a>合成复用原则</h2><p>它要求在软件复用时，要尽量先使用组合或者聚合等关联关系来实现，其次才考虑使用继承关系来实现。如果要使用继承关系，则必须严格遵循<font color=\"orange\">里氏替换原则</font>。合成复用原则同里氏替换原则相辅相成的，两者都是开闭原则的具体实现规范。</p>\n<p>如果不了解什么是组合和聚合的话可以看看这个篇文章<a href=\"https://blog.csdn.net/qq_31655965/article/details/54645220\" rel=\"noopener\" target=\"_blank\">&lt;&lt;组合、聚合与继承的爱恨情仇&gt;&gt;</a>,讲的挺好的</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>在程序设计中，尽量遵循OOP七大原则．不过有句话说的好，<font color=\"orange\">规则是死的，人是活的</font>．意思是这七大原则有时候也不是万能的，有时候有的业务场景如果遵循了这些原则，反而变得难维护，所以一切都要从实际出发，23种设计模式也是一样，不要按死规则来．</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p><img src=\"http://cdn.mjava.top/autumn-4656877_1920.png\" alt></p>\n<h2 id=\"开闭原则\"><a href=\"#开闭原则\" class=\"headerlink\" title=\"开闭原则\"></a>开闭原则</h2><p>开闭原则相当于所有原则的祖先，主张对修改关闭，对拓展开放．</p>\n<h2 id=\"里氏替换原则\"><a href=\"#里氏替换原则\" class=\"headerlink\" title=\"里氏替换原则\"></a>里氏替换原则</h2><p><font color=\"orange\">当两个类有继承关系时，子类不能修改父类的方法和变量.  </font>里氏替换中的<font color=\"orange\">替换</font>指的是：当有父类出现的地方，这个父类可以<font color=\"orange\">替换</font>成子类，而且对程序没有影响，这就遵循了里氏替换原则；当替换成子类时对程序有影响，说明子类修改了父类的方法，就没有遵循里氏替换原则了；</p>\n<h2 id=\"依赖倒置原则\"><a href=\"#依赖倒置原则\" class=\"headerlink\" title=\"依赖倒置原则\"></a>依赖倒置原则</h2><p>依赖倒置原则是对开闭原则的一个实现，也是主张对拓展开放，对修改关闭．它的核心思想是<font color=\"orange\">面对接口编程，不要面对具体实现编程</font>．</p>\n<p><img src=\"http://cdn.mjava.top/3-1Q113131610L7.gif\" alt=\"来自C语言中文网\"></p>\n<p>这是一个遵守依赖倒置原则的UML图，原来的话当客户购买商品时,shopping这个方法要传入相应的网店进去，当要更改店铺时，就要修改Cusromer这个类里的shopping方法，而现在，只要定义一个Shop接口，所有的店铺都实现这个接口的方法，顾客类的shopping方法只要传入Shop这个接口类就可以了．然后具体实现的时候，要到哪里买，就传入哪一个网店就可以了，而不用修改Cusromer这个类的方法；</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//代码来之＇C语言中文网＇</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DIPtest</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        Customer wang=<span class=\"keyword\">new</span> Customer();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"顾客购买以下商品：\"</span>); </span><br><span class=\"line\">        wang.shopping(<span class=\"keyword\">new</span> ShaoguanShop()); </span><br><span class=\"line\">        wang.shopping(<span class=\"keyword\">new</span> WuyuanShop());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//商店</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Shop</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">sell</span><span class=\"params\">()</span></span>; <span class=\"comment\">//卖</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//韶关网店</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShaoguanShop</span> <span class=\"keyword\">implements</span> <span class=\"title\">Shop</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">sell</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"韶关土特产：香菇、木耳……\"</span>; </span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//婺源网店</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WuyuanShop</span> <span class=\"keyword\">implements</span> <span class=\"title\">Shop</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">sell</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"婺源土特产：绿茶、酒糟鱼……\"</span>; </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br><span class=\"line\"><span class=\"comment\">//顾客</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Customer</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">shopping</span><span class=\"params\">(Shop shop)</span></span></span><br><span class=\"line\"><span class=\"function\">    </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//购物</span></span><br><span class=\"line\">        System.out.println(shop.sell()); </span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//输出</span></span><br><span class=\"line\">顾客购买以下商品：</span><br><span class=\"line\">韶关土特产：香菇、木耳……</span><br><span class=\"line\">婺源土特产：绿茶、酒糟鱼……</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"单一职责\"><a href=\"#单一职责\" class=\"headerlink\" title=\"单一职责\"></a>单一职责</h2><p><font color=\"orange\">单一职责要求一个类只负责一项职责.  </font>这个听起来很简单，但是实际应用上却非常的难把握．因为这个职责在中国是非常抽象的概念，中国是一个文化底蕴非常丰富的国家，就像&lt;&lt;设计模式之禅&gt;&gt; 这本书里所说的例子：比如说中国的筷子，他既可以当刀来分割食物，也可以当叉子来叉取食物，而在国外，叉子就是叉子，用来取食物的，刀就是用来分割食物的；所以这个单一职责要求软件开发人员有非常丰富的实践经验．不然很难把握；</p>\n<h2 id=\"迪米特法则\"><a href=\"#迪米特法则\" class=\"headerlink\" title=\"迪米特法则\"></a>迪米特法则</h2><p><font color=\"orange\">迪米特法则也称最小知道原则，一个类对外暴露的东西越少越好．</font></p>\n<ol>\n<li>从依赖者的角度来说，只依赖应该依赖的对象。</li>\n<li>从被依赖者的角度说，只暴露应该暴露的方法。</li>\n</ol>\n<p>个人理解：当A类需要调用B类的三个方法才能实现的功能时,B类可以对这三个方法进行一个封装，然后只暴露封装的这个方法给A,这样A就只需要调用B的这个封装的方法就可以了，当B的三个方法中有修改的时候，只要修改B这个对外封装的方法就可以，而Ａ调用者却不用改变，因为Ａ只知道调用这个方法可以实现功能，而不用具体管Ｂ内部是怎么实现的，降低了程序的耦合度；</p>\n<h2 id=\"接口隔离原则\"><a href=\"#接口隔离原则\" class=\"headerlink\" title=\"接口隔离原则\"></a>接口隔离原则</h2><p>这个和单一职责有点类似，不过还是不一样的．</p>\n<ul>\n<li>单一职责原则注重的是职责，而接口隔离原则注重的是对接口依赖的隔离。</li>\n<li>单一职责原则主要是约束类，它针对的是程序中的实现和细节；接口隔离原则主要约束接口，主要针对抽象和程序整体框架的构建。</li>\n</ul>\n<p>官方定义：<font color=\"orange\">要求程序员尽量将臃肿庞大的接口拆分成更小的和更具体的接口，让接口中只包含客户感兴趣的方法，降低程序耦合度。</font></p>\n<p>这个法则也要根据实际的业务场景来应用，如果粒度控制的太小，就会导致类的急剧增加，明明一个功能只要三四个类，如果粒度小的话，就会变成十几个，甚至几十个，虽然这样程序耦合度低，比较灵活，但是维护难啊．如果粒度大，耦合度就会高，程序不灵活．所以这个原则要求技术人员有足够的实践，经验和领悟；</p>\n<h2 id=\"合成复用原则\"><a href=\"#合成复用原则\" class=\"headerlink\" title=\"合成复用原则\"></a>合成复用原则</h2><p>它要求在软件复用时，要尽量先使用组合或者聚合等关联关系来实现，其次才考虑使用继承关系来实现。如果要使用继承关系，则必须严格遵循<font color=\"orange\">里氏替换原则</font>。合成复用原则同里氏替换原则相辅相成的，两者都是开闭原则的具体实现规范。</p>\n<p>如果不了解什么是组合和聚合的话可以看看这个篇文章<a href=\"https://blog.csdn.net/qq_31655965/article/details/54645220\" rel=\"noopener\" target=\"_blank\">&lt;&lt;组合、聚合与继承的爱恨情仇&gt;&gt;</a>,讲的挺好的</p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>在程序设计中，尽量遵循OOP七大原则．不过有句话说的好，<font color=\"orange\">规则是死的，人是活的</font>．意思是这七大原则有时候也不是万能的，有时候有的业务场景如果遵循了这些原则，反而变得难维护，所以一切都要从实际出发，23种设计模式也是一样，不要按死规则来．</p>\n"},{"title":"一个故事一个模式-原型模式","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-25T15:34:48.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n![](http://cdn.mjava.top/20191226084321.jpg)\n\n> 积千里跬步,汇万里江河;每天进步一点点,终有一天将成大佬\n>\n> 所有源代码都在这:https://github.com/z573419235/GofDemo\n>\n> 各位大佬记得点个星星哦\n\n## 前言\n\n​        前几天生病了,每天头昏脑胀的,诶,生病的时候才知道身体健康的重要性,以后还是要加强锻炼,身体是革命的本钱;\n\n​        隔了差不多有五六天没写日志了,罪过罪过;好了,今天要说的是原型模式,原型模式在`Java`中核心秘密就是`clone`这个方法,通过重新`Object`中的`clone`方法.来达到原型模式;而要重新`clone`方法就必须要实现`Cloneable`这个接口,不实现这个接口的话就会报`java.lang.CloneNotSupportedException`异常;\n\n\n\n\n\n## 我是鸣人\n\n​        鸣人最喜欢的就是吃拉面,就算是上课的时候也是心心念念的想着一乐大叔的拉面\n\n![](http://cdn.mjava.top/20191225222050.gif)\n\n先来看看鸣人的原型实体类:\n\n```java\n/**\n * @author zheng\n *\n * 我是鸣人实体类\n */\n@Data\npublic class Naruto implements Cloneable{\n    /**\n     * 姓名\n     * */\n    private String name=\"鸣人\";\n    /**\n     * 年龄\n     * */\n    private int age=13;\n    /**\n     * 任务\n     * */\n    private String task;\n    /**\n     *爱好\n     * */\n    private ArrayList<String> hobby=new ArrayList<>();\n    /**\n     * 构造方法\n     * */\n    public Naruto(){\n        this.hobby.add(\"吃拉面\");\n        this.hobby.add(\"泡温泉\");\n    }\n\n    /**\n     * 重写Object类的clone方法\n     * */\n    @Override\n    public Naruto clone(){\n        Naruto naruto=null;\n        try {\n            naruto=(Naruto)super.clone();\n        } catch (CloneNotSupportedException e) {\n            e.printStackTrace();\n        }\n        return naruto;\n    }\n\n    @Override\n    public String toString() {\n        return \"Naruto{\" +\n                \"name='\" + name + '\\'' +\n                \", age='\" + age + '\\'' +\n                \", task='\" + task + '\\'' +\n                \", hobby=\" + hobby +\n                '}';\n    }\n}\n```\n\n> 为了代码整洁,我安装了lombok插件,所以不用写get/set方法,直接加个`@Data`注解就可以了;\n\n\n\n一天,鸣人上着伊鲁卡老师的课,可是心里还是念念不忘一乐大叔的拉面,想着前几天刚学了影分身之术,想着用分身术逃出去吃拉面.于是他就有变了一个分身留着这上课,自己却跑去吃拉面了;\n\n```java\n/**\n * 原型模式\n * @author zheng\n * */\npublic class Main {\n    public static void main(String[] args) {\n        //我是鸣人本人\n        Naruto naruto=new Naruto();\n        //我是影分身\n        Naruto narutoYin=naruto.clone();\n\n        narutoYin.setTask(\"上课\");\n        naruto.setTask(\"吃拉面\");\n\n        System.out.println(\"鸣人本人:\"+naruto.toString());\n        System.out.println(\"影分身:\"+narutoYin.toString());\n\n    }\n}\n\n//控制台输出\n鸣人本人:Naruto{name='鸣人', age='13', task='吃拉面', hobby=[吃拉面, 泡温泉]}\n影分身:Naruto{name='鸣人', age='13', task='上课', hobby=[吃拉面, 泡温泉]}\n```\n\n可以看到,鸣人本人的任务是去<font color=orange>吃拉面</font>,他的影分身的任务是留着教室<font color=orange>上课</font>;当然鸣人可以通过他本人创建无数个影分身,同时执行多个任务;这就是<font color=orange>原型模式</font>;\n\n![](http://cdn.mjava.top/20191225222314.gif)\n\n## 浅拷贝和深拷贝\n\n原型模式就是通过一个原型clone出多个和原型一样的类,但是拷贝也分<font color=orange>浅拷贝</font>和<font color=orange>深拷贝</font>;\n\n### 浅拷贝\n\n> 浅拷贝有多浅,浅到就相当于没有给你拷贝,他就是让你<font color=orange>和原型共用一个空间,没有给你分配新的内存</font>;\n\n比如上面的鸣人本人有爱好,但是隐分身一般是没有爱好的,所以创建隐分身要吧爱好给清除调:\n\n```java\n/**\n * 原型模式\n * @author zheng\n * */\npublic class Main {\n    public static void main(String[] args) {\n        //我是鸣人本人\n        Naruto naruto=new Naruto();\n        //我是影分身\n        Naruto narutoYin=naruto.clone();\n\n        narutoYin.setTask(\"上课\");\n        //影分身不配有爱好\n        narutoYin.getHobby().clear();\n        naruto.setTask(\"吃拉面\");\n\n        System.out.println(\"鸣人本人:\"+naruto.toString());\n        System.out.println(\"影分身:\"+narutoYin.toString());\n\n    }\n}\n//控制台输出\n鸣人本人:Naruto{name='鸣人', age='13', task='吃拉面', hobby=[]}\n影分身:Naruto{name='鸣人', age='13', task='上课', hobby=[]}\n```\n\nWTF,竟然把本人的爱好也清除调了,那还去吃啥拉面啊,算了算了,安安心心上课吧,诶;叫你上影分身课是时候不认真,失败了吧!!!\n\n### 深拷贝\n\n> 深拷贝就是在`clone`方法里除了克隆类之外,还要克隆引用对象,这样才会重新给引用对象<font color=orange>分配新的内存空间</font>\n\n进过上次的教训,鸣人苦练影分身之术,终于学得核心所在,看看他新的影分身技能吧:\n\n![](http://cdn.mjava.top/20191225220944.png)\n\n在变一个看看:\n\n```java\n/**\n * 原型模式\n * @author zheng\n * */\npublic class Main {\n    public static void main(String[] args) {\n        //我是鸣人本人\n        Naruto naruto=new Naruto();\n        //我是影分身\n        Naruto narutoYin=naruto.clone();\n\n        narutoYin.setTask(\"上课\");\n        //影分身不配有爱好\n        narutoYin.getHobby().clear();\n        naruto.setTask(\"吃拉面\");\n\n        System.out.println(\"鸣人本人:\"+naruto.toString());\n        System.out.println(\"影分身:\"+narutoYin.toString());\n\n    }\n}\n//控制台输出\n鸣人本人:Naruto{name='鸣人', age='13', task='吃拉面', hobby=[吃拉面, 泡温泉]}\n影分身:Naruto{name='鸣人', age='13', task='上课', hobby=[]}\n```\n\n哈哈,成功了,这下可以安安心心的区吃拉面了吧;\n\n![](http://cdn.mjava.top/20191225222402.gif)\n\n## 总结\n\n​        引用设计模式之禅的一句话:内部的数组和引用对象才不拷贝，其他的原始类型比如`int`、`long`、`char`等都会被拷贝，但是对于`String`类型，`Java`就希望你把它认为是基本类型，它是没有clone方法的，处理机制也比较特殊，通过字符串池（stringpool）在需要的时候才在内存中创建新的字符串，在使用的时候就把`String`当做基本类使用即可。注意:<font color=orange>使用clone方法，在类的成员变量上就不要增加final关键字,否则当你重新设置这个成员变量的值时是不能设置的,因为final的不可变的,只能引用原来的值</font>","source":"_posts/gof/gof-prototype.md","raw":"---\ntitle: 一个故事一个模式-原型模式\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-25 23:34:48\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- 设计模式\n- 原型模式\ncategories:\n- GOF\n---\n\n\n![](http://cdn.mjava.top/20191226084321.jpg)\n\n> 积千里跬步,汇万里江河;每天进步一点点,终有一天将成大佬\n>\n> 所有源代码都在这:https://github.com/z573419235/GofDemo\n>\n> 各位大佬记得点个星星哦\n\n## 前言\n\n​        前几天生病了,每天头昏脑胀的,诶,生病的时候才知道身体健康的重要性,以后还是要加强锻炼,身体是革命的本钱;\n\n​        隔了差不多有五六天没写日志了,罪过罪过;好了,今天要说的是原型模式,原型模式在`Java`中核心秘密就是`clone`这个方法,通过重新`Object`中的`clone`方法.来达到原型模式;而要重新`clone`方法就必须要实现`Cloneable`这个接口,不实现这个接口的话就会报`java.lang.CloneNotSupportedException`异常;\n\n\n\n\n\n## 我是鸣人\n\n​        鸣人最喜欢的就是吃拉面,就算是上课的时候也是心心念念的想着一乐大叔的拉面\n\n![](http://cdn.mjava.top/20191225222050.gif)\n\n先来看看鸣人的原型实体类:\n\n```java\n/**\n * @author zheng\n *\n * 我是鸣人实体类\n */\n@Data\npublic class Naruto implements Cloneable{\n    /**\n     * 姓名\n     * */\n    private String name=\"鸣人\";\n    /**\n     * 年龄\n     * */\n    private int age=13;\n    /**\n     * 任务\n     * */\n    private String task;\n    /**\n     *爱好\n     * */\n    private ArrayList<String> hobby=new ArrayList<>();\n    /**\n     * 构造方法\n     * */\n    public Naruto(){\n        this.hobby.add(\"吃拉面\");\n        this.hobby.add(\"泡温泉\");\n    }\n\n    /**\n     * 重写Object类的clone方法\n     * */\n    @Override\n    public Naruto clone(){\n        Naruto naruto=null;\n        try {\n            naruto=(Naruto)super.clone();\n        } catch (CloneNotSupportedException e) {\n            e.printStackTrace();\n        }\n        return naruto;\n    }\n\n    @Override\n    public String toString() {\n        return \"Naruto{\" +\n                \"name='\" + name + '\\'' +\n                \", age='\" + age + '\\'' +\n                \", task='\" + task + '\\'' +\n                \", hobby=\" + hobby +\n                '}';\n    }\n}\n```\n\n> 为了代码整洁,我安装了lombok插件,所以不用写get/set方法,直接加个`@Data`注解就可以了;\n\n\n\n一天,鸣人上着伊鲁卡老师的课,可是心里还是念念不忘一乐大叔的拉面,想着前几天刚学了影分身之术,想着用分身术逃出去吃拉面.于是他就有变了一个分身留着这上课,自己却跑去吃拉面了;\n\n```java\n/**\n * 原型模式\n * @author zheng\n * */\npublic class Main {\n    public static void main(String[] args) {\n        //我是鸣人本人\n        Naruto naruto=new Naruto();\n        //我是影分身\n        Naruto narutoYin=naruto.clone();\n\n        narutoYin.setTask(\"上课\");\n        naruto.setTask(\"吃拉面\");\n\n        System.out.println(\"鸣人本人:\"+naruto.toString());\n        System.out.println(\"影分身:\"+narutoYin.toString());\n\n    }\n}\n\n//控制台输出\n鸣人本人:Naruto{name='鸣人', age='13', task='吃拉面', hobby=[吃拉面, 泡温泉]}\n影分身:Naruto{name='鸣人', age='13', task='上课', hobby=[吃拉面, 泡温泉]}\n```\n\n可以看到,鸣人本人的任务是去<font color=orange>吃拉面</font>,他的影分身的任务是留着教室<font color=orange>上课</font>;当然鸣人可以通过他本人创建无数个影分身,同时执行多个任务;这就是<font color=orange>原型模式</font>;\n\n![](http://cdn.mjava.top/20191225222314.gif)\n\n## 浅拷贝和深拷贝\n\n原型模式就是通过一个原型clone出多个和原型一样的类,但是拷贝也分<font color=orange>浅拷贝</font>和<font color=orange>深拷贝</font>;\n\n### 浅拷贝\n\n> 浅拷贝有多浅,浅到就相当于没有给你拷贝,他就是让你<font color=orange>和原型共用一个空间,没有给你分配新的内存</font>;\n\n比如上面的鸣人本人有爱好,但是隐分身一般是没有爱好的,所以创建隐分身要吧爱好给清除调:\n\n```java\n/**\n * 原型模式\n * @author zheng\n * */\npublic class Main {\n    public static void main(String[] args) {\n        //我是鸣人本人\n        Naruto naruto=new Naruto();\n        //我是影分身\n        Naruto narutoYin=naruto.clone();\n\n        narutoYin.setTask(\"上课\");\n        //影分身不配有爱好\n        narutoYin.getHobby().clear();\n        naruto.setTask(\"吃拉面\");\n\n        System.out.println(\"鸣人本人:\"+naruto.toString());\n        System.out.println(\"影分身:\"+narutoYin.toString());\n\n    }\n}\n//控制台输出\n鸣人本人:Naruto{name='鸣人', age='13', task='吃拉面', hobby=[]}\n影分身:Naruto{name='鸣人', age='13', task='上课', hobby=[]}\n```\n\nWTF,竟然把本人的爱好也清除调了,那还去吃啥拉面啊,算了算了,安安心心上课吧,诶;叫你上影分身课是时候不认真,失败了吧!!!\n\n### 深拷贝\n\n> 深拷贝就是在`clone`方法里除了克隆类之外,还要克隆引用对象,这样才会重新给引用对象<font color=orange>分配新的内存空间</font>\n\n进过上次的教训,鸣人苦练影分身之术,终于学得核心所在,看看他新的影分身技能吧:\n\n![](http://cdn.mjava.top/20191225220944.png)\n\n在变一个看看:\n\n```java\n/**\n * 原型模式\n * @author zheng\n * */\npublic class Main {\n    public static void main(String[] args) {\n        //我是鸣人本人\n        Naruto naruto=new Naruto();\n        //我是影分身\n        Naruto narutoYin=naruto.clone();\n\n        narutoYin.setTask(\"上课\");\n        //影分身不配有爱好\n        narutoYin.getHobby().clear();\n        naruto.setTask(\"吃拉面\");\n\n        System.out.println(\"鸣人本人:\"+naruto.toString());\n        System.out.println(\"影分身:\"+narutoYin.toString());\n\n    }\n}\n//控制台输出\n鸣人本人:Naruto{name='鸣人', age='13', task='吃拉面', hobby=[吃拉面, 泡温泉]}\n影分身:Naruto{name='鸣人', age='13', task='上课', hobby=[]}\n```\n\n哈哈,成功了,这下可以安安心心的区吃拉面了吧;\n\n![](http://cdn.mjava.top/20191225222402.gif)\n\n## 总结\n\n​        引用设计模式之禅的一句话:内部的数组和引用对象才不拷贝，其他的原始类型比如`int`、`long`、`char`等都会被拷贝，但是对于`String`类型，`Java`就希望你把它认为是基本类型，它是没有clone方法的，处理机制也比较特殊，通过字符串池（stringpool）在需要的时候才在内存中创建新的字符串，在使用的时候就把`String`当做基本类使用即可。注意:<font color=orange>使用clone方法，在类的成员变量上就不要增加final关键字,否则当你重新设置这个成员变量的值时是不能设置的,因为final的不可变的,只能引用原来的值</font>","slug":"gof/gof-prototype","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjg000n2mg5aoqskhqc","content":"<p><img src=\"http://cdn.mjava.top/20191226084321.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步,汇万里江河;每天进步一点点,终有一天将成大佬</p>\n<p>所有源代码都在这:<a href=\"https://github.com/z573419235/GofDemo\" rel=\"noopener\" target=\"_blank\">https://github.com/z573419235/GofDemo</a></p>\n<p>各位大佬记得点个星星哦</p>\n</blockquote>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>​        前几天生病了,每天头昏脑胀的,诶,生病的时候才知道身体健康的重要性,以后还是要加强锻炼,身体是革命的本钱;</p>\n<p>​        隔了差不多有五六天没写日志了,罪过罪过;好了,今天要说的是原型模式,原型模式在<code>Java</code>中核心秘密就是<code>clone</code>这个方法,通过重新<code>Object</code>中的<code>clone</code>方法.来达到原型模式;而要重新<code>clone</code>方法就必须要实现<code>Cloneable</code>这个接口,不实现这个接口的话就会报<code>java.lang.CloneNotSupportedException</code>异常;</p>\n<h2 id=\"我是鸣人\"><a href=\"#我是鸣人\" class=\"headerlink\" title=\"我是鸣人\"></a>我是鸣人</h2><p>​        鸣人最喜欢的就是吃拉面,就算是上课的时候也是心心念念的想着一乐大叔的拉面</p>\n<p><img src=\"http://cdn.mjava.top/20191225222050.gif\" alt></p>\n<p>先来看看鸣人的原型实体类:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> zheng</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * 我是鸣人实体类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Naruto</span> <span class=\"keyword\">implements</span> <span class=\"title\">Cloneable</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 姓名</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name=<span class=\"string\">\"鸣人\"</span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 年龄</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> age=<span class=\"number\">13</span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 任务</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String task;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *爱好</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> ArrayList&lt;String&gt; hobby=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 构造方法</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Naruto</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.hobby.add(<span class=\"string\">\"吃拉面\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.hobby.add(<span class=\"string\">\"泡温泉\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 重写Object类的clone方法</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Naruto <span class=\"title\">clone</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        Naruto naruto=<span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            naruto=(Naruto)<span class=\"keyword\">super</span>.clone();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> naruto;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"Naruto&#123;\"</span> +</span><br><span class=\"line\">                <span class=\"string\">\"name='\"</span> + name + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", age='\"</span> + age + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", task='\"</span> + task + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", hobby=\"</span> + hobby +</span><br><span class=\"line\">                <span class=\"string\">'&#125;'</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>为了代码整洁,我安装了lombok插件,所以不用写get/set方法,直接加个<code>@Data</code>注解就可以了;</p>\n</blockquote>\n<p>一天,鸣人上着伊鲁卡老师的课,可是心里还是念念不忘一乐大叔的拉面,想着前几天刚学了影分身之术,想着用分身术逃出去吃拉面.于是他就有变了一个分身留着这上课,自己却跑去吃拉面了;</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 原型模式</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> zheng</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//我是鸣人本人</span></span><br><span class=\"line\">        Naruto naruto=<span class=\"keyword\">new</span> Naruto();</span><br><span class=\"line\">        <span class=\"comment\">//我是影分身</span></span><br><span class=\"line\">        Naruto narutoYin=naruto.clone();</span><br><span class=\"line\"></span><br><span class=\"line\">        narutoYin.setTask(<span class=\"string\">\"上课\"</span>);</span><br><span class=\"line\">        naruto.setTask(<span class=\"string\">\"吃拉面\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"鸣人本人:\"</span>+naruto.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"影分身:\"</span>+narutoYin.toString());</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//控制台输出</span></span><br><span class=\"line\">鸣人本人:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'吃拉面'</span>, hobby=[吃拉面, 泡温泉]&#125;</span><br><span class=\"line\">影分身:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'上课'</span>, hobby=[吃拉面, 泡温泉]&#125;</span><br></pre></td></tr></table></figure>\n\n<p>可以看到,鸣人本人的任务是去<font color=\"orange\">吃拉面</font>,他的影分身的任务是留着教室<font color=\"orange\">上课</font>;当然鸣人可以通过他本人创建无数个影分身,同时执行多个任务;这就是<font color=\"orange\">原型模式</font>;</p>\n<p><img src=\"http://cdn.mjava.top/20191225222314.gif\" alt></p>\n<h2 id=\"浅拷贝和深拷贝\"><a href=\"#浅拷贝和深拷贝\" class=\"headerlink\" title=\"浅拷贝和深拷贝\"></a>浅拷贝和深拷贝</h2><p>原型模式就是通过一个原型clone出多个和原型一样的类,但是拷贝也分<font color=\"orange\">浅拷贝</font>和<font color=\"orange\">深拷贝</font>;</p>\n<h3 id=\"浅拷贝\"><a href=\"#浅拷贝\" class=\"headerlink\" title=\"浅拷贝\"></a>浅拷贝</h3><blockquote>\n<p>浅拷贝有多浅,浅到就相当于没有给你拷贝,他就是让你<font color=\"orange\">和原型共用一个空间,没有给你分配新的内存</font>;</p>\n</blockquote>\n<p>比如上面的鸣人本人有爱好,但是隐分身一般是没有爱好的,所以创建隐分身要吧爱好给清除调:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 原型模式</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> zheng</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//我是鸣人本人</span></span><br><span class=\"line\">        Naruto naruto=<span class=\"keyword\">new</span> Naruto();</span><br><span class=\"line\">        <span class=\"comment\">//我是影分身</span></span><br><span class=\"line\">        Naruto narutoYin=naruto.clone();</span><br><span class=\"line\"></span><br><span class=\"line\">        narutoYin.setTask(<span class=\"string\">\"上课\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">//影分身不配有爱好</span></span><br><span class=\"line\">        narutoYin.getHobby().clear();</span><br><span class=\"line\">        naruto.setTask(<span class=\"string\">\"吃拉面\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"鸣人本人:\"</span>+naruto.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"影分身:\"</span>+narutoYin.toString());</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//控制台输出</span></span><br><span class=\"line\">鸣人本人:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'吃拉面'</span>, hobby=[]&#125;</span><br><span class=\"line\">影分身:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'上课'</span>, hobby=[]&#125;</span><br></pre></td></tr></table></figure>\n\n<p>WTF,竟然把本人的爱好也清除调了,那还去吃啥拉面啊,算了算了,安安心心上课吧,诶;叫你上影分身课是时候不认真,失败了吧!!!</p>\n<h3 id=\"深拷贝\"><a href=\"#深拷贝\" class=\"headerlink\" title=\"深拷贝\"></a>深拷贝</h3><blockquote>\n<p>深拷贝就是在<code>clone</code>方法里除了克隆类之外,还要克隆引用对象,这样才会重新给引用对象<font color=\"orange\">分配新的内存空间</font></p>\n</blockquote>\n<p>进过上次的教训,鸣人苦练影分身之术,终于学得核心所在,看看他新的影分身技能吧:</p>\n<p><img src=\"http://cdn.mjava.top/20191225220944.png\" alt></p>\n<p>在变一个看看:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 原型模式</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> zheng</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//我是鸣人本人</span></span><br><span class=\"line\">        Naruto naruto=<span class=\"keyword\">new</span> Naruto();</span><br><span class=\"line\">        <span class=\"comment\">//我是影分身</span></span><br><span class=\"line\">        Naruto narutoYin=naruto.clone();</span><br><span class=\"line\"></span><br><span class=\"line\">        narutoYin.setTask(<span class=\"string\">\"上课\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">//影分身不配有爱好</span></span><br><span class=\"line\">        narutoYin.getHobby().clear();</span><br><span class=\"line\">        naruto.setTask(<span class=\"string\">\"吃拉面\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"鸣人本人:\"</span>+naruto.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"影分身:\"</span>+narutoYin.toString());</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//控制台输出</span></span><br><span class=\"line\">鸣人本人:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'吃拉面'</span>, hobby=[吃拉面, 泡温泉]&#125;</span><br><span class=\"line\">影分身:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'上课'</span>, hobby=[]&#125;</span><br></pre></td></tr></table></figure>\n\n<p>哈哈,成功了,这下可以安安心心的区吃拉面了吧;</p>\n<p><img src=\"http://cdn.mjava.top/20191225222402.gif\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>​        引用设计模式之禅的一句话:内部的数组和引用对象才不拷贝，其他的原始类型比如<code>int</code>、<code>long</code>、<code>char</code>等都会被拷贝，但是对于<code>String</code>类型，<code>Java</code>就希望你把它认为是基本类型，它是没有clone方法的，处理机制也比较特殊，通过字符串池（stringpool）在需要的时候才在内存中创建新的字符串，在使用的时候就把<code>String</code>当做基本类使用即可。注意:<font color=\"orange\">使用clone方法，在类的成员变量上就不要增加final关键字,否则当你重新设置这个成员变量的值时是不能设置的,因为final的不可变的,只能引用原来的值</font></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p><img src=\"http://cdn.mjava.top/20191226084321.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步,汇万里江河;每天进步一点点,终有一天将成大佬</p>\n<p>所有源代码都在这:<a href=\"https://github.com/z573419235/GofDemo\" rel=\"noopener\" target=\"_blank\">https://github.com/z573419235/GofDemo</a></p>\n<p>各位大佬记得点个星星哦</p>\n</blockquote>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>​        前几天生病了,每天头昏脑胀的,诶,生病的时候才知道身体健康的重要性,以后还是要加强锻炼,身体是革命的本钱;</p>\n<p>​        隔了差不多有五六天没写日志了,罪过罪过;好了,今天要说的是原型模式,原型模式在<code>Java</code>中核心秘密就是<code>clone</code>这个方法,通过重新<code>Object</code>中的<code>clone</code>方法.来达到原型模式;而要重新<code>clone</code>方法就必须要实现<code>Cloneable</code>这个接口,不实现这个接口的话就会报<code>java.lang.CloneNotSupportedException</code>异常;</p>\n<h2 id=\"我是鸣人\"><a href=\"#我是鸣人\" class=\"headerlink\" title=\"我是鸣人\"></a>我是鸣人</h2><p>​        鸣人最喜欢的就是吃拉面,就算是上课的时候也是心心念念的想着一乐大叔的拉面</p>\n<p><img src=\"http://cdn.mjava.top/20191225222050.gif\" alt></p>\n<p>先来看看鸣人的原型实体类:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> zheng</span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * 我是鸣人实体类</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Naruto</span> <span class=\"keyword\">implements</span> <span class=\"title\">Cloneable</span></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 姓名</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String name=<span class=\"string\">\"鸣人\"</span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 年龄</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> age=<span class=\"number\">13</span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 任务</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String task;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *爱好</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> ArrayList&lt;String&gt; hobby=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 构造方法</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Naruto</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.hobby.add(<span class=\"string\">\"吃拉面\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.hobby.add(<span class=\"string\">\"泡温泉\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 重写Object类的clone方法</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Naruto <span class=\"title\">clone</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        Naruto naruto=<span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            naruto=(Naruto)<span class=\"keyword\">super</span>.clone();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (CloneNotSupportedException e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> naruto;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">toString</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"Naruto&#123;\"</span> +</span><br><span class=\"line\">                <span class=\"string\">\"name='\"</span> + name + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", age='\"</span> + age + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", task='\"</span> + task + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", hobby=\"</span> + hobby +</span><br><span class=\"line\">                <span class=\"string\">'&#125;'</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>为了代码整洁,我安装了lombok插件,所以不用写get/set方法,直接加个<code>@Data</code>注解就可以了;</p>\n</blockquote>\n<p>一天,鸣人上着伊鲁卡老师的课,可是心里还是念念不忘一乐大叔的拉面,想着前几天刚学了影分身之术,想着用分身术逃出去吃拉面.于是他就有变了一个分身留着这上课,自己却跑去吃拉面了;</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 原型模式</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> zheng</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//我是鸣人本人</span></span><br><span class=\"line\">        Naruto naruto=<span class=\"keyword\">new</span> Naruto();</span><br><span class=\"line\">        <span class=\"comment\">//我是影分身</span></span><br><span class=\"line\">        Naruto narutoYin=naruto.clone();</span><br><span class=\"line\"></span><br><span class=\"line\">        narutoYin.setTask(<span class=\"string\">\"上课\"</span>);</span><br><span class=\"line\">        naruto.setTask(<span class=\"string\">\"吃拉面\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"鸣人本人:\"</span>+naruto.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"影分身:\"</span>+narutoYin.toString());</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//控制台输出</span></span><br><span class=\"line\">鸣人本人:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'吃拉面'</span>, hobby=[吃拉面, 泡温泉]&#125;</span><br><span class=\"line\">影分身:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'上课'</span>, hobby=[吃拉面, 泡温泉]&#125;</span><br></pre></td></tr></table></figure>\n\n<p>可以看到,鸣人本人的任务是去<font color=\"orange\">吃拉面</font>,他的影分身的任务是留着教室<font color=\"orange\">上课</font>;当然鸣人可以通过他本人创建无数个影分身,同时执行多个任务;这就是<font color=\"orange\">原型模式</font>;</p>\n<p><img src=\"http://cdn.mjava.top/20191225222314.gif\" alt></p>\n<h2 id=\"浅拷贝和深拷贝\"><a href=\"#浅拷贝和深拷贝\" class=\"headerlink\" title=\"浅拷贝和深拷贝\"></a>浅拷贝和深拷贝</h2><p>原型模式就是通过一个原型clone出多个和原型一样的类,但是拷贝也分<font color=\"orange\">浅拷贝</font>和<font color=\"orange\">深拷贝</font>;</p>\n<h3 id=\"浅拷贝\"><a href=\"#浅拷贝\" class=\"headerlink\" title=\"浅拷贝\"></a>浅拷贝</h3><blockquote>\n<p>浅拷贝有多浅,浅到就相当于没有给你拷贝,他就是让你<font color=\"orange\">和原型共用一个空间,没有给你分配新的内存</font>;</p>\n</blockquote>\n<p>比如上面的鸣人本人有爱好,但是隐分身一般是没有爱好的,所以创建隐分身要吧爱好给清除调:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 原型模式</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> zheng</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//我是鸣人本人</span></span><br><span class=\"line\">        Naruto naruto=<span class=\"keyword\">new</span> Naruto();</span><br><span class=\"line\">        <span class=\"comment\">//我是影分身</span></span><br><span class=\"line\">        Naruto narutoYin=naruto.clone();</span><br><span class=\"line\"></span><br><span class=\"line\">        narutoYin.setTask(<span class=\"string\">\"上课\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">//影分身不配有爱好</span></span><br><span class=\"line\">        narutoYin.getHobby().clear();</span><br><span class=\"line\">        naruto.setTask(<span class=\"string\">\"吃拉面\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"鸣人本人:\"</span>+naruto.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"影分身:\"</span>+narutoYin.toString());</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//控制台输出</span></span><br><span class=\"line\">鸣人本人:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'吃拉面'</span>, hobby=[]&#125;</span><br><span class=\"line\">影分身:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'上课'</span>, hobby=[]&#125;</span><br></pre></td></tr></table></figure>\n\n<p>WTF,竟然把本人的爱好也清除调了,那还去吃啥拉面啊,算了算了,安安心心上课吧,诶;叫你上影分身课是时候不认真,失败了吧!!!</p>\n<h3 id=\"深拷贝\"><a href=\"#深拷贝\" class=\"headerlink\" title=\"深拷贝\"></a>深拷贝</h3><blockquote>\n<p>深拷贝就是在<code>clone</code>方法里除了克隆类之外,还要克隆引用对象,这样才会重新给引用对象<font color=\"orange\">分配新的内存空间</font></p>\n</blockquote>\n<p>进过上次的教训,鸣人苦练影分身之术,终于学得核心所在,看看他新的影分身技能吧:</p>\n<p><img src=\"http://cdn.mjava.top/20191225220944.png\" alt></p>\n<p>在变一个看看:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 原型模式</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> zheng</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Main</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//我是鸣人本人</span></span><br><span class=\"line\">        Naruto naruto=<span class=\"keyword\">new</span> Naruto();</span><br><span class=\"line\">        <span class=\"comment\">//我是影分身</span></span><br><span class=\"line\">        Naruto narutoYin=naruto.clone();</span><br><span class=\"line\"></span><br><span class=\"line\">        narutoYin.setTask(<span class=\"string\">\"上课\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">//影分身不配有爱好</span></span><br><span class=\"line\">        narutoYin.getHobby().clear();</span><br><span class=\"line\">        naruto.setTask(<span class=\"string\">\"吃拉面\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"鸣人本人:\"</span>+naruto.toString());</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"影分身:\"</span>+narutoYin.toString());</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//控制台输出</span></span><br><span class=\"line\">鸣人本人:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'吃拉面'</span>, hobby=[吃拉面, 泡温泉]&#125;</span><br><span class=\"line\">影分身:Naruto&#123;name=<span class=\"string\">'鸣人'</span>, age=<span class=\"string\">'13'</span>, task=<span class=\"string\">'上课'</span>, hobby=[]&#125;</span><br></pre></td></tr></table></figure>\n\n<p>哈哈,成功了,这下可以安安心心的区吃拉面了吧;</p>\n<p><img src=\"http://cdn.mjava.top/20191225222402.gif\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>​        引用设计模式之禅的一句话:内部的数组和引用对象才不拷贝，其他的原始类型比如<code>int</code>、<code>long</code>、<code>char</code>等都会被拷贝，但是对于<code>String</code>类型，<code>Java</code>就希望你把它认为是基本类型，它是没有clone方法的，处理机制也比较特殊，通过字符串池（stringpool）在需要的时候才在内存中创建新的字符串，在使用的时候就把<code>String</code>当做基本类使用即可。注意:<font color=\"orange\">使用clone方法，在类的成员变量上就不要增加final关键字,否则当你重新设置这个成员变量的值时是不能设置的,因为final的不可变的,只能引用原来的值</font></p>\n"},{"title":"设计模式之建造者模式【用好玩的故事讲清楚设计模式】","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-26T22:50:31.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n![](http://cdn.mjava.top/20191226220204.jpg)\n\n> 积千里跬步,汇万里江河;每天进步一点点,终有一天将成大佬\n>\n> 所有源代码都在这:[https://github.com/z573419235/GofDemo](https://github.com/z573419235/GofDemo)\n>\n> 各位大佬记得点个星星哦\n\n## 前言\n\n建造者模式用于实例化一个比较复杂的实体类,<font color=orange>当你实例化一个类时,它的构造参数比较多时,就可以用建造者模式来简化实例化过程</font>;前几篇工厂模式的文章我们说道买车,那只是简单的区工厂买车,我们不关系工厂是怎么造出来的.可是实际工厂造一辆车需要有方向盘、发动机、车架、轮胎等部件,而且不同品牌的车的部件都是不同的,<font color=orange>部件虽然不同,但是造车的方式基本都是差不多的步骤</font>,这时候就可以用建造者模式来造一辆车了;\n\n建造者（Builder）模式由产品、抽象建造者、具体建造者、指挥者等 4 个要素构成\n\n## 土豪朋友开车厂\n\n​        土豪朋友上次买了车之后,发现造车卖还挺赚钱,于是决定涉足汽车领域,真是很有商业头脑啊,不愧是我的玉树临风,疯言疯语,语速惊人,人模狗样的土豪朋友啊.\n\n![](http://cdn.mjava.top/20191226171943.jpg)\n\n一天,前去向他讨教汽车的知识,他给我讲了汽车的大致构成:\n\n```java\n/**\n * 汽车 产品类 定义汽车的构成\n * */\n@Data\npublic class Car {\n    /**\n     * 方向盘\n     * */\n    private String steering;\n    /**\n     * 发动机\n     * */\n    private String engine;\n    /**\n     * 车架\n     * */\n    private String frame;\n    /**\n     * 轮胎\n     * */\n    private String tire;\n    /**\n     * 展示一下汽车配置\n     * */\n    public String show() {\n        return \"{\" +\n                \"steering='\" + steering + '\\'' +\n                \", engine='\" + engine + '\\'' +\n                \", frame='\" + frame + '\\'' +\n                \", tire='\" + tire + '\\'' +\n                '}';\n    }\n}\n```\n\n果真是大致啊,忽悠我不懂车是吧,就给我讲4个东西,这谁不知道啊,哼!土豪朋友忙解释到:这不是为了通俗易懂嘛!!哈哈哈---土豪朋友尴尬而不失礼貌的笑着!\n\n![](http://cdn.mjava.top/20191226172548.jpg)\n\n算了算了,不和你计较了,你再和我讲下你们车厂的造车模式吧!!他说,一开始他造车自己累的半死,什么都要亲力亲为,后来招了两个专家,<font color=orange>一个负责宝马的制造,一个负责奔驰的制造</font>,我现在要什么车,只要指挥谁造车就好了.轻松的很;\n\n他给我介绍了一下他的两个专家:\n\n```java\n/**\n * 宝马车建造者\n * */\npublic class BMWBuilder extends AbstractBuild {\n    @Override\n    void buildEngine() {\n        car.setEngine(\"宝马的发动机\");\n    }\n\n    @Override\n    void buildSteering() {\n        car.setSteering(\"宝马的方向盘\");\n    }\n\n    @Override\n    void buildFrame() {\n        car.setFrame(\"宝马的车架\");\n    }\n\n    @Override\n    void buildTire() {\n        car.setTire(\"宝马的轮胎\");\n    }\n}\n```\n\n```java\n/**\n * 奔驰车建造者\n * */\npublic class BenzBuilder extends AbstractBuild {\n    @Override\n    void buildEngine() {\n        car.setEngine(\"奔驰的发动机\");\n    }\n\n    @Override\n    void buildSteering() {\n        car.setSteering(\"奔驰的方向盘\");\n    }\n\n    @Override\n    void buildFrame() {\n        car.setFrame(\"奔驰的车架\");\n    }\n\n    @Override\n    void buildTire() {\n        car.setTire(\"奔驰的轮胎\");\n    }\n}\n```\n\n<font color=orange>他们两个都遵循下面这个`AbstractBuild`汽车的建造规则:</font>\n\n```java\n/**\n * 抽象建造者 定义造车的方法\n * */\nabstract class AbstractBuild {\n    /**\n     * 造的产品是车\n     * */\n    protected Car car=new Car();\n    /**\n     * 造发动机\n     * */\n    abstract void buildEngine();\n    /**\n     * 造轮胎\n     * */\n    abstract void buildSteering();\n    /**\n     * 造车架\n     * */\n    abstract void buildFrame();\n    /**\n     * 造轮胎\n     * */\n    abstract void buildTire();\n    /**\n     * 得到造好的车\n     * */\n    public Car getCar(){\n        return this.car;\n    }\n}\n```\n\n土豪朋友还跟我讲了是怎么指挥他们造车的:\n\n```java\n/**\n * 所有的建造者要听这个包工头的话,叫你造什么就造什么\n * */\npublic class Boss {\n\n    public static Car builderCar(AbstractBuild build){\n        build.buildEngine();\n        build.buildFrame();\n        build.buildSteering();\n        build.buildTire();\n        return build.getCar();\n    }\n}\n```\n\n经过他这一翻显摆之后,感觉虽然长的人摸狗样的,干起事来还真是一套一套的,哈哈哈哈!!\n\n![](http://cdn.mjava.top/20191226174032.gif)\n\n说完,还向我展示了汽车是怎样造成的...........\n\n![](http://cdn.mjava.top/20191226174235.png)\n\n## 总结\n\n其实建造者模式和<font color=orange>工厂模式</font>还是挺像的,<font color=orange>建造者模式里的建造者就相当于工厂模式里的工厂</font>,不过建造者的核心是可以<font color=orange>控制顺序</font>,比如上面的土豪老板可以控制建造工人的建造顺序,可以控制他们是先造轮胎还是先造发动机,这才是建造者模式意义;\n\n> 建造者模式如果和<font color=orange>模板方法模式</font>搭配起来,<font color=orange>建造工人那个类封装一个模板方法</font>开放给老板,老板就可以直接控制这个类就可以了,那这就和工厂模式没什么两样了","source":"_posts/gof/gof-builder.md","raw":"---\ntitle: 设计模式之建造者模式【用好玩的故事讲清楚设计模式】\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-27 06:50:31\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- 设计模式\n- 建造者模式\ncategories:\n- GOF\n---\n\n\n\n![](http://cdn.mjava.top/20191226220204.jpg)\n\n> 积千里跬步,汇万里江河;每天进步一点点,终有一天将成大佬\n>\n> 所有源代码都在这:[https://github.com/z573419235/GofDemo](https://github.com/z573419235/GofDemo)\n>\n> 各位大佬记得点个星星哦\n\n## 前言\n\n建造者模式用于实例化一个比较复杂的实体类,<font color=orange>当你实例化一个类时,它的构造参数比较多时,就可以用建造者模式来简化实例化过程</font>;前几篇工厂模式的文章我们说道买车,那只是简单的区工厂买车,我们不关系工厂是怎么造出来的.可是实际工厂造一辆车需要有方向盘、发动机、车架、轮胎等部件,而且不同品牌的车的部件都是不同的,<font color=orange>部件虽然不同,但是造车的方式基本都是差不多的步骤</font>,这时候就可以用建造者模式来造一辆车了;\n\n建造者（Builder）模式由产品、抽象建造者、具体建造者、指挥者等 4 个要素构成\n\n## 土豪朋友开车厂\n\n​        土豪朋友上次买了车之后,发现造车卖还挺赚钱,于是决定涉足汽车领域,真是很有商业头脑啊,不愧是我的玉树临风,疯言疯语,语速惊人,人模狗样的土豪朋友啊.\n\n![](http://cdn.mjava.top/20191226171943.jpg)\n\n一天,前去向他讨教汽车的知识,他给我讲了汽车的大致构成:\n\n```java\n/**\n * 汽车 产品类 定义汽车的构成\n * */\n@Data\npublic class Car {\n    /**\n     * 方向盘\n     * */\n    private String steering;\n    /**\n     * 发动机\n     * */\n    private String engine;\n    /**\n     * 车架\n     * */\n    private String frame;\n    /**\n     * 轮胎\n     * */\n    private String tire;\n    /**\n     * 展示一下汽车配置\n     * */\n    public String show() {\n        return \"{\" +\n                \"steering='\" + steering + '\\'' +\n                \", engine='\" + engine + '\\'' +\n                \", frame='\" + frame + '\\'' +\n                \", tire='\" + tire + '\\'' +\n                '}';\n    }\n}\n```\n\n果真是大致啊,忽悠我不懂车是吧,就给我讲4个东西,这谁不知道啊,哼!土豪朋友忙解释到:这不是为了通俗易懂嘛!!哈哈哈---土豪朋友尴尬而不失礼貌的笑着!\n\n![](http://cdn.mjava.top/20191226172548.jpg)\n\n算了算了,不和你计较了,你再和我讲下你们车厂的造车模式吧!!他说,一开始他造车自己累的半死,什么都要亲力亲为,后来招了两个专家,<font color=orange>一个负责宝马的制造,一个负责奔驰的制造</font>,我现在要什么车,只要指挥谁造车就好了.轻松的很;\n\n他给我介绍了一下他的两个专家:\n\n```java\n/**\n * 宝马车建造者\n * */\npublic class BMWBuilder extends AbstractBuild {\n    @Override\n    void buildEngine() {\n        car.setEngine(\"宝马的发动机\");\n    }\n\n    @Override\n    void buildSteering() {\n        car.setSteering(\"宝马的方向盘\");\n    }\n\n    @Override\n    void buildFrame() {\n        car.setFrame(\"宝马的车架\");\n    }\n\n    @Override\n    void buildTire() {\n        car.setTire(\"宝马的轮胎\");\n    }\n}\n```\n\n```java\n/**\n * 奔驰车建造者\n * */\npublic class BenzBuilder extends AbstractBuild {\n    @Override\n    void buildEngine() {\n        car.setEngine(\"奔驰的发动机\");\n    }\n\n    @Override\n    void buildSteering() {\n        car.setSteering(\"奔驰的方向盘\");\n    }\n\n    @Override\n    void buildFrame() {\n        car.setFrame(\"奔驰的车架\");\n    }\n\n    @Override\n    void buildTire() {\n        car.setTire(\"奔驰的轮胎\");\n    }\n}\n```\n\n<font color=orange>他们两个都遵循下面这个`AbstractBuild`汽车的建造规则:</font>\n\n```java\n/**\n * 抽象建造者 定义造车的方法\n * */\nabstract class AbstractBuild {\n    /**\n     * 造的产品是车\n     * */\n    protected Car car=new Car();\n    /**\n     * 造发动机\n     * */\n    abstract void buildEngine();\n    /**\n     * 造轮胎\n     * */\n    abstract void buildSteering();\n    /**\n     * 造车架\n     * */\n    abstract void buildFrame();\n    /**\n     * 造轮胎\n     * */\n    abstract void buildTire();\n    /**\n     * 得到造好的车\n     * */\n    public Car getCar(){\n        return this.car;\n    }\n}\n```\n\n土豪朋友还跟我讲了是怎么指挥他们造车的:\n\n```java\n/**\n * 所有的建造者要听这个包工头的话,叫你造什么就造什么\n * */\npublic class Boss {\n\n    public static Car builderCar(AbstractBuild build){\n        build.buildEngine();\n        build.buildFrame();\n        build.buildSteering();\n        build.buildTire();\n        return build.getCar();\n    }\n}\n```\n\n经过他这一翻显摆之后,感觉虽然长的人摸狗样的,干起事来还真是一套一套的,哈哈哈哈!!\n\n![](http://cdn.mjava.top/20191226174032.gif)\n\n说完,还向我展示了汽车是怎样造成的...........\n\n![](http://cdn.mjava.top/20191226174235.png)\n\n## 总结\n\n其实建造者模式和<font color=orange>工厂模式</font>还是挺像的,<font color=orange>建造者模式里的建造者就相当于工厂模式里的工厂</font>,不过建造者的核心是可以<font color=orange>控制顺序</font>,比如上面的土豪老板可以控制建造工人的建造顺序,可以控制他们是先造轮胎还是先造发动机,这才是建造者模式意义;\n\n> 建造者模式如果和<font color=orange>模板方法模式</font>搭配起来,<font color=orange>建造工人那个类封装一个模板方法</font>开放给老板,老板就可以直接控制这个类就可以了,那这就和工厂模式没什么两样了","slug":"gof/gof-builder","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjh000r2mg5w9id4zss","content":"<p><img src=\"http://cdn.mjava.top/20191226220204.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步,汇万里江河;每天进步一点点,终有一天将成大佬</p>\n<p>所有源代码都在这:<a href=\"https://github.com/z573419235/GofDemo\" rel=\"noopener\" target=\"_blank\">https://github.com/z573419235/GofDemo</a></p>\n<p>各位大佬记得点个星星哦</p>\n</blockquote>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>建造者模式用于实例化一个比较复杂的实体类,<font color=\"orange\">当你实例化一个类时,它的构造参数比较多时,就可以用建造者模式来简化实例化过程</font>;前几篇工厂模式的文章我们说道买车,那只是简单的区工厂买车,我们不关系工厂是怎么造出来的.可是实际工厂造一辆车需要有方向盘、发动机、车架、轮胎等部件,而且不同品牌的车的部件都是不同的,<font color=\"orange\">部件虽然不同,但是造车的方式基本都是差不多的步骤</font>,这时候就可以用建造者模式来造一辆车了;</p>\n<p>建造者（Builder）模式由产品、抽象建造者、具体建造者、指挥者等 4 个要素构成</p>\n<h2 id=\"土豪朋友开车厂\"><a href=\"#土豪朋友开车厂\" class=\"headerlink\" title=\"土豪朋友开车厂\"></a>土豪朋友开车厂</h2><p>​        土豪朋友上次买了车之后,发现造车卖还挺赚钱,于是决定涉足汽车领域,真是很有商业头脑啊,不愧是我的玉树临风,疯言疯语,语速惊人,人模狗样的土豪朋友啊.</p>\n<p><img src=\"http://cdn.mjava.top/20191226171943.jpg\" alt></p>\n<p>一天,前去向他讨教汽车的知识,他给我讲了汽车的大致构成:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 汽车 产品类 定义汽车的构成</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 方向盘</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String steering;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 发动机</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String engine;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 车架</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String frame;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 轮胎</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String tire;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 展示一下汽车配置</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">show</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"&#123;\"</span> +</span><br><span class=\"line\">                <span class=\"string\">\"steering='\"</span> + steering + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", engine='\"</span> + engine + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", frame='\"</span> + frame + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", tire='\"</span> + tire + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">'&#125;'</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>果真是大致啊,忽悠我不懂车是吧,就给我讲4个东西,这谁不知道啊,哼!土豪朋友忙解释到:这不是为了通俗易懂嘛!!哈哈哈—土豪朋友尴尬而不失礼貌的笑着!</p>\n<p><img src=\"http://cdn.mjava.top/20191226172548.jpg\" alt></p>\n<p>算了算了,不和你计较了,你再和我讲下你们车厂的造车模式吧!!他说,一开始他造车自己累的半死,什么都要亲力亲为,后来招了两个专家,<font color=\"orange\">一个负责宝马的制造,一个负责奔驰的制造</font>,我现在要什么车,只要指挥谁造车就好了.轻松的很;</p>\n<p>他给我介绍了一下他的两个专家:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 宝马车建造者</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BMWBuilder</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractBuild</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildEngine</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setEngine(<span class=\"string\">\"宝马的发动机\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildSteering</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setSteering(<span class=\"string\">\"宝马的方向盘\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildFrame</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setFrame(<span class=\"string\">\"宝马的车架\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildTire</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setTire(<span class=\"string\">\"宝马的轮胎\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 奔驰车建造者</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BenzBuilder</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractBuild</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildEngine</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setEngine(<span class=\"string\">\"奔驰的发动机\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildSteering</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setSteering(<span class=\"string\">\"奔驰的方向盘\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildFrame</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setFrame(<span class=\"string\">\"奔驰的车架\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildTire</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setTire(<span class=\"string\">\"奔驰的轮胎\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><font color=\"orange\">他们两个都遵循下面这个<code>AbstractBuild</code>汽车的建造规则:</font></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 抽象建造者 定义造车的方法</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AbstractBuild</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 造的产品是车</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> Car car=<span class=\"keyword\">new</span> Car();</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 造发动机</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">buildEngine</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 造轮胎</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">buildSteering</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 造车架</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">buildFrame</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 造轮胎</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">buildTire</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 得到造好的车</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Car <span class=\"title\">getCar</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.car;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>土豪朋友还跟我讲了是怎么指挥他们造车的:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 所有的建造者要听这个包工头的话,叫你造什么就造什么</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Boss</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Car <span class=\"title\">builderCar</span><span class=\"params\">(AbstractBuild build)</span></span>&#123;</span><br><span class=\"line\">        build.buildEngine();</span><br><span class=\"line\">        build.buildFrame();</span><br><span class=\"line\">        build.buildSteering();</span><br><span class=\"line\">        build.buildTire();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> build.getCar();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>经过他这一翻显摆之后,感觉虽然长的人摸狗样的,干起事来还真是一套一套的,哈哈哈哈!!</p>\n<p><img src=\"http://cdn.mjava.top/20191226174032.gif\" alt></p>\n<p>说完,还向我展示了汽车是怎样造成的………..</p>\n<p><img src=\"http://cdn.mjava.top/20191226174235.png\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>其实建造者模式和<font color=\"orange\">工厂模式</font>还是挺像的,<font color=\"orange\">建造者模式里的建造者就相当于工厂模式里的工厂</font>,不过建造者的核心是可以<font color=\"orange\">控制顺序</font>,比如上面的土豪老板可以控制建造工人的建造顺序,可以控制他们是先造轮胎还是先造发动机,这才是建造者模式意义;</p>\n<blockquote>\n<p>建造者模式如果和<font color=\"orange\">模板方法模式</font>搭配起来,<font color=\"orange\">建造工人那个类封装一个模板方法</font>开放给老板,老板就可以直接控制这个类就可以了,那这就和工厂模式没什么两样了</p>\n</blockquote>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p><img src=\"http://cdn.mjava.top/20191226220204.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步,汇万里江河;每天进步一点点,终有一天将成大佬</p>\n<p>所有源代码都在这:<a href=\"https://github.com/z573419235/GofDemo\" rel=\"noopener\" target=\"_blank\">https://github.com/z573419235/GofDemo</a></p>\n<p>各位大佬记得点个星星哦</p>\n</blockquote>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>建造者模式用于实例化一个比较复杂的实体类,<font color=\"orange\">当你实例化一个类时,它的构造参数比较多时,就可以用建造者模式来简化实例化过程</font>;前几篇工厂模式的文章我们说道买车,那只是简单的区工厂买车,我们不关系工厂是怎么造出来的.可是实际工厂造一辆车需要有方向盘、发动机、车架、轮胎等部件,而且不同品牌的车的部件都是不同的,<font color=\"orange\">部件虽然不同,但是造车的方式基本都是差不多的步骤</font>,这时候就可以用建造者模式来造一辆车了;</p>\n<p>建造者（Builder）模式由产品、抽象建造者、具体建造者、指挥者等 4 个要素构成</p>\n<h2 id=\"土豪朋友开车厂\"><a href=\"#土豪朋友开车厂\" class=\"headerlink\" title=\"土豪朋友开车厂\"></a>土豪朋友开车厂</h2><p>​        土豪朋友上次买了车之后,发现造车卖还挺赚钱,于是决定涉足汽车领域,真是很有商业头脑啊,不愧是我的玉树临风,疯言疯语,语速惊人,人模狗样的土豪朋友啊.</p>\n<p><img src=\"http://cdn.mjava.top/20191226171943.jpg\" alt></p>\n<p>一天,前去向他讨教汽车的知识,他给我讲了汽车的大致构成:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 汽车 产品类 定义汽车的构成</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"meta\">@Data</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Car</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 方向盘</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String steering;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 发动机</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String engine;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 车架</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String frame;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 轮胎</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> String tire;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 展示一下汽车配置</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">show</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"&#123;\"</span> +</span><br><span class=\"line\">                <span class=\"string\">\"steering='\"</span> + steering + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", engine='\"</span> + engine + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", frame='\"</span> + frame + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">\", tire='\"</span> + tire + <span class=\"string\">'\\''</span> +</span><br><span class=\"line\">                <span class=\"string\">'&#125;'</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>果真是大致啊,忽悠我不懂车是吧,就给我讲4个东西,这谁不知道啊,哼!土豪朋友忙解释到:这不是为了通俗易懂嘛!!哈哈哈—土豪朋友尴尬而不失礼貌的笑着!</p>\n<p><img src=\"http://cdn.mjava.top/20191226172548.jpg\" alt></p>\n<p>算了算了,不和你计较了,你再和我讲下你们车厂的造车模式吧!!他说,一开始他造车自己累的半死,什么都要亲力亲为,后来招了两个专家,<font color=\"orange\">一个负责宝马的制造,一个负责奔驰的制造</font>,我现在要什么车,只要指挥谁造车就好了.轻松的很;</p>\n<p>他给我介绍了一下他的两个专家:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 宝马车建造者</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BMWBuilder</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractBuild</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildEngine</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setEngine(<span class=\"string\">\"宝马的发动机\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildSteering</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setSteering(<span class=\"string\">\"宝马的方向盘\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildFrame</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setFrame(<span class=\"string\">\"宝马的车架\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildTire</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setTire(<span class=\"string\">\"宝马的轮胎\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 奔驰车建造者</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BenzBuilder</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractBuild</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildEngine</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setEngine(<span class=\"string\">\"奔驰的发动机\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildSteering</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setSteering(<span class=\"string\">\"奔驰的方向盘\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildFrame</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setFrame(<span class=\"string\">\"奔驰的车架\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">buildTire</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        car.setTire(<span class=\"string\">\"奔驰的轮胎\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><font color=\"orange\">他们两个都遵循下面这个<code>AbstractBuild</code>汽车的建造规则:</font></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 抽象建造者 定义造车的方法</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AbstractBuild</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 造的产品是车</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"keyword\">protected</span> Car car=<span class=\"keyword\">new</span> Car();</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 造发动机</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">buildEngine</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 造轮胎</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">buildSteering</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 造车架</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">buildFrame</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 造轮胎</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">buildTire</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 得到造好的车</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Car <span class=\"title\">getCar</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>.car;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>土豪朋友还跟我讲了是怎么指挥他们造车的:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 所有的建造者要听这个包工头的话,叫你造什么就造什么</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Boss</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Car <span class=\"title\">builderCar</span><span class=\"params\">(AbstractBuild build)</span></span>&#123;</span><br><span class=\"line\">        build.buildEngine();</span><br><span class=\"line\">        build.buildFrame();</span><br><span class=\"line\">        build.buildSteering();</span><br><span class=\"line\">        build.buildTire();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> build.getCar();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>经过他这一翻显摆之后,感觉虽然长的人摸狗样的,干起事来还真是一套一套的,哈哈哈哈!!</p>\n<p><img src=\"http://cdn.mjava.top/20191226174032.gif\" alt></p>\n<p>说完,还向我展示了汽车是怎样造成的………..</p>\n<p><img src=\"http://cdn.mjava.top/20191226174235.png\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>其实建造者模式和<font color=\"orange\">工厂模式</font>还是挺像的,<font color=\"orange\">建造者模式里的建造者就相当于工厂模式里的工厂</font>,不过建造者的核心是可以<font color=\"orange\">控制顺序</font>,比如上面的土豪老板可以控制建造工人的建造顺序,可以控制他们是先造轮胎还是先造发动机,这才是建造者模式意义;</p>\n<blockquote>\n<p>建造者模式如果和<font color=\"orange\">模板方法模式</font>搭配起来,<font color=\"orange\">建造工人那个类封装一个模板方法</font>开放给老板,老板就可以直接控制这个类就可以了,那这就和工厂模式没什么两样了</p>\n</blockquote>\n"},{"title":"Java8 Stream方法大全","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-10T01:53:34.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n![Stream](http://cdn.mjava.top/blog/java_8_stream.png)","source":"_posts/java/java-8-stream-method.md","raw":"---\ntitle: Java8 Stream方法大全\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-10 09:53:34\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Java\ncategories:\n- Java\n---\n\n![Stream](http://cdn.mjava.top/blog/java_8_stream.png)","slug":"java/java-8-stream-method","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bji000s2mg5b9xa3spq","content":"<p><img src=\"http://cdn.mjava.top/blog/java_8_stream.png\" alt=\"Stream\"></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p><img src=\"http://cdn.mjava.top/blog/java_8_stream.png\" alt=\"Stream\"></p>\n"},{"title":"设计模式系例-单例模式","top":true,"cover":false,"toc":true,"mathjax":true,"date":"2019-10-22T13:16:37.000Z","password":null,"summary":null,"_content":"\n   \n\n![](http://cdn.mjava.top/gof-singleton.jpg)\n\n> 积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬 \n\n\n\n## 前言\n\n网上说单例模式是所有模式中最简单的一种模式，巧的是我也这么认为。不过越简单的东西，往往坑就隐藏的越深，这边文章我会把我知道的几个坑所出来。\n\n\n\n## 一.什么是单例模式\n\n​    就如同他的名字一样，'单例'-就是只有一个实例。也就是说一个类在全局中最多只有一个实例存在，不能在多了，在多就不叫单例模式了。\n\n\n\n### 1.白话小故事\n\n​    程序员小H单身已久，每天不是对着电脑，就是抱着手机这样来维持生活。某日，坐在电脑前，突然感觉一切都索然无味。谋生想找一个对象来一起度过人生美好的每一天。\n\n​    于是精心打扮出门找对象，由于小H很帅，很快就找到了心仪的另一半--小K。小H的心中永远只有小K一个人，而且发誓永远不会在找新对象。\n\n> 小H和小K的关系就是单例模式，在小H的全局中只有一个小K对象，且无第二个，如果有第二个的话，他们之间的关系就出问题了。哈哈\n\n\n\n## 2.用在哪里\n\n​    单例模式一般用在对实例数量有严格要求的地方，比如数据池，线程池，缓存，session回话等等。\n\n\n\n## 3.在Java中构成的条件\n\n- 静态变量\n- 静态方法\n- 私有构造器\n\n## 二.单例模式的两种形态\n\n### 1.懒汉模式\n\n> 线程不安全\n\n```java\npublic class Singleton {\n\n    private static Singleton unsingleton;\n\n    private Singleton(){}\n\n    public static Singleton getInstance(){\n        if(unsingleton==null){\n            unsingleton=new Singleton();\n        }\n        return unsingleton;\n    }\n}\n```\n\n\n\n### 2.饿汉模式\n\n> 线程安全\n\n```java\npublic class Singleton {\n\n    private static Singleton unsingleton=new Singleton();\n\n    private Singleton(){}\n\n    public static Singleton getInstance(){\n        return unsingleton;\n    }\n}\n```\n\n\n\n#### 调用\n\n```java\npublic class Test {\n    public static void main(String[] args) {\n        Singleton singleton1=Singleton.getInstance();\n    }\n}\n```\n\n## 三.懒汉模式优化成线程安全\n\n  懒汉模式要变成线程安全的除了用饿汉模式之外，还有两种方法。\n\n### 1.加synchronized关键字\n\n> 此方法是最简单又有效的方法，不过对性能上会有所损失。比如两个线程同时调用这个实例，其中一个线程要等另一个线程调用完才可以继续调用。而线程不安全往往发生在这个实例在第一次调用的时候发生，当实例被调用一次后，线程是安全的，所以加synchronized就显得有些浪费性能。\n\n```java\npublic class Singleton {\n\n    private static Singleton unsingleton;\n\n    private Singleton(){}\n\n    public static synchronized Singleton getInstance(){\n        if(unsingleton==null){\n            unsingleton=new Singleton();\n        }\n        return unsingleton;\n    }\n}\n```\n\n### 2.用\"双重检查加锁\"\n\n> 上个方法说到，线程不安全往往发生在这个实例在第一次调用的时候发生，当实例被调用一次后，线程是安全的。那有没有方法只有在第一次调用的时候才用synchronized关键字，而第一次后就不用synchronized关键字呢？答案是当然有的，就是用volatile来修饰静态变量，保持其可见性。\n\n```java\npublic class Singleton {\n\n    private static volatile Singleton unsingleton;\n\n    private Singleton(){}\n\n    public static Singleton getInstance(){\n        if(unsingleton==null){\n            //只有当第一次访问的时候才会使用synchronized关键字\n            synchronized (Singleton.class){\n                unsingleton=new Singleton();\n            }\n        }\n        return unsingleton;\n    }\n}\n```\n\n\n\n## 三种线程安全的单例模式比较\n\n- 饿汉模式：性能好，写法简单，个人比较推荐用这个\n\n- 加synchronized关键字：性能差，不过对懒汉模式的盖章比较直接有效。\n\n- volatile-双重验证加锁：性能好，对Java版本有要求，要求Java5以上版本\n\n  ","source":"_posts/gof/gof-singleton.md","raw":"---\ntitle: 设计模式系例-单例模式\ntop: true\ncover: false\ntoc: true\nmathjax: true\ntags:\n  - GOF\n  - Singleton\ncategories:\n  - GOF\ndate: 2019-10-22 21:16:37\npassword:\nsummary:\n---\n\n   \n\n![](http://cdn.mjava.top/gof-singleton.jpg)\n\n> 积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬 \n\n\n\n## 前言\n\n网上说单例模式是所有模式中最简单的一种模式，巧的是我也这么认为。不过越简单的东西，往往坑就隐藏的越深，这边文章我会把我知道的几个坑所出来。\n\n\n\n## 一.什么是单例模式\n\n​    就如同他的名字一样，'单例'-就是只有一个实例。也就是说一个类在全局中最多只有一个实例存在，不能在多了，在多就不叫单例模式了。\n\n\n\n### 1.白话小故事\n\n​    程序员小H单身已久，每天不是对着电脑，就是抱着手机这样来维持生活。某日，坐在电脑前，突然感觉一切都索然无味。谋生想找一个对象来一起度过人生美好的每一天。\n\n​    于是精心打扮出门找对象，由于小H很帅，很快就找到了心仪的另一半--小K。小H的心中永远只有小K一个人，而且发誓永远不会在找新对象。\n\n> 小H和小K的关系就是单例模式，在小H的全局中只有一个小K对象，且无第二个，如果有第二个的话，他们之间的关系就出问题了。哈哈\n\n\n\n## 2.用在哪里\n\n​    单例模式一般用在对实例数量有严格要求的地方，比如数据池，线程池，缓存，session回话等等。\n\n\n\n## 3.在Java中构成的条件\n\n- 静态变量\n- 静态方法\n- 私有构造器\n\n## 二.单例模式的两种形态\n\n### 1.懒汉模式\n\n> 线程不安全\n\n```java\npublic class Singleton {\n\n    private static Singleton unsingleton;\n\n    private Singleton(){}\n\n    public static Singleton getInstance(){\n        if(unsingleton==null){\n            unsingleton=new Singleton();\n        }\n        return unsingleton;\n    }\n}\n```\n\n\n\n### 2.饿汉模式\n\n> 线程安全\n\n```java\npublic class Singleton {\n\n    private static Singleton unsingleton=new Singleton();\n\n    private Singleton(){}\n\n    public static Singleton getInstance(){\n        return unsingleton;\n    }\n}\n```\n\n\n\n#### 调用\n\n```java\npublic class Test {\n    public static void main(String[] args) {\n        Singleton singleton1=Singleton.getInstance();\n    }\n}\n```\n\n## 三.懒汉模式优化成线程安全\n\n  懒汉模式要变成线程安全的除了用饿汉模式之外，还有两种方法。\n\n### 1.加synchronized关键字\n\n> 此方法是最简单又有效的方法，不过对性能上会有所损失。比如两个线程同时调用这个实例，其中一个线程要等另一个线程调用完才可以继续调用。而线程不安全往往发生在这个实例在第一次调用的时候发生，当实例被调用一次后，线程是安全的，所以加synchronized就显得有些浪费性能。\n\n```java\npublic class Singleton {\n\n    private static Singleton unsingleton;\n\n    private Singleton(){}\n\n    public static synchronized Singleton getInstance(){\n        if(unsingleton==null){\n            unsingleton=new Singleton();\n        }\n        return unsingleton;\n    }\n}\n```\n\n### 2.用\"双重检查加锁\"\n\n> 上个方法说到，线程不安全往往发生在这个实例在第一次调用的时候发生，当实例被调用一次后，线程是安全的。那有没有方法只有在第一次调用的时候才用synchronized关键字，而第一次后就不用synchronized关键字呢？答案是当然有的，就是用volatile来修饰静态变量，保持其可见性。\n\n```java\npublic class Singleton {\n\n    private static volatile Singleton unsingleton;\n\n    private Singleton(){}\n\n    public static Singleton getInstance(){\n        if(unsingleton==null){\n            //只有当第一次访问的时候才会使用synchronized关键字\n            synchronized (Singleton.class){\n                unsingleton=new Singleton();\n            }\n        }\n        return unsingleton;\n    }\n}\n```\n\n\n\n## 三种线程安全的单例模式比较\n\n- 饿汉模式：性能好，写法简单，个人比较推荐用这个\n\n- 加synchronized关键字：性能差，不过对懒汉模式的盖章比较直接有效。\n\n- volatile-双重验证加锁：性能好，对Java版本有要求，要求Java5以上版本\n\n  ","slug":"gof/gof-singleton","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjj000w2mg5kv343q9p","content":"<p><img src=\"http://cdn.mjava.top/gof-singleton.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬 </p>\n</blockquote>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>网上说单例模式是所有模式中最简单的一种模式，巧的是我也这么认为。不过越简单的东西，往往坑就隐藏的越深，这边文章我会把我知道的几个坑所出来。</p>\n<h2 id=\"一-什么是单例模式\"><a href=\"#一-什么是单例模式\" class=\"headerlink\" title=\"一.什么是单例模式\"></a>一.什么是单例模式</h2><p>​    就如同他的名字一样，’单例’-就是只有一个实例。也就是说一个类在全局中最多只有一个实例存在，不能在多了，在多就不叫单例模式了。</p>\n<h3 id=\"1-白话小故事\"><a href=\"#1-白话小故事\" class=\"headerlink\" title=\"1.白话小故事\"></a>1.白话小故事</h3><p>​    程序员小H单身已久，每天不是对着电脑，就是抱着手机这样来维持生活。某日，坐在电脑前，突然感觉一切都索然无味。谋生想找一个对象来一起度过人生美好的每一天。</p>\n<p>​    于是精心打扮出门找对象，由于小H很帅，很快就找到了心仪的另一半–小K。小H的心中永远只有小K一个人，而且发誓永远不会在找新对象。</p>\n<blockquote>\n<p>小H和小K的关系就是单例模式，在小H的全局中只有一个小K对象，且无第二个，如果有第二个的话，他们之间的关系就出问题了。哈哈</p>\n</blockquote>\n<h2 id=\"2-用在哪里\"><a href=\"#2-用在哪里\" class=\"headerlink\" title=\"2.用在哪里\"></a>2.用在哪里</h2><p>​    单例模式一般用在对实例数量有严格要求的地方，比如数据池，线程池，缓存，session回话等等。</p>\n<h2 id=\"3-在Java中构成的条件\"><a href=\"#3-在Java中构成的条件\" class=\"headerlink\" title=\"3.在Java中构成的条件\"></a>3.在Java中构成的条件</h2><ul>\n<li>静态变量</li>\n<li>静态方法</li>\n<li>私有构造器</li>\n</ul>\n<h2 id=\"二-单例模式的两种形态\"><a href=\"#二-单例模式的两种形态\" class=\"headerlink\" title=\"二.单例模式的两种形态\"></a>二.单例模式的两种形态</h2><h3 id=\"1-懒汉模式\"><a href=\"#1-懒汉模式\" class=\"headerlink\" title=\"1.懒汉模式\"></a>1.懒汉模式</h3><blockquote>\n<p>线程不安全</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton unsingleton;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(unsingleton==<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            unsingleton=<span class=\"keyword\">new</span> Singleton();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> unsingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-饿汉模式\"><a href=\"#2-饿汉模式\" class=\"headerlink\" title=\"2.饿汉模式\"></a>2.饿汉模式</h3><blockquote>\n<p>线程安全</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton unsingleton=<span class=\"keyword\">new</span> Singleton();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> unsingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"调用\"><a href=\"#调用\" class=\"headerlink\" title=\"调用\"></a>调用</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Singleton singleton1=Singleton.getInstance();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"三-懒汉模式优化成线程安全\"><a href=\"#三-懒汉模式优化成线程安全\" class=\"headerlink\" title=\"三.懒汉模式优化成线程安全\"></a>三.懒汉模式优化成线程安全</h2><p>  懒汉模式要变成线程安全的除了用饿汉模式之外，还有两种方法。</p>\n<h3 id=\"1-加synchronized关键字\"><a href=\"#1-加synchronized关键字\" class=\"headerlink\" title=\"1.加synchronized关键字\"></a>1.加synchronized关键字</h3><blockquote>\n<p>此方法是最简单又有效的方法，不过对性能上会有所损失。比如两个线程同时调用这个实例，其中一个线程要等另一个线程调用完才可以继续调用。而线程不安全往往发生在这个实例在第一次调用的时候发生，当实例被调用一次后，线程是安全的，所以加synchronized就显得有些浪费性能。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton unsingleton;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(unsingleton==<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            unsingleton=<span class=\"keyword\">new</span> Singleton();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> unsingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-用”双重检查加锁”\"><a href=\"#2-用”双重检查加锁”\" class=\"headerlink\" title=\"2.用”双重检查加锁”\"></a>2.用”双重检查加锁”</h3><blockquote>\n<p>上个方法说到，线程不安全往往发生在这个实例在第一次调用的时候发生，当实例被调用一次后，线程是安全的。那有没有方法只有在第一次调用的时候才用synchronized关键字，而第一次后就不用synchronized关键字呢？答案是当然有的，就是用volatile来修饰静态变量，保持其可见性。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">volatile</span> Singleton unsingleton;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(unsingleton==<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//只有当第一次访问的时候才会使用synchronized关键字</span></span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (Singleton.class)&#123;</span><br><span class=\"line\">                unsingleton=<span class=\"keyword\">new</span> Singleton();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> unsingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"三种线程安全的单例模式比较\"><a href=\"#三种线程安全的单例模式比较\" class=\"headerlink\" title=\"三种线程安全的单例模式比较\"></a>三种线程安全的单例模式比较</h2><ul>\n<li><p>饿汉模式：性能好，写法简单，个人比较推荐用这个</p>\n</li>\n<li><p>加synchronized关键字：性能差，不过对懒汉模式的盖章比较直接有效。</p>\n</li>\n<li><p>volatile-双重验证加锁：性能好，对Java版本有要求，要求Java5以上版本</p>\n</li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p><img src=\"http://cdn.mjava.top/gof-singleton.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬 </p>\n</blockquote>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>网上说单例模式是所有模式中最简单的一种模式，巧的是我也这么认为。不过越简单的东西，往往坑就隐藏的越深，这边文章我会把我知道的几个坑所出来。</p>\n<h2 id=\"一-什么是单例模式\"><a href=\"#一-什么是单例模式\" class=\"headerlink\" title=\"一.什么是单例模式\"></a>一.什么是单例模式</h2><p>​    就如同他的名字一样，’单例’-就是只有一个实例。也就是说一个类在全局中最多只有一个实例存在，不能在多了，在多就不叫单例模式了。</p>\n<h3 id=\"1-白话小故事\"><a href=\"#1-白话小故事\" class=\"headerlink\" title=\"1.白话小故事\"></a>1.白话小故事</h3><p>​    程序员小H单身已久，每天不是对着电脑，就是抱着手机这样来维持生活。某日，坐在电脑前，突然感觉一切都索然无味。谋生想找一个对象来一起度过人生美好的每一天。</p>\n<p>​    于是精心打扮出门找对象，由于小H很帅，很快就找到了心仪的另一半–小K。小H的心中永远只有小K一个人，而且发誓永远不会在找新对象。</p>\n<blockquote>\n<p>小H和小K的关系就是单例模式，在小H的全局中只有一个小K对象，且无第二个，如果有第二个的话，他们之间的关系就出问题了。哈哈</p>\n</blockquote>\n<h2 id=\"2-用在哪里\"><a href=\"#2-用在哪里\" class=\"headerlink\" title=\"2.用在哪里\"></a>2.用在哪里</h2><p>​    单例模式一般用在对实例数量有严格要求的地方，比如数据池，线程池，缓存，session回话等等。</p>\n<h2 id=\"3-在Java中构成的条件\"><a href=\"#3-在Java中构成的条件\" class=\"headerlink\" title=\"3.在Java中构成的条件\"></a>3.在Java中构成的条件</h2><ul>\n<li>静态变量</li>\n<li>静态方法</li>\n<li>私有构造器</li>\n</ul>\n<h2 id=\"二-单例模式的两种形态\"><a href=\"#二-单例模式的两种形态\" class=\"headerlink\" title=\"二.单例模式的两种形态\"></a>二.单例模式的两种形态</h2><h3 id=\"1-懒汉模式\"><a href=\"#1-懒汉模式\" class=\"headerlink\" title=\"1.懒汉模式\"></a>1.懒汉模式</h3><blockquote>\n<p>线程不安全</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton unsingleton;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(unsingleton==<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            unsingleton=<span class=\"keyword\">new</span> Singleton();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> unsingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-饿汉模式\"><a href=\"#2-饿汉模式\" class=\"headerlink\" title=\"2.饿汉模式\"></a>2.饿汉模式</h3><blockquote>\n<p>线程安全</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton unsingleton=<span class=\"keyword\">new</span> Singleton();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> unsingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"调用\"><a href=\"#调用\" class=\"headerlink\" title=\"调用\"></a>调用</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        Singleton singleton1=Singleton.getInstance();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"三-懒汉模式优化成线程安全\"><a href=\"#三-懒汉模式优化成线程安全\" class=\"headerlink\" title=\"三.懒汉模式优化成线程安全\"></a>三.懒汉模式优化成线程安全</h2><p>  懒汉模式要变成线程安全的除了用饿汉模式之外，还有两种方法。</p>\n<h3 id=\"1-加synchronized关键字\"><a href=\"#1-加synchronized关键字\" class=\"headerlink\" title=\"1.加synchronized关键字\"></a>1.加synchronized关键字</h3><blockquote>\n<p>此方法是最简单又有效的方法，不过对性能上会有所损失。比如两个线程同时调用这个实例，其中一个线程要等另一个线程调用完才可以继续调用。而线程不安全往往发生在这个实例在第一次调用的时候发生，当实例被调用一次后，线程是安全的，所以加synchronized就显得有些浪费性能。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Singleton unsingleton;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">synchronized</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(unsingleton==<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            unsingleton=<span class=\"keyword\">new</span> Singleton();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> unsingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-用”双重检查加锁”\"><a href=\"#2-用”双重检查加锁”\" class=\"headerlink\" title=\"2.用”双重检查加锁”\"></a>2.用”双重检查加锁”</h3><blockquote>\n<p>上个方法说到，线程不安全往往发生在这个实例在第一次调用的时候发生，当实例被调用一次后，线程是安全的。那有没有方法只有在第一次调用的时候才用synchronized关键字，而第一次后就不用synchronized关键字呢？答案是当然有的，就是用volatile来修饰静态变量，保持其可见性。</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Singleton</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">volatile</span> Singleton unsingleton;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Singleton</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Singleton <span class=\"title\">getInstance</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(unsingleton==<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">            <span class=\"comment\">//只有当第一次访问的时候才会使用synchronized关键字</span></span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (Singleton.class)&#123;</span><br><span class=\"line\">                unsingleton=<span class=\"keyword\">new</span> Singleton();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> unsingleton;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"三种线程安全的单例模式比较\"><a href=\"#三种线程安全的单例模式比较\" class=\"headerlink\" title=\"三种线程安全的单例模式比较\"></a>三种线程安全的单例模式比较</h2><ul>\n<li><p>饿汉模式：性能好，写法简单，个人比较推荐用这个</p>\n</li>\n<li><p>加synchronized关键字：性能差，不过对懒汉模式的盖章比较直接有效。</p>\n</li>\n<li><p>volatile-双重验证加锁：性能好，对Java版本有要求，要求Java5以上版本</p>\n</li>\n</ul>\n"},{"title":"Dubbo的Telnet调试三部曲","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-02-05T06:04:54.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 第一步\n\n找到Dubbo服务的`IP地址`，比如我的Dubbo服务地址是`192.168.1.11`\n\n## 第二步\n\n使用命令连接Dubbo服务\n\n```shell\ntelnet 192.168.1.11 20880\n```\n\n## 第三步\n\n直接调试方法\n\n```shell\n# 调试TestService类下的get方法\ninvoke com.example.test.service.TestService.get(1132359)\n```\n\n## 资料\n\nhttps://dubbo.apache.org/zh/docs/v2.7/user/references/telnet/","source":"_posts/dubbo/dcf9d2d8-9c11-404a-874d-57834303dcac.md","raw":"---\ntitle: Dubbo的Telnet调试三部曲\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-02-05 14:04:54\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Dubbo\ncategories:\n- Dubbo\n---\n\n## 第一步\n\n找到Dubbo服务的`IP地址`，比如我的Dubbo服务地址是`192.168.1.11`\n\n## 第二步\n\n使用命令连接Dubbo服务\n\n```shell\ntelnet 192.168.1.11 20880\n```\n\n## 第三步\n\n直接调试方法\n\n```shell\n# 调试TestService类下的get方法\ninvoke com.example.test.service.TestService.get(1132359)\n```\n\n## 资料\n\nhttps://dubbo.apache.org/zh/docs/v2.7/user/references/telnet/","slug":"dubbo/dcf9d2d8-9c11-404a-874d-57834303dcac","published":1,"updated":"2021-02-05T06:06:57.827Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjk000y2mg5tt6s79bh","content":"<h2 id=\"第一步\"><a href=\"#第一步\" class=\"headerlink\" title=\"第一步\"></a>第一步</h2><p>找到Dubbo服务的<code>IP地址</code>，比如我的Dubbo服务地址是<code>192.168.1.11</code></p>\n<h2 id=\"第二步\"><a href=\"#第二步\" class=\"headerlink\" title=\"第二步\"></a>第二步</h2><p>使用命令连接Dubbo服务</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">telnet 192.168.1.11 20880</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"第三步\"><a href=\"#第三步\" class=\"headerlink\" title=\"第三步\"></a>第三步</h2><p>直接调试方法</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 调试TestService类下的get方法</span></span><br><span class=\"line\">invoke com.example.test.service.TestService.get(1132359)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"资料\"><a href=\"#资料\" class=\"headerlink\" title=\"资料\"></a>资料</h2><p><a href=\"https://dubbo.apache.org/zh/docs/v2.7/user/references/telnet/\" rel=\"noopener\" target=\"_blank\">https://dubbo.apache.org/zh/docs/v2.7/user/references/telnet/</a></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"第一步\"><a href=\"#第一步\" class=\"headerlink\" title=\"第一步\"></a>第一步</h2><p>找到Dubbo服务的<code>IP地址</code>，比如我的Dubbo服务地址是<code>192.168.1.11</code></p>\n<h2 id=\"第二步\"><a href=\"#第二步\" class=\"headerlink\" title=\"第二步\"></a>第二步</h2><p>使用命令连接Dubbo服务</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">telnet 192.168.1.11 20880</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"第三步\"><a href=\"#第三步\" class=\"headerlink\" title=\"第三步\"></a>第三步</h2><p>直接调试方法</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 调试TestService类下的get方法</span></span><br><span class=\"line\">invoke com.example.test.service.TestService.get(1132359)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"资料\"><a href=\"#资料\" class=\"headerlink\" title=\"资料\"></a>资料</h2><p><a href=\"https://dubbo.apache.org/zh/docs/v2.7/user/references/telnet/\" rel=\"noopener\" target=\"_blank\">https://dubbo.apache.org/zh/docs/v2.7/user/references/telnet/</a></p>\n"},{"title":"设计模式系列-模板方法模式","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-19T16:04:28.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n![](http://cdn.mjava.top/20191220000613.jpg)\n\n> 积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬\n\n\n\n## 文前常规发言\n\n　　模板方法的设计<font color=orange>符合迪米特法则</font>，也就是最少知道原则，他通过对一些重复方法的封装，减少类之间的耦合，让调用者也更省心，原来要调两三个方法才能实现的功能，现在调一个就可以了；就像我们伟大的祖国，现在也在推行这种模式呢．以前区办一些证明什么的，要跑三四个地方，还要保证这三四个地方都正常帮你办理，如果其中一个地方没办理，那么整个流程就都作废了．现在好了，提倡最多跑一次，只要去一个地方办<font color=orange>一次</font>手续就可以了，你只要知道这个地方能办好就行，其他的就不用烦心了；\n\n![](http://cdn.mjava.top/20191219215431.gif)\n\n## 阿狗卖电脑\n\n　　阿狗是一个三十五岁没了头发的年轻小伙，当问及为什么没了头发，阿狗摸摸头，眼里充满了悔恨的泪水；要不是小时候没听大人的话，长大了也不至于做程序员啊－－－阿狗唉声叹气的说道．听到这里，我仿佛已经知道了答案．当我问他为什么现在改行卖电脑了，他说外面的世界很大，想趁年轻，多闯闯（<font color=orange>实则是被公司裁员，被迫来卖电脑了</font>）；\n\n![](http://cdn.mjava.top/20191219220453.gif)\n\n看看他的电脑店里都有什么\n\n```java\n/**\n * 阿狗电脑店\n * */\nabstract class AGouShop {\n    /**\n     *显卡\n     * */\n    abstract void xianKa();\n    /**\n     *cpu\n     * */\n    abstract void cpu();\n    /**\n     *电源\n     * */\n    abstract void dianYuan();\n    /**\n     *主板\n     * */\n    abstract void zhuBan();\n    /**\n     *硬盘\n     * */\n    abstract void yingPan();\n    /**\n     *内存条\n     * */\n    abstract void neiCun();\n    /**\n     *机箱\n     * */\n    abstract void jiXiang();\n}\n```\n\n还不错，该有的都有了．当我们正在店里逛着时，来了两个顾客，<font color=orange>阿猫</font>和<font color=orange>大牛</font>，他们都来到阿狗店电脑店，挑选的电脑配件，准备组装电脑．\n\n\n\n看看阿猫：\n\n![](http://cdn.mjava.top/20191219222853.png)\n\n\n\n在看看大牛的：\n\n![](http://cdn.mjava.top/20191219222925.png)\n\n\n\n再看看他们怎么组装的吧：\n\n![](http://cdn.mjava.top/20191219223122.png)\n\n## 有想法的阿狗\n\n　　阿狗自从卖电脑后，发现头上的头发也慢慢的长了出来了，每天也更加自信了．一天，他发现客户有个痛点，就是买电脑要分别买好配件，然后再自己组装，有时候买的配件有问题，又要拿去换，导致费时费力．这时，阿狗头脑灵光一闪，想到了当年做程序员时的<font color=orange>模板方法模式</font>；何不把客户组装电脑的步骤自己承包，这样客户只要来买电脑时选下<font color=orange>配件</font>，我就帮他组装好给他．客户省心省力，到时候生意肯定好；于是他改造了他的电脑店：\n\n```java\n/**\n * 阿狗电脑店\n * */\nabstract class AGouShop {\n    /**\n     *显卡\n     * */\n    abstract void xianKa();\n    /**\n     *cpu\n     * */\n    abstract void cpu();\n    /**\n     *电源\n     * */\n    abstract void dianYuan();\n    /**\n     *主板\n     * */\n    abstract void zhuBan();\n    /**\n     *硬盘\n     * */\n    abstract void yingPan();\n    /**\n     *内存条\n     * */\n    abstract void neiCun();\n    /**\n     *机箱\n     * */\n    abstract void jiXiang();\n\n    /**\n     * 阿狗帮客户装电脑\n     * 模板方法\n     * */\n    public void zhuZHuang(){\n        System.out.println(\"阿狗开始组装电脑＝＝＝＝＝＝\");\n        this.cpu();\n        this.dianYuan();\n        this.neiCun();\n        this.xianKa();\n        this.yingPan();\n        this.zhuBan();\n        this.jiXiang();\n        System.out.println(\"阿狗电脑组装完成＝＝＝＝＝＝\");\n    }\n}\n```\n\n上次的阿猫又来买电脑了：\n\n![](http://cdn.mjava.top/20191219232821.png)\n\n看看结果：\n\n![](http://cdn.mjava.top/20191219232931.png)\n\n\n\n## 客户反馈\n\n　　阿狗按照上面的模式运行后，缺少增加了不少客户，可是有的顾客却反应说，为什么一定要我选显卡啊，我又不玩游戏，而且我买的cpu有核显，可以不要我选显卡嘛？阿狗一听，这是个问题啊，遵照客户就是上帝的原则(<font color=orange>有钱就赚原则</font>)，于是他又改了他店铺的模式：\n\n```java\n/**\n * 阿狗电脑店\n * */\nabstract class AGouShop {\n    /**\n     *　显卡\n     * ＂具体方法＂\n     * */\n    protected void xianKa(){\n        System.out.println(\"客户选了显卡\");\n    }\n    /**\n     * 是否要显卡　　默认是要显卡的\n     * ＂钩子方法＂\n     * */\n    public boolean isTrue(){\n        return true;\n    }\n    /**\n     *cpu\n     * */\n    abstract void cpu();\n    /**\n     *电源\n     * */\n    abstract void dianYuan();\n    /**\n     *主板\n     * */\n    abstract void zhuBan();\n    /**\n     *硬盘\n     * */\n    abstract void yingPan();\n    /**\n     *内存条\n     * */\n    abstract void neiCun();\n    /**\n     *机箱\n     * */\n    abstract void jiXiang();\n\n    /**\n     * 阿狗帮客户装电脑\n     * 模板方法\n     * */\n    public void zhuZHuang(){\n        System.out.println(\"阿狗开始组装电脑＝＝＝＝＝＝\");\n        this.cpu();\n        this.dianYuan();\n        this.neiCun();\n        //判断要不要显卡\n        if(this.isTrue()) {\n            this.xianKa();\n        }\n        this.yingPan();\n        this.zhuBan();\n        this.jiXiang();\n        System.out.println(\"阿狗电脑组装完成＝＝＝＝＝＝\");\n    }\n}\n```\n\n> 可以看到上加了<font color=orange>具体方法</font>和<font color=orange>钩子方法</font>\n\n上上次的阿猫和大牛，又双来买电脑了－－－－－有钱真好：\n\n阿猫默认要显卡：\n\n![](http://cdn.mjava.top/20191219234521.png)\n\n大牛不要显卡：![](http://cdn.mjava.top/20191219234630.png)\n\n看看他们的电脑吧：\n\n![](http://cdn.mjava.top/20191219234803.png)\n\n\n\n## 总结一下下\n\n  上面对比了阿牛的三种买电脑模式\n\n- 普通模式：自己只提供最基础的东西，所有的由客户自己去完成\n- 自己帮客户完成组装电脑：这里就用到了<font color=orange>模板方法模式</font>，通过对自身方法的封装，使客户买电脑更轻松了\n- 客户有选择显卡的权利：这里用到了<font color=orange>模板方法模式</font>中的<font color=orange>钩子方法</font>，通过客户暴露钩子方法，使其可以控制阿狗在装电脑是要不要装显卡这个步骤方法，<font color=orange>钩子方法</font>是<font color=orange>模板方法模式</font>的灵魂，有了它，这个模式才有更大的意义；","source":"_posts/gof/gof-taemplate-method.md","raw":"---\ntitle: 设计模式系列-模板方法模式\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-20 00:04:28\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- 设计模式\n- 模板方法模式\ncategories:\n- GOF\n---\n\n![](http://cdn.mjava.top/20191220000613.jpg)\n\n> 积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬\n\n\n\n## 文前常规发言\n\n　　模板方法的设计<font color=orange>符合迪米特法则</font>，也就是最少知道原则，他通过对一些重复方法的封装，减少类之间的耦合，让调用者也更省心，原来要调两三个方法才能实现的功能，现在调一个就可以了；就像我们伟大的祖国，现在也在推行这种模式呢．以前区办一些证明什么的，要跑三四个地方，还要保证这三四个地方都正常帮你办理，如果其中一个地方没办理，那么整个流程就都作废了．现在好了，提倡最多跑一次，只要去一个地方办<font color=orange>一次</font>手续就可以了，你只要知道这个地方能办好就行，其他的就不用烦心了；\n\n![](http://cdn.mjava.top/20191219215431.gif)\n\n## 阿狗卖电脑\n\n　　阿狗是一个三十五岁没了头发的年轻小伙，当问及为什么没了头发，阿狗摸摸头，眼里充满了悔恨的泪水；要不是小时候没听大人的话，长大了也不至于做程序员啊－－－阿狗唉声叹气的说道．听到这里，我仿佛已经知道了答案．当我问他为什么现在改行卖电脑了，他说外面的世界很大，想趁年轻，多闯闯（<font color=orange>实则是被公司裁员，被迫来卖电脑了</font>）；\n\n![](http://cdn.mjava.top/20191219220453.gif)\n\n看看他的电脑店里都有什么\n\n```java\n/**\n * 阿狗电脑店\n * */\nabstract class AGouShop {\n    /**\n     *显卡\n     * */\n    abstract void xianKa();\n    /**\n     *cpu\n     * */\n    abstract void cpu();\n    /**\n     *电源\n     * */\n    abstract void dianYuan();\n    /**\n     *主板\n     * */\n    abstract void zhuBan();\n    /**\n     *硬盘\n     * */\n    abstract void yingPan();\n    /**\n     *内存条\n     * */\n    abstract void neiCun();\n    /**\n     *机箱\n     * */\n    abstract void jiXiang();\n}\n```\n\n还不错，该有的都有了．当我们正在店里逛着时，来了两个顾客，<font color=orange>阿猫</font>和<font color=orange>大牛</font>，他们都来到阿狗店电脑店，挑选的电脑配件，准备组装电脑．\n\n\n\n看看阿猫：\n\n![](http://cdn.mjava.top/20191219222853.png)\n\n\n\n在看看大牛的：\n\n![](http://cdn.mjava.top/20191219222925.png)\n\n\n\n再看看他们怎么组装的吧：\n\n![](http://cdn.mjava.top/20191219223122.png)\n\n## 有想法的阿狗\n\n　　阿狗自从卖电脑后，发现头上的头发也慢慢的长了出来了，每天也更加自信了．一天，他发现客户有个痛点，就是买电脑要分别买好配件，然后再自己组装，有时候买的配件有问题，又要拿去换，导致费时费力．这时，阿狗头脑灵光一闪，想到了当年做程序员时的<font color=orange>模板方法模式</font>；何不把客户组装电脑的步骤自己承包，这样客户只要来买电脑时选下<font color=orange>配件</font>，我就帮他组装好给他．客户省心省力，到时候生意肯定好；于是他改造了他的电脑店：\n\n```java\n/**\n * 阿狗电脑店\n * */\nabstract class AGouShop {\n    /**\n     *显卡\n     * */\n    abstract void xianKa();\n    /**\n     *cpu\n     * */\n    abstract void cpu();\n    /**\n     *电源\n     * */\n    abstract void dianYuan();\n    /**\n     *主板\n     * */\n    abstract void zhuBan();\n    /**\n     *硬盘\n     * */\n    abstract void yingPan();\n    /**\n     *内存条\n     * */\n    abstract void neiCun();\n    /**\n     *机箱\n     * */\n    abstract void jiXiang();\n\n    /**\n     * 阿狗帮客户装电脑\n     * 模板方法\n     * */\n    public void zhuZHuang(){\n        System.out.println(\"阿狗开始组装电脑＝＝＝＝＝＝\");\n        this.cpu();\n        this.dianYuan();\n        this.neiCun();\n        this.xianKa();\n        this.yingPan();\n        this.zhuBan();\n        this.jiXiang();\n        System.out.println(\"阿狗电脑组装完成＝＝＝＝＝＝\");\n    }\n}\n```\n\n上次的阿猫又来买电脑了：\n\n![](http://cdn.mjava.top/20191219232821.png)\n\n看看结果：\n\n![](http://cdn.mjava.top/20191219232931.png)\n\n\n\n## 客户反馈\n\n　　阿狗按照上面的模式运行后，缺少增加了不少客户，可是有的顾客却反应说，为什么一定要我选显卡啊，我又不玩游戏，而且我买的cpu有核显，可以不要我选显卡嘛？阿狗一听，这是个问题啊，遵照客户就是上帝的原则(<font color=orange>有钱就赚原则</font>)，于是他又改了他店铺的模式：\n\n```java\n/**\n * 阿狗电脑店\n * */\nabstract class AGouShop {\n    /**\n     *　显卡\n     * ＂具体方法＂\n     * */\n    protected void xianKa(){\n        System.out.println(\"客户选了显卡\");\n    }\n    /**\n     * 是否要显卡　　默认是要显卡的\n     * ＂钩子方法＂\n     * */\n    public boolean isTrue(){\n        return true;\n    }\n    /**\n     *cpu\n     * */\n    abstract void cpu();\n    /**\n     *电源\n     * */\n    abstract void dianYuan();\n    /**\n     *主板\n     * */\n    abstract void zhuBan();\n    /**\n     *硬盘\n     * */\n    abstract void yingPan();\n    /**\n     *内存条\n     * */\n    abstract void neiCun();\n    /**\n     *机箱\n     * */\n    abstract void jiXiang();\n\n    /**\n     * 阿狗帮客户装电脑\n     * 模板方法\n     * */\n    public void zhuZHuang(){\n        System.out.println(\"阿狗开始组装电脑＝＝＝＝＝＝\");\n        this.cpu();\n        this.dianYuan();\n        this.neiCun();\n        //判断要不要显卡\n        if(this.isTrue()) {\n            this.xianKa();\n        }\n        this.yingPan();\n        this.zhuBan();\n        this.jiXiang();\n        System.out.println(\"阿狗电脑组装完成＝＝＝＝＝＝\");\n    }\n}\n```\n\n> 可以看到上加了<font color=orange>具体方法</font>和<font color=orange>钩子方法</font>\n\n上上次的阿猫和大牛，又双来买电脑了－－－－－有钱真好：\n\n阿猫默认要显卡：\n\n![](http://cdn.mjava.top/20191219234521.png)\n\n大牛不要显卡：![](http://cdn.mjava.top/20191219234630.png)\n\n看看他们的电脑吧：\n\n![](http://cdn.mjava.top/20191219234803.png)\n\n\n\n## 总结一下下\n\n  上面对比了阿牛的三种买电脑模式\n\n- 普通模式：自己只提供最基础的东西，所有的由客户自己去完成\n- 自己帮客户完成组装电脑：这里就用到了<font color=orange>模板方法模式</font>，通过对自身方法的封装，使客户买电脑更轻松了\n- 客户有选择显卡的权利：这里用到了<font color=orange>模板方法模式</font>中的<font color=orange>钩子方法</font>，通过客户暴露钩子方法，使其可以控制阿狗在装电脑是要不要装显卡这个步骤方法，<font color=orange>钩子方法</font>是<font color=orange>模板方法模式</font>的灵魂，有了它，这个模式才有更大的意义；","slug":"gof/gof-taemplate-method","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjl00122mg5g432fihm","content":"<p><img src=\"http://cdn.mjava.top/20191220000613.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"文前常规发言\"><a href=\"#文前常规发言\" class=\"headerlink\" title=\"文前常规发言\"></a>文前常规发言</h2><p>　　模板方法的设计<font color=\"orange\">符合迪米特法则</font>，也就是最少知道原则，他通过对一些重复方法的封装，减少类之间的耦合，让调用者也更省心，原来要调两三个方法才能实现的功能，现在调一个就可以了；就像我们伟大的祖国，现在也在推行这种模式呢．以前区办一些证明什么的，要跑三四个地方，还要保证这三四个地方都正常帮你办理，如果其中一个地方没办理，那么整个流程就都作废了．现在好了，提倡最多跑一次，只要去一个地方办<font color=\"orange\">一次</font>手续就可以了，你只要知道这个地方能办好就行，其他的就不用烦心了；</p>\n<p><img src=\"http://cdn.mjava.top/20191219215431.gif\" alt></p>\n<h2 id=\"阿狗卖电脑\"><a href=\"#阿狗卖电脑\" class=\"headerlink\" title=\"阿狗卖电脑\"></a>阿狗卖电脑</h2><p>　　阿狗是一个三十五岁没了头发的年轻小伙，当问及为什么没了头发，阿狗摸摸头，眼里充满了悔恨的泪水；要不是小时候没听大人的话，长大了也不至于做程序员啊－－－阿狗唉声叹气的说道．听到这里，我仿佛已经知道了答案．当我问他为什么现在改行卖电脑了，他说外面的世界很大，想趁年轻，多闯闯（<font color=\"orange\">实则是被公司裁员，被迫来卖电脑了</font>）；</p>\n<p><img src=\"http://cdn.mjava.top/20191219220453.gif\" alt></p>\n<p>看看他的电脑店里都有什么</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 阿狗电脑店</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AGouShop</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *显卡</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">xianKa</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *cpu</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">cpu</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *电源</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">dianYuan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *主板</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">zhuBan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *硬盘</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">yingPan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *内存条</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">neiCun</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *机箱</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">jiXiang</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>还不错，该有的都有了．当我们正在店里逛着时，来了两个顾客，<font color=\"orange\">阿猫</font>和<font color=\"orange\">大牛</font>，他们都来到阿狗店电脑店，挑选的电脑配件，准备组装电脑．</p>\n<p>看看阿猫：</p>\n<p><img src=\"http://cdn.mjava.top/20191219222853.png\" alt></p>\n<p>在看看大牛的：</p>\n<p><img src=\"http://cdn.mjava.top/20191219222925.png\" alt></p>\n<p>再看看他们怎么组装的吧：</p>\n<p><img src=\"http://cdn.mjava.top/20191219223122.png\" alt></p>\n<h2 id=\"有想法的阿狗\"><a href=\"#有想法的阿狗\" class=\"headerlink\" title=\"有想法的阿狗\"></a>有想法的阿狗</h2><p>　　阿狗自从卖电脑后，发现头上的头发也慢慢的长了出来了，每天也更加自信了．一天，他发现客户有个痛点，就是买电脑要分别买好配件，然后再自己组装，有时候买的配件有问题，又要拿去换，导致费时费力．这时，阿狗头脑灵光一闪，想到了当年做程序员时的<font color=\"orange\">模板方法模式</font>；何不把客户组装电脑的步骤自己承包，这样客户只要来买电脑时选下<font color=\"orange\">配件</font>，我就帮他组装好给他．客户省心省力，到时候生意肯定好；于是他改造了他的电脑店：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 阿狗电脑店</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AGouShop</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *显卡</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">xianKa</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *cpu</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">cpu</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *电源</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">dianYuan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *主板</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">zhuBan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *硬盘</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">yingPan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *内存条</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">neiCun</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *机箱</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">jiXiang</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 阿狗帮客户装电脑</span></span><br><span class=\"line\"><span class=\"comment\">     * 模板方法</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">zhuZHuang</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"阿狗开始组装电脑＝＝＝＝＝＝\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.cpu();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.dianYuan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.neiCun();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.xianKa();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.yingPan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.zhuBan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.jiXiang();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"阿狗电脑组装完成＝＝＝＝＝＝\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>上次的阿猫又来买电脑了：</p>\n<p><img src=\"http://cdn.mjava.top/20191219232821.png\" alt></p>\n<p>看看结果：</p>\n<p><img src=\"http://cdn.mjava.top/20191219232931.png\" alt></p>\n<h2 id=\"客户反馈\"><a href=\"#客户反馈\" class=\"headerlink\" title=\"客户反馈\"></a>客户反馈</h2><p>　　阿狗按照上面的模式运行后，缺少增加了不少客户，可是有的顾客却反应说，为什么一定要我选显卡啊，我又不玩游戏，而且我买的cpu有核显，可以不要我选显卡嘛？阿狗一听，这是个问题啊，遵照客户就是上帝的原则(<font color=\"orange\">有钱就赚原则</font>)，于是他又改了他店铺的模式：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 阿狗电脑店</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AGouShop</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *　显卡</span></span><br><span class=\"line\"><span class=\"comment\">     * ＂具体方法＂</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">xianKa</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"客户选了显卡\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 是否要显卡　　默认是要显卡的</span></span><br><span class=\"line\"><span class=\"comment\">     * ＂钩子方法＂</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isTrue</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *cpu</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">cpu</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *电源</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">dianYuan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *主板</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">zhuBan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *硬盘</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">yingPan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *内存条</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">neiCun</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *机箱</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">jiXiang</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 阿狗帮客户装电脑</span></span><br><span class=\"line\"><span class=\"comment\">     * 模板方法</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">zhuZHuang</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"阿狗开始组装电脑＝＝＝＝＝＝\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.cpu();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.dianYuan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.neiCun();</span><br><span class=\"line\">        <span class=\"comment\">//判断要不要显卡</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">this</span>.isTrue()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.xianKa();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.yingPan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.zhuBan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.jiXiang();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"阿狗电脑组装完成＝＝＝＝＝＝\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>可以看到上加了<font color=\"orange\">具体方法</font>和<font color=\"orange\">钩子方法</font></p>\n</blockquote>\n<p>上上次的阿猫和大牛，又双来买电脑了－－－－－有钱真好：</p>\n<p>阿猫默认要显卡：</p>\n<p><img src=\"http://cdn.mjava.top/20191219234521.png\" alt></p>\n<p>大牛不要显卡：<img src=\"http://cdn.mjava.top/20191219234630.png\" alt></p>\n<p>看看他们的电脑吧：</p>\n<p><img src=\"http://cdn.mjava.top/20191219234803.png\" alt></p>\n<h2 id=\"总结一下下\"><a href=\"#总结一下下\" class=\"headerlink\" title=\"总结一下下\"></a>总结一下下</h2><p>  上面对比了阿牛的三种买电脑模式</p>\n<ul>\n<li>普通模式：自己只提供最基础的东西，所有的由客户自己去完成</li>\n<li>自己帮客户完成组装电脑：这里就用到了<font color=\"orange\">模板方法模式</font>，通过对自身方法的封装，使客户买电脑更轻松了</li>\n<li>客户有选择显卡的权利：这里用到了<font color=\"orange\">模板方法模式</font>中的<font color=\"orange\">钩子方法</font>，通过客户暴露钩子方法，使其可以控制阿狗在装电脑是要不要装显卡这个步骤方法，<font color=\"orange\">钩子方法</font>是<font color=\"orange\">模板方法模式</font>的灵魂，有了它，这个模式才有更大的意义；</li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p><img src=\"http://cdn.mjava.top/20191220000613.jpg\" alt></p>\n<blockquote>\n<p>积千里跬步，汇万里江河．每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"文前常规发言\"><a href=\"#文前常规发言\" class=\"headerlink\" title=\"文前常规发言\"></a>文前常规发言</h2><p>　　模板方法的设计<font color=\"orange\">符合迪米特法则</font>，也就是最少知道原则，他通过对一些重复方法的封装，减少类之间的耦合，让调用者也更省心，原来要调两三个方法才能实现的功能，现在调一个就可以了；就像我们伟大的祖国，现在也在推行这种模式呢．以前区办一些证明什么的，要跑三四个地方，还要保证这三四个地方都正常帮你办理，如果其中一个地方没办理，那么整个流程就都作废了．现在好了，提倡最多跑一次，只要去一个地方办<font color=\"orange\">一次</font>手续就可以了，你只要知道这个地方能办好就行，其他的就不用烦心了；</p>\n<p><img src=\"http://cdn.mjava.top/20191219215431.gif\" alt></p>\n<h2 id=\"阿狗卖电脑\"><a href=\"#阿狗卖电脑\" class=\"headerlink\" title=\"阿狗卖电脑\"></a>阿狗卖电脑</h2><p>　　阿狗是一个三十五岁没了头发的年轻小伙，当问及为什么没了头发，阿狗摸摸头，眼里充满了悔恨的泪水；要不是小时候没听大人的话，长大了也不至于做程序员啊－－－阿狗唉声叹气的说道．听到这里，我仿佛已经知道了答案．当我问他为什么现在改行卖电脑了，他说外面的世界很大，想趁年轻，多闯闯（<font color=\"orange\">实则是被公司裁员，被迫来卖电脑了</font>）；</p>\n<p><img src=\"http://cdn.mjava.top/20191219220453.gif\" alt></p>\n<p>看看他的电脑店里都有什么</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 阿狗电脑店</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AGouShop</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *显卡</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">xianKa</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *cpu</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">cpu</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *电源</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">dianYuan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *主板</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">zhuBan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *硬盘</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">yingPan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *内存条</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">neiCun</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *机箱</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">jiXiang</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>还不错，该有的都有了．当我们正在店里逛着时，来了两个顾客，<font color=\"orange\">阿猫</font>和<font color=\"orange\">大牛</font>，他们都来到阿狗店电脑店，挑选的电脑配件，准备组装电脑．</p>\n<p>看看阿猫：</p>\n<p><img src=\"http://cdn.mjava.top/20191219222853.png\" alt></p>\n<p>在看看大牛的：</p>\n<p><img src=\"http://cdn.mjava.top/20191219222925.png\" alt></p>\n<p>再看看他们怎么组装的吧：</p>\n<p><img src=\"http://cdn.mjava.top/20191219223122.png\" alt></p>\n<h2 id=\"有想法的阿狗\"><a href=\"#有想法的阿狗\" class=\"headerlink\" title=\"有想法的阿狗\"></a>有想法的阿狗</h2><p>　　阿狗自从卖电脑后，发现头上的头发也慢慢的长了出来了，每天也更加自信了．一天，他发现客户有个痛点，就是买电脑要分别买好配件，然后再自己组装，有时候买的配件有问题，又要拿去换，导致费时费力．这时，阿狗头脑灵光一闪，想到了当年做程序员时的<font color=\"orange\">模板方法模式</font>；何不把客户组装电脑的步骤自己承包，这样客户只要来买电脑时选下<font color=\"orange\">配件</font>，我就帮他组装好给他．客户省心省力，到时候生意肯定好；于是他改造了他的电脑店：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 阿狗电脑店</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AGouShop</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *显卡</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">xianKa</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *cpu</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">cpu</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *电源</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">dianYuan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *主板</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">zhuBan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *硬盘</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">yingPan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *内存条</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">neiCun</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *机箱</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">jiXiang</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 阿狗帮客户装电脑</span></span><br><span class=\"line\"><span class=\"comment\">     * 模板方法</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">zhuZHuang</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"阿狗开始组装电脑＝＝＝＝＝＝\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.cpu();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.dianYuan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.neiCun();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.xianKa();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.yingPan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.zhuBan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.jiXiang();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"阿狗电脑组装完成＝＝＝＝＝＝\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>上次的阿猫又来买电脑了：</p>\n<p><img src=\"http://cdn.mjava.top/20191219232821.png\" alt></p>\n<p>看看结果：</p>\n<p><img src=\"http://cdn.mjava.top/20191219232931.png\" alt></p>\n<h2 id=\"客户反馈\"><a href=\"#客户反馈\" class=\"headerlink\" title=\"客户反馈\"></a>客户反馈</h2><p>　　阿狗按照上面的模式运行后，缺少增加了不少客户，可是有的顾客却反应说，为什么一定要我选显卡啊，我又不玩游戏，而且我买的cpu有核显，可以不要我选显卡嘛？阿狗一听，这是个问题啊，遵照客户就是上帝的原则(<font color=\"orange\">有钱就赚原则</font>)，于是他又改了他店铺的模式：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * 阿狗电脑店</span></span><br><span class=\"line\"><span class=\"comment\"> * */</span></span><br><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AGouShop</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *　显卡</span></span><br><span class=\"line\"><span class=\"comment\">     * ＂具体方法＂</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">xianKa</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"客户选了显卡\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 是否要显卡　　默认是要显卡的</span></span><br><span class=\"line\"><span class=\"comment\">     * ＂钩子方法＂</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isTrue</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *cpu</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">cpu</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *电源</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">dianYuan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *主板</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">zhuBan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *硬盘</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">yingPan</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *内存条</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">neiCun</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *机箱</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">jiXiang</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 阿狗帮客户装电脑</span></span><br><span class=\"line\"><span class=\"comment\">     * 模板方法</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">zhuZHuang</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"阿狗开始组装电脑＝＝＝＝＝＝\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.cpu();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.dianYuan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.neiCun();</span><br><span class=\"line\">        <span class=\"comment\">//判断要不要显卡</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"keyword\">this</span>.isTrue()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.xianKa();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.yingPan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.zhuBan();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.jiXiang();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"阿狗电脑组装完成＝＝＝＝＝＝\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>可以看到上加了<font color=\"orange\">具体方法</font>和<font color=\"orange\">钩子方法</font></p>\n</blockquote>\n<p>上上次的阿猫和大牛，又双来买电脑了－－－－－有钱真好：</p>\n<p>阿猫默认要显卡：</p>\n<p><img src=\"http://cdn.mjava.top/20191219234521.png\" alt></p>\n<p>大牛不要显卡：<img src=\"http://cdn.mjava.top/20191219234630.png\" alt></p>\n<p>看看他们的电脑吧：</p>\n<p><img src=\"http://cdn.mjava.top/20191219234803.png\" alt></p>\n<h2 id=\"总结一下下\"><a href=\"#总结一下下\" class=\"headerlink\" title=\"总结一下下\"></a>总结一下下</h2><p>  上面对比了阿牛的三种买电脑模式</p>\n<ul>\n<li>普通模式：自己只提供最基础的东西，所有的由客户自己去完成</li>\n<li>自己帮客户完成组装电脑：这里就用到了<font color=\"orange\">模板方法模式</font>，通过对自身方法的封装，使客户买电脑更轻松了</li>\n<li>客户有选择显卡的权利：这里用到了<font color=\"orange\">模板方法模式</font>中的<font color=\"orange\">钩子方法</font>，通过客户暴露钩子方法，使其可以控制阿狗在装电脑是要不要装显卡这个步骤方法，<font color=\"orange\">钩子方法</font>是<font color=\"orange\">模板方法模式</font>的灵魂，有了它，这个模式才有更大的意义；</li>\n</ul>\n"},{"title":"Java数组的几种初始化方式","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-09T02:22:12.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n## 一维数组\n\n### 初始化容量\n\n```java\n/**\n* 定义容量为5,初始值为0的int一维数组\n*/\nint array[]=new int[5];\nint[] array2=new int[5];\n```\n\n### 初始化值\n\n```java\n/**\n* 初始化一维容量为5的一维数组的值\n*/\nint[] array10={1,2,3,4,5};\nint aray12[]={1,2,3,4,5};\n```\n\n\n\n\n\n## 二维数组\n\n> 二维数组初始化时必须要声明行数,列数可随意 \n\n\n### 初始化容量\n- 声明了列数的\n\n\n\n```java\n/**\n* 初始化一个5行5列的二维数组\n*/\nint[][] array3=new int[5][5];\nint []array4[]=new int[5][5];\nint array5[][]=new int[5][5];\n```\n\n\n-  未声明列数的\n\n\n\n> 此种方法初始化后如果要赋值的话要new一个数组,如果按照常规的方法赋值然后取值会报空指针异常\n```java\n/**\n* 初始化一个5行空列的二维数组\n*/\nint[][] array6=new int[5][];\nint []arra7[]=new int[5][];\nint array8[][]=new int[5][];\n```\n ```java\n/**\n* 赋值方法\n*/\nint[][] array6=new int[5][];\narray6[0]=new int[]{1,2,3};\nSystem.out.println(array6[0][0]);\n\n//输出:1\n ```\n\n\n#### 初始化值\n\n```java\n/**\n* 初始化并赋值一个2行3列的二维数组\n*/\nint[][] array13={{1,2,3},{4,5,6}};\nint []array14[]={{1,2,3},{4,5,6}};\nint array15[][]={{1,2,3},{4,5,6}};\n```\n\n\n\n## 总结\n\n​    其他像什么三维数组,多维数组初始化的方式都差不多,可以自己在IDE工具中试一下;","source":"_posts/java/java-array-init.md","raw":"---\ntitle: Java数组的几种初始化方式\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-09 10:22:12\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Java\ncategories:\n- Java\n---\n\n\n\n## 一维数组\n\n### 初始化容量\n\n```java\n/**\n* 定义容量为5,初始值为0的int一维数组\n*/\nint array[]=new int[5];\nint[] array2=new int[5];\n```\n\n### 初始化值\n\n```java\n/**\n* 初始化一维容量为5的一维数组的值\n*/\nint[] array10={1,2,3,4,5};\nint aray12[]={1,2,3,4,5};\n```\n\n\n\n\n\n## 二维数组\n\n> 二维数组初始化时必须要声明行数,列数可随意 \n\n\n### 初始化容量\n- 声明了列数的\n\n\n\n```java\n/**\n* 初始化一个5行5列的二维数组\n*/\nint[][] array3=new int[5][5];\nint []array4[]=new int[5][5];\nint array5[][]=new int[5][5];\n```\n\n\n-  未声明列数的\n\n\n\n> 此种方法初始化后如果要赋值的话要new一个数组,如果按照常规的方法赋值然后取值会报空指针异常\n```java\n/**\n* 初始化一个5行空列的二维数组\n*/\nint[][] array6=new int[5][];\nint []arra7[]=new int[5][];\nint array8[][]=new int[5][];\n```\n ```java\n/**\n* 赋值方法\n*/\nint[][] array6=new int[5][];\narray6[0]=new int[]{1,2,3};\nSystem.out.println(array6[0][0]);\n\n//输出:1\n ```\n\n\n#### 初始化值\n\n```java\n/**\n* 初始化并赋值一个2行3列的二维数组\n*/\nint[][] array13={{1,2,3},{4,5,6}};\nint []array14[]={{1,2,3},{4,5,6}};\nint array15[][]={{1,2,3},{4,5,6}};\n```\n\n\n\n## 总结\n\n​    其他像什么三维数组,多维数组初始化的方式都差不多,可以自己在IDE工具中试一下;","slug":"java/java-array-init","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjn00152mg53ydwdemy","content":"<h2 id=\"一维数组\"><a href=\"#一维数组\" class=\"headerlink\" title=\"一维数组\"></a>一维数组</h2><h3 id=\"初始化容量\"><a href=\"#初始化容量\" class=\"headerlink\" title=\"初始化容量\"></a>初始化容量</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 定义容量为5,初始值为0的int一维数组</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> array[]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span>[] array2=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>];</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"初始化值\"><a href=\"#初始化值\" class=\"headerlink\" title=\"初始化值\"></a>初始化值</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 初始化一维容量为5的一维数组的值</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>[] array10=&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>&#125;;</span><br><span class=\"line\"><span class=\"keyword\">int</span> aray12[]=&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>&#125;;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"二维数组\"><a href=\"#二维数组\" class=\"headerlink\" title=\"二维数组\"></a>二维数组</h2><blockquote>\n<p>二维数组初始化时必须要声明行数,列数可随意 </p>\n</blockquote>\n<h3 id=\"初始化容量-1\"><a href=\"#初始化容量-1\" class=\"headerlink\" title=\"初始化容量\"></a>初始化容量</h3><ul>\n<li>声明了列数的</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 初始化一个5行5列的二维数组</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>[][] array3=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][<span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> []array4[]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][<span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> array5[][]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][<span class=\"number\">5</span>];</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>未声明列数的</li>\n</ul>\n<blockquote>\n<p>此种方法初始化后如果要赋值的话要new一个数组,如果按照常规的方法赋值然后取值会报空指针异常</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 初始化一个5行空列的二维数组</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>[][] array6=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][];</span><br><span class=\"line\"><span class=\"keyword\">int</span> []arra7[]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][];</span><br><span class=\"line\"><span class=\"keyword\">int</span> array8[][]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][];</span><br></pre></td></tr></table></figure>\n\n <figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 赋值方法</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>[][] array6=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][];</span><br><span class=\"line\">array6[<span class=\"number\">0</span>]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[]&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>&#125;;</span><br><span class=\"line\">System.out.println(array6[<span class=\"number\">0</span>][<span class=\"number\">0</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//输出:1</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"初始化值-1\"><a href=\"#初始化值-1\" class=\"headerlink\" title=\"初始化值\"></a>初始化值</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 初始化并赋值一个2行3列的二维数组</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>[][] array13=&#123;&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>&#125;,&#123;<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>&#125;&#125;;</span><br><span class=\"line\"><span class=\"keyword\">int</span> []array14[]=&#123;&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>&#125;,&#123;<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>&#125;&#125;;</span><br><span class=\"line\"><span class=\"keyword\">int</span> array15[][]=&#123;&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>&#125;,&#123;<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>&#125;&#125;;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>​    其他像什么三维数组,多维数组初始化的方式都差不多,可以自己在IDE工具中试一下;</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"一维数组\"><a href=\"#一维数组\" class=\"headerlink\" title=\"一维数组\"></a>一维数组</h2><h3 id=\"初始化容量\"><a href=\"#初始化容量\" class=\"headerlink\" title=\"初始化容量\"></a>初始化容量</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 定义容量为5,初始值为0的int一维数组</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> array[]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span>[] array2=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>];</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"初始化值\"><a href=\"#初始化值\" class=\"headerlink\" title=\"初始化值\"></a>初始化值</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 初始化一维容量为5的一维数组的值</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>[] array10=&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>&#125;;</span><br><span class=\"line\"><span class=\"keyword\">int</span> aray12[]=&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>&#125;;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"二维数组\"><a href=\"#二维数组\" class=\"headerlink\" title=\"二维数组\"></a>二维数组</h2><blockquote>\n<p>二维数组初始化时必须要声明行数,列数可随意 </p>\n</blockquote>\n<h3 id=\"初始化容量-1\"><a href=\"#初始化容量-1\" class=\"headerlink\" title=\"初始化容量\"></a>初始化容量</h3><ul>\n<li>声明了列数的</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 初始化一个5行5列的二维数组</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>[][] array3=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][<span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> []array4[]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][<span class=\"number\">5</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> array5[][]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][<span class=\"number\">5</span>];</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>未声明列数的</li>\n</ul>\n<blockquote>\n<p>此种方法初始化后如果要赋值的话要new一个数组,如果按照常规的方法赋值然后取值会报空指针异常</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 初始化一个5行空列的二维数组</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>[][] array6=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][];</span><br><span class=\"line\"><span class=\"keyword\">int</span> []arra7[]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][];</span><br><span class=\"line\"><span class=\"keyword\">int</span> array8[][]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][];</span><br></pre></td></tr></table></figure>\n\n <figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 赋值方法</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>[][] array6=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[<span class=\"number\">5</span>][];</span><br><span class=\"line\">array6[<span class=\"number\">0</span>]=<span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[]&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>&#125;;</span><br><span class=\"line\">System.out.println(array6[<span class=\"number\">0</span>][<span class=\"number\">0</span>]);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//输出:1</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"初始化值-1\"><a href=\"#初始化值-1\" class=\"headerlink\" title=\"初始化值\"></a>初始化值</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 初始化并赋值一个2行3列的二维数组</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">int</span>[][] array13=&#123;&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>&#125;,&#123;<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>&#125;&#125;;</span><br><span class=\"line\"><span class=\"keyword\">int</span> []array14[]=&#123;&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>&#125;,&#123;<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>&#125;&#125;;</span><br><span class=\"line\"><span class=\"keyword\">int</span> array15[][]=&#123;&#123;<span class=\"number\">1</span>,<span class=\"number\">2</span>,<span class=\"number\">3</span>&#125;,&#123;<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>&#125;&#125;;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>​    其他像什么三维数组,多维数组初始化的方式都差不多,可以自己在IDE工具中试一下;</p>\n"},{"title":"【源码解析】扒开ArrayList的外衣","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-01-03T11:13:31.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n> 积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬。\n\n## 本文内容\n\n当然ArrayList里的方法不止这些，本文主要讲一些常用的方法\n\n![](http://cdn.mjava.top/blog/20200103101050.png)\n\n## 方法变量\n\n`Arraylist`里的方法变量主要有以下几个\n\n![](http://cdn.mjava.top/blog/Selection_005.png)\n\n\n\n## 构造方法\n\n### 有参构造\n\n#### 传入数组的大小\n\n##### 代码实现\n\n```java\nList<String> list=new ArrayList<>(5);\n```\n\n##### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_004.png)\n\n#### 传入一个list对象\n\n其实这个就相当于把传入的list对象里的数据<font color=orange>复制</font>到新的ArrayList对象\n\n##### 代码实现\n\n```java\nList<String> list=new ArrayList<>(Arrays.asList(\"z\",\"m\",\"h\"));\n```\n\n> 这里用来`Arrays`工具类里的`asList`方法，它的源码里是直接返回一个List，有兴趣的可以去看看，这里就不介绍了\n\n##### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_006.png)\n\n### 无参构造\n\n这个比较简单，直接赋值一个空数组\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/20200103112943.png)\n\n## add方法\n\nadd一般常用的有两个方法，一个就是`add(E e)`在尾部添加数据，一个就是`add(int index,E element)`在指定位置插入元素\n\n### add(E e)\n\n这个是`Arrayist`的主要方法，平时用的也是最多的方法之一，所以源码比较复杂，比较长\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"灰灰HK\");\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_007.png)\n\n- <font color=orange>ensureCapacityInternal(int minCapacity)</font>确保数组容量充足\n\n![](http://cdn.mjava.top/blog/Selection_009.png)\n\n- <font color=orange>calculateCapacity(Object[] elementData, int minCapacity)</font>\n\n![](http://cdn.mjava.top/blog/Selection_010.png)\n\n- 再回到<font color=orange>ensureExplicitCapacity(int minCapacity)</font>这个方法，这个方法先`修改次数加1`，然后判断`size+1`是不是比当前的数组容量大，如果比当前的数组容量大，则进行扩容操作，扩大容量为原数组的`1.5倍`\n\n> 比如第二次调用add方法，此时`size+1=2`, ` elementData.length=10`,为什么等于10呢？因为第一次默认把数组容量从0扩大到了10,这时`size+1`比`elementData.length`小，就不会进行扩容操作\n\n![](http://cdn.mjava.top/blog/Selection_011.png)\n\n- <font color=orange>grow(int minCapacity)</font>扩容\n\n> 这里调用`Arrays.copyOf()`方法进行复制操作，当进一步深入这个方法时，发现是由`System.arraycopy()`这个方法实现复制功能的，这个方法由`native`关键字修饰，表示不是由`Java`语言实现的，一般是c/cpp实现\n\n![](http://cdn.mjava.top/blog/Selection_012.png)\n\n#### 小结\n\n到这里，add的方法流程就走完了，其核心步骤：\n\n- 每次添加元素时判断数组容量是否充足\n\n- <font color=orange>第一次</font>添加元素，把数组容量扩容到10\n\n- 扩容时，除第一次，以后的每次扩容为<font color=orange>原大小的1.5倍</font>\n\n- 扩容后调用`System.arraycopy()`方法把原数组的元素复制到扩容后的新数组\n\n  \n\n### add(int index, E element)\n\n该方法为在指定位置插入元素，该位置及后面所有元素后移\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.add(0,\"灰灰\");\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_013.png)\n\n> 可以看到，这边又用到了`System.arraycopy()`这个方法\n\n- <font color=orange>rangeCheckForAdd(int index)</font>判断是否越界\n\n> 这里他是和`size`对比，而不是和数组的`length`对比，我个人认为这样第一节省了空间，第二方便后面移动的操作\n\n![](http://cdn.mjava.top/blog/Selection_014.png)\n\n- <font color=orange>System.arraycopy()</font>拷贝数组\n\n```java\npublic static native void arraycopy(Object src,  int  srcPos,\n                             \t\tObject dest, int destPos,\n                                    int length)\n```\n\n> - src    原数组对象\n> - srcPos    原数组起始位置\n> - dest    目标数组\n> - destPos    目标数组起始位置\n> - length    复制多少个数据\n\n#### 小结\n\n插入方法其主要步骤如下:\n\n- 检查插入的位置是否越界\n- 检查数组容量是否充足，不充足进行扩容相关操作\n- 调用`System.arraycopy()`进行`index`及后面的元素后移\n\n## get方法\n\n### get(int index)\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.get(0);\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_015.png)\n\n- <font color=orange>rangeCheck(int index)</font>判断是否越界\n\n> get个add方法判断越界的方法是不一样的，这边是`index>=size`,多了个`等于`，为什么要多个等于呢？因为数组是从0开始的，而size<font color=orange>相当于</font>是开始的从1开始的\n\n```java\nprivate void rangeCheck(int index) {\n    if (index >= size)\n        throw new IndexOutOfBoundsException(outOfBoundsMsg(index));\n}\n```\n\n- <font color=orange>elementData(int index)</font>直接返回对应下标的数组元素\n\n```java\nE elementData(int index) {\n    return (E) elementData[index];\n}\n```\n\n#### 小结\n\nget方法比较简单，主要步骤为：\n\n- 检查是否越界\n- 返回对应元素\n\n## set方法\n\n### set(int index, E element)\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.set(0,\"灰灰\");\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_016.png)\n\n## remove方法\n\n### remove(int index)\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.remove(0);\n```\n\n#### 源码解析\n\n> 当删除的元素为最后一个元素时，`numMoved`就小于0了，就不会进行移动元素的操作\n\n![](http://cdn.mjava.top/blog/Selection_017.png)\n\n### remove(Object o)\n\n> 这个方法在实际中用的比较少，因为`AraryList`是可以保存重复的元素，所以删除是<font color=orange>删除最早添加的元素</font>\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.remove(\"hk\");\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_018.png)\n\n- <font color=orange>fastRemove(int index)</font>删除元素\n\n> 这个方法和remove(int index)内部的操作类似，不过这边不保存被删除的元素\n\n```java\nprivate void fastRemove(int index) {\n    modCount++;\n    int numMoved = size - index - 1;\n    if (numMoved > 0)\n        System.arraycopy(elementData, index+1, elementData, index,\n                         numMoved);\n    elementData[--size] = null; // clear to let GC do its work\n}\n```\n\n## clear方法\n\n### clear()\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.clear();\n```\n\n#### 源码分析\n\n![](http://cdn.mjava.top/blog/Selection_019.png)\n\n## 总结\n\n`ArrayList`底层扩容或者移动数组元素时都调用了`System.arraycopy()`来进行相关操作，平时进行我们进行数组复制或移动的时候也可以调用这个方法了，这个性能比循环复制性能高多了，特别是在大量数据的时候。\n\n文章好几次出现了`modCount++`这个操作，这个`modCount`主要用户内部类的迭代器","source":"_posts/java/java-arraylist-source-1.md","raw":"---\ntitle: 【源码解析】扒开ArrayList的外衣\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-01-03 19:13:31\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Java\n- ArrayList\n- 源码解析\ncategories:\n- Java\n---\n\n> 积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬。\n\n## 本文内容\n\n当然ArrayList里的方法不止这些，本文主要讲一些常用的方法\n\n![](http://cdn.mjava.top/blog/20200103101050.png)\n\n## 方法变量\n\n`Arraylist`里的方法变量主要有以下几个\n\n![](http://cdn.mjava.top/blog/Selection_005.png)\n\n\n\n## 构造方法\n\n### 有参构造\n\n#### 传入数组的大小\n\n##### 代码实现\n\n```java\nList<String> list=new ArrayList<>(5);\n```\n\n##### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_004.png)\n\n#### 传入一个list对象\n\n其实这个就相当于把传入的list对象里的数据<font color=orange>复制</font>到新的ArrayList对象\n\n##### 代码实现\n\n```java\nList<String> list=new ArrayList<>(Arrays.asList(\"z\",\"m\",\"h\"));\n```\n\n> 这里用来`Arrays`工具类里的`asList`方法，它的源码里是直接返回一个List，有兴趣的可以去看看，这里就不介绍了\n\n##### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_006.png)\n\n### 无参构造\n\n这个比较简单，直接赋值一个空数组\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/20200103112943.png)\n\n## add方法\n\nadd一般常用的有两个方法，一个就是`add(E e)`在尾部添加数据，一个就是`add(int index,E element)`在指定位置插入元素\n\n### add(E e)\n\n这个是`Arrayist`的主要方法，平时用的也是最多的方法之一，所以源码比较复杂，比较长\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"灰灰HK\");\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_007.png)\n\n- <font color=orange>ensureCapacityInternal(int minCapacity)</font>确保数组容量充足\n\n![](http://cdn.mjava.top/blog/Selection_009.png)\n\n- <font color=orange>calculateCapacity(Object[] elementData, int minCapacity)</font>\n\n![](http://cdn.mjava.top/blog/Selection_010.png)\n\n- 再回到<font color=orange>ensureExplicitCapacity(int minCapacity)</font>这个方法，这个方法先`修改次数加1`，然后判断`size+1`是不是比当前的数组容量大，如果比当前的数组容量大，则进行扩容操作，扩大容量为原数组的`1.5倍`\n\n> 比如第二次调用add方法，此时`size+1=2`, ` elementData.length=10`,为什么等于10呢？因为第一次默认把数组容量从0扩大到了10,这时`size+1`比`elementData.length`小，就不会进行扩容操作\n\n![](http://cdn.mjava.top/blog/Selection_011.png)\n\n- <font color=orange>grow(int minCapacity)</font>扩容\n\n> 这里调用`Arrays.copyOf()`方法进行复制操作，当进一步深入这个方法时，发现是由`System.arraycopy()`这个方法实现复制功能的，这个方法由`native`关键字修饰，表示不是由`Java`语言实现的，一般是c/cpp实现\n\n![](http://cdn.mjava.top/blog/Selection_012.png)\n\n#### 小结\n\n到这里，add的方法流程就走完了，其核心步骤：\n\n- 每次添加元素时判断数组容量是否充足\n\n- <font color=orange>第一次</font>添加元素，把数组容量扩容到10\n\n- 扩容时，除第一次，以后的每次扩容为<font color=orange>原大小的1.5倍</font>\n\n- 扩容后调用`System.arraycopy()`方法把原数组的元素复制到扩容后的新数组\n\n  \n\n### add(int index, E element)\n\n该方法为在指定位置插入元素，该位置及后面所有元素后移\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.add(0,\"灰灰\");\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_013.png)\n\n> 可以看到，这边又用到了`System.arraycopy()`这个方法\n\n- <font color=orange>rangeCheckForAdd(int index)</font>判断是否越界\n\n> 这里他是和`size`对比，而不是和数组的`length`对比，我个人认为这样第一节省了空间，第二方便后面移动的操作\n\n![](http://cdn.mjava.top/blog/Selection_014.png)\n\n- <font color=orange>System.arraycopy()</font>拷贝数组\n\n```java\npublic static native void arraycopy(Object src,  int  srcPos,\n                             \t\tObject dest, int destPos,\n                                    int length)\n```\n\n> - src    原数组对象\n> - srcPos    原数组起始位置\n> - dest    目标数组\n> - destPos    目标数组起始位置\n> - length    复制多少个数据\n\n#### 小结\n\n插入方法其主要步骤如下:\n\n- 检查插入的位置是否越界\n- 检查数组容量是否充足，不充足进行扩容相关操作\n- 调用`System.arraycopy()`进行`index`及后面的元素后移\n\n## get方法\n\n### get(int index)\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.get(0);\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_015.png)\n\n- <font color=orange>rangeCheck(int index)</font>判断是否越界\n\n> get个add方法判断越界的方法是不一样的，这边是`index>=size`,多了个`等于`，为什么要多个等于呢？因为数组是从0开始的，而size<font color=orange>相当于</font>是开始的从1开始的\n\n```java\nprivate void rangeCheck(int index) {\n    if (index >= size)\n        throw new IndexOutOfBoundsException(outOfBoundsMsg(index));\n}\n```\n\n- <font color=orange>elementData(int index)</font>直接返回对应下标的数组元素\n\n```java\nE elementData(int index) {\n    return (E) elementData[index];\n}\n```\n\n#### 小结\n\nget方法比较简单，主要步骤为：\n\n- 检查是否越界\n- 返回对应元素\n\n## set方法\n\n### set(int index, E element)\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.set(0,\"灰灰\");\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_016.png)\n\n## remove方法\n\n### remove(int index)\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.remove(0);\n```\n\n#### 源码解析\n\n> 当删除的元素为最后一个元素时，`numMoved`就小于0了，就不会进行移动元素的操作\n\n![](http://cdn.mjava.top/blog/Selection_017.png)\n\n### remove(Object o)\n\n> 这个方法在实际中用的比较少，因为`AraryList`是可以保存重复的元素，所以删除是<font color=orange>删除最早添加的元素</font>\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.remove(\"hk\");\n```\n\n#### 源码解析\n\n![](http://cdn.mjava.top/blog/Selection_018.png)\n\n- <font color=orange>fastRemove(int index)</font>删除元素\n\n> 这个方法和remove(int index)内部的操作类似，不过这边不保存被删除的元素\n\n```java\nprivate void fastRemove(int index) {\n    modCount++;\n    int numMoved = size - index - 1;\n    if (numMoved > 0)\n        System.arraycopy(elementData, index+1, elementData, index,\n                         numMoved);\n    elementData[--size] = null; // clear to let GC do its work\n}\n```\n\n## clear方法\n\n### clear()\n\n#### 代码实现\n\n```java\nList<String> list=new ArrayList<>();\nlist.add(\"hk\");\nlist.clear();\n```\n\n#### 源码分析\n\n![](http://cdn.mjava.top/blog/Selection_019.png)\n\n## 总结\n\n`ArrayList`底层扩容或者移动数组元素时都调用了`System.arraycopy()`来进行相关操作，平时进行我们进行数组复制或移动的时候也可以调用这个方法了，这个性能比循环复制性能高多了，特别是在大量数据的时候。\n\n文章好几次出现了`modCount++`这个操作，这个`modCount`主要用户内部类的迭代器","slug":"java/java-arraylist-source-1","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjo00192mg518u2atbp","content":"<blockquote>\n<p>积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬。</p>\n</blockquote>\n<h2 id=\"本文内容\"><a href=\"#本文内容\" class=\"headerlink\" title=\"本文内容\"></a>本文内容</h2><p>当然ArrayList里的方法不止这些，本文主要讲一些常用的方法</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200103101050.png\" alt></p>\n<h2 id=\"方法变量\"><a href=\"#方法变量\" class=\"headerlink\" title=\"方法变量\"></a>方法变量</h2><p><code>Arraylist</code>里的方法变量主要有以下几个</p>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_005.png\" alt></p>\n<h2 id=\"构造方法\"><a href=\"#构造方法\" class=\"headerlink\" title=\"构造方法\"></a>构造方法</h2><h3 id=\"有参构造\"><a href=\"#有参构造\" class=\"headerlink\" title=\"有参构造\"></a>有参构造</h3><h4 id=\"传入数组的大小\"><a href=\"#传入数组的大小\" class=\"headerlink\" title=\"传入数组的大小\"></a>传入数组的大小</h4><h5 id=\"代码实现\"><a href=\"#代码实现\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;(<span class=\"number\">5</span>);</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"源码解析\"><a href=\"#源码解析\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h5><p><img src=\"http://cdn.mjava.top/blog/Selection_004.png\" alt></p>\n<h4 id=\"传入一个list对象\"><a href=\"#传入一个list对象\" class=\"headerlink\" title=\"传入一个list对象\"></a>传入一个list对象</h4><p>其实这个就相当于把传入的list对象里的数据<font color=\"orange\">复制</font>到新的ArrayList对象</p>\n<h5 id=\"代码实现-1\"><a href=\"#代码实现-1\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;(Arrays.asList(<span class=\"string\">\"z\"</span>,<span class=\"string\">\"m\"</span>,<span class=\"string\">\"h\"</span>));</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>这里用来<code>Arrays</code>工具类里的<code>asList</code>方法，它的源码里是直接返回一个List，有兴趣的可以去看看，这里就不介绍了</p>\n</blockquote>\n<h5 id=\"源码解析-1\"><a href=\"#源码解析-1\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h5><p><img src=\"http://cdn.mjava.top/blog/Selection_006.png\" alt></p>\n<h3 id=\"无参构造\"><a href=\"#无参构造\" class=\"headerlink\" title=\"无参构造\"></a>无参构造</h3><p>这个比较简单，直接赋值一个空数组</p>\n<h4 id=\"代码实现-2\"><a href=\"#代码实现-2\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-2\"><a href=\"#源码解析-2\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/20200103112943.png\" alt></p>\n<h2 id=\"add方法\"><a href=\"#add方法\" class=\"headerlink\" title=\"add方法\"></a>add方法</h2><p>add一般常用的有两个方法，一个就是<code>add(E e)</code>在尾部添加数据，一个就是<code>add(int index,E element)</code>在指定位置插入元素</p>\n<h3 id=\"add-E-e\"><a href=\"#add-E-e\" class=\"headerlink\" title=\"add(E e)\"></a>add(E e)</h3><p>这个是<code>Arrayist</code>的主要方法，平时用的也是最多的方法之一，所以源码比较复杂，比较长</p>\n<h4 id=\"代码实现-3\"><a href=\"#代码实现-3\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"灰灰HK\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-3\"><a href=\"#源码解析-3\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_007.png\" alt></p>\n<ul>\n<li><font color=\"orange\">ensureCapacityInternal(int minCapacity)</font>确保数组容量充足</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_009.png\" alt></p>\n<ul>\n<li><font color=\"orange\">calculateCapacity(Object[] elementData, int minCapacity)</font></li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_010.png\" alt></p>\n<ul>\n<li>再回到<font color=\"orange\">ensureExplicitCapacity(int minCapacity)</font>这个方法，这个方法先<code>修改次数加1</code>，然后判断<code>size+1</code>是不是比当前的数组容量大，如果比当前的数组容量大，则进行扩容操作，扩大容量为原数组的<code>1.5倍</code></li>\n</ul>\n<blockquote>\n<p>比如第二次调用add方法，此时<code>size+1=2</code>, <code>elementData.length=10</code>,为什么等于10呢？因为第一次默认把数组容量从0扩大到了10,这时<code>size+1</code>比<code>elementData.length</code>小，就不会进行扩容操作</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_011.png\" alt></p>\n<ul>\n<li><font color=\"orange\">grow(int minCapacity)</font>扩容</li>\n</ul>\n<blockquote>\n<p>这里调用<code>Arrays.copyOf()</code>方法进行复制操作，当进一步深入这个方法时，发现是由<code>System.arraycopy()</code>这个方法实现复制功能的，这个方法由<code>native</code>关键字修饰，表示不是由<code>Java</code>语言实现的，一般是c/cpp实现</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_012.png\" alt></p>\n<h4 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h4><p>到这里，add的方法流程就走完了，其核心步骤：</p>\n<ul>\n<li><p>每次添加元素时判断数组容量是否充足</p>\n</li>\n<li><p><font color=\"orange\">第一次</font>添加元素，把数组容量扩容到10</p>\n</li>\n<li><p>扩容时，除第一次，以后的每次扩容为<font color=\"orange\">原大小的1.5倍</font></p>\n</li>\n<li><p>扩容后调用<code>System.arraycopy()</code>方法把原数组的元素复制到扩容后的新数组</p>\n</li>\n</ul>\n<h3 id=\"add-int-index-E-element\"><a href=\"#add-int-index-E-element\" class=\"headerlink\" title=\"add(int index, E element)\"></a>add(int index, E element)</h3><p>该方法为在指定位置插入元素，该位置及后面所有元素后移</p>\n<h4 id=\"代码实现-4\"><a href=\"#代码实现-4\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.add(<span class=\"number\">0</span>,<span class=\"string\">\"灰灰\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-4\"><a href=\"#源码解析-4\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_013.png\" alt></p>\n<blockquote>\n<p>可以看到，这边又用到了<code>System.arraycopy()</code>这个方法</p>\n</blockquote>\n<ul>\n<li><font color=\"orange\">rangeCheckForAdd(int index)</font>判断是否越界</li>\n</ul>\n<blockquote>\n<p>这里他是和<code>size</code>对比，而不是和数组的<code>length</code>对比，我个人认为这样第一节省了空间，第二方便后面移动的操作</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_014.png\" alt></p>\n<ul>\n<li><font color=\"orange\">System.arraycopy()</font>拷贝数组</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">arraycopy</span><span class=\"params\">(Object src,  <span class=\"keyword\">int</span>  srcPos,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                             \t\tObject dest, <span class=\"keyword\">int</span> destPos,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                    <span class=\"keyword\">int</span> length)</span></span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<ul>\n<li>src    原数组对象</li>\n<li>srcPos    原数组起始位置</li>\n<li>dest    目标数组</li>\n<li>destPos    目标数组起始位置</li>\n<li>length    复制多少个数据</li>\n</ul>\n</blockquote>\n<h4 id=\"小结-1\"><a href=\"#小结-1\" class=\"headerlink\" title=\"小结\"></a>小结</h4><p>插入方法其主要步骤如下:</p>\n<ul>\n<li>检查插入的位置是否越界</li>\n<li>检查数组容量是否充足，不充足进行扩容相关操作</li>\n<li>调用<code>System.arraycopy()</code>进行<code>index</code>及后面的元素后移</li>\n</ul>\n<h2 id=\"get方法\"><a href=\"#get方法\" class=\"headerlink\" title=\"get方法\"></a>get方法</h2><h3 id=\"get-int-index\"><a href=\"#get-int-index\" class=\"headerlink\" title=\"get(int index)\"></a>get(int index)</h3><h4 id=\"代码实现-5\"><a href=\"#代码实现-5\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.get(<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-5\"><a href=\"#源码解析-5\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_015.png\" alt></p>\n<ul>\n<li><font color=\"orange\">rangeCheck(int index)</font>判断是否越界</li>\n</ul>\n<blockquote>\n<p>get个add方法判断越界的方法是不一样的，这边是<code>index&gt;=size</code>,多了个<code>等于</code>，为什么要多个等于呢？因为数组是从0开始的，而size<font color=\"orange\">相当于</font>是开始的从1开始的</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">rangeCheck</span><span class=\"params\">(<span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &gt;= size)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><font color=\"orange\">elementData(int index)</font>直接返回对应下标的数组元素</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">E <span class=\"title\">elementData</span><span class=\"params\">(<span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (E) elementData[index];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"小结-2\"><a href=\"#小结-2\" class=\"headerlink\" title=\"小结\"></a>小结</h4><p>get方法比较简单，主要步骤为：</p>\n<ul>\n<li>检查是否越界</li>\n<li>返回对应元素</li>\n</ul>\n<h2 id=\"set方法\"><a href=\"#set方法\" class=\"headerlink\" title=\"set方法\"></a>set方法</h2><h3 id=\"set-int-index-E-element\"><a href=\"#set-int-index-E-element\" class=\"headerlink\" title=\"set(int index, E element)\"></a>set(int index, E element)</h3><h4 id=\"代码实现-6\"><a href=\"#代码实现-6\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.set(<span class=\"number\">0</span>,<span class=\"string\">\"灰灰\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-6\"><a href=\"#源码解析-6\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_016.png\" alt></p>\n<h2 id=\"remove方法\"><a href=\"#remove方法\" class=\"headerlink\" title=\"remove方法\"></a>remove方法</h2><h3 id=\"remove-int-index\"><a href=\"#remove-int-index\" class=\"headerlink\" title=\"remove(int index)\"></a>remove(int index)</h3><h4 id=\"代码实现-7\"><a href=\"#代码实现-7\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.remove(<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-7\"><a href=\"#源码解析-7\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><blockquote>\n<p>当删除的元素为最后一个元素时，<code>numMoved</code>就小于0了，就不会进行移动元素的操作</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_017.png\" alt></p>\n<h3 id=\"remove-Object-o\"><a href=\"#remove-Object-o\" class=\"headerlink\" title=\"remove(Object o)\"></a>remove(Object o)</h3><blockquote>\n<p>这个方法在实际中用的比较少，因为<code>AraryList</code>是可以保存重复的元素，所以删除是<font color=\"orange\">删除最早添加的元素</font></p>\n</blockquote>\n<h4 id=\"代码实现-8\"><a href=\"#代码实现-8\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.remove(<span class=\"string\">\"hk\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-8\"><a href=\"#源码解析-8\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_018.png\" alt></p>\n<ul>\n<li><font color=\"orange\">fastRemove(int index)</font>删除元素</li>\n</ul>\n<blockquote>\n<p>这个方法和remove(int index)内部的操作类似，不过这边不保存被删除的元素</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">fastRemove</span><span class=\"params\">(<span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">    modCount++;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> numMoved = size - index - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (numMoved &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        System.arraycopy(elementData, index+<span class=\"number\">1</span>, elementData, index,</span><br><span class=\"line\">                         numMoved);</span><br><span class=\"line\">    elementData[--size] = <span class=\"keyword\">null</span>; <span class=\"comment\">// clear to let GC do its work</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"clear方法\"><a href=\"#clear方法\" class=\"headerlink\" title=\"clear方法\"></a>clear方法</h2><h3 id=\"clear\"><a href=\"#clear\" class=\"headerlink\" title=\"clear()\"></a>clear()</h3><h4 id=\"代码实现-9\"><a href=\"#代码实现-9\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.clear();</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码分析\"><a href=\"#源码分析\" class=\"headerlink\" title=\"源码分析\"></a>源码分析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_019.png\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p><code>ArrayList</code>底层扩容或者移动数组元素时都调用了<code>System.arraycopy()</code>来进行相关操作，平时进行我们进行数组复制或移动的时候也可以调用这个方法了，这个性能比循环复制性能高多了，特别是在大量数据的时候。</p>\n<p>文章好几次出现了<code>modCount++</code>这个操作，这个<code>modCount</code>主要用户内部类的迭代器</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<blockquote>\n<p>积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬。</p>\n</blockquote>\n<h2 id=\"本文内容\"><a href=\"#本文内容\" class=\"headerlink\" title=\"本文内容\"></a>本文内容</h2><p>当然ArrayList里的方法不止这些，本文主要讲一些常用的方法</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200103101050.png\" alt></p>\n<h2 id=\"方法变量\"><a href=\"#方法变量\" class=\"headerlink\" title=\"方法变量\"></a>方法变量</h2><p><code>Arraylist</code>里的方法变量主要有以下几个</p>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_005.png\" alt></p>\n<h2 id=\"构造方法\"><a href=\"#构造方法\" class=\"headerlink\" title=\"构造方法\"></a>构造方法</h2><h3 id=\"有参构造\"><a href=\"#有参构造\" class=\"headerlink\" title=\"有参构造\"></a>有参构造</h3><h4 id=\"传入数组的大小\"><a href=\"#传入数组的大小\" class=\"headerlink\" title=\"传入数组的大小\"></a>传入数组的大小</h4><h5 id=\"代码实现\"><a href=\"#代码实现\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;(<span class=\"number\">5</span>);</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"源码解析\"><a href=\"#源码解析\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h5><p><img src=\"http://cdn.mjava.top/blog/Selection_004.png\" alt></p>\n<h4 id=\"传入一个list对象\"><a href=\"#传入一个list对象\" class=\"headerlink\" title=\"传入一个list对象\"></a>传入一个list对象</h4><p>其实这个就相当于把传入的list对象里的数据<font color=\"orange\">复制</font>到新的ArrayList对象</p>\n<h5 id=\"代码实现-1\"><a href=\"#代码实现-1\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;(Arrays.asList(<span class=\"string\">\"z\"</span>,<span class=\"string\">\"m\"</span>,<span class=\"string\">\"h\"</span>));</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>这里用来<code>Arrays</code>工具类里的<code>asList</code>方法，它的源码里是直接返回一个List，有兴趣的可以去看看，这里就不介绍了</p>\n</blockquote>\n<h5 id=\"源码解析-1\"><a href=\"#源码解析-1\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h5><p><img src=\"http://cdn.mjava.top/blog/Selection_006.png\" alt></p>\n<h3 id=\"无参构造\"><a href=\"#无参构造\" class=\"headerlink\" title=\"无参构造\"></a>无参构造</h3><p>这个比较简单，直接赋值一个空数组</p>\n<h4 id=\"代码实现-2\"><a href=\"#代码实现-2\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-2\"><a href=\"#源码解析-2\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/20200103112943.png\" alt></p>\n<h2 id=\"add方法\"><a href=\"#add方法\" class=\"headerlink\" title=\"add方法\"></a>add方法</h2><p>add一般常用的有两个方法，一个就是<code>add(E e)</code>在尾部添加数据，一个就是<code>add(int index,E element)</code>在指定位置插入元素</p>\n<h3 id=\"add-E-e\"><a href=\"#add-E-e\" class=\"headerlink\" title=\"add(E e)\"></a>add(E e)</h3><p>这个是<code>Arrayist</code>的主要方法，平时用的也是最多的方法之一，所以源码比较复杂，比较长</p>\n<h4 id=\"代码实现-3\"><a href=\"#代码实现-3\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"灰灰HK\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-3\"><a href=\"#源码解析-3\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_007.png\" alt></p>\n<ul>\n<li><font color=\"orange\">ensureCapacityInternal(int minCapacity)</font>确保数组容量充足</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_009.png\" alt></p>\n<ul>\n<li><font color=\"orange\">calculateCapacity(Object[] elementData, int minCapacity)</font></li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_010.png\" alt></p>\n<ul>\n<li>再回到<font color=\"orange\">ensureExplicitCapacity(int minCapacity)</font>这个方法，这个方法先<code>修改次数加1</code>，然后判断<code>size+1</code>是不是比当前的数组容量大，如果比当前的数组容量大，则进行扩容操作，扩大容量为原数组的<code>1.5倍</code></li>\n</ul>\n<blockquote>\n<p>比如第二次调用add方法，此时<code>size+1=2</code>, <code>elementData.length=10</code>,为什么等于10呢？因为第一次默认把数组容量从0扩大到了10,这时<code>size+1</code>比<code>elementData.length</code>小，就不会进行扩容操作</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_011.png\" alt></p>\n<ul>\n<li><font color=\"orange\">grow(int minCapacity)</font>扩容</li>\n</ul>\n<blockquote>\n<p>这里调用<code>Arrays.copyOf()</code>方法进行复制操作，当进一步深入这个方法时，发现是由<code>System.arraycopy()</code>这个方法实现复制功能的，这个方法由<code>native</code>关键字修饰，表示不是由<code>Java</code>语言实现的，一般是c/cpp实现</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_012.png\" alt></p>\n<h4 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h4><p>到这里，add的方法流程就走完了，其核心步骤：</p>\n<ul>\n<li><p>每次添加元素时判断数组容量是否充足</p>\n</li>\n<li><p><font color=\"orange\">第一次</font>添加元素，把数组容量扩容到10</p>\n</li>\n<li><p>扩容时，除第一次，以后的每次扩容为<font color=\"orange\">原大小的1.5倍</font></p>\n</li>\n<li><p>扩容后调用<code>System.arraycopy()</code>方法把原数组的元素复制到扩容后的新数组</p>\n</li>\n</ul>\n<h3 id=\"add-int-index-E-element\"><a href=\"#add-int-index-E-element\" class=\"headerlink\" title=\"add(int index, E element)\"></a>add(int index, E element)</h3><p>该方法为在指定位置插入元素，该位置及后面所有元素后移</p>\n<h4 id=\"代码实现-4\"><a href=\"#代码实现-4\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.add(<span class=\"number\">0</span>,<span class=\"string\">\"灰灰\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-4\"><a href=\"#源码解析-4\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_013.png\" alt></p>\n<blockquote>\n<p>可以看到，这边又用到了<code>System.arraycopy()</code>这个方法</p>\n</blockquote>\n<ul>\n<li><font color=\"orange\">rangeCheckForAdd(int index)</font>判断是否越界</li>\n</ul>\n<blockquote>\n<p>这里他是和<code>size</code>对比，而不是和数组的<code>length</code>对比，我个人认为这样第一节省了空间，第二方便后面移动的操作</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_014.png\" alt></p>\n<ul>\n<li><font color=\"orange\">System.arraycopy()</font>拷贝数组</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">native</span> <span class=\"keyword\">void</span> <span class=\"title\">arraycopy</span><span class=\"params\">(Object src,  <span class=\"keyword\">int</span>  srcPos,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                             \t\tObject dest, <span class=\"keyword\">int</span> destPos,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                    <span class=\"keyword\">int</span> length)</span></span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<ul>\n<li>src    原数组对象</li>\n<li>srcPos    原数组起始位置</li>\n<li>dest    目标数组</li>\n<li>destPos    目标数组起始位置</li>\n<li>length    复制多少个数据</li>\n</ul>\n</blockquote>\n<h4 id=\"小结-1\"><a href=\"#小结-1\" class=\"headerlink\" title=\"小结\"></a>小结</h4><p>插入方法其主要步骤如下:</p>\n<ul>\n<li>检查插入的位置是否越界</li>\n<li>检查数组容量是否充足，不充足进行扩容相关操作</li>\n<li>调用<code>System.arraycopy()</code>进行<code>index</code>及后面的元素后移</li>\n</ul>\n<h2 id=\"get方法\"><a href=\"#get方法\" class=\"headerlink\" title=\"get方法\"></a>get方法</h2><h3 id=\"get-int-index\"><a href=\"#get-int-index\" class=\"headerlink\" title=\"get(int index)\"></a>get(int index)</h3><h4 id=\"代码实现-5\"><a href=\"#代码实现-5\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.get(<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-5\"><a href=\"#源码解析-5\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_015.png\" alt></p>\n<ul>\n<li><font color=\"orange\">rangeCheck(int index)</font>判断是否越界</li>\n</ul>\n<blockquote>\n<p>get个add方法判断越界的方法是不一样的，这边是<code>index&gt;=size</code>,多了个<code>等于</code>，为什么要多个等于呢？因为数组是从0开始的，而size<font color=\"orange\">相当于</font>是开始的从1开始的</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">rangeCheck</span><span class=\"params\">(<span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &gt;= size)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IndexOutOfBoundsException(outOfBoundsMsg(index));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><font color=\"orange\">elementData(int index)</font>直接返回对应下标的数组元素</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\">E <span class=\"title\">elementData</span><span class=\"params\">(<span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (E) elementData[index];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"小结-2\"><a href=\"#小结-2\" class=\"headerlink\" title=\"小结\"></a>小结</h4><p>get方法比较简单，主要步骤为：</p>\n<ul>\n<li>检查是否越界</li>\n<li>返回对应元素</li>\n</ul>\n<h2 id=\"set方法\"><a href=\"#set方法\" class=\"headerlink\" title=\"set方法\"></a>set方法</h2><h3 id=\"set-int-index-E-element\"><a href=\"#set-int-index-E-element\" class=\"headerlink\" title=\"set(int index, E element)\"></a>set(int index, E element)</h3><h4 id=\"代码实现-6\"><a href=\"#代码实现-6\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.set(<span class=\"number\">0</span>,<span class=\"string\">\"灰灰\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-6\"><a href=\"#源码解析-6\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_016.png\" alt></p>\n<h2 id=\"remove方法\"><a href=\"#remove方法\" class=\"headerlink\" title=\"remove方法\"></a>remove方法</h2><h3 id=\"remove-int-index\"><a href=\"#remove-int-index\" class=\"headerlink\" title=\"remove(int index)\"></a>remove(int index)</h3><h4 id=\"代码实现-7\"><a href=\"#代码实现-7\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.remove(<span class=\"number\">0</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-7\"><a href=\"#源码解析-7\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><blockquote>\n<p>当删除的元素为最后一个元素时，<code>numMoved</code>就小于0了，就不会进行移动元素的操作</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/Selection_017.png\" alt></p>\n<h3 id=\"remove-Object-o\"><a href=\"#remove-Object-o\" class=\"headerlink\" title=\"remove(Object o)\"></a>remove(Object o)</h3><blockquote>\n<p>这个方法在实际中用的比较少，因为<code>AraryList</code>是可以保存重复的元素，所以删除是<font color=\"orange\">删除最早添加的元素</font></p>\n</blockquote>\n<h4 id=\"代码实现-8\"><a href=\"#代码实现-8\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.remove(<span class=\"string\">\"hk\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码解析-8\"><a href=\"#源码解析-8\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_018.png\" alt></p>\n<ul>\n<li><font color=\"orange\">fastRemove(int index)</font>删除元素</li>\n</ul>\n<blockquote>\n<p>这个方法和remove(int index)内部的操作类似，不过这边不保存被删除的元素</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">fastRemove</span><span class=\"params\">(<span class=\"keyword\">int</span> index)</span> </span>&#123;</span><br><span class=\"line\">    modCount++;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> numMoved = size - index - <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (numMoved &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        System.arraycopy(elementData, index+<span class=\"number\">1</span>, elementData, index,</span><br><span class=\"line\">                         numMoved);</span><br><span class=\"line\">    elementData[--size] = <span class=\"keyword\">null</span>; <span class=\"comment\">// clear to let GC do its work</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"clear方法\"><a href=\"#clear方法\" class=\"headerlink\" title=\"clear方法\"></a>clear方法</h2><h3 id=\"clear\"><a href=\"#clear\" class=\"headerlink\" title=\"clear()\"></a>clear()</h3><h4 id=\"代码实现-9\"><a href=\"#代码实现-9\" class=\"headerlink\" title=\"代码实现\"></a>代码实现</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">List&lt;String&gt; list=<span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">list.add(<span class=\"string\">\"hk\"</span>);</span><br><span class=\"line\">list.clear();</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"源码分析\"><a href=\"#源码分析\" class=\"headerlink\" title=\"源码分析\"></a>源码分析</h4><p><img src=\"http://cdn.mjava.top/blog/Selection_019.png\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p><code>ArrayList</code>底层扩容或者移动数组元素时都调用了<code>System.arraycopy()</code>来进行相关操作，平时进行我们进行数组复制或移动的时候也可以调用这个方法了，这个性能比循环复制性能高多了，特别是在大量数据的时候。</p>\n<p>文章好几次出现了<code>modCount++</code>这个操作，这个<code>modCount</code>主要用户内部类的迭代器</p>\n"},{"title":"Java包装类缓存机制","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-09-16T07:08:18.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n\n\n## 面试题\n\n首先,来看一道常见的面试题,下面代码运行后会输出什么?\n\n![](http://cdn.mjava.top/blog/20200603110911.png)\n\n上面代码运行后,最终会输出`false`和`true`;为什么会这样呢?\n\n按道理来说,在Java中`==`是比较两个对象的地址,上面代码中`i3`和`i4`是两个不同的对象,理应也应该返回是`false`,怎么返回是`true`呢?让我们慢慢往下看\n\n## Integer的缓存机制\n\n让我们来看看他的源代码.\n\n当执行`Integer i=128;`这个语句时,Java会调用`valueOf(int i)`方法,然后`自动装箱`的方式,让其变成`Integer i=new Integer(128)`,具体源码如下:\n\n```java\npublic static Integer valueOf(int i) {\n    if (i >= IntegerCache.low && i <= IntegerCache.high)\n        return IntegerCache.cache[i + (-IntegerCache.low)];\n    //装箱\n    return new Integer(i);\n}\n```\n\n从上面的源码中可以看到,在装箱之前会执行一个`if`语句,这个`if`语句就是判断传入的值是否在缓存内,如果在缓存内,就直接返回缓存内的值,如果不在缓存内,就装箱,在堆内创建一个新空间来存放.\n\n```java\n//Integer包装类缓存源码\nprivate static class IntegerCache {\n        static final int low = -128;\n        static final int high;\n        static final Integer cache[];\n        static {\n            // high value may be configured by property\n            int h = 127;\n            String integerCacheHighPropValue =\n                sun.misc.VM.getSavedProperty(\"java.lang.Integer.IntegerCache.high\");\n            if (integerCacheHighPropValue != null) {\n                try {\n                    int i = parseInt(integerCacheHighPropValue);\n                    i = Math.max(i, 127);\n                    // Maximum array size is Integer.MAX_VALUE\n                    h = Math.min(i, Integer.MAX_VALUE - (-low) -1);\n                } catch( NumberFormatException nfe) {\n                    // If the property cannot be parsed into an int, ignore it.\n                }\n            }\n            high = h;\n            cache = new Integer[(high - low) + 1];\n            int j = low;\n            for(int k = 0; k < cache.length; k++)\n                cache[k] = new Integer(j++);\n            // range [-128, 127] must be interned (JLS7 5.1.7)\n            assert IntegerCache.high >= 127;\n        }\n        private IntegerCache() {}\n    }\n```\n\n从源码中可以看到,`Integer`的缓存范围是`-128~127`,所以过程大致如下:\n\n![](http://cdn.mjava.top/blog/20200603114246.png)\n\n按照上面这个方法,只要在数据在缓存池范围内的,都会引用缓存在堆内的地址,所有上面的`i3==i4`会输出为`true`;而不在缓存范围内的,就会在堆中开放新的空间来存放对象,所以地址不同,用`==`比较返回也不同;\n\n## 其他包装类缓存机制\n\n除了`Integer`之外,其他的包装类也使用了缓存技术;\n\n### Long\n\n> 缓存范围-128~127\n\n\n\n```java\npublic static Long valueOf(long l) {\n    final int offset = 128;\n    if (l >= -128 && l <= 127) { // will cache\n        return LongCache.cache[(int)l + offset];\n    }\n    return new Long(l);\n}\n\n\nprivate static class LongCache {\n    private LongCache(){}\n\n    static final Long cache[] = new Long[-(-128) + 127 + 1];\n\n    static {\n        for(int i = 0; i < cache.length; i++)\n            cache[i] = new Long(i - 128);\n    }\n}\n```\n\n### Byte\n\n> 缓存范围-128~127   (byte范围:一个byte占8位,所以取值范围是**-2^7~2^7-1**)\n\n\n\n```java\npublic static Byte valueOf(byte b) {\n    final int offset = 128;\n    return ByteCache.cache[(int)b + offset];\n}\n\nprivate static class ByteCache {\n    private ByteCache(){}\n\n    static final Byte cache[] = new Byte[-(-128) + 127 + 1];\n\n    static {\n        for(int i = 0; i < cache.length; i++)\n            cache[i] = new Byte((byte)(i - 128));\n    }\n}\n```\n\n### Character\n\n> 缓存范围0~127  (ascii码范围) \n\n\n\n```java\npublic static Character valueOf(char c) {\n    if (c <= 127) { // must cache\n        return CharacterCache.cache[(int)c];\n    }\n    return new Character(c);\n}\n\nprivate static class CharacterCache {\n    private CharacterCache(){}\n\n    static final Character cache[] = new Character[127 + 1];\n\n    static {\n        for (int i = 0; i < cache.length; i++)\n            cache[i] = new Character((char)i);\n    }\n}\n```\n\n### Short\n\n> 缓存范围-128~127\n\n\n\n```java\npublic static Short valueOf(short s) {\n    final int offset = 128;\n    int sAsInt = s;\n    if (sAsInt >= -128 && sAsInt <= 127) { // must cache\n        return ShortCache.cache[sAsInt + offset];\n    }\n    return new Short(s);\n}\n\nprivate static class ShortCache {\n    private ShortCache(){}\n\n    static final Short cache[] = new Short[-(-128) + 127 + 1];\n\n    static {\n        for(int i = 0; i < cache.length; i++)\n            cache[i] = new Short((short)(i - 128));\n    }\n}\n```\n\n### Boolean\n\n> 缓存范围 `true`  `false`     它只设置了两个静态变量用来充当缓存\n\n\n\n```java\npublic static final Boolean TRUE = new Boolean(true);\npublic static final Boolean FALSE = new Boolean(false);\n\npublic static Boolean valueOf(boolean b) {\n    return (b ? TRUE : FALSE);\n}\n```\n\n## 建议\n\n包装类对比数据是否相同的时候,建议采用重写的`equals()`方法.","source":"_posts/java/java-base-data-pack.md","raw":"---\ntitle: Java包装类缓存机制\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-09-16 15:08:18\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Java\ncategories:\n- Java\n---\n\n\n\n\n\n## 面试题\n\n首先,来看一道常见的面试题,下面代码运行后会输出什么?\n\n![](http://cdn.mjava.top/blog/20200603110911.png)\n\n上面代码运行后,最终会输出`false`和`true`;为什么会这样呢?\n\n按道理来说,在Java中`==`是比较两个对象的地址,上面代码中`i3`和`i4`是两个不同的对象,理应也应该返回是`false`,怎么返回是`true`呢?让我们慢慢往下看\n\n## Integer的缓存机制\n\n让我们来看看他的源代码.\n\n当执行`Integer i=128;`这个语句时,Java会调用`valueOf(int i)`方法,然后`自动装箱`的方式,让其变成`Integer i=new Integer(128)`,具体源码如下:\n\n```java\npublic static Integer valueOf(int i) {\n    if (i >= IntegerCache.low && i <= IntegerCache.high)\n        return IntegerCache.cache[i + (-IntegerCache.low)];\n    //装箱\n    return new Integer(i);\n}\n```\n\n从上面的源码中可以看到,在装箱之前会执行一个`if`语句,这个`if`语句就是判断传入的值是否在缓存内,如果在缓存内,就直接返回缓存内的值,如果不在缓存内,就装箱,在堆内创建一个新空间来存放.\n\n```java\n//Integer包装类缓存源码\nprivate static class IntegerCache {\n        static final int low = -128;\n        static final int high;\n        static final Integer cache[];\n        static {\n            // high value may be configured by property\n            int h = 127;\n            String integerCacheHighPropValue =\n                sun.misc.VM.getSavedProperty(\"java.lang.Integer.IntegerCache.high\");\n            if (integerCacheHighPropValue != null) {\n                try {\n                    int i = parseInt(integerCacheHighPropValue);\n                    i = Math.max(i, 127);\n                    // Maximum array size is Integer.MAX_VALUE\n                    h = Math.min(i, Integer.MAX_VALUE - (-low) -1);\n                } catch( NumberFormatException nfe) {\n                    // If the property cannot be parsed into an int, ignore it.\n                }\n            }\n            high = h;\n            cache = new Integer[(high - low) + 1];\n            int j = low;\n            for(int k = 0; k < cache.length; k++)\n                cache[k] = new Integer(j++);\n            // range [-128, 127] must be interned (JLS7 5.1.7)\n            assert IntegerCache.high >= 127;\n        }\n        private IntegerCache() {}\n    }\n```\n\n从源码中可以看到,`Integer`的缓存范围是`-128~127`,所以过程大致如下:\n\n![](http://cdn.mjava.top/blog/20200603114246.png)\n\n按照上面这个方法,只要在数据在缓存池范围内的,都会引用缓存在堆内的地址,所有上面的`i3==i4`会输出为`true`;而不在缓存范围内的,就会在堆中开放新的空间来存放对象,所以地址不同,用`==`比较返回也不同;\n\n## 其他包装类缓存机制\n\n除了`Integer`之外,其他的包装类也使用了缓存技术;\n\n### Long\n\n> 缓存范围-128~127\n\n\n\n```java\npublic static Long valueOf(long l) {\n    final int offset = 128;\n    if (l >= -128 && l <= 127) { // will cache\n        return LongCache.cache[(int)l + offset];\n    }\n    return new Long(l);\n}\n\n\nprivate static class LongCache {\n    private LongCache(){}\n\n    static final Long cache[] = new Long[-(-128) + 127 + 1];\n\n    static {\n        for(int i = 0; i < cache.length; i++)\n            cache[i] = new Long(i - 128);\n    }\n}\n```\n\n### Byte\n\n> 缓存范围-128~127   (byte范围:一个byte占8位,所以取值范围是**-2^7~2^7-1**)\n\n\n\n```java\npublic static Byte valueOf(byte b) {\n    final int offset = 128;\n    return ByteCache.cache[(int)b + offset];\n}\n\nprivate static class ByteCache {\n    private ByteCache(){}\n\n    static final Byte cache[] = new Byte[-(-128) + 127 + 1];\n\n    static {\n        for(int i = 0; i < cache.length; i++)\n            cache[i] = new Byte((byte)(i - 128));\n    }\n}\n```\n\n### Character\n\n> 缓存范围0~127  (ascii码范围) \n\n\n\n```java\npublic static Character valueOf(char c) {\n    if (c <= 127) { // must cache\n        return CharacterCache.cache[(int)c];\n    }\n    return new Character(c);\n}\n\nprivate static class CharacterCache {\n    private CharacterCache(){}\n\n    static final Character cache[] = new Character[127 + 1];\n\n    static {\n        for (int i = 0; i < cache.length; i++)\n            cache[i] = new Character((char)i);\n    }\n}\n```\n\n### Short\n\n> 缓存范围-128~127\n\n\n\n```java\npublic static Short valueOf(short s) {\n    final int offset = 128;\n    int sAsInt = s;\n    if (sAsInt >= -128 && sAsInt <= 127) { // must cache\n        return ShortCache.cache[sAsInt + offset];\n    }\n    return new Short(s);\n}\n\nprivate static class ShortCache {\n    private ShortCache(){}\n\n    static final Short cache[] = new Short[-(-128) + 127 + 1];\n\n    static {\n        for(int i = 0; i < cache.length; i++)\n            cache[i] = new Short((short)(i - 128));\n    }\n}\n```\n\n### Boolean\n\n> 缓存范围 `true`  `false`     它只设置了两个静态变量用来充当缓存\n\n\n\n```java\npublic static final Boolean TRUE = new Boolean(true);\npublic static final Boolean FALSE = new Boolean(false);\n\npublic static Boolean valueOf(boolean b) {\n    return (b ? TRUE : FALSE);\n}\n```\n\n## 建议\n\n包装类对比数据是否相同的时候,建议采用重写的`equals()`方法.","slug":"java/java-base-data-pack","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjp001d2mg5ewknpbxj","content":"<h2 id=\"面试题\"><a href=\"#面试题\" class=\"headerlink\" title=\"面试题\"></a>面试题</h2><p>首先,来看一道常见的面试题,下面代码运行后会输出什么?</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200603110911.png\" alt></p>\n<p>上面代码运行后,最终会输出<code>false</code>和<code>true</code>;为什么会这样呢?</p>\n<p>按道理来说,在Java中<code>==</code>是比较两个对象的地址,上面代码中<code>i3</code>和<code>i4</code>是两个不同的对象,理应也应该返回是<code>false</code>,怎么返回是<code>true</code>呢?让我们慢慢往下看</p>\n<h2 id=\"Integer的缓存机制\"><a href=\"#Integer的缓存机制\" class=\"headerlink\" title=\"Integer的缓存机制\"></a>Integer的缓存机制</h2><p>让我们来看看他的源代码.</p>\n<p>当执行<code>Integer i=128;</code>这个语句时,Java会调用<code>valueOf(int i)</code>方法,然后<code>自动装箱</code>的方式,让其变成<code>Integer i=new Integer(128)</code>,具体源码如下:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Integer <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class=\"line\">    <span class=\"comment\">//装箱</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Integer(i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>从上面的源码中可以看到,在装箱之前会执行一个<code>if</code>语句,这个<code>if</code>语句就是判断传入的值是否在缓存内,如果在缓存内,就直接返回缓存内的值,如果不在缓存内,就装箱,在堆内创建一个新空间来存放.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//Integer包装类缓存源码</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IntegerCache</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> low = -<span class=\"number\">128</span>;</span><br><span class=\"line\">        <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> high;</span><br><span class=\"line\">        <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Integer cache[];</span><br><span class=\"line\">        <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// high value may be configured by property</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> h = <span class=\"number\">127</span>;</span><br><span class=\"line\">            String integerCacheHighPropValue =</span><br><span class=\"line\">                sun.misc.VM.getSavedProperty(<span class=\"string\">\"java.lang.Integer.IntegerCache.high\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (integerCacheHighPropValue != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> i = parseInt(integerCacheHighPropValue);</span><br><span class=\"line\">                    i = Math.max(i, <span class=\"number\">127</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// Maximum array size is Integer.MAX_VALUE</span></span><br><span class=\"line\">                    h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class=\"number\">1</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span>( NumberFormatException nfe) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// If the property cannot be parsed into an int, ignore it.</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            high = h;</span><br><span class=\"line\">            cache = <span class=\"keyword\">new</span> Integer[(high - low) + <span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"keyword\">int</span> j = low;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> k = <span class=\"number\">0</span>; k &lt; cache.length; k++)</span><br><span class=\"line\">                cache[k] = <span class=\"keyword\">new</span> Integer(j++);</span><br><span class=\"line\">            <span class=\"comment\">// range [-128, 127] must be interned (JLS7 5.1.7)</span></span><br><span class=\"line\">            <span class=\"keyword\">assert</span> IntegerCache.high &gt;= <span class=\"number\">127</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">IntegerCache</span><span class=\"params\">()</span> </span>&#123;&#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>从源码中可以看到,<code>Integer</code>的缓存范围是<code>-128~127</code>,所以过程大致如下:</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200603114246.png\" alt></p>\n<p>按照上面这个方法,只要在数据在缓存池范围内的,都会引用缓存在堆内的地址,所有上面的<code>i3==i4</code>会输出为<code>true</code>;而不在缓存范围内的,就会在堆中开放新的空间来存放对象,所以地址不同,用<code>==</code>比较返回也不同;</p>\n<h2 id=\"其他包装类缓存机制\"><a href=\"#其他包装类缓存机制\" class=\"headerlink\" title=\"其他包装类缓存机制\"></a>其他包装类缓存机制</h2><p>除了<code>Integer</code>之外,其他的包装类也使用了缓存技术;</p>\n<h3 id=\"Long\"><a href=\"#Long\" class=\"headerlink\" title=\"Long\"></a>Long</h3><blockquote>\n<p>缓存范围-128~127</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Long <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">long</span> l)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> offset = <span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &gt;= -<span class=\"number\">128</span> &amp;&amp; l &lt;= <span class=\"number\">127</span>) &#123; <span class=\"comment\">// will cache</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> LongCache.cache[(<span class=\"keyword\">int</span>)l + offset];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Long(l);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongCache</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">LongCache</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Long cache[] = <span class=\"keyword\">new</span> Long[-(-<span class=\"number\">128</span>) + <span class=\"number\">127</span> + <span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cache.length; i++)</span><br><span class=\"line\">            cache[i] = <span class=\"keyword\">new</span> Long(i - <span class=\"number\">128</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Byte\"><a href=\"#Byte\" class=\"headerlink\" title=\"Byte\"></a>Byte</h3><blockquote>\n<p>缓存范围-128<del>127   (byte范围:一个byte占8位,所以取值范围是**-2^7</del>2^7-1**)</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Byte <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">byte</span> b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> offset = <span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ByteCache.cache[(<span class=\"keyword\">int</span>)b + offset];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ByteCache</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">ByteCache</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Byte cache[] = <span class=\"keyword\">new</span> Byte[-(-<span class=\"number\">128</span>) + <span class=\"number\">127</span> + <span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cache.length; i++)</span><br><span class=\"line\">            cache[i] = <span class=\"keyword\">new</span> Byte((<span class=\"keyword\">byte</span>)(i - <span class=\"number\">128</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Character\"><a href=\"#Character\" class=\"headerlink\" title=\"Character\"></a>Character</h3><blockquote>\n<p>缓存范围0~127  (ascii码范围) </p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Character <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (c &lt;= <span class=\"number\">127</span>) &#123; <span class=\"comment\">// must cache</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> CharacterCache.cache[(<span class=\"keyword\">int</span>)c];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Character(c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CharacterCache</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">CharacterCache</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Character cache[] = <span class=\"keyword\">new</span> Character[<span class=\"number\">127</span> + <span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cache.length; i++)</span><br><span class=\"line\">            cache[i] = <span class=\"keyword\">new</span> Character((<span class=\"keyword\">char</span>)i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Short\"><a href=\"#Short\" class=\"headerlink\" title=\"Short\"></a>Short</h3><blockquote>\n<p>缓存范围-128~127</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Short <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">short</span> s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> offset = <span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sAsInt = s;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (sAsInt &gt;= -<span class=\"number\">128</span> &amp;&amp; sAsInt &lt;= <span class=\"number\">127</span>) &#123; <span class=\"comment\">// must cache</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> ShortCache.cache[sAsInt + offset];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Short(s);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShortCache</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">ShortCache</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Short cache[] = <span class=\"keyword\">new</span> Short[-(-<span class=\"number\">128</span>) + <span class=\"number\">127</span> + <span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cache.length; i++)</span><br><span class=\"line\">            cache[i] = <span class=\"keyword\">new</span> Short((<span class=\"keyword\">short</span>)(i - <span class=\"number\">128</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Boolean\"><a href=\"#Boolean\" class=\"headerlink\" title=\"Boolean\"></a>Boolean</h3><blockquote>\n<p>缓存范围 <code>true</code>  <code>false</code>     它只设置了两个静态变量用来充当缓存</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Boolean TRUE = <span class=\"keyword\">new</span> Boolean(<span class=\"keyword\">true</span>);</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Boolean FALSE = <span class=\"keyword\">new</span> Boolean(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Boolean <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">boolean</span> b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (b ? TRUE : FALSE);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"建议\"><a href=\"#建议\" class=\"headerlink\" title=\"建议\"></a>建议</h2><p>包装类对比数据是否相同的时候,建议采用重写的<code>equals()</code>方法.</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"面试题\"><a href=\"#面试题\" class=\"headerlink\" title=\"面试题\"></a>面试题</h2><p>首先,来看一道常见的面试题,下面代码运行后会输出什么?</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200603110911.png\" alt></p>\n<p>上面代码运行后,最终会输出<code>false</code>和<code>true</code>;为什么会这样呢?</p>\n<p>按道理来说,在Java中<code>==</code>是比较两个对象的地址,上面代码中<code>i3</code>和<code>i4</code>是两个不同的对象,理应也应该返回是<code>false</code>,怎么返回是<code>true</code>呢?让我们慢慢往下看</p>\n<h2 id=\"Integer的缓存机制\"><a href=\"#Integer的缓存机制\" class=\"headerlink\" title=\"Integer的缓存机制\"></a>Integer的缓存机制</h2><p>让我们来看看他的源代码.</p>\n<p>当执行<code>Integer i=128;</code>这个语句时,Java会调用<code>valueOf(int i)</code>方法,然后<code>自动装箱</code>的方式,让其变成<code>Integer i=new Integer(128)</code>,具体源码如下:</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Integer <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">int</span> i)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> IntegerCache.cache[i + (-IntegerCache.low)];</span><br><span class=\"line\">    <span class=\"comment\">//装箱</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Integer(i);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>从上面的源码中可以看到,在装箱之前会执行一个<code>if</code>语句,这个<code>if</code>语句就是判断传入的值是否在缓存内,如果在缓存内,就直接返回缓存内的值,如果不在缓存内,就装箱,在堆内创建一个新空间来存放.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//Integer包装类缓存源码</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">IntegerCache</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> low = -<span class=\"number\">128</span>;</span><br><span class=\"line\">        <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> high;</span><br><span class=\"line\">        <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Integer cache[];</span><br><span class=\"line\">        <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// high value may be configured by property</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> h = <span class=\"number\">127</span>;</span><br><span class=\"line\">            String integerCacheHighPropValue =</span><br><span class=\"line\">                sun.misc.VM.getSavedProperty(<span class=\"string\">\"java.lang.Integer.IntegerCache.high\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (integerCacheHighPropValue != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> i = parseInt(integerCacheHighPropValue);</span><br><span class=\"line\">                    i = Math.max(i, <span class=\"number\">127</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// Maximum array size is Integer.MAX_VALUE</span></span><br><span class=\"line\">                    h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class=\"number\">1</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span>( NumberFormatException nfe) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// If the property cannot be parsed into an int, ignore it.</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            high = h;</span><br><span class=\"line\">            cache = <span class=\"keyword\">new</span> Integer[(high - low) + <span class=\"number\">1</span>];</span><br><span class=\"line\">            <span class=\"keyword\">int</span> j = low;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> k = <span class=\"number\">0</span>; k &lt; cache.length; k++)</span><br><span class=\"line\">                cache[k] = <span class=\"keyword\">new</span> Integer(j++);</span><br><span class=\"line\">            <span class=\"comment\">// range [-128, 127] must be interned (JLS7 5.1.7)</span></span><br><span class=\"line\">            <span class=\"keyword\">assert</span> IntegerCache.high &gt;= <span class=\"number\">127</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">IntegerCache</span><span class=\"params\">()</span> </span>&#123;&#125;</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n\n<p>从源码中可以看到,<code>Integer</code>的缓存范围是<code>-128~127</code>,所以过程大致如下:</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200603114246.png\" alt></p>\n<p>按照上面这个方法,只要在数据在缓存池范围内的,都会引用缓存在堆内的地址,所有上面的<code>i3==i4</code>会输出为<code>true</code>;而不在缓存范围内的,就会在堆中开放新的空间来存放对象,所以地址不同,用<code>==</code>比较返回也不同;</p>\n<h2 id=\"其他包装类缓存机制\"><a href=\"#其他包装类缓存机制\" class=\"headerlink\" title=\"其他包装类缓存机制\"></a>其他包装类缓存机制</h2><p>除了<code>Integer</code>之外,其他的包装类也使用了缓存技术;</p>\n<h3 id=\"Long\"><a href=\"#Long\" class=\"headerlink\" title=\"Long\"></a>Long</h3><blockquote>\n<p>缓存范围-128~127</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Long <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">long</span> l)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> offset = <span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (l &gt;= -<span class=\"number\">128</span> &amp;&amp; l &lt;= <span class=\"number\">127</span>) &#123; <span class=\"comment\">// will cache</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> LongCache.cache[(<span class=\"keyword\">int</span>)l + offset];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Long(l);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongCache</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">LongCache</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Long cache[] = <span class=\"keyword\">new</span> Long[-(-<span class=\"number\">128</span>) + <span class=\"number\">127</span> + <span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cache.length; i++)</span><br><span class=\"line\">            cache[i] = <span class=\"keyword\">new</span> Long(i - <span class=\"number\">128</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Byte\"><a href=\"#Byte\" class=\"headerlink\" title=\"Byte\"></a>Byte</h3><blockquote>\n<p>缓存范围-128<del>127   (byte范围:一个byte占8位,所以取值范围是**-2^7</del>2^7-1**)</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Byte <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">byte</span> b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> offset = <span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ByteCache.cache[(<span class=\"keyword\">int</span>)b + offset];</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ByteCache</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">ByteCache</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Byte cache[] = <span class=\"keyword\">new</span> Byte[-(-<span class=\"number\">128</span>) + <span class=\"number\">127</span> + <span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cache.length; i++)</span><br><span class=\"line\">            cache[i] = <span class=\"keyword\">new</span> Byte((<span class=\"keyword\">byte</span>)(i - <span class=\"number\">128</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Character\"><a href=\"#Character\" class=\"headerlink\" title=\"Character\"></a>Character</h3><blockquote>\n<p>缓存范围0~127  (ascii码范围) </p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Character <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">char</span> c)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (c &lt;= <span class=\"number\">127</span>) &#123; <span class=\"comment\">// must cache</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> CharacterCache.cache[(<span class=\"keyword\">int</span>)c];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Character(c);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CharacterCache</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">CharacterCache</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Character cache[] = <span class=\"keyword\">new</span> Character[<span class=\"number\">127</span> + <span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cache.length; i++)</span><br><span class=\"line\">            cache[i] = <span class=\"keyword\">new</span> Character((<span class=\"keyword\">char</span>)i);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Short\"><a href=\"#Short\" class=\"headerlink\" title=\"Short\"></a>Short</h3><blockquote>\n<p>缓存范围-128~127</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Short <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">short</span> s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> offset = <span class=\"number\">128</span>;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> sAsInt = s;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (sAsInt &gt;= -<span class=\"number\">128</span> &amp;&amp; sAsInt &lt;= <span class=\"number\">127</span>) &#123; <span class=\"comment\">// must cache</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> ShortCache.cache[sAsInt + offset];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Short(s);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ShortCache</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">ShortCache</span><span class=\"params\">()</span></span>&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Short cache[] = <span class=\"keyword\">new</span> Short[-(-<span class=\"number\">128</span>) + <span class=\"number\">127</span> + <span class=\"number\">1</span>];</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; cache.length; i++)</span><br><span class=\"line\">            cache[i] = <span class=\"keyword\">new</span> Short((<span class=\"keyword\">short</span>)(i - <span class=\"number\">128</span>));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Boolean\"><a href=\"#Boolean\" class=\"headerlink\" title=\"Boolean\"></a>Boolean</h3><blockquote>\n<p>缓存范围 <code>true</code>  <code>false</code>     它只设置了两个静态变量用来充当缓存</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Boolean TRUE = <span class=\"keyword\">new</span> Boolean(<span class=\"keyword\">true</span>);</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Boolean FALSE = <span class=\"keyword\">new</span> Boolean(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> Boolean <span class=\"title\">valueOf</span><span class=\"params\">(<span class=\"keyword\">boolean</span> b)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (b ? TRUE : FALSE);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"建议\"><a href=\"#建议\" class=\"headerlink\" title=\"建议\"></a>建议</h2><p>包装类对比数据是否相同的时候,建议采用重写的<code>equals()</code>方法.</p>\n"},{"title":"【图】用图片告诉你Java中的位运算","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-30T14:17:30.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n![](http://cdn.mjava.top/20191230221924.jpg)\n\n## 前言\n\n​        虽然位运算在实际开发中并不常用,但是在各种算法中却常常见到它们的身影.因为是直接操作二进制的,所以机器执行起来就快很多,所以尽管实际业务中不常用,但如果你不想只做个码农,这个基础还是要掌握的;\n\n讲位操作之前,就必须要知道<font color=orange>原码、反码、补码</font>\n\n> 其中正数的<font color=orange>原码=反码=补码</font>\n\n## 原码、反码、补码\n\n> 在机器的内存中,一个负数的表示是<font color=orange>这个负数的绝对值取原码,再取反码,再加一</font>,最后出现的就是这个负数在内存中的表示的二进制数值\n\n比如说-9在内存中的二进制码,这里用8位表示:\n\n![](http://cdn.mjava.top/20191230212102.png)\n\n最后<font color=orange>-9在内存中的二进制值为11110111</font>\n\n> 在二进制中,最高位为符号位,<font color=red>0代表正,1代表负</font>\n\n## 位运算\n\n### 左移和右移\n\n在`Java`中的`int`类型有<font color=orange>4字节</font>,一个字节有<font color=orange>8位</font>,所以这边用32位表示一个数\n\n#### 负数的左移和右移\n\n> <font color=orange>这边负数表示是在内存中表示的二进制值</font>\n>\n> 右移时:最高位<font color=orange>补符号位1</font>\n>\n> 左移时:末尾补0\n\n![](http://cdn.mjava.top/20191230212836.png)\n\n#### 正数的左移和右移\n\n> 右移时:最高位<font color=orange>补符号位0</font>\n>\n> 左移时:末尾补0\n\n![](http://cdn.mjava.top/20191230212951.png)\n\n### 无符号右移\n\n>无论是正数还是负数,右移<font color=orange>最高位一律补0</font>\n\n![](http://cdn.mjava.top/20191230213359.png)\n\n### &(位与)\n\n> 当相对应的位都为1时,等于1,否则等于0\n\n为了方便表示,接下来全部都用8位表示一个数\n\n![](http://cdn.mjava.top/20191230215214.png)\n\n### |(位或)\n\n> 当相对应的位有一个为1时,等于1,否则等于0\n\n![](http://cdn.mjava.top/20191230215609.png)\n\n### ^(异或)\n\n> 当相对应的位不同时,等于1,相同时等于0\n\n![](http://cdn.mjava.top/20191230220948.png)\n\n### ~(取反)\n\n> 1等于0,0等于1\n\n![](http://cdn.mjava.top/20191230220449.png)\n\n## 总结\n\n| 含义       | 运算符 | 说明                                                         |\n| ---------- | ------ | ------------------------------------------------------------ |\n| 左移       | <<     | 末尾补0                                                      |\n| 右移       | \\>>    | 负数:最高位<font color=orange>补符号位1</font>      正数:最高位<font color=orange>补符号位0</font> |\n| 无符号右移 | \\>>>   | 无论是正数还是负数,右移<font color=orange>最高位一律补0</font> |\n| &(位与)    | &      | 当相对应的位都为1时,等于1,否则等于0                          |\n| \\|(位或)   | \\|     | 当相对应的位有一个为1时,等于1,否则等于0                      |\n| ^(异或)    | ^      | 当相对应的位 不同时,等于1  相同时,等于0                      |\n| ~(取反)    | ~      | 1等于0,0等于1                                                |\n\n> 最后有个小技巧,<font color=orange>向左位移几位就是乘以2的几次方,比如9向左移n位,就是</font>\n\n$$\n9向左移n位=9*2^n\n$$\n\n> <font color=orange>向右移几位就是除以2的几次方然后向下取整,比如9向右移动n位,就是</font>\n\n$$\n9向右移n位=⌊9/2^n⌋\n$$\n\n<font color=red>注:⌊⌋是数学符号向下取整,例如:2.25向下取整是2;   -2.25向下取整是-3; 具体的话可以看看这篇文章[向上取整与向下取整函数](https://www.shuxuele.com/sets/function-floor-ceiling.html);该技巧不适用无符号右移</font>\n\n","source":"_posts/java/java-base-wei.md","raw":"---\ntitle: 【图】用图片告诉你Java中的位运算\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-30 22:17:30\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Java\ncategories:\n- Java\n---\n\n![](http://cdn.mjava.top/20191230221924.jpg)\n\n## 前言\n\n​        虽然位运算在实际开发中并不常用,但是在各种算法中却常常见到它们的身影.因为是直接操作二进制的,所以机器执行起来就快很多,所以尽管实际业务中不常用,但如果你不想只做个码农,这个基础还是要掌握的;\n\n讲位操作之前,就必须要知道<font color=orange>原码、反码、补码</font>\n\n> 其中正数的<font color=orange>原码=反码=补码</font>\n\n## 原码、反码、补码\n\n> 在机器的内存中,一个负数的表示是<font color=orange>这个负数的绝对值取原码,再取反码,再加一</font>,最后出现的就是这个负数在内存中的表示的二进制数值\n\n比如说-9在内存中的二进制码,这里用8位表示:\n\n![](http://cdn.mjava.top/20191230212102.png)\n\n最后<font color=orange>-9在内存中的二进制值为11110111</font>\n\n> 在二进制中,最高位为符号位,<font color=red>0代表正,1代表负</font>\n\n## 位运算\n\n### 左移和右移\n\n在`Java`中的`int`类型有<font color=orange>4字节</font>,一个字节有<font color=orange>8位</font>,所以这边用32位表示一个数\n\n#### 负数的左移和右移\n\n> <font color=orange>这边负数表示是在内存中表示的二进制值</font>\n>\n> 右移时:最高位<font color=orange>补符号位1</font>\n>\n> 左移时:末尾补0\n\n![](http://cdn.mjava.top/20191230212836.png)\n\n#### 正数的左移和右移\n\n> 右移时:最高位<font color=orange>补符号位0</font>\n>\n> 左移时:末尾补0\n\n![](http://cdn.mjava.top/20191230212951.png)\n\n### 无符号右移\n\n>无论是正数还是负数,右移<font color=orange>最高位一律补0</font>\n\n![](http://cdn.mjava.top/20191230213359.png)\n\n### &(位与)\n\n> 当相对应的位都为1时,等于1,否则等于0\n\n为了方便表示,接下来全部都用8位表示一个数\n\n![](http://cdn.mjava.top/20191230215214.png)\n\n### |(位或)\n\n> 当相对应的位有一个为1时,等于1,否则等于0\n\n![](http://cdn.mjava.top/20191230215609.png)\n\n### ^(异或)\n\n> 当相对应的位不同时,等于1,相同时等于0\n\n![](http://cdn.mjava.top/20191230220948.png)\n\n### ~(取反)\n\n> 1等于0,0等于1\n\n![](http://cdn.mjava.top/20191230220449.png)\n\n## 总结\n\n| 含义       | 运算符 | 说明                                                         |\n| ---------- | ------ | ------------------------------------------------------------ |\n| 左移       | <<     | 末尾补0                                                      |\n| 右移       | \\>>    | 负数:最高位<font color=orange>补符号位1</font>      正数:最高位<font color=orange>补符号位0</font> |\n| 无符号右移 | \\>>>   | 无论是正数还是负数,右移<font color=orange>最高位一律补0</font> |\n| &(位与)    | &      | 当相对应的位都为1时,等于1,否则等于0                          |\n| \\|(位或)   | \\|     | 当相对应的位有一个为1时,等于1,否则等于0                      |\n| ^(异或)    | ^      | 当相对应的位 不同时,等于1  相同时,等于0                      |\n| ~(取反)    | ~      | 1等于0,0等于1                                                |\n\n> 最后有个小技巧,<font color=orange>向左位移几位就是乘以2的几次方,比如9向左移n位,就是</font>\n\n$$\n9向左移n位=9*2^n\n$$\n\n> <font color=orange>向右移几位就是除以2的几次方然后向下取整,比如9向右移动n位,就是</font>\n\n$$\n9向右移n位=⌊9/2^n⌋\n$$\n\n<font color=red>注:⌊⌋是数学符号向下取整,例如:2.25向下取整是2;   -2.25向下取整是-3; 具体的话可以看看这篇文章[向上取整与向下取整函数](https://www.shuxuele.com/sets/function-floor-ceiling.html);该技巧不适用无符号右移</font>\n\n","slug":"java/java-base-wei","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjq001h2mg55ahbgu8f","content":"<p><img src=\"http://cdn.mjava.top/20191230221924.jpg\" alt></p>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>​        虽然位运算在实际开发中并不常用,但是在各种算法中却常常见到它们的身影.因为是直接操作二进制的,所以机器执行起来就快很多,所以尽管实际业务中不常用,但如果你不想只做个码农,这个基础还是要掌握的;</p>\n<p>讲位操作之前,就必须要知道<font color=\"orange\">原码、反码、补码</font></p>\n<blockquote>\n<p>其中正数的<font color=\"orange\">原码=反码=补码</font></p>\n</blockquote>\n<h2 id=\"原码、反码、补码\"><a href=\"#原码、反码、补码\" class=\"headerlink\" title=\"原码、反码、补码\"></a>原码、反码、补码</h2><blockquote>\n<p>在机器的内存中,一个负数的表示是<font color=\"orange\">这个负数的绝对值取原码,再取反码,再加一</font>,最后出现的就是这个负数在内存中的表示的二进制数值</p>\n</blockquote>\n<p>比如说-9在内存中的二进制码,这里用8位表示:</p>\n<p><img src=\"http://cdn.mjava.top/20191230212102.png\" alt></p>\n<p>最后<font color=\"orange\">-9在内存中的二进制值为11110111</font></p>\n<blockquote>\n<p>在二进制中,最高位为符号位,<font color=\"red\">0代表正,1代表负</font></p>\n</blockquote>\n<h2 id=\"位运算\"><a href=\"#位运算\" class=\"headerlink\" title=\"位运算\"></a>位运算</h2><h3 id=\"左移和右移\"><a href=\"#左移和右移\" class=\"headerlink\" title=\"左移和右移\"></a>左移和右移</h3><p>在<code>Java</code>中的<code>int</code>类型有<font color=\"orange\">4字节</font>,一个字节有<font color=\"orange\">8位</font>,所以这边用32位表示一个数</p>\n<h4 id=\"负数的左移和右移\"><a href=\"#负数的左移和右移\" class=\"headerlink\" title=\"负数的左移和右移\"></a>负数的左移和右移</h4><blockquote>\n<p><font color=\"orange\">这边负数表示是在内存中表示的二进制值</font></p>\n<p>右移时:最高位<font color=\"orange\">补符号位1</font></p>\n<p>左移时:末尾补0</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230212836.png\" alt></p>\n<h4 id=\"正数的左移和右移\"><a href=\"#正数的左移和右移\" class=\"headerlink\" title=\"正数的左移和右移\"></a>正数的左移和右移</h4><blockquote>\n<p>右移时:最高位<font color=\"orange\">补符号位0</font></p>\n<p>左移时:末尾补0</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230212951.png\" alt></p>\n<h3 id=\"无符号右移\"><a href=\"#无符号右移\" class=\"headerlink\" title=\"无符号右移\"></a>无符号右移</h3><blockquote>\n<p>无论是正数还是负数,右移<font color=\"orange\">最高位一律补0</font></p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230213359.png\" alt></p>\n<h3 id=\"amp-位与\"><a href=\"#amp-位与\" class=\"headerlink\" title=\"&amp;(位与)\"></a>&amp;(位与)</h3><blockquote>\n<p>当相对应的位都为1时,等于1,否则等于0</p>\n</blockquote>\n<p>为了方便表示,接下来全部都用8位表示一个数</p>\n<p><img src=\"http://cdn.mjava.top/20191230215214.png\" alt></p>\n<h3 id=\"位或\"><a href=\"#位或\" class=\"headerlink\" title=\"|(位或)\"></a>|(位或)</h3><blockquote>\n<p>当相对应的位有一个为1时,等于1,否则等于0</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230215609.png\" alt></p>\n<h3 id=\"异或\"><a href=\"#异或\" class=\"headerlink\" title=\"^(异或)\"></a>^(异或)</h3><blockquote>\n<p>当相对应的位不同时,等于1,相同时等于0</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230220948.png\" alt></p>\n<h3 id=\"取反\"><a href=\"#取反\" class=\"headerlink\" title=\"~(取反)\"></a>~(取反)</h3><blockquote>\n<p>1等于0,0等于1</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230220449.png\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><table>\n<thead>\n<tr>\n<th>含义</th>\n<th>运算符</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>左移</td>\n<td>&lt;&lt;</td>\n<td>末尾补0</td>\n</tr>\n<tr>\n<td>右移</td>\n<td>&gt;&gt;</td>\n<td>负数:最高位<font color=\"orange\">补符号位1</font>      正数:最高位<font color=\"orange\">补符号位0</font></td>\n</tr>\n<tr>\n<td>无符号右移</td>\n<td>&gt;&gt;&gt;</td>\n<td>无论是正数还是负数,右移<font color=\"orange\">最高位一律补0</font></td>\n</tr>\n<tr>\n<td>&amp;(位与)</td>\n<td>&amp;</td>\n<td>当相对应的位都为1时,等于1,否则等于0</td>\n</tr>\n<tr>\n<td>|(位或)</td>\n<td>|</td>\n<td>当相对应的位有一个为1时,等于1,否则等于0</td>\n</tr>\n<tr>\n<td>^(异或)</td>\n<td>^</td>\n<td>当相对应的位 不同时,等于1  相同时,等于0</td>\n</tr>\n<tr>\n<td>~(取反)</td>\n<td>~</td>\n<td>1等于0,0等于1</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>最后有个小技巧,<font color=\"orange\">向左位移几位就是乘以2的几次方,比如9向左移n位,就是</font></p>\n</blockquote>\n<p>$$<br>9向左移n位=9*2^n<br>$$</p>\n<blockquote>\n<p><font color=\"orange\">向右移几位就是除以2的几次方然后向下取整,比如9向右移动n位,就是</font></p>\n</blockquote>\n<p>$$<br>9向右移n位=⌊9/2^n⌋<br>$$</p>\n<p><font color=\"red\">注:⌊⌋是数学符号向下取整,例如:2.25向下取整是2;   -2.25向下取整是-3; 具体的话可以看看这篇文章<a href=\"https://www.shuxuele.com/sets/function-floor-ceiling.html\" rel=\"noopener\" target=\"_blank\">向上取整与向下取整函数</a>;该技巧不适用无符号右移</font></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p><img src=\"http://cdn.mjava.top/20191230221924.jpg\" alt></p>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>​        虽然位运算在实际开发中并不常用,但是在各种算法中却常常见到它们的身影.因为是直接操作二进制的,所以机器执行起来就快很多,所以尽管实际业务中不常用,但如果你不想只做个码农,这个基础还是要掌握的;</p>\n<p>讲位操作之前,就必须要知道<font color=\"orange\">原码、反码、补码</font></p>\n<blockquote>\n<p>其中正数的<font color=\"orange\">原码=反码=补码</font></p>\n</blockquote>\n<h2 id=\"原码、反码、补码\"><a href=\"#原码、反码、补码\" class=\"headerlink\" title=\"原码、反码、补码\"></a>原码、反码、补码</h2><blockquote>\n<p>在机器的内存中,一个负数的表示是<font color=\"orange\">这个负数的绝对值取原码,再取反码,再加一</font>,最后出现的就是这个负数在内存中的表示的二进制数值</p>\n</blockquote>\n<p>比如说-9在内存中的二进制码,这里用8位表示:</p>\n<p><img src=\"http://cdn.mjava.top/20191230212102.png\" alt></p>\n<p>最后<font color=\"orange\">-9在内存中的二进制值为11110111</font></p>\n<blockquote>\n<p>在二进制中,最高位为符号位,<font color=\"red\">0代表正,1代表负</font></p>\n</blockquote>\n<h2 id=\"位运算\"><a href=\"#位运算\" class=\"headerlink\" title=\"位运算\"></a>位运算</h2><h3 id=\"左移和右移\"><a href=\"#左移和右移\" class=\"headerlink\" title=\"左移和右移\"></a>左移和右移</h3><p>在<code>Java</code>中的<code>int</code>类型有<font color=\"orange\">4字节</font>,一个字节有<font color=\"orange\">8位</font>,所以这边用32位表示一个数</p>\n<h4 id=\"负数的左移和右移\"><a href=\"#负数的左移和右移\" class=\"headerlink\" title=\"负数的左移和右移\"></a>负数的左移和右移</h4><blockquote>\n<p><font color=\"orange\">这边负数表示是在内存中表示的二进制值</font></p>\n<p>右移时:最高位<font color=\"orange\">补符号位1</font></p>\n<p>左移时:末尾补0</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230212836.png\" alt></p>\n<h4 id=\"正数的左移和右移\"><a href=\"#正数的左移和右移\" class=\"headerlink\" title=\"正数的左移和右移\"></a>正数的左移和右移</h4><blockquote>\n<p>右移时:最高位<font color=\"orange\">补符号位0</font></p>\n<p>左移时:末尾补0</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230212951.png\" alt></p>\n<h3 id=\"无符号右移\"><a href=\"#无符号右移\" class=\"headerlink\" title=\"无符号右移\"></a>无符号右移</h3><blockquote>\n<p>无论是正数还是负数,右移<font color=\"orange\">最高位一律补0</font></p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230213359.png\" alt></p>\n<h3 id=\"amp-位与\"><a href=\"#amp-位与\" class=\"headerlink\" title=\"&amp;(位与)\"></a>&amp;(位与)</h3><blockquote>\n<p>当相对应的位都为1时,等于1,否则等于0</p>\n</blockquote>\n<p>为了方便表示,接下来全部都用8位表示一个数</p>\n<p><img src=\"http://cdn.mjava.top/20191230215214.png\" alt></p>\n<h3 id=\"位或\"><a href=\"#位或\" class=\"headerlink\" title=\"|(位或)\"></a>|(位或)</h3><blockquote>\n<p>当相对应的位有一个为1时,等于1,否则等于0</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230215609.png\" alt></p>\n<h3 id=\"异或\"><a href=\"#异或\" class=\"headerlink\" title=\"^(异或)\"></a>^(异或)</h3><blockquote>\n<p>当相对应的位不同时,等于1,相同时等于0</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230220948.png\" alt></p>\n<h3 id=\"取反\"><a href=\"#取反\" class=\"headerlink\" title=\"~(取反)\"></a>~(取反)</h3><blockquote>\n<p>1等于0,0等于1</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/20191230220449.png\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><table>\n<thead>\n<tr>\n<th>含义</th>\n<th>运算符</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>左移</td>\n<td>&lt;&lt;</td>\n<td>末尾补0</td>\n</tr>\n<tr>\n<td>右移</td>\n<td>&gt;&gt;</td>\n<td>负数:最高位<font color=\"orange\">补符号位1</font>      正数:最高位<font color=\"orange\">补符号位0</font></td>\n</tr>\n<tr>\n<td>无符号右移</td>\n<td>&gt;&gt;&gt;</td>\n<td>无论是正数还是负数,右移<font color=\"orange\">最高位一律补0</font></td>\n</tr>\n<tr>\n<td>&amp;(位与)</td>\n<td>&amp;</td>\n<td>当相对应的位都为1时,等于1,否则等于0</td>\n</tr>\n<tr>\n<td>|(位或)</td>\n<td>|</td>\n<td>当相对应的位有一个为1时,等于1,否则等于0</td>\n</tr>\n<tr>\n<td>^(异或)</td>\n<td>^</td>\n<td>当相对应的位 不同时,等于1  相同时,等于0</td>\n</tr>\n<tr>\n<td>~(取反)</td>\n<td>~</td>\n<td>1等于0,0等于1</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>最后有个小技巧,<font color=\"orange\">向左位移几位就是乘以2的几次方,比如9向左移n位,就是</font></p>\n</blockquote>\n<p>$$<br>9向左移n位=9*2^n<br>$$</p>\n<blockquote>\n<p><font color=\"orange\">向右移几位就是除以2的几次方然后向下取整,比如9向右移动n位,就是</font></p>\n</blockquote>\n<p>$$<br>9向右移n位=⌊9/2^n⌋<br>$$</p>\n<p><font color=\"red\">注:⌊⌋是数学符号向下取整,例如:2.25向下取整是2;   -2.25向下取整是-3; 具体的话可以看看这篇文章<a href=\"https://www.shuxuele.com/sets/function-floor-ceiling.html\" rel=\"noopener\" target=\"_blank\">向上取整与向下取整函数</a>;该技巧不适用无符号右移</font></p>\n"},{"title":"Java的==和equals","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-08-20T11:22:50.000Z","password":null,"summary":null,"_content":"在平常工作和学习中，我们一般用==和equals来比较两个对象或数据是否相等。但是什么时候用equals，什么时候用==一直都不怎么清楚，今天整理了下；\n\n## 首先看看Java的栈空间和堆空间的地址引用\n![Java栈空间和堆空间](http://cdn.mjava.top/blog/javaand1.png)\n\n##  ==的说明\n  在Java中，==对比的是两个对象在空间里的地址是否一致,比如上图的s2==s3返回的是false，s5==s6返回的是为true。话不多说，上代码。\n```java\npublic class demo2 {\n    public static void main(String[] args) {\n        String s1=new String(\"t1\");\n        String s2=new String(\"t2\");\n        String s3=new String(\"t2\");\n\n        String s4=new String(\"t3\");\n        String s5=\"t3\";\n        String s6=\"t3\";\n\n        System.out.println(\"s2==s3:\"+(s2==s3));\n        System.out.println(\"s5==s6:\"+(s5==s6));\n    }\n}\n```\n结果：\n![控制台输出](http://cdn.mjava.top/blog/javaand2.png)\n\n>这是因为==比的是在空间里的地址，s2和s3在堆里面是两个不同的对象，所以地址也不同，自然返回就是false。s5和s6是Java的基础数据类型，指向的是常量池里同一个引用，所以地址也相同，返回的就是true。\n\n## equals的说明\n  每个Object里的equals都不一样，我们看看String里的源码\n```java\npublic boolean equals(Object anObject) {\n    if (this == anObject) {\n        return true;\n    }\n    if (anObject instanceof String) {\n        String anotherString = (String)anObject;\n        int n = value.length;\n        if (n == anotherString.value.length) {\n            char v1[] = value;\n            char v2[] = anotherString.value;\n            int i = 0;\n            while (n-- != 0) {\n                if (v1[i] != v2[i])\n                    return false;\n                i++;\n            }\n            return true;\n        }\n    }\n    return false;\n}\n```\n* 首先它会对比地址，如果地址相等，就直接返回true\n* 如果地址不相等，就会对比里面的每一个字符，直到完全相等，然后返回true\n\n## 总结\n　　所以一般如果是对比两个对象是否相等的话，用==就可以。但是如果你要对比两个值是否相等的话，就要用equals了，因为如果用==就会出现上面明明值相等,返回却是false的情况。\n","source":"_posts/java/java-equals.md","raw":"---\ntitle: Java的==和equals\ntop: false\ncover: false\ntoc: true\nmathjax: true\ncategories:\n  - Java\ntags:\n  - Java\ndate: 2019-08-20 19:22:50\npassword:\nsummary:\n---\n在平常工作和学习中，我们一般用==和equals来比较两个对象或数据是否相等。但是什么时候用equals，什么时候用==一直都不怎么清楚，今天整理了下；\n\n## 首先看看Java的栈空间和堆空间的地址引用\n![Java栈空间和堆空间](http://cdn.mjava.top/blog/javaand1.png)\n\n##  ==的说明\n  在Java中，==对比的是两个对象在空间里的地址是否一致,比如上图的s2==s3返回的是false，s5==s6返回的是为true。话不多说，上代码。\n```java\npublic class demo2 {\n    public static void main(String[] args) {\n        String s1=new String(\"t1\");\n        String s2=new String(\"t2\");\n        String s3=new String(\"t2\");\n\n        String s4=new String(\"t3\");\n        String s5=\"t3\";\n        String s6=\"t3\";\n\n        System.out.println(\"s2==s3:\"+(s2==s3));\n        System.out.println(\"s5==s6:\"+(s5==s6));\n    }\n}\n```\n结果：\n![控制台输出](http://cdn.mjava.top/blog/javaand2.png)\n\n>这是因为==比的是在空间里的地址，s2和s3在堆里面是两个不同的对象，所以地址也不同，自然返回就是false。s5和s6是Java的基础数据类型，指向的是常量池里同一个引用，所以地址也相同，返回的就是true。\n\n## equals的说明\n  每个Object里的equals都不一样，我们看看String里的源码\n```java\npublic boolean equals(Object anObject) {\n    if (this == anObject) {\n        return true;\n    }\n    if (anObject instanceof String) {\n        String anotherString = (String)anObject;\n        int n = value.length;\n        if (n == anotherString.value.length) {\n            char v1[] = value;\n            char v2[] = anotherString.value;\n            int i = 0;\n            while (n-- != 0) {\n                if (v1[i] != v2[i])\n                    return false;\n                i++;\n            }\n            return true;\n        }\n    }\n    return false;\n}\n```\n* 首先它会对比地址，如果地址相等，就直接返回true\n* 如果地址不相等，就会对比里面的每一个字符，直到完全相等，然后返回true\n\n## 总结\n　　所以一般如果是对比两个对象是否相等的话，用==就可以。但是如果你要对比两个值是否相等的话，就要用equals了，因为如果用==就会出现上面明明值相等,返回却是false的情况。\n","slug":"java/java-equals","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjr001l2mg5z5jvh3al","content":"<p>在平常工作和学习中，我们一般用==和equals来比较两个对象或数据是否相等。但是什么时候用equals，什么时候用==一直都不怎么清楚，今天整理了下；</p>\n<h2 id=\"首先看看Java的栈空间和堆空间的地址引用\"><a href=\"#首先看看Java的栈空间和堆空间的地址引用\" class=\"headerlink\" title=\"首先看看Java的栈空间和堆空间的地址引用\"></a>首先看看Java的栈空间和堆空间的地址引用</h2><p><img src=\"http://cdn.mjava.top/blog/javaand1.png\" alt=\"Java栈空间和堆空间\"></p>\n<h2 id=\"的说明\"><a href=\"#的说明\" class=\"headerlink\" title=\"==的说明\"></a>==的说明</h2><p>  在Java中，==对比的是两个对象在空间里的地址是否一致,比如上图的s2==s3返回的是false，s5==s6返回的是为true。话不多说，上代码。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">demo2</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        String s1=<span class=\"keyword\">new</span> String(<span class=\"string\">\"t1\"</span>);</span><br><span class=\"line\">        String s2=<span class=\"keyword\">new</span> String(<span class=\"string\">\"t2\"</span>);</span><br><span class=\"line\">        String s3=<span class=\"keyword\">new</span> String(<span class=\"string\">\"t2\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        String s4=<span class=\"keyword\">new</span> String(<span class=\"string\">\"t3\"</span>);</span><br><span class=\"line\">        String s5=<span class=\"string\">\"t3\"</span>;</span><br><span class=\"line\">        String s6=<span class=\"string\">\"t3\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"s2==s3:\"</span>+(s2==s3));</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"s5==s6:\"</span>+(s5==s6));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>结果：<br><img src=\"http://cdn.mjava.top/blog/javaand2.png\" alt=\"控制台输出\"></p>\n<blockquote>\n<p>这是因为==比的是在空间里的地址，s2和s3在堆里面是两个不同的对象，所以地址也不同，自然返回就是false。s5和s6是Java的基础数据类型，指向的是常量池里同一个引用，所以地址也相同，返回的就是true。</p>\n</blockquote>\n<h2 id=\"equals的说明\"><a href=\"#equals的说明\" class=\"headerlink\" title=\"equals的说明\"></a>equals的说明</h2><p>  每个Object里的equals都不一样，我们看看String里的源码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">equals</span><span class=\"params\">(Object anObject)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span> == anObject) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (anObject <span class=\"keyword\">instanceof</span> String) &#123;</span><br><span class=\"line\">        String anotherString = (String)anObject;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> n = value.length;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n == anotherString.value.length) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> v1[] = value;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> v2[] = anotherString.value;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (n-- != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (v1[i] != v2[i])</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                i++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>首先它会对比地址，如果地址相等，就直接返回true</li>\n<li>如果地址不相等，就会对比里面的每一个字符，直到完全相等，然后返回true</li>\n</ul>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>　　所以一般如果是对比两个对象是否相等的话，用==就可以。但是如果你要对比两个值是否相等的话，就要用equals了，因为如果用==就会出现上面明明值相等,返回却是false的情况。</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p>在平常工作和学习中，我们一般用==和equals来比较两个对象或数据是否相等。但是什么时候用equals，什么时候用==一直都不怎么清楚，今天整理了下；</p>\n<h2 id=\"首先看看Java的栈空间和堆空间的地址引用\"><a href=\"#首先看看Java的栈空间和堆空间的地址引用\" class=\"headerlink\" title=\"首先看看Java的栈空间和堆空间的地址引用\"></a>首先看看Java的栈空间和堆空间的地址引用</h2><p><img src=\"http://cdn.mjava.top/blog/javaand1.png\" alt=\"Java栈空间和堆空间\"></p>\n<h2 id=\"的说明\"><a href=\"#的说明\" class=\"headerlink\" title=\"==的说明\"></a>==的说明</h2><p>  在Java中，==对比的是两个对象在空间里的地址是否一致,比如上图的s2==s3返回的是false，s5==s6返回的是为true。话不多说，上代码。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">demo2</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        String s1=<span class=\"keyword\">new</span> String(<span class=\"string\">\"t1\"</span>);</span><br><span class=\"line\">        String s2=<span class=\"keyword\">new</span> String(<span class=\"string\">\"t2\"</span>);</span><br><span class=\"line\">        String s3=<span class=\"keyword\">new</span> String(<span class=\"string\">\"t2\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        String s4=<span class=\"keyword\">new</span> String(<span class=\"string\">\"t3\"</span>);</span><br><span class=\"line\">        String s5=<span class=\"string\">\"t3\"</span>;</span><br><span class=\"line\">        String s6=<span class=\"string\">\"t3\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"s2==s3:\"</span>+(s2==s3));</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"s5==s6:\"</span>+(s5==s6));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>结果：<br><img src=\"http://cdn.mjava.top/blog/javaand2.png\" alt=\"控制台输出\"></p>\n<blockquote>\n<p>这是因为==比的是在空间里的地址，s2和s3在堆里面是两个不同的对象，所以地址也不同，自然返回就是false。s5和s6是Java的基础数据类型，指向的是常量池里同一个引用，所以地址也相同，返回的就是true。</p>\n</blockquote>\n<h2 id=\"equals的说明\"><a href=\"#equals的说明\" class=\"headerlink\" title=\"equals的说明\"></a>equals的说明</h2><p>  每个Object里的equals都不一样，我们看看String里的源码</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">equals</span><span class=\"params\">(Object anObject)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">this</span> == anObject) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (anObject <span class=\"keyword\">instanceof</span> String) &#123;</span><br><span class=\"line\">        String anotherString = (String)anObject;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> n = value.length;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (n == anotherString.value.length) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> v1[] = value;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> v2[] = anotherString.value;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> i = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (n-- != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (v1[i] != v2[i])</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                i++;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>首先它会对比地址，如果地址相等，就直接返回true</li>\n<li>如果地址不相等，就会对比里面的每一个字符，直到完全相等，然后返回true</li>\n</ul>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>　　所以一般如果是对比两个对象是否相等的话，用==就可以。但是如果你要对比两个值是否相等的话，就要用equals了，因为如果用==就会出现上面明明值相等,返回却是false的情况。</p>\n"},{"title":"Java中String判断为空的4大方法比较","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-08-20T10:59:15.000Z","password":null,"summary":null,"_content":"\n## 一.四大方法\n```java\npublic class demo1 {\n   public static void main(String[] args) {\n       String a=\"\";\n       String a2=new String();\n\n       System.out.println(a==\"\");\n       System.out.println(a2==\"\");\n       System.out.println(\"------------------------------\");\n       System.out.println(a==null);\n       System.out.println(a2==null);\n       System.out.println(\"------------------------------\");\n       System.out.println(a.length()<=0);\n       System.out.println(a2.length()<=0);\n       System.out.println(\"------------------------------\");\n       System.out.println(a.isEmpty());\n       System.out.println(a2.isEmpty());\n       System.out.println(\"------------------------------\");\n       \n   }\n}\n```\n## 二.输出结果\n![控制台输出](http://cdn.mjava.top/blog/javaands1.png)\n\n>可以看到用\"==\"判断的那组出现了不一致的情况\n","source":"_posts/java/java-isnull-four.md","raw":"---\ntitle: Java中String判断为空的4大方法比较\ntop: false\ncover: false\ntoc: true\nmathjax: true\ntags:\n  - Java\ncategories:\n  - Java\ndate: 2019-08-20 18:59:15\npassword:\nsummary:\n---\n\n## 一.四大方法\n```java\npublic class demo1 {\n   public static void main(String[] args) {\n       String a=\"\";\n       String a2=new String();\n\n       System.out.println(a==\"\");\n       System.out.println(a2==\"\");\n       System.out.println(\"------------------------------\");\n       System.out.println(a==null);\n       System.out.println(a2==null);\n       System.out.println(\"------------------------------\");\n       System.out.println(a.length()<=0);\n       System.out.println(a2.length()<=0);\n       System.out.println(\"------------------------------\");\n       System.out.println(a.isEmpty());\n       System.out.println(a2.isEmpty());\n       System.out.println(\"------------------------------\");\n       \n   }\n}\n```\n## 二.输出结果\n![控制台输出](http://cdn.mjava.top/blog/javaands1.png)\n\n>可以看到用\"==\"判断的那组出现了不一致的情况\n","slug":"java/java-isnull-four","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjs001p2mg5x5i8tysz","content":"<h2 id=\"一-四大方法\"><a href=\"#一-四大方法\" class=\"headerlink\" title=\"一.四大方法\"></a>一.四大方法</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">demo1</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">       String a=<span class=\"string\">\"\"</span>;</span><br><span class=\"line\">       String a2=<span class=\"keyword\">new</span> String();</span><br><span class=\"line\"></span><br><span class=\"line\">       System.out.println(a==<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">       System.out.println(a2==<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"------------------------------\"</span>);</span><br><span class=\"line\">       System.out.println(a==<span class=\"keyword\">null</span>);</span><br><span class=\"line\">       System.out.println(a2==<span class=\"keyword\">null</span>);</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"------------------------------\"</span>);</span><br><span class=\"line\">       System.out.println(a.length()&lt;=<span class=\"number\">0</span>);</span><br><span class=\"line\">       System.out.println(a2.length()&lt;=<span class=\"number\">0</span>);</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"------------------------------\"</span>);</span><br><span class=\"line\">       System.out.println(a.isEmpty());</span><br><span class=\"line\">       System.out.println(a2.isEmpty());</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"------------------------------\"</span>);</span><br><span class=\"line\">       </span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"二-输出结果\"><a href=\"#二-输出结果\" class=\"headerlink\" title=\"二.输出结果\"></a>二.输出结果</h2><p><img src=\"http://cdn.mjava.top/blog/javaands1.png\" alt=\"控制台输出\"></p>\n<blockquote>\n<p>可以看到用”==”判断的那组出现了不一致的情况</p>\n</blockquote>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"一-四大方法\"><a href=\"#一-四大方法\" class=\"headerlink\" title=\"一.四大方法\"></a>一.四大方法</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">demo1</span> </span>&#123;</span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">       String a=<span class=\"string\">\"\"</span>;</span><br><span class=\"line\">       String a2=<span class=\"keyword\">new</span> String();</span><br><span class=\"line\"></span><br><span class=\"line\">       System.out.println(a==<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">       System.out.println(a2==<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"------------------------------\"</span>);</span><br><span class=\"line\">       System.out.println(a==<span class=\"keyword\">null</span>);</span><br><span class=\"line\">       System.out.println(a2==<span class=\"keyword\">null</span>);</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"------------------------------\"</span>);</span><br><span class=\"line\">       System.out.println(a.length()&lt;=<span class=\"number\">0</span>);</span><br><span class=\"line\">       System.out.println(a2.length()&lt;=<span class=\"number\">0</span>);</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"------------------------------\"</span>);</span><br><span class=\"line\">       System.out.println(a.isEmpty());</span><br><span class=\"line\">       System.out.println(a2.isEmpty());</span><br><span class=\"line\">       System.out.println(<span class=\"string\">\"------------------------------\"</span>);</span><br><span class=\"line\">       </span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"二-输出结果\"><a href=\"#二-输出结果\" class=\"headerlink\" title=\"二.输出结果\"></a>二.输出结果</h2><p><img src=\"http://cdn.mjava.top/blog/javaands1.png\" alt=\"控制台输出\"></p>\n<blockquote>\n<p>可以看到用”==”判断的那组出现了不一致的情况</p>\n</blockquote>\n"},{"title":"Nacos报[NACOS HTTP-POST]","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-11-14T15:50:58.000Z","password":null,"summary":null,"_content":"\n## 问题\n\n　由于项目使用阿里的Nacos来管理项目的配置文件，今天所有使用Nacos的项目的日志都报[NACOS HTTP-POST] The maximum number of tolerable server reconnection errors has been reached这个错误。\n\n## 解决方法\n\n　查阅资料后说是连接超过了最大重试次数。Nacos有个maxRetry这个配置参数，默认是3;可是和SpringCloud整合后在application文件中找不到这个参数，只好另寻方法；\n\n　由于项目都是Docker容器化的，先前出现过连接不到Nacos的问题,于是就查看了各个Docker容器的IP。\n\n### 修正Nacos的地址\n\n　查阅后发现，是因为同事吧服务器重启了一遍，导致Docker服务也重启了，然后Docker容器里的IP全部都变了。因为同一台服务器上我们各个容器间的访问是通过Docker容器内部IP的，也就是172.16.x.x这个IP段。所以导致访问不到报错。\n\n```properties\nspring.cloud.nacos.config.server-addr=172.16.X.X     //更改到最新nacos的地址\n```","source":"_posts/java/nacos-post-error.md","raw":"---\ntitle: Nacos报[NACOS HTTP-POST]\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-11-14 23:50:58\npassword:\nsummary:\ntags:\n  - Nacos\ncategories:\n  - Java\n---\n\n## 问题\n\n　由于项目使用阿里的Nacos来管理项目的配置文件，今天所有使用Nacos的项目的日志都报[NACOS HTTP-POST] The maximum number of tolerable server reconnection errors has been reached这个错误。\n\n## 解决方法\n\n　查阅资料后说是连接超过了最大重试次数。Nacos有个maxRetry这个配置参数，默认是3;可是和SpringCloud整合后在application文件中找不到这个参数，只好另寻方法；\n\n　由于项目都是Docker容器化的，先前出现过连接不到Nacos的问题,于是就查看了各个Docker容器的IP。\n\n### 修正Nacos的地址\n\n　查阅后发现，是因为同事吧服务器重启了一遍，导致Docker服务也重启了，然后Docker容器里的IP全部都变了。因为同一台服务器上我们各个容器间的访问是通过Docker容器内部IP的，也就是172.16.x.x这个IP段。所以导致访问不到报错。\n\n```properties\nspring.cloud.nacos.config.server-addr=172.16.X.X     //更改到最新nacos的地址\n```","slug":"java/nacos-post-error","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjt001s2mg5r0k8ndn8","content":"<h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>　由于项目使用阿里的Nacos来管理项目的配置文件，今天所有使用Nacos的项目的日志都报[NACOS HTTP-POST] The maximum number of tolerable server reconnection errors has been reached这个错误。</p>\n<h2 id=\"解决方法\"><a href=\"#解决方法\" class=\"headerlink\" title=\"解决方法\"></a>解决方法</h2><p>　查阅资料后说是连接超过了最大重试次数。Nacos有个maxRetry这个配置参数，默认是3;可是和SpringCloud整合后在application文件中找不到这个参数，只好另寻方法；</p>\n<p>　由于项目都是Docker容器化的，先前出现过连接不到Nacos的问题,于是就查看了各个Docker容器的IP。</p>\n<h3 id=\"修正Nacos的地址\"><a href=\"#修正Nacos的地址\" class=\"headerlink\" title=\"修正Nacos的地址\"></a>修正Nacos的地址</h3><p>　查阅后发现，是因为同事吧服务器重启了一遍，导致Docker服务也重启了，然后Docker容器里的IP全部都变了。因为同一台服务器上我们各个容器间的访问是通过Docker容器内部IP的，也就是172.16.x.x这个IP段。所以导致访问不到报错。</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">spring.cloud.nacos.config.server-addr</span>=<span class=\"string\">172.16.X.X     //更改到最新nacos的地址</span></span><br></pre></td></tr></table></figure>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><p>　由于项目使用阿里的Nacos来管理项目的配置文件，今天所有使用Nacos的项目的日志都报[NACOS HTTP-POST] The maximum number of tolerable server reconnection errors has been reached这个错误。</p>\n<h2 id=\"解决方法\"><a href=\"#解决方法\" class=\"headerlink\" title=\"解决方法\"></a>解决方法</h2><p>　查阅资料后说是连接超过了最大重试次数。Nacos有个maxRetry这个配置参数，默认是3;可是和SpringCloud整合后在application文件中找不到这个参数，只好另寻方法；</p>\n<p>　由于项目都是Docker容器化的，先前出现过连接不到Nacos的问题,于是就查看了各个Docker容器的IP。</p>\n<h3 id=\"修正Nacos的地址\"><a href=\"#修正Nacos的地址\" class=\"headerlink\" title=\"修正Nacos的地址\"></a>修正Nacos的地址</h3><p>　查阅后发现，是因为同事吧服务器重启了一遍，导致Docker服务也重启了，然后Docker容器里的IP全部都变了。因为同一台服务器上我们各个容器间的访问是通过Docker容器内部IP的，也就是172.16.x.x这个IP段。所以导致访问不到报错。</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">spring.cloud.nacos.config.server-addr</span>=<span class=\"string\">172.16.X.X     //更改到最新nacos的地址</span></span><br></pre></td></tr></table></figure>"},{"title":"Base64影响泰文字段取值问题","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-08-14T02:39:23.000Z","password":null,"summary":null,"_content":"\n## 今天在工作中，图片要用base64上传，上传数据中还有泰文，然后和前端app联调时发现他们传的泰文这边竟然没存到库里，怀疑是app没有传值过来，于是一番操作\n\n#### 查看日志\n\n>what,日志里面竟然有他们传过来的泰文的值\n\n#### 对比ios和android的数据\n\n>发现日志里的数据都是一样的，但是android上传的数据全部传入了mysql数据库，ios的除了泰文，其他的也都传到了库里\n\n#### 确定问题\n\n>最后对比发现，android的泰文字段三放在base64字段前面的然后传上来的，ios是放在base64字段后面传上来的，怀疑问题在此处\n\n#### 修复bug\n\n>于是叫ios也和android一样，把上传字段的顺序调整了以下，把泰文的字段放在base64字段前面，然后上传。改了之后试了以下，，竟然解决了，2222333333\n\n总结：暂时不知道具体什么原因，有可能是因为base64数据太长了，影响到泰文的字段存储了。\n","source":"_posts/java/problem-java-base64.md","raw":"---\ntitle: Base64影响泰文字段取值问题\ntop: false\ncover: false\ntoc: true\nmathjax: true\ntags:\n  - Java\n  - Base64\n  - Pit\ncategories:\n  - Java\ndate: 2019-08-14 10:39:23\npassword:\nsummary:\n---\n\n## 今天在工作中，图片要用base64上传，上传数据中还有泰文，然后和前端app联调时发现他们传的泰文这边竟然没存到库里，怀疑是app没有传值过来，于是一番操作\n\n#### 查看日志\n\n>what,日志里面竟然有他们传过来的泰文的值\n\n#### 对比ios和android的数据\n\n>发现日志里的数据都是一样的，但是android上传的数据全部传入了mysql数据库，ios的除了泰文，其他的也都传到了库里\n\n#### 确定问题\n\n>最后对比发现，android的泰文字段三放在base64字段前面的然后传上来的，ios是放在base64字段后面传上来的，怀疑问题在此处\n\n#### 修复bug\n\n>于是叫ios也和android一样，把上传字段的顺序调整了以下，把泰文的字段放在base64字段前面，然后上传。改了之后试了以下，，竟然解决了，2222333333\n\n总结：暂时不知道具体什么原因，有可能是因为base64数据太长了，影响到泰文的字段存储了。\n","slug":"java/problem-java-base64","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjv001w2mg54fw61wmt","content":"<h2 id=\"今天在工作中，图片要用base64上传，上传数据中还有泰文，然后和前端app联调时发现他们传的泰文这边竟然没存到库里，怀疑是app没有传值过来，于是一番操作\"><a href=\"#今天在工作中，图片要用base64上传，上传数据中还有泰文，然后和前端app联调时发现他们传的泰文这边竟然没存到库里，怀疑是app没有传值过来，于是一番操作\" class=\"headerlink\" title=\"今天在工作中，图片要用base64上传，上传数据中还有泰文，然后和前端app联调时发现他们传的泰文这边竟然没存到库里，怀疑是app没有传值过来，于是一番操作\"></a>今天在工作中，图片要用base64上传，上传数据中还有泰文，然后和前端app联调时发现他们传的泰文这边竟然没存到库里，怀疑是app没有传值过来，于是一番操作</h2><h4 id=\"查看日志\"><a href=\"#查看日志\" class=\"headerlink\" title=\"查看日志\"></a>查看日志</h4><blockquote>\n<p>what,日志里面竟然有他们传过来的泰文的值</p>\n</blockquote>\n<h4 id=\"对比ios和android的数据\"><a href=\"#对比ios和android的数据\" class=\"headerlink\" title=\"对比ios和android的数据\"></a>对比ios和android的数据</h4><blockquote>\n<p>发现日志里的数据都是一样的，但是android上传的数据全部传入了mysql数据库，ios的除了泰文，其他的也都传到了库里</p>\n</blockquote>\n<h4 id=\"确定问题\"><a href=\"#确定问题\" class=\"headerlink\" title=\"确定问题\"></a>确定问题</h4><blockquote>\n<p>最后对比发现，android的泰文字段三放在base64字段前面的然后传上来的，ios是放在base64字段后面传上来的，怀疑问题在此处</p>\n</blockquote>\n<h4 id=\"修复bug\"><a href=\"#修复bug\" class=\"headerlink\" title=\"修复bug\"></a>修复bug</h4><blockquote>\n<p>于是叫ios也和android一样，把上传字段的顺序调整了以下，把泰文的字段放在base64字段前面，然后上传。改了之后试了以下，，竟然解决了，2222333333</p>\n</blockquote>\n<p>总结：暂时不知道具体什么原因，有可能是因为base64数据太长了，影响到泰文的字段存储了。</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"今天在工作中，图片要用base64上传，上传数据中还有泰文，然后和前端app联调时发现他们传的泰文这边竟然没存到库里，怀疑是app没有传值过来，于是一番操作\"><a href=\"#今天在工作中，图片要用base64上传，上传数据中还有泰文，然后和前端app联调时发现他们传的泰文这边竟然没存到库里，怀疑是app没有传值过来，于是一番操作\" class=\"headerlink\" title=\"今天在工作中，图片要用base64上传，上传数据中还有泰文，然后和前端app联调时发现他们传的泰文这边竟然没存到库里，怀疑是app没有传值过来，于是一番操作\"></a>今天在工作中，图片要用base64上传，上传数据中还有泰文，然后和前端app联调时发现他们传的泰文这边竟然没存到库里，怀疑是app没有传值过来，于是一番操作</h2><h4 id=\"查看日志\"><a href=\"#查看日志\" class=\"headerlink\" title=\"查看日志\"></a>查看日志</h4><blockquote>\n<p>what,日志里面竟然有他们传过来的泰文的值</p>\n</blockquote>\n<h4 id=\"对比ios和android的数据\"><a href=\"#对比ios和android的数据\" class=\"headerlink\" title=\"对比ios和android的数据\"></a>对比ios和android的数据</h4><blockquote>\n<p>发现日志里的数据都是一样的，但是android上传的数据全部传入了mysql数据库，ios的除了泰文，其他的也都传到了库里</p>\n</blockquote>\n<h4 id=\"确定问题\"><a href=\"#确定问题\" class=\"headerlink\" title=\"确定问题\"></a>确定问题</h4><blockquote>\n<p>最后对比发现，android的泰文字段三放在base64字段前面的然后传上来的，ios是放在base64字段后面传上来的，怀疑问题在此处</p>\n</blockquote>\n<h4 id=\"修复bug\"><a href=\"#修复bug\" class=\"headerlink\" title=\"修复bug\"></a>修复bug</h4><blockquote>\n<p>于是叫ios也和android一样，把上传字段的顺序调整了以下，把泰文的字段放在base64字段前面，然后上传。改了之后试了以下，，竟然解决了，2222333333</p>\n</blockquote>\n<p>总结：暂时不知道具体什么原因，有可能是因为base64数据太长了，影响到泰文的字段存储了。</p>\n"},{"title":"Jenkins教程-搭建(Docker版)","top":true,"cover":false,"toc":true,"mathjax":true,"date":"2019-11-07T09:19:34.000Z","password":null,"summary":null,"_content":"\n## 目录\n\n- [Jenkins教程-搭建(Docker版)](https://mjava.top/jenkins/build-jenkins-docker/)\n\n- [Jenkins教程-创建Maven项目](https://mjava.top/jenkins/build-jenkins-mavne/)\n\n- [Jenkins教程-Docker+GitLab持续部署持续集成](https://mjava.top/jenkins/build-jenkins-ci-cd/)\n\n  \n\n## 环境\n\n- 主机：172.16.54.131\n\n- 系统：Cnetos 7\n\n## 安装Docker-CE\n\n### 检查Docker\n\n首先检查本机是否安装Docker，如果安装了直接跳过安装Docker步骤\n\n```shell\ndocker -v\n```\n\n> 如果出现Docker version 19.03.4, build 9013bf583a类似的信息，则说明已安装Docker\n\n### 安装\n\n- 本教程以centos7安装方式说明，其他系统安装方式会有不同\n\n执行以下命令，安装Docker\n\n```shell\nyum install -y yum-utils device-mapper-persistent-data lvm2\n\nyum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n    \nyum install docker-ce\n\nservice docker start\n\nsystemctl enable docker\n```\n\n- 第一条命令：为添加源做准备 使其支持存储\n- 第二条命令：添加docker-ce软件源\n- 第三条命令：安装docker-ce\n- 第四条命令：启动docker服务\n- 第五条命令：设置开启自启\n\n## 安装Jenkins的Docker容器\n\n### 创建文件夹\n\n在创建容器前先在宿主机创建一个Jenkins的工作文件夹，用于持久化\n\n```shell\nmkdir /opt/jenkins     \t\t\t//创建文件夹\nchmod 7777 /opt/jenkins\t\t\t//授予权限\n```\n\n> 该文件夹一定要给权限，不然docker容器访问不了，容器会创建失败。\n\n### 拉取官方镜像\n\n```shell\ndocker pull jenkins/jenkins:lts\n```\n\n### 启动容器\n\n```shell\ndocker run -d -p 8080:8080 -p 50000:50000 -u root -v /var/run/docker.sock:/var/run/docker.sock -v $(which docker):/usr/bin/docker -v /opt/jenkins:/var/jenkins_home -v /etc/localtime:/etc/localtime -e JAVA_OPTS=-Duser.timezone=Asia/Shanghai --restart=always --name jenkins jenkins/jenkins:lts\n```\n\n> 启动容器一定要用root用户进入docker容器，不然访问不了宿主机的docker服务。还有要挂载/var/run/docker.sock和$(which docker)这两个文件夹到容器，这样docker版的jenkins才可以用使用docker相关服务。 \n\n### 查看容器日志\n\n```shell\ndocker logs jenkins \n```\n\n![log界面](http://cdn.mjava.top/blog/jenkins_docker_logs_4345.png)\n> 记下43455b344f904cf69a4af9e231f7d48d这个密码，等下要用到\n\n## 初始化Jenkins\n\n### 解锁\n\n在浏览器访问172.16.54.131:8080这个地址，进入Jenkins的web界面。（如果访问不了，请开启防火墙的8080端口）\n\n![jenkins界面](http://cdn.mjava.top/blog/jenkins_web_sign_in_201911071359.png)\n\n在输入框中填入刚才保存的密码\n\n### 自定义\n\n推荐直接选 安装推荐的插件\n\n![Jenkins自定义界面](http://cdn.mjava.top/blog/jenkins_setupwizard_1911071408.png)\n\n### 安装插件\n\n到这个界面等他安装完成，时间会长一点\n\n![Jenkins安装插件](http://cdn.mjava.top/blog/jenkins_191107141216.png)\n\n> 如这个界面插件下载失败，直接点继续，进行下一步，具体解决办法可以看这个篇文章\n>\n> [Jenkins初始化界面插件安装失败解决方法](https://mjava.top/2019/11/07/technology/learningExperience/Linux/Jenkins/Jenkins%E5%88%9D%E5%A7%8B%E5%8C%96%E7%95%8C%E9%9D%A2%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/)\n\n\n\n### 创建用户\n\n设置你的登录账号和密码，然后点保存完成\n![Jenkins创建用户](http://cdn.mjava.top/blog/jenkins_20191107160016.png)\n\n### 实例配置\n默认直接点保存完成\n![Jenkins实例配置](http://cdn.mjava.top/blog/jenkins_20191107160056.png)\n\n### 开始使用\n点击开始使用Jenkins\n![Jenkins开始使用](http://cdn.mjava.top/blog/jenkins_20191107160129.png)\n\n### Jenkins主界面\n进入Jenkins主界面，到此教程结束\n![Jenkins主界面](http://cdn.mjava.top/blog/jenkins_20191107160204.png)\n\n","source":"_posts/jenkins/build-jenkins-docker.md","raw":"---\ntitle: Jenkins教程-搭建(Docker版)\ntop: true\ncover: false\ntoc: true\nmathjax: true\ntags:\n  - Jenkins\n  - Docker\n  - Linux\ncategories:\n  - Jenkins\ndate: 2019-11-07 17:19:34\npassword:\nsummary:\n---\n\n## 目录\n\n- [Jenkins教程-搭建(Docker版)](https://mjava.top/jenkins/build-jenkins-docker/)\n\n- [Jenkins教程-创建Maven项目](https://mjava.top/jenkins/build-jenkins-mavne/)\n\n- [Jenkins教程-Docker+GitLab持续部署持续集成](https://mjava.top/jenkins/build-jenkins-ci-cd/)\n\n  \n\n## 环境\n\n- 主机：172.16.54.131\n\n- 系统：Cnetos 7\n\n## 安装Docker-CE\n\n### 检查Docker\n\n首先检查本机是否安装Docker，如果安装了直接跳过安装Docker步骤\n\n```shell\ndocker -v\n```\n\n> 如果出现Docker version 19.03.4, build 9013bf583a类似的信息，则说明已安装Docker\n\n### 安装\n\n- 本教程以centos7安装方式说明，其他系统安装方式会有不同\n\n执行以下命令，安装Docker\n\n```shell\nyum install -y yum-utils device-mapper-persistent-data lvm2\n\nyum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n    \nyum install docker-ce\n\nservice docker start\n\nsystemctl enable docker\n```\n\n- 第一条命令：为添加源做准备 使其支持存储\n- 第二条命令：添加docker-ce软件源\n- 第三条命令：安装docker-ce\n- 第四条命令：启动docker服务\n- 第五条命令：设置开启自启\n\n## 安装Jenkins的Docker容器\n\n### 创建文件夹\n\n在创建容器前先在宿主机创建一个Jenkins的工作文件夹，用于持久化\n\n```shell\nmkdir /opt/jenkins     \t\t\t//创建文件夹\nchmod 7777 /opt/jenkins\t\t\t//授予权限\n```\n\n> 该文件夹一定要给权限，不然docker容器访问不了，容器会创建失败。\n\n### 拉取官方镜像\n\n```shell\ndocker pull jenkins/jenkins:lts\n```\n\n### 启动容器\n\n```shell\ndocker run -d -p 8080:8080 -p 50000:50000 -u root -v /var/run/docker.sock:/var/run/docker.sock -v $(which docker):/usr/bin/docker -v /opt/jenkins:/var/jenkins_home -v /etc/localtime:/etc/localtime -e JAVA_OPTS=-Duser.timezone=Asia/Shanghai --restart=always --name jenkins jenkins/jenkins:lts\n```\n\n> 启动容器一定要用root用户进入docker容器，不然访问不了宿主机的docker服务。还有要挂载/var/run/docker.sock和$(which docker)这两个文件夹到容器，这样docker版的jenkins才可以用使用docker相关服务。 \n\n### 查看容器日志\n\n```shell\ndocker logs jenkins \n```\n\n![log界面](http://cdn.mjava.top/blog/jenkins_docker_logs_4345.png)\n> 记下43455b344f904cf69a4af9e231f7d48d这个密码，等下要用到\n\n## 初始化Jenkins\n\n### 解锁\n\n在浏览器访问172.16.54.131:8080这个地址，进入Jenkins的web界面。（如果访问不了，请开启防火墙的8080端口）\n\n![jenkins界面](http://cdn.mjava.top/blog/jenkins_web_sign_in_201911071359.png)\n\n在输入框中填入刚才保存的密码\n\n### 自定义\n\n推荐直接选 安装推荐的插件\n\n![Jenkins自定义界面](http://cdn.mjava.top/blog/jenkins_setupwizard_1911071408.png)\n\n### 安装插件\n\n到这个界面等他安装完成，时间会长一点\n\n![Jenkins安装插件](http://cdn.mjava.top/blog/jenkins_191107141216.png)\n\n> 如这个界面插件下载失败，直接点继续，进行下一步，具体解决办法可以看这个篇文章\n>\n> [Jenkins初始化界面插件安装失败解决方法](https://mjava.top/2019/11/07/technology/learningExperience/Linux/Jenkins/Jenkins%E5%88%9D%E5%A7%8B%E5%8C%96%E7%95%8C%E9%9D%A2%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/)\n\n\n\n### 创建用户\n\n设置你的登录账号和密码，然后点保存完成\n![Jenkins创建用户](http://cdn.mjava.top/blog/jenkins_20191107160016.png)\n\n### 实例配置\n默认直接点保存完成\n![Jenkins实例配置](http://cdn.mjava.top/blog/jenkins_20191107160056.png)\n\n### 开始使用\n点击开始使用Jenkins\n![Jenkins开始使用](http://cdn.mjava.top/blog/jenkins_20191107160129.png)\n\n### Jenkins主界面\n进入Jenkins主界面，到此教程结束\n![Jenkins主界面](http://cdn.mjava.top/blog/jenkins_20191107160204.png)\n\n","slug":"jenkins/build-jenkins-docker","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjv001y2mg50jcxzlra","content":"<h2 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h2><ul>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-docker/\">Jenkins教程-搭建(Docker版)</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-mavne/\">Jenkins教程-创建Maven项目</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-ci-cd/\">Jenkins教程-Docker+GitLab持续部署持续集成</a></p>\n</li>\n</ul>\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><ul>\n<li><p>主机：172.16.54.131</p>\n</li>\n<li><p>系统：Cnetos 7</p>\n</li>\n</ul>\n<h2 id=\"安装Docker-CE\"><a href=\"#安装Docker-CE\" class=\"headerlink\" title=\"安装Docker-CE\"></a>安装Docker-CE</h2><h3 id=\"检查Docker\"><a href=\"#检查Docker\" class=\"headerlink\" title=\"检查Docker\"></a>检查Docker</h3><p>首先检查本机是否安装Docker，如果安装了直接跳过安装Docker步骤</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker -v</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>如果出现Docker version 19.03.4, build 9013bf583a类似的信息，则说明已安装Docker</p>\n</blockquote>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><ul>\n<li>本教程以centos7安装方式说明，其他系统安装方式会有不同</li>\n</ul>\n<p>执行以下命令，安装Docker</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class=\"line\"></span><br><span class=\"line\">yum-config-manager \\</span><br><span class=\"line\">    --add-repo \\</span><br><span class=\"line\">    https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class=\"line\">    </span><br><span class=\"line\">yum install docker-ce</span><br><span class=\"line\"></span><br><span class=\"line\">service docker start</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl enable docker</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>第一条命令：为添加源做准备 使其支持存储</li>\n<li>第二条命令：添加docker-ce软件源</li>\n<li>第三条命令：安装docker-ce</li>\n<li>第四条命令：启动docker服务</li>\n<li>第五条命令：设置开启自启</li>\n</ul>\n<h2 id=\"安装Jenkins的Docker容器\"><a href=\"#安装Jenkins的Docker容器\" class=\"headerlink\" title=\"安装Jenkins的Docker容器\"></a>安装Jenkins的Docker容器</h2><h3 id=\"创建文件夹\"><a href=\"#创建文件夹\" class=\"headerlink\" title=\"创建文件夹\"></a>创建文件夹</h3><p>在创建容器前先在宿主机创建一个Jenkins的工作文件夹，用于持久化</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir /opt/jenkins     \t\t\t//创建文件夹</span><br><span class=\"line\">chmod 7777 /opt/jenkins\t\t\t//授予权限</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>该文件夹一定要给权限，不然docker容器访问不了，容器会创建失败。</p>\n</blockquote>\n<h3 id=\"拉取官方镜像\"><a href=\"#拉取官方镜像\" class=\"headerlink\" title=\"拉取官方镜像\"></a>拉取官方镜像</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker pull jenkins/jenkins:lts</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"启动容器\"><a href=\"#启动容器\" class=\"headerlink\" title=\"启动容器\"></a>启动容器</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -d -p 8080:8080 -p 50000:50000 -u root -v /var/run/docker.sock:/var/run/docker.sock -v $(which docker):/usr/bin/docker -v /opt/jenkins:/var/jenkins_home -v /etc/localtime:/etc/localtime -e JAVA_OPTS=-Duser.timezone=Asia/Shanghai --restart=always --name jenkins jenkins/jenkins:lts</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>启动容器一定要用root用户进入docker容器，不然访问不了宿主机的docker服务。还有要挂载/var/run/docker.sock和$(which docker)这两个文件夹到容器，这样docker版的jenkins才可以用使用docker相关服务。 </p>\n</blockquote>\n<h3 id=\"查看容器日志\"><a href=\"#查看容器日志\" class=\"headerlink\" title=\"查看容器日志\"></a>查看容器日志</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker logs jenkins</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/jenkins_docker_logs_4345.png\" alt=\"log界面\"></p>\n<blockquote>\n<p>记下43455b344f904cf69a4af9e231f7d48d这个密码，等下要用到</p>\n</blockquote>\n<h2 id=\"初始化Jenkins\"><a href=\"#初始化Jenkins\" class=\"headerlink\" title=\"初始化Jenkins\"></a>初始化Jenkins</h2><h3 id=\"解锁\"><a href=\"#解锁\" class=\"headerlink\" title=\"解锁\"></a>解锁</h3><p>在浏览器访问172.16.54.131:8080这个地址，进入Jenkins的web界面。（如果访问不了，请开启防火墙的8080端口）</p>\n<p><img src=\"http://cdn.mjava.top/blog/jenkins_web_sign_in_201911071359.png\" alt=\"jenkins界面\"></p>\n<p>在输入框中填入刚才保存的密码</p>\n<h3 id=\"自定义\"><a href=\"#自定义\" class=\"headerlink\" title=\"自定义\"></a>自定义</h3><p>推荐直接选 安装推荐的插件</p>\n<p><img src=\"http://cdn.mjava.top/blog/jenkins_setupwizard_1911071408.png\" alt=\"Jenkins自定义界面\"></p>\n<h3 id=\"安装插件\"><a href=\"#安装插件\" class=\"headerlink\" title=\"安装插件\"></a>安装插件</h3><p>到这个界面等他安装完成，时间会长一点</p>\n<p><img src=\"http://cdn.mjava.top/blog/jenkins_191107141216.png\" alt=\"Jenkins安装插件\"></p>\n<blockquote>\n<p>如这个界面插件下载失败，直接点继续，进行下一步，具体解决办法可以看这个篇文章</p>\n<p><a href=\"https://mjava.top/2019/11/07/technology/learningExperience/Linux/Jenkins/Jenkins%E5%88%9D%E5%A7%8B%E5%8C%96%E7%95%8C%E9%9D%A2%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/\">Jenkins初始化界面插件安装失败解决方法</a></p>\n</blockquote>\n<h3 id=\"创建用户\"><a href=\"#创建用户\" class=\"headerlink\" title=\"创建用户\"></a>创建用户</h3><p>设置你的登录账号和密码，然后点保存完成<br><img src=\"http://cdn.mjava.top/blog/jenkins_20191107160016.png\" alt=\"Jenkins创建用户\"></p>\n<h3 id=\"实例配置\"><a href=\"#实例配置\" class=\"headerlink\" title=\"实例配置\"></a>实例配置</h3><p>默认直接点保存完成<br><img src=\"http://cdn.mjava.top/blog/jenkins_20191107160056.png\" alt=\"Jenkins实例配置\"></p>\n<h3 id=\"开始使用\"><a href=\"#开始使用\" class=\"headerlink\" title=\"开始使用\"></a>开始使用</h3><p>点击开始使用Jenkins<br><img src=\"http://cdn.mjava.top/blog/jenkins_20191107160129.png\" alt=\"Jenkins开始使用\"></p>\n<h3 id=\"Jenkins主界面\"><a href=\"#Jenkins主界面\" class=\"headerlink\" title=\"Jenkins主界面\"></a>Jenkins主界面</h3><p>进入Jenkins主界面，到此教程结束<br><img src=\"http://cdn.mjava.top/blog/jenkins_20191107160204.png\" alt=\"Jenkins主界面\"></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h2><ul>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-docker/\">Jenkins教程-搭建(Docker版)</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-mavne/\">Jenkins教程-创建Maven项目</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-ci-cd/\">Jenkins教程-Docker+GitLab持续部署持续集成</a></p>\n</li>\n</ul>\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><ul>\n<li><p>主机：172.16.54.131</p>\n</li>\n<li><p>系统：Cnetos 7</p>\n</li>\n</ul>\n<h2 id=\"安装Docker-CE\"><a href=\"#安装Docker-CE\" class=\"headerlink\" title=\"安装Docker-CE\"></a>安装Docker-CE</h2><h3 id=\"检查Docker\"><a href=\"#检查Docker\" class=\"headerlink\" title=\"检查Docker\"></a>检查Docker</h3><p>首先检查本机是否安装Docker，如果安装了直接跳过安装Docker步骤</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker -v</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>如果出现Docker version 19.03.4, build 9013bf583a类似的信息，则说明已安装Docker</p>\n</blockquote>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><ul>\n<li>本教程以centos7安装方式说明，其他系统安装方式会有不同</li>\n</ul>\n<p>执行以下命令，安装Docker</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class=\"line\"></span><br><span class=\"line\">yum-config-manager \\</span><br><span class=\"line\">    --add-repo \\</span><br><span class=\"line\">    https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class=\"line\">    </span><br><span class=\"line\">yum install docker-ce</span><br><span class=\"line\"></span><br><span class=\"line\">service docker start</span><br><span class=\"line\"></span><br><span class=\"line\">systemctl enable docker</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>第一条命令：为添加源做准备 使其支持存储</li>\n<li>第二条命令：添加docker-ce软件源</li>\n<li>第三条命令：安装docker-ce</li>\n<li>第四条命令：启动docker服务</li>\n<li>第五条命令：设置开启自启</li>\n</ul>\n<h2 id=\"安装Jenkins的Docker容器\"><a href=\"#安装Jenkins的Docker容器\" class=\"headerlink\" title=\"安装Jenkins的Docker容器\"></a>安装Jenkins的Docker容器</h2><h3 id=\"创建文件夹\"><a href=\"#创建文件夹\" class=\"headerlink\" title=\"创建文件夹\"></a>创建文件夹</h3><p>在创建容器前先在宿主机创建一个Jenkins的工作文件夹，用于持久化</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir /opt/jenkins     \t\t\t//创建文件夹</span><br><span class=\"line\">chmod 7777 /opt/jenkins\t\t\t//授予权限</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>该文件夹一定要给权限，不然docker容器访问不了，容器会创建失败。</p>\n</blockquote>\n<h3 id=\"拉取官方镜像\"><a href=\"#拉取官方镜像\" class=\"headerlink\" title=\"拉取官方镜像\"></a>拉取官方镜像</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker pull jenkins/jenkins:lts</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"启动容器\"><a href=\"#启动容器\" class=\"headerlink\" title=\"启动容器\"></a>启动容器</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -d -p 8080:8080 -p 50000:50000 -u root -v /var/run/docker.sock:/var/run/docker.sock -v $(which docker):/usr/bin/docker -v /opt/jenkins:/var/jenkins_home -v /etc/localtime:/etc/localtime -e JAVA_OPTS=-Duser.timezone=Asia/Shanghai --restart=always --name jenkins jenkins/jenkins:lts</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>启动容器一定要用root用户进入docker容器，不然访问不了宿主机的docker服务。还有要挂载/var/run/docker.sock和$(which docker)这两个文件夹到容器，这样docker版的jenkins才可以用使用docker相关服务。 </p>\n</blockquote>\n<h3 id=\"查看容器日志\"><a href=\"#查看容器日志\" class=\"headerlink\" title=\"查看容器日志\"></a>查看容器日志</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker logs jenkins</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/jenkins_docker_logs_4345.png\" alt=\"log界面\"></p>\n<blockquote>\n<p>记下43455b344f904cf69a4af9e231f7d48d这个密码，等下要用到</p>\n</blockquote>\n<h2 id=\"初始化Jenkins\"><a href=\"#初始化Jenkins\" class=\"headerlink\" title=\"初始化Jenkins\"></a>初始化Jenkins</h2><h3 id=\"解锁\"><a href=\"#解锁\" class=\"headerlink\" title=\"解锁\"></a>解锁</h3><p>在浏览器访问172.16.54.131:8080这个地址，进入Jenkins的web界面。（如果访问不了，请开启防火墙的8080端口）</p>\n<p><img src=\"http://cdn.mjava.top/blog/jenkins_web_sign_in_201911071359.png\" alt=\"jenkins界面\"></p>\n<p>在输入框中填入刚才保存的密码</p>\n<h3 id=\"自定义\"><a href=\"#自定义\" class=\"headerlink\" title=\"自定义\"></a>自定义</h3><p>推荐直接选 安装推荐的插件</p>\n<p><img src=\"http://cdn.mjava.top/blog/jenkins_setupwizard_1911071408.png\" alt=\"Jenkins自定义界面\"></p>\n<h3 id=\"安装插件\"><a href=\"#安装插件\" class=\"headerlink\" title=\"安装插件\"></a>安装插件</h3><p>到这个界面等他安装完成，时间会长一点</p>\n<p><img src=\"http://cdn.mjava.top/blog/jenkins_191107141216.png\" alt=\"Jenkins安装插件\"></p>\n<blockquote>\n<p>如这个界面插件下载失败，直接点继续，进行下一步，具体解决办法可以看这个篇文章</p>\n<p><a href=\"https://mjava.top/2019/11/07/technology/learningExperience/Linux/Jenkins/Jenkins%E5%88%9D%E5%A7%8B%E5%8C%96%E7%95%8C%E9%9D%A2%E6%8F%92%E4%BB%B6%E5%AE%89%E8%A3%85%E5%A4%B1%E8%B4%A5%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/\">Jenkins初始化界面插件安装失败解决方法</a></p>\n</blockquote>\n<h3 id=\"创建用户\"><a href=\"#创建用户\" class=\"headerlink\" title=\"创建用户\"></a>创建用户</h3><p>设置你的登录账号和密码，然后点保存完成<br><img src=\"http://cdn.mjava.top/blog/jenkins_20191107160016.png\" alt=\"Jenkins创建用户\"></p>\n<h3 id=\"实例配置\"><a href=\"#实例配置\" class=\"headerlink\" title=\"实例配置\"></a>实例配置</h3><p>默认直接点保存完成<br><img src=\"http://cdn.mjava.top/blog/jenkins_20191107160056.png\" alt=\"Jenkins实例配置\"></p>\n<h3 id=\"开始使用\"><a href=\"#开始使用\" class=\"headerlink\" title=\"开始使用\"></a>开始使用</h3><p>点击开始使用Jenkins<br><img src=\"http://cdn.mjava.top/blog/jenkins_20191107160129.png\" alt=\"Jenkins开始使用\"></p>\n<h3 id=\"Jenkins主界面\"><a href=\"#Jenkins主界面\" class=\"headerlink\" title=\"Jenkins主界面\"></a>Jenkins主界面</h3><p>进入Jenkins主界面，到此教程结束<br><img src=\"http://cdn.mjava.top/blog/jenkins_20191107160204.png\" alt=\"Jenkins主界面\"></p>\n"},{"title":"浅谈MDC","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-09-16T07:10:47.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n## MDC是什么？\n\n`MDC` 全拼 `Mapped Diagnostic Contexts`，是`SLF4J`类日志系统中实现分布式多线程日志数据传递的重要工具；可利用`MDC`将一些运行时的上下文数据打印出来。目前只有`log4j`和`logback`提供原生的`MDC`支持；\n\n## 简单使用\n\n`MDC`里面提供的都是静态方法，所以可以直接调用\n\n```java\n// 设置一个key\nMDC.put(\"name\",\"灰色Code\");\n\n// 获取一个key的值\nMDC.get(\"name\");\n    \n// 删除一个key\nMDC.remove(\"name\");\n    \n// 清空MDC里的内容\nMDC.clear();\n\n// 获取上下文中的map\nMap<String,String> map = MDC.getCopyOfContextMap();\n\n// 设置MDC的map\nMDC.setContextMap(map);\n```\n\n\n\n## 源码解析\n\n### MDC\n\n通过阅读`MDC`的源码可以发现，它其实是调用了`MDCAdapter`的接口来实现的\n\n![](http://cdn.mjava.top/blog/20200729200214.png)\n\n\n\n### MDCAdapter\n\n`MDCAdapter`接口有三个实现类，而`MDC`是调用了`LogbackMDCAdapter`里的方法(在MDC里有一个静态代码块，实例化了这个对象)\n\n![](http://cdn.mjava.top/blog/20200729201118.png)\n\n### LogbackMDCAdapter\n\n**而**`LogbackMDCAdapter`主要是用`ThreadLocal`在线程上下文中维护一个`HashMap`来实现的\n\n![](http://cdn.mjava.top/blog/20200729201650.png)\n\n## 总结\n\n怎么样,实现原理是不是很简单，就这么短短几行代码，就实现了听起来很高大上的`MDC`。\n\n所以简单来说，`MDC`就是利用`ThreadLocal`在线程中维护了一个`HashMap`，利用`HashMap`来存放数据","source":"_posts/java/mdc-test.md","raw":"---\ntitle: 浅谈MDC\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-09-16 15:10:47\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Logback\n- MDC\ncategories:\n- Java\n---\n\n\n\n## MDC是什么？\n\n`MDC` 全拼 `Mapped Diagnostic Contexts`，是`SLF4J`类日志系统中实现分布式多线程日志数据传递的重要工具；可利用`MDC`将一些运行时的上下文数据打印出来。目前只有`log4j`和`logback`提供原生的`MDC`支持；\n\n## 简单使用\n\n`MDC`里面提供的都是静态方法，所以可以直接调用\n\n```java\n// 设置一个key\nMDC.put(\"name\",\"灰色Code\");\n\n// 获取一个key的值\nMDC.get(\"name\");\n    \n// 删除一个key\nMDC.remove(\"name\");\n    \n// 清空MDC里的内容\nMDC.clear();\n\n// 获取上下文中的map\nMap<String,String> map = MDC.getCopyOfContextMap();\n\n// 设置MDC的map\nMDC.setContextMap(map);\n```\n\n\n\n## 源码解析\n\n### MDC\n\n通过阅读`MDC`的源码可以发现，它其实是调用了`MDCAdapter`的接口来实现的\n\n![](http://cdn.mjava.top/blog/20200729200214.png)\n\n\n\n### MDCAdapter\n\n`MDCAdapter`接口有三个实现类，而`MDC`是调用了`LogbackMDCAdapter`里的方法(在MDC里有一个静态代码块，实例化了这个对象)\n\n![](http://cdn.mjava.top/blog/20200729201118.png)\n\n### LogbackMDCAdapter\n\n**而**`LogbackMDCAdapter`主要是用`ThreadLocal`在线程上下文中维护一个`HashMap`来实现的\n\n![](http://cdn.mjava.top/blog/20200729201650.png)\n\n## 总结\n\n怎么样,实现原理是不是很简单，就这么短短几行代码，就实现了听起来很高大上的`MDC`。\n\n所以简单来说，`MDC`就是利用`ThreadLocal`在线程中维护了一个`HashMap`，利用`HashMap`来存放数据","slug":"java/mdc-test","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjw00232mg5byw7u5fb","content":"<h2 id=\"MDC是什么？\"><a href=\"#MDC是什么？\" class=\"headerlink\" title=\"MDC是什么？\"></a>MDC是什么？</h2><p><code>MDC</code> 全拼 <code>Mapped Diagnostic Contexts</code>，是<code>SLF4J</code>类日志系统中实现分布式多线程日志数据传递的重要工具；可利用<code>MDC</code>将一些运行时的上下文数据打印出来。目前只有<code>log4j</code>和<code>logback</code>提供原生的<code>MDC</code>支持；</p>\n<h2 id=\"简单使用\"><a href=\"#简单使用\" class=\"headerlink\" title=\"简单使用\"></a>简单使用</h2><p><code>MDC</code>里面提供的都是静态方法，所以可以直接调用</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 设置一个key</span></span><br><span class=\"line\">MDC.put(<span class=\"string\">\"name\"</span>,<span class=\"string\">\"灰色Code\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取一个key的值</span></span><br><span class=\"line\">MDC.get(<span class=\"string\">\"name\"</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">// 删除一个key</span></span><br><span class=\"line\">MDC.remove(<span class=\"string\">\"name\"</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">// 清空MDC里的内容</span></span><br><span class=\"line\">MDC.clear();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取上下文中的map</span></span><br><span class=\"line\">Map&lt;String,String&gt; map = MDC.getCopyOfContextMap();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 设置MDC的map</span></span><br><span class=\"line\">MDC.setContextMap(map);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"源码解析\"><a href=\"#源码解析\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h2><h3 id=\"MDC\"><a href=\"#MDC\" class=\"headerlink\" title=\"MDC\"></a>MDC</h3><p>通过阅读<code>MDC</code>的源码可以发现，它其实是调用了<code>MDCAdapter</code>的接口来实现的</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200729200214.png\" alt></p>\n<h3 id=\"MDCAdapter\"><a href=\"#MDCAdapter\" class=\"headerlink\" title=\"MDCAdapter\"></a>MDCAdapter</h3><p><code>MDCAdapter</code>接口有三个实现类，而<code>MDC</code>是调用了<code>LogbackMDCAdapter</code>里的方法(在MDC里有一个静态代码块，实例化了这个对象)</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200729201118.png\" alt></p>\n<h3 id=\"LogbackMDCAdapter\"><a href=\"#LogbackMDCAdapter\" class=\"headerlink\" title=\"LogbackMDCAdapter\"></a>LogbackMDCAdapter</h3><p><strong>而</strong><code>LogbackMDCAdapter</code>主要是用<code>ThreadLocal</code>在线程上下文中维护一个<code>HashMap</code>来实现的</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200729201650.png\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>怎么样,实现原理是不是很简单，就这么短短几行代码，就实现了听起来很高大上的<code>MDC</code>。</p>\n<p>所以简单来说，<code>MDC</code>就是利用<code>ThreadLocal</code>在线程中维护了一个<code>HashMap</code>，利用<code>HashMap</code>来存放数据</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"MDC是什么？\"><a href=\"#MDC是什么？\" class=\"headerlink\" title=\"MDC是什么？\"></a>MDC是什么？</h2><p><code>MDC</code> 全拼 <code>Mapped Diagnostic Contexts</code>，是<code>SLF4J</code>类日志系统中实现分布式多线程日志数据传递的重要工具；可利用<code>MDC</code>将一些运行时的上下文数据打印出来。目前只有<code>log4j</code>和<code>logback</code>提供原生的<code>MDC</code>支持；</p>\n<h2 id=\"简单使用\"><a href=\"#简单使用\" class=\"headerlink\" title=\"简单使用\"></a>简单使用</h2><p><code>MDC</code>里面提供的都是静态方法，所以可以直接调用</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 设置一个key</span></span><br><span class=\"line\">MDC.put(<span class=\"string\">\"name\"</span>,<span class=\"string\">\"灰色Code\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取一个key的值</span></span><br><span class=\"line\">MDC.get(<span class=\"string\">\"name\"</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">// 删除一个key</span></span><br><span class=\"line\">MDC.remove(<span class=\"string\">\"name\"</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"comment\">// 清空MDC里的内容</span></span><br><span class=\"line\">MDC.clear();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 获取上下文中的map</span></span><br><span class=\"line\">Map&lt;String,String&gt; map = MDC.getCopyOfContextMap();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 设置MDC的map</span></span><br><span class=\"line\">MDC.setContextMap(map);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"源码解析\"><a href=\"#源码解析\" class=\"headerlink\" title=\"源码解析\"></a>源码解析</h2><h3 id=\"MDC\"><a href=\"#MDC\" class=\"headerlink\" title=\"MDC\"></a>MDC</h3><p>通过阅读<code>MDC</code>的源码可以发现，它其实是调用了<code>MDCAdapter</code>的接口来实现的</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200729200214.png\" alt></p>\n<h3 id=\"MDCAdapter\"><a href=\"#MDCAdapter\" class=\"headerlink\" title=\"MDCAdapter\"></a>MDCAdapter</h3><p><code>MDCAdapter</code>接口有三个实现类，而<code>MDC</code>是调用了<code>LogbackMDCAdapter</code>里的方法(在MDC里有一个静态代码块，实例化了这个对象)</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200729201118.png\" alt></p>\n<h3 id=\"LogbackMDCAdapter\"><a href=\"#LogbackMDCAdapter\" class=\"headerlink\" title=\"LogbackMDCAdapter\"></a>LogbackMDCAdapter</h3><p><strong>而</strong><code>LogbackMDCAdapter</code>主要是用<code>ThreadLocal</code>在线程上下文中维护一个<code>HashMap</code>来实现的</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200729201650.png\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>怎么样,实现原理是不是很简单，就这么短短几行代码，就实现了听起来很高大上的<code>MDC</code>。</p>\n<p>所以简单来说，<code>MDC</code>就是利用<code>ThreadLocal</code>在线程中维护了一个<code>HashMap</code>，利用<code>HashMap</code>来存放数据</p>\n"},{"title":"Jenkins教程-Docker+GitLab持续部署持续集成","top":true,"cover":false,"toc":true,"mathjax":true,"date":"2019-11-12T09:27:02.000Z","password":null,"summary":null,"_content":"\n## 目录\n\n- [Jenkins教程-搭建(Docker版)](https://mjava.top/jenkins/build-jenkins-docker/)\n\n- [Jenkins教程-创建Maven项目](https://mjava.top/jenkins/build-jenkins-mavne/)\n\n- [Jenkins教程-Docker+GitLab持续部署持续集成](https://mjava.top/jenkins/build-jenkins-ci-cd/)\n\n\n\n## 环境\n\n|        | 地址       | 系统     | 安装的软件                   |\n| ------ | ---------- | -------- | ---------------------------- |\n| 主机１ | 10.25.0.72 | Centos 7 | Docker　,　Jenkins(Docker版) |\n| 主机２ | 10.25.0.50 | Cnetos 7 | Docker                       |\n\n\n\n## Jenkins所需添加插件\n\n- [Git Parameter](https://plugins.jenkins.io/git-parameter)\n- [GitLab](https://plugins.jenkins.io/gitlab-plugin)\n\n- [SSH](https://plugins.jenkins.io/ssh)\n\n## 创建ssh登录凭据\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111043.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111058.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111115.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111130.png)\n\n> 这边选择Username with password,用账户密码来设置；然后在Username和Password输入框中分别输入10.25.0.50服务器的账号和密码。点击OK保存；\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111529.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111806.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112160316.png)\n\n## 添加SSH配置\n![Jenkins界面](http://cdn.mjava.top/blog/20191112160521.png)\n> 找到SSH remote hosts \n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112160541.png)\n> 设置你远程机器的ip和端口，然后选择刚配置好的凭证，点击save保存\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112160920.png)\n\n## 配置Job\n\n> 进入上篇文章创建好的Job,在此基础上进行改造\n\n\n\n### 配置Git Parameter,来获取gitlab的Tag数据\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112161424.png)\n\n### 配置触发器\n\n> 点击最下面的Generate,生成秘钥。然后记下URL:http://172.16.54.131:8080/project/JenkinsTest 和生成的秘钥：60327d68d10f1f7621696edd42719d1c\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112161808.png)\n\n### 添加构建完成后的动作\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112161842.png)\n\n### 添加Execute shell 和Execute shell script on remote host using ssh\n\n- Execute shell ： 执行Jenkins所在服务器的脚本\n- Execute shell script on remote host using ssh：登录远程服务器执行脚本\n\n\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112161940.png)\n\n\n\n### 编写你要执行的脚本\n\n> 由于是自定义的，内容我就不粘贴出来了.编写好后点击保存\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112164613.png)\n\n## 开始构建\n\n### 手动构建\n\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112164653.png)\n\n\n\n#### 选择你要构建的tag标签，点击Build开始构建并自动部署\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112164746.png)\n\n### 自动构建\n\n> 自动构建是当你push或打tag上传代码的时候，Jenkins就会自动构建部署\n\n\n\n#### 自动构建流程\n\n![Jenkins界面](http://cdn.mjava.top/blog/201911121717.png)\n\n\n####　配置GitLab代码仓库\n> 点击你你项目右边Settings的Integrations,然后在URL和Secret Tonken中填写刚保存的URL和秘钥，选择Tag push events,然后点击保存\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112165036.png)\n\n　\n\n\n\n#### Git打Tag标签\n\n```shell\ngit tag -a 1.0 -m '1.0'  \t\t//打一个1.0的tag\ngit push origin 1.0 \t\t\t//上传1.0标签到远程仓库\n```\n\n上传完tag后此时Jenkins已经开始自动构建并部署项目了；\n\n\n\n## 注意\n\n弄自动部署时，Jenkins和GitLab要都能互相访问的到，不然就会出错；","source":"_posts/jenkins/build-jenkins-ci-cd.md","raw":"---\ntitle: Jenkins教程-Docker+GitLab持续部署持续集成\ntop: true\ncover: false\ntoc: true\nmathjax: true\ntags:\n  - Jenkins\ncategories:\n  - Jenkins\ndate: 2019-11-12 17:27:02\npassword:\nsummary:\n---\n\n## 目录\n\n- [Jenkins教程-搭建(Docker版)](https://mjava.top/jenkins/build-jenkins-docker/)\n\n- [Jenkins教程-创建Maven项目](https://mjava.top/jenkins/build-jenkins-mavne/)\n\n- [Jenkins教程-Docker+GitLab持续部署持续集成](https://mjava.top/jenkins/build-jenkins-ci-cd/)\n\n\n\n## 环境\n\n|        | 地址       | 系统     | 安装的软件                   |\n| ------ | ---------- | -------- | ---------------------------- |\n| 主机１ | 10.25.0.72 | Centos 7 | Docker　,　Jenkins(Docker版) |\n| 主机２ | 10.25.0.50 | Cnetos 7 | Docker                       |\n\n\n\n## Jenkins所需添加插件\n\n- [Git Parameter](https://plugins.jenkins.io/git-parameter)\n- [GitLab](https://plugins.jenkins.io/gitlab-plugin)\n\n- [SSH](https://plugins.jenkins.io/ssh)\n\n## 创建ssh登录凭据\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111043.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111058.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111115.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111130.png)\n\n> 这边选择Username with password,用账户密码来设置；然后在Username和Password输入框中分别输入10.25.0.50服务器的账号和密码。点击OK保存；\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111529.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111806.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112160316.png)\n\n## 添加SSH配置\n![Jenkins界面](http://cdn.mjava.top/blog/20191112160521.png)\n> 找到SSH remote hosts \n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112160541.png)\n> 设置你远程机器的ip和端口，然后选择刚配置好的凭证，点击save保存\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112160920.png)\n\n## 配置Job\n\n> 进入上篇文章创建好的Job,在此基础上进行改造\n\n\n\n### 配置Git Parameter,来获取gitlab的Tag数据\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112161424.png)\n\n### 配置触发器\n\n> 点击最下面的Generate,生成秘钥。然后记下URL:http://172.16.54.131:8080/project/JenkinsTest 和生成的秘钥：60327d68d10f1f7621696edd42719d1c\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112161808.png)\n\n### 添加构建完成后的动作\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112161842.png)\n\n### 添加Execute shell 和Execute shell script on remote host using ssh\n\n- Execute shell ： 执行Jenkins所在服务器的脚本\n- Execute shell script on remote host using ssh：登录远程服务器执行脚本\n\n\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112161940.png)\n\n\n\n### 编写你要执行的脚本\n\n> 由于是自定义的，内容我就不粘贴出来了.编写好后点击保存\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112164613.png)\n\n## 开始构建\n\n### 手动构建\n\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112164653.png)\n\n\n\n#### 选择你要构建的tag标签，点击Build开始构建并自动部署\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112164746.png)\n\n### 自动构建\n\n> 自动构建是当你push或打tag上传代码的时候，Jenkins就会自动构建部署\n\n\n\n#### 自动构建流程\n\n![Jenkins界面](http://cdn.mjava.top/blog/201911121717.png)\n\n\n####　配置GitLab代码仓库\n> 点击你你项目右边Settings的Integrations,然后在URL和Secret Tonken中填写刚保存的URL和秘钥，选择Tag push events,然后点击保存\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112165036.png)\n\n　\n\n\n\n#### Git打Tag标签\n\n```shell\ngit tag -a 1.0 -m '1.0'  \t\t//打一个1.0的tag\ngit push origin 1.0 \t\t\t//上传1.0标签到远程仓库\n```\n\n上传完tag后此时Jenkins已经开始自动构建并部署项目了；\n\n\n\n## 注意\n\n弄自动部署时，Jenkins和GitLab要都能互相访问的到，不然就会出错；","slug":"jenkins/build-jenkins-ci-cd","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjx00252mg5hb7z6voh","content":"<h2 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h2><ul>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-docker/\">Jenkins教程-搭建(Docker版)</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-mavne/\">Jenkins教程-创建Maven项目</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-ci-cd/\">Jenkins教程-Docker+GitLab持续部署持续集成</a></p>\n</li>\n</ul>\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><table>\n<thead>\n<tr>\n<th></th>\n<th>地址</th>\n<th>系统</th>\n<th>安装的软件</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>主机１</td>\n<td>10.25.0.72</td>\n<td>Centos 7</td>\n<td>Docker　,　Jenkins(Docker版)</td>\n</tr>\n<tr>\n<td>主机２</td>\n<td>10.25.0.50</td>\n<td>Cnetos 7</td>\n<td>Docker</td>\n</tr>\n</tbody></table>\n<h2 id=\"Jenkins所需添加插件\"><a href=\"#Jenkins所需添加插件\" class=\"headerlink\" title=\"Jenkins所需添加插件\"></a>Jenkins所需添加插件</h2><ul>\n<li><p><a href=\"https://plugins.jenkins.io/git-parameter\" rel=\"noopener\" target=\"_blank\">Git Parameter</a></p>\n</li>\n<li><p><a href=\"https://plugins.jenkins.io/gitlab-plugin\" rel=\"noopener\" target=\"_blank\">GitLab</a></p>\n</li>\n<li><p><a href=\"https://plugins.jenkins.io/ssh\" rel=\"noopener\" target=\"_blank\">SSH</a></p>\n</li>\n</ul>\n<h2 id=\"创建ssh登录凭据\"><a href=\"#创建ssh登录凭据\" class=\"headerlink\" title=\"创建ssh登录凭据\"></a>创建ssh登录凭据</h2><p><img src=\"http://cdn.mjava.top/blog/20191112111043.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111058.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111115.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111130.png\" alt=\"Jenkins界面\"></p>\n<blockquote>\n<p>这边选择Username with password,用账户密码来设置；然后在Username和Password输入框中分别输入10.25.0.50服务器的账号和密码。点击OK保存；</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112111529.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111806.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112160316.png\" alt=\"Jenkins界面\"></p>\n<h2 id=\"添加SSH配置\"><a href=\"#添加SSH配置\" class=\"headerlink\" title=\"添加SSH配置\"></a>添加SSH配置</h2><p><img src=\"http://cdn.mjava.top/blog/20191112160521.png\" alt=\"Jenkins界面\"></p>\n<blockquote>\n<p>找到SSH remote hosts </p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112160541.png\" alt=\"Jenkins界面\"></p>\n<blockquote>\n<p>设置你远程机器的ip和端口，然后选择刚配置好的凭证，点击save保存</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112160920.png\" alt=\"Jenkins界面\"></p>\n<h2 id=\"配置Job\"><a href=\"#配置Job\" class=\"headerlink\" title=\"配置Job\"></a>配置Job</h2><blockquote>\n<p>进入上篇文章创建好的Job,在此基础上进行改造</p>\n</blockquote>\n<h3 id=\"配置Git-Parameter-来获取gitlab的Tag数据\"><a href=\"#配置Git-Parameter-来获取gitlab的Tag数据\" class=\"headerlink\" title=\"配置Git Parameter,来获取gitlab的Tag数据\"></a>配置Git Parameter,来获取gitlab的Tag数据</h3><p><img src=\"http://cdn.mjava.top/blog/20191112161424.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"配置触发器\"><a href=\"#配置触发器\" class=\"headerlink\" title=\"配置触发器\"></a>配置触发器</h3><blockquote>\n<p>点击最下面的Generate,生成秘钥。然后记下URL:<a href=\"http://172.16.54.131:8080/project/JenkinsTest\" rel=\"noopener\" target=\"_blank\">http://172.16.54.131:8080/project/JenkinsTest</a> 和生成的秘钥：60327d68d10f1f7621696edd42719d1c</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112161808.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"添加构建完成后的动作\"><a href=\"#添加构建完成后的动作\" class=\"headerlink\" title=\"添加构建完成后的动作\"></a>添加构建完成后的动作</h3><p><img src=\"http://cdn.mjava.top/blog/20191112161842.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"添加Execute-shell-和Execute-shell-script-on-remote-host-using-ssh\"><a href=\"#添加Execute-shell-和Execute-shell-script-on-remote-host-using-ssh\" class=\"headerlink\" title=\"添加Execute shell 和Execute shell script on remote host using ssh\"></a>添加Execute shell 和Execute shell script on remote host using ssh</h3><ul>\n<li>Execute shell ： 执行Jenkins所在服务器的脚本</li>\n<li>Execute shell script on remote host using ssh：登录远程服务器执行脚本</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20191112161940.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"编写你要执行的脚本\"><a href=\"#编写你要执行的脚本\" class=\"headerlink\" title=\"编写你要执行的脚本\"></a>编写你要执行的脚本</h3><blockquote>\n<p>由于是自定义的，内容我就不粘贴出来了.编写好后点击保存</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112164613.png\" alt=\"Jenkins界面\"></p>\n<h2 id=\"开始构建\"><a href=\"#开始构建\" class=\"headerlink\" title=\"开始构建\"></a>开始构建</h2><h3 id=\"手动构建\"><a href=\"#手动构建\" class=\"headerlink\" title=\"手动构建\"></a>手动构建</h3><p><img src=\"http://cdn.mjava.top/blog/20191112164653.png\" alt=\"Jenkins界面\"></p>\n<h4 id=\"选择你要构建的tag标签，点击Build开始构建并自动部署\"><a href=\"#选择你要构建的tag标签，点击Build开始构建并自动部署\" class=\"headerlink\" title=\"选择你要构建的tag标签，点击Build开始构建并自动部署\"></a>选择你要构建的tag标签，点击Build开始构建并自动部署</h4><p><img src=\"http://cdn.mjava.top/blog/20191112164746.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"自动构建\"><a href=\"#自动构建\" class=\"headerlink\" title=\"自动构建\"></a>自动构建</h3><blockquote>\n<p>自动构建是当你push或打tag上传代码的时候，Jenkins就会自动构建部署</p>\n</blockquote>\n<h4 id=\"自动构建流程\"><a href=\"#自动构建流程\" class=\"headerlink\" title=\"自动构建流程\"></a>自动构建流程</h4><p><img src=\"http://cdn.mjava.top/blog/201911121717.png\" alt=\"Jenkins界面\"></p>\n<p>####　配置GitLab代码仓库</p>\n<blockquote>\n<p>点击你你项目右边Settings的Integrations,然后在URL和Secret Tonken中填写刚保存的URL和秘钥，选择Tag push events,然后点击保存</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112165036.png\" alt=\"Jenkins界面\"></p>\n<p>　</p>\n<h4 id=\"Git打Tag标签\"><a href=\"#Git打Tag标签\" class=\"headerlink\" title=\"Git打Tag标签\"></a>Git打Tag标签</h4><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git tag -a 1.0 -m '1.0'  \t\t//打一个1.0的tag</span><br><span class=\"line\">git push origin 1.0 \t\t\t//上传1.0标签到远程仓库</span><br></pre></td></tr></table></figure>\n\n<p>上传完tag后此时Jenkins已经开始自动构建并部署项目了；</p>\n<h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><p>弄自动部署时，Jenkins和GitLab要都能互相访问的到，不然就会出错；</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h2><ul>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-docker/\">Jenkins教程-搭建(Docker版)</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-mavne/\">Jenkins教程-创建Maven项目</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-ci-cd/\">Jenkins教程-Docker+GitLab持续部署持续集成</a></p>\n</li>\n</ul>\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><table>\n<thead>\n<tr>\n<th></th>\n<th>地址</th>\n<th>系统</th>\n<th>安装的软件</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>主机１</td>\n<td>10.25.0.72</td>\n<td>Centos 7</td>\n<td>Docker　,　Jenkins(Docker版)</td>\n</tr>\n<tr>\n<td>主机２</td>\n<td>10.25.0.50</td>\n<td>Cnetos 7</td>\n<td>Docker</td>\n</tr>\n</tbody></table>\n<h2 id=\"Jenkins所需添加插件\"><a href=\"#Jenkins所需添加插件\" class=\"headerlink\" title=\"Jenkins所需添加插件\"></a>Jenkins所需添加插件</h2><ul>\n<li><p><a href=\"https://plugins.jenkins.io/git-parameter\" rel=\"noopener\" target=\"_blank\">Git Parameter</a></p>\n</li>\n<li><p><a href=\"https://plugins.jenkins.io/gitlab-plugin\" rel=\"noopener\" target=\"_blank\">GitLab</a></p>\n</li>\n<li><p><a href=\"https://plugins.jenkins.io/ssh\" rel=\"noopener\" target=\"_blank\">SSH</a></p>\n</li>\n</ul>\n<h2 id=\"创建ssh登录凭据\"><a href=\"#创建ssh登录凭据\" class=\"headerlink\" title=\"创建ssh登录凭据\"></a>创建ssh登录凭据</h2><p><img src=\"http://cdn.mjava.top/blog/20191112111043.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111058.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111115.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111130.png\" alt=\"Jenkins界面\"></p>\n<blockquote>\n<p>这边选择Username with password,用账户密码来设置；然后在Username和Password输入框中分别输入10.25.0.50服务器的账号和密码。点击OK保存；</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112111529.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111806.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112160316.png\" alt=\"Jenkins界面\"></p>\n<h2 id=\"添加SSH配置\"><a href=\"#添加SSH配置\" class=\"headerlink\" title=\"添加SSH配置\"></a>添加SSH配置</h2><p><img src=\"http://cdn.mjava.top/blog/20191112160521.png\" alt=\"Jenkins界面\"></p>\n<blockquote>\n<p>找到SSH remote hosts </p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112160541.png\" alt=\"Jenkins界面\"></p>\n<blockquote>\n<p>设置你远程机器的ip和端口，然后选择刚配置好的凭证，点击save保存</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112160920.png\" alt=\"Jenkins界面\"></p>\n<h2 id=\"配置Job\"><a href=\"#配置Job\" class=\"headerlink\" title=\"配置Job\"></a>配置Job</h2><blockquote>\n<p>进入上篇文章创建好的Job,在此基础上进行改造</p>\n</blockquote>\n<h3 id=\"配置Git-Parameter-来获取gitlab的Tag数据\"><a href=\"#配置Git-Parameter-来获取gitlab的Tag数据\" class=\"headerlink\" title=\"配置Git Parameter,来获取gitlab的Tag数据\"></a>配置Git Parameter,来获取gitlab的Tag数据</h3><p><img src=\"http://cdn.mjava.top/blog/20191112161424.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"配置触发器\"><a href=\"#配置触发器\" class=\"headerlink\" title=\"配置触发器\"></a>配置触发器</h3><blockquote>\n<p>点击最下面的Generate,生成秘钥。然后记下URL:<a href=\"http://172.16.54.131:8080/project/JenkinsTest\" rel=\"noopener\" target=\"_blank\">http://172.16.54.131:8080/project/JenkinsTest</a> 和生成的秘钥：60327d68d10f1f7621696edd42719d1c</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112161808.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"添加构建完成后的动作\"><a href=\"#添加构建完成后的动作\" class=\"headerlink\" title=\"添加构建完成后的动作\"></a>添加构建完成后的动作</h3><p><img src=\"http://cdn.mjava.top/blog/20191112161842.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"添加Execute-shell-和Execute-shell-script-on-remote-host-using-ssh\"><a href=\"#添加Execute-shell-和Execute-shell-script-on-remote-host-using-ssh\" class=\"headerlink\" title=\"添加Execute shell 和Execute shell script on remote host using ssh\"></a>添加Execute shell 和Execute shell script on remote host using ssh</h3><ul>\n<li>Execute shell ： 执行Jenkins所在服务器的脚本</li>\n<li>Execute shell script on remote host using ssh：登录远程服务器执行脚本</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20191112161940.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"编写你要执行的脚本\"><a href=\"#编写你要执行的脚本\" class=\"headerlink\" title=\"编写你要执行的脚本\"></a>编写你要执行的脚本</h3><blockquote>\n<p>由于是自定义的，内容我就不粘贴出来了.编写好后点击保存</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112164613.png\" alt=\"Jenkins界面\"></p>\n<h2 id=\"开始构建\"><a href=\"#开始构建\" class=\"headerlink\" title=\"开始构建\"></a>开始构建</h2><h3 id=\"手动构建\"><a href=\"#手动构建\" class=\"headerlink\" title=\"手动构建\"></a>手动构建</h3><p><img src=\"http://cdn.mjava.top/blog/20191112164653.png\" alt=\"Jenkins界面\"></p>\n<h4 id=\"选择你要构建的tag标签，点击Build开始构建并自动部署\"><a href=\"#选择你要构建的tag标签，点击Build开始构建并自动部署\" class=\"headerlink\" title=\"选择你要构建的tag标签，点击Build开始构建并自动部署\"></a>选择你要构建的tag标签，点击Build开始构建并自动部署</h4><p><img src=\"http://cdn.mjava.top/blog/20191112164746.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"自动构建\"><a href=\"#自动构建\" class=\"headerlink\" title=\"自动构建\"></a>自动构建</h3><blockquote>\n<p>自动构建是当你push或打tag上传代码的时候，Jenkins就会自动构建部署</p>\n</blockquote>\n<h4 id=\"自动构建流程\"><a href=\"#自动构建流程\" class=\"headerlink\" title=\"自动构建流程\"></a>自动构建流程</h4><p><img src=\"http://cdn.mjava.top/blog/201911121717.png\" alt=\"Jenkins界面\"></p>\n<p>####　配置GitLab代码仓库</p>\n<blockquote>\n<p>点击你你项目右边Settings的Integrations,然后在URL和Secret Tonken中填写刚保存的URL和秘钥，选择Tag push events,然后点击保存</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112165036.png\" alt=\"Jenkins界面\"></p>\n<p>　</p>\n<h4 id=\"Git打Tag标签\"><a href=\"#Git打Tag标签\" class=\"headerlink\" title=\"Git打Tag标签\"></a>Git打Tag标签</h4><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git tag -a 1.0 -m '1.0'  \t\t//打一个1.0的tag</span><br><span class=\"line\">git push origin 1.0 \t\t\t//上传1.0标签到远程仓库</span><br></pre></td></tr></table></figure>\n\n<p>上传完tag后此时Jenkins已经开始自动构建并部署项目了；</p>\n<h2 id=\"注意\"><a href=\"#注意\" class=\"headerlink\" title=\"注意\"></a>注意</h2><p>弄自动部署时，Jenkins和GitLab要都能互相访问的到，不然就会出错；</p>\n"},{"title":"Jenkins教程-创建Maven项目","top":true,"cover":false,"toc":true,"mathjax":true,"date":"2019-11-12T09:26:19.000Z","password":null,"summary":null,"_content":"\n## 目录\n\n- [Jenkins教程-搭建(Docker版)](https://mjava.top/jenkins/build-jenkins-docker/)\n\n- [Jenkins教程-创建Maven项目](https://mjava.top/jenkins/build-jenkins-mavne/)\n\n- [Jenkins教程-Docker+GitLab持续部署持续集成](https://mjava.top/jenkins/build-jenkins-ci-cd/)\n\n\n\n## 前期准备\n\n本教程是和gitlab集成,所以要有gitlab仓库。注意：如果后期要弄自动部署的话,你Jenkins的地址gitlab必须能访问到。不然gitlab监听到事件就通知不了Jenkins了；\n\n### 环境\n\n- Centos 7\n- Jenkins(Docker版)\n\n### 所需插件\n\n> 除了搭建Jenkins时安装的插件,还需安装的插件\n\n- [Maven Integration](https://plugins.jenkins.io/maven-plugin)\n\n### 安装Maven\n\n点击侧边栏的Manage Jenkins,然后点击Global Tool Configuration,进入全局工具设置\n![Jenkins界面](http://cdn.mjava.top/blog/20191112105932.png)\n\n\n然后找到Maven,点击Add Maven,可以选择你要的Maven版本，然后设置一个名字。点击保存\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112110029.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112110130.png)\n\n\n\n### 创建Git登录凭证\n点击侧边栏的凭证，然后按图点击\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111043.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111058.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111115.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111130.png)\n\n这边Kind有很多选项，这边选择Username with password,用账户密码来设置；然后在Username和Password输入框中分别输入gitlab的账号和密码。点击OK保存；\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111529.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111806.png)\n\n\n\n保存后就会出现你保存好的凭证；\n\n\n\n## 创建JOB\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111950.png)\n\n### 创建Maven项目\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112035.png)\n\n### 输入你的gitlab项目地址，然后选择刚才配置的凭证\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112620.png)\n\n### 输入Maven打包命令，然后点击保存\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112719.png)\n\n### 开始构建\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112747.png)\n\n### 查看构建项目日志\n> 第一次构建会比慢，因为他要下载maven相关构建的包\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112803.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112841.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112854.png)\n\n### 查看构建好的jar包\n![Jenkins界面](http://cdn.mjava.top/blog/20191112122030.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112122112.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112122135.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112122200.png)\n\n> 到此，构建maven项目已结束，可以下载这个jar包进行部署。后面会有自动构建部署的教程","source":"_posts/jenkins/build-jenkins-mavne.md","raw":"---\ntitle: Jenkins教程-创建Maven项目\ntop: true\ncover: false\ntoc: true\nmathjax: true\ntags:\n  - Jenkins\ncategories:\n  - Jenkins\ndate: 2019-11-12 17:26:19\npassword:\nsummary:\n---\n\n## 目录\n\n- [Jenkins教程-搭建(Docker版)](https://mjava.top/jenkins/build-jenkins-docker/)\n\n- [Jenkins教程-创建Maven项目](https://mjava.top/jenkins/build-jenkins-mavne/)\n\n- [Jenkins教程-Docker+GitLab持续部署持续集成](https://mjava.top/jenkins/build-jenkins-ci-cd/)\n\n\n\n## 前期准备\n\n本教程是和gitlab集成,所以要有gitlab仓库。注意：如果后期要弄自动部署的话,你Jenkins的地址gitlab必须能访问到。不然gitlab监听到事件就通知不了Jenkins了；\n\n### 环境\n\n- Centos 7\n- Jenkins(Docker版)\n\n### 所需插件\n\n> 除了搭建Jenkins时安装的插件,还需安装的插件\n\n- [Maven Integration](https://plugins.jenkins.io/maven-plugin)\n\n### 安装Maven\n\n点击侧边栏的Manage Jenkins,然后点击Global Tool Configuration,进入全局工具设置\n![Jenkins界面](http://cdn.mjava.top/blog/20191112105932.png)\n\n\n然后找到Maven,点击Add Maven,可以选择你要的Maven版本，然后设置一个名字。点击保存\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112110029.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112110130.png)\n\n\n\n### 创建Git登录凭证\n点击侧边栏的凭证，然后按图点击\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111043.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111058.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111115.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111130.png)\n\n这边Kind有很多选项，这边选择Username with password,用账户密码来设置；然后在Username和Password输入框中分别输入gitlab的账号和密码。点击OK保存；\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111529.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111806.png)\n\n\n\n保存后就会出现你保存好的凭证；\n\n\n\n## 创建JOB\n![Jenkins界面](http://cdn.mjava.top/blog/20191112111950.png)\n\n### 创建Maven项目\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112035.png)\n\n### 输入你的gitlab项目地址，然后选择刚才配置的凭证\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112620.png)\n\n### 输入Maven打包命令，然后点击保存\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112719.png)\n\n### 开始构建\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112747.png)\n\n### 查看构建项目日志\n> 第一次构建会比慢，因为他要下载maven相关构建的包\n\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112803.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112841.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112112854.png)\n\n### 查看构建好的jar包\n![Jenkins界面](http://cdn.mjava.top/blog/20191112122030.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112122112.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112122135.png)\n![Jenkins界面](http://cdn.mjava.top/blog/20191112122200.png)\n\n> 到此，构建maven项目已结束，可以下载这个jar包进行部署。后面会有自动构建部署的教程","slug":"jenkins/build-jenkins-mavne","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjy00292mg5o5rj5zk3","content":"<h2 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h2><ul>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-docker/\">Jenkins教程-搭建(Docker版)</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-mavne/\">Jenkins教程-创建Maven项目</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-ci-cd/\">Jenkins教程-Docker+GitLab持续部署持续集成</a></p>\n</li>\n</ul>\n<h2 id=\"前期准备\"><a href=\"#前期准备\" class=\"headerlink\" title=\"前期准备\"></a>前期准备</h2><p>本教程是和gitlab集成,所以要有gitlab仓库。注意：如果后期要弄自动部署的话,你Jenkins的地址gitlab必须能访问到。不然gitlab监听到事件就通知不了Jenkins了；</p>\n<h3 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h3><ul>\n<li>Centos 7</li>\n<li>Jenkins(Docker版)</li>\n</ul>\n<h3 id=\"所需插件\"><a href=\"#所需插件\" class=\"headerlink\" title=\"所需插件\"></a>所需插件</h3><blockquote>\n<p>除了搭建Jenkins时安装的插件,还需安装的插件</p>\n</blockquote>\n<ul>\n<li><a href=\"https://plugins.jenkins.io/maven-plugin\" rel=\"noopener\" target=\"_blank\">Maven Integration</a></li>\n</ul>\n<h3 id=\"安装Maven\"><a href=\"#安装Maven\" class=\"headerlink\" title=\"安装Maven\"></a>安装Maven</h3><p>点击侧边栏的Manage Jenkins,然后点击Global Tool Configuration,进入全局工具设置<br><img src=\"http://cdn.mjava.top/blog/20191112105932.png\" alt=\"Jenkins界面\"></p>\n<p>然后找到Maven,点击Add Maven,可以选择你要的Maven版本，然后设置一个名字。点击保存</p>\n<p><img src=\"http://cdn.mjava.top/blog/20191112110029.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112110130.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"创建Git登录凭证\"><a href=\"#创建Git登录凭证\" class=\"headerlink\" title=\"创建Git登录凭证\"></a>创建Git登录凭证</h3><p>点击侧边栏的凭证，然后按图点击<br><img src=\"http://cdn.mjava.top/blog/20191112111043.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111058.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111115.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111130.png\" alt=\"Jenkins界面\"></p>\n<p>这边Kind有很多选项，这边选择Username with password,用账户密码来设置；然后在Username和Password输入框中分别输入gitlab的账号和密码。点击OK保存；</p>\n<p><img src=\"http://cdn.mjava.top/blog/20191112111529.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111806.png\" alt=\"Jenkins界面\"></p>\n<p>保存后就会出现你保存好的凭证；</p>\n<h2 id=\"创建JOB\"><a href=\"#创建JOB\" class=\"headerlink\" title=\"创建JOB\"></a>创建JOB</h2><p><img src=\"http://cdn.mjava.top/blog/20191112111950.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"创建Maven项目\"><a href=\"#创建Maven项目\" class=\"headerlink\" title=\"创建Maven项目\"></a>创建Maven项目</h3><p><img src=\"http://cdn.mjava.top/blog/20191112112035.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"输入你的gitlab项目地址，然后选择刚才配置的凭证\"><a href=\"#输入你的gitlab项目地址，然后选择刚才配置的凭证\" class=\"headerlink\" title=\"输入你的gitlab项目地址，然后选择刚才配置的凭证\"></a>输入你的gitlab项目地址，然后选择刚才配置的凭证</h3><p><img src=\"http://cdn.mjava.top/blog/20191112112620.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"输入Maven打包命令，然后点击保存\"><a href=\"#输入Maven打包命令，然后点击保存\" class=\"headerlink\" title=\"输入Maven打包命令，然后点击保存\"></a>输入Maven打包命令，然后点击保存</h3><p><img src=\"http://cdn.mjava.top/blog/20191112112719.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"开始构建\"><a href=\"#开始构建\" class=\"headerlink\" title=\"开始构建\"></a>开始构建</h3><p><img src=\"http://cdn.mjava.top/blog/20191112112747.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"查看构建项目日志\"><a href=\"#查看构建项目日志\" class=\"headerlink\" title=\"查看构建项目日志\"></a>查看构建项目日志</h3><blockquote>\n<p>第一次构建会比慢，因为他要下载maven相关构建的包</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112112803.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112112841.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112112854.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"查看构建好的jar包\"><a href=\"#查看构建好的jar包\" class=\"headerlink\" title=\"查看构建好的jar包\"></a>查看构建好的jar包</h3><p><img src=\"http://cdn.mjava.top/blog/20191112122030.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112122112.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112122135.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112122200.png\" alt=\"Jenkins界面\"></p>\n<blockquote>\n<p>到此，构建maven项目已结束，可以下载这个jar包进行部署。后面会有自动构建部署的教程</p>\n</blockquote>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"目录\"><a href=\"#目录\" class=\"headerlink\" title=\"目录\"></a>目录</h2><ul>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-docker/\">Jenkins教程-搭建(Docker版)</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-mavne/\">Jenkins教程-创建Maven项目</a></p>\n</li>\n<li><p><a href=\"https://mjava.top/jenkins/build-jenkins-ci-cd/\">Jenkins教程-Docker+GitLab持续部署持续集成</a></p>\n</li>\n</ul>\n<h2 id=\"前期准备\"><a href=\"#前期准备\" class=\"headerlink\" title=\"前期准备\"></a>前期准备</h2><p>本教程是和gitlab集成,所以要有gitlab仓库。注意：如果后期要弄自动部署的话,你Jenkins的地址gitlab必须能访问到。不然gitlab监听到事件就通知不了Jenkins了；</p>\n<h3 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h3><ul>\n<li>Centos 7</li>\n<li>Jenkins(Docker版)</li>\n</ul>\n<h3 id=\"所需插件\"><a href=\"#所需插件\" class=\"headerlink\" title=\"所需插件\"></a>所需插件</h3><blockquote>\n<p>除了搭建Jenkins时安装的插件,还需安装的插件</p>\n</blockquote>\n<ul>\n<li><a href=\"https://plugins.jenkins.io/maven-plugin\" rel=\"noopener\" target=\"_blank\">Maven Integration</a></li>\n</ul>\n<h3 id=\"安装Maven\"><a href=\"#安装Maven\" class=\"headerlink\" title=\"安装Maven\"></a>安装Maven</h3><p>点击侧边栏的Manage Jenkins,然后点击Global Tool Configuration,进入全局工具设置<br><img src=\"http://cdn.mjava.top/blog/20191112105932.png\" alt=\"Jenkins界面\"></p>\n<p>然后找到Maven,点击Add Maven,可以选择你要的Maven版本，然后设置一个名字。点击保存</p>\n<p><img src=\"http://cdn.mjava.top/blog/20191112110029.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112110130.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"创建Git登录凭证\"><a href=\"#创建Git登录凭证\" class=\"headerlink\" title=\"创建Git登录凭证\"></a>创建Git登录凭证</h3><p>点击侧边栏的凭证，然后按图点击<br><img src=\"http://cdn.mjava.top/blog/20191112111043.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111058.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111115.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111130.png\" alt=\"Jenkins界面\"></p>\n<p>这边Kind有很多选项，这边选择Username with password,用账户密码来设置；然后在Username和Password输入框中分别输入gitlab的账号和密码。点击OK保存；</p>\n<p><img src=\"http://cdn.mjava.top/blog/20191112111529.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112111806.png\" alt=\"Jenkins界面\"></p>\n<p>保存后就会出现你保存好的凭证；</p>\n<h2 id=\"创建JOB\"><a href=\"#创建JOB\" class=\"headerlink\" title=\"创建JOB\"></a>创建JOB</h2><p><img src=\"http://cdn.mjava.top/blog/20191112111950.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"创建Maven项目\"><a href=\"#创建Maven项目\" class=\"headerlink\" title=\"创建Maven项目\"></a>创建Maven项目</h3><p><img src=\"http://cdn.mjava.top/blog/20191112112035.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"输入你的gitlab项目地址，然后选择刚才配置的凭证\"><a href=\"#输入你的gitlab项目地址，然后选择刚才配置的凭证\" class=\"headerlink\" title=\"输入你的gitlab项目地址，然后选择刚才配置的凭证\"></a>输入你的gitlab项目地址，然后选择刚才配置的凭证</h3><p><img src=\"http://cdn.mjava.top/blog/20191112112620.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"输入Maven打包命令，然后点击保存\"><a href=\"#输入Maven打包命令，然后点击保存\" class=\"headerlink\" title=\"输入Maven打包命令，然后点击保存\"></a>输入Maven打包命令，然后点击保存</h3><p><img src=\"http://cdn.mjava.top/blog/20191112112719.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"开始构建\"><a href=\"#开始构建\" class=\"headerlink\" title=\"开始构建\"></a>开始构建</h3><p><img src=\"http://cdn.mjava.top/blog/20191112112747.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"查看构建项目日志\"><a href=\"#查看构建项目日志\" class=\"headerlink\" title=\"查看构建项目日志\"></a>查看构建项目日志</h3><blockquote>\n<p>第一次构建会比慢，因为他要下载maven相关构建的包</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20191112112803.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112112841.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112112854.png\" alt=\"Jenkins界面\"></p>\n<h3 id=\"查看构建好的jar包\"><a href=\"#查看构建好的jar包\" class=\"headerlink\" title=\"查看构建好的jar包\"></a>查看构建好的jar包</h3><p><img src=\"http://cdn.mjava.top/blog/20191112122030.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112122112.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112122135.png\" alt=\"Jenkins界面\"><br><img src=\"http://cdn.mjava.top/blog/20191112122200.png\" alt=\"Jenkins界面\"></p>\n<blockquote>\n<p>到此，构建maven项目已结束，可以下载这个jar包进行部署。后面会有自动构建部署的教程</p>\n</blockquote>\n"},{"title":"Jenkins插件版本太旧的更新方法","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-11-12T09:27:27.000Z","password":null,"summary":null,"_content":"\n## 前言\n\n\tJenkins的插件好多都是互相依赖的，如果有的插件版本太低，而另一个插件就会导致用不了，就会出现下面的情况：\n![jenkins插件管理界面](http://cdn.mjava.top/blog/20191108102617.png)\n\nDurable Task Plugin version 1.29 is older than required. To fix, install version 1.33 or later.\n\n\n\n## 查看本地已安装版本\n\n可以看到，本地安装的版本和刚才提示的一样，是1.29版本的，刚才提示说太旧了，要更新到1.33版本。\n\n![jenkins插件管理界面](http://cdn.mjava.top/blog/20191108100855.png)\n\n\n\n## 搜索插件\n\n当你理所应当的去这个界面准备搜索这个插件并更新时。。。。你傻了，，怎么搜不到？？？WTF\n\n![jenkins插件管理界面](http://cdn.mjava.top/blog/20191108102907.png)\n\n\n\n不要慌，天无绝人之路，这里找不到，可以去另外的地方找。浏览器打开这个网站\n\n[Jenkins插件下载](https://plugins.jenkins.io/)\n\n- 进入后在输入框里输入你刚才要下载的插件:\n\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108101610.png)\n\n\n- 选择对应的插件\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108101748.png)\n\n\n- 然后点击右上角\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108101807.png)\n\n\n- 下载刚才提示的1.33版本\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108101832.png)\n\n\n- 下载完成后是一个hpi文件\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108102109.png)\n\n\n## 导入插件\n- 到插件管理界面，找到Upload Plugin\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108102152.png)\n\n- 然后选择刚才下载的插件，点击导入\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108102223.png)\n\n- 可以看到插件正在导入\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108102240.png)\n\n- 导入完成后，重启Jenkins就OK了\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108102254.png)","source":"_posts/jenkins/problem-jenkins-01.md","raw":"---\ntitle: Jenkins插件版本太旧的更新方法\ntop: false\ncover: false\ntoc: true\nmathjax: true\ntags:\n  - Jenkins\ncategories:\n  - Jenkins\ndate: 2019-11-12 17:27:27\npassword:\nsummary:\n---\n\n## 前言\n\n\tJenkins的插件好多都是互相依赖的，如果有的插件版本太低，而另一个插件就会导致用不了，就会出现下面的情况：\n![jenkins插件管理界面](http://cdn.mjava.top/blog/20191108102617.png)\n\nDurable Task Plugin version 1.29 is older than required. To fix, install version 1.33 or later.\n\n\n\n## 查看本地已安装版本\n\n可以看到，本地安装的版本和刚才提示的一样，是1.29版本的，刚才提示说太旧了，要更新到1.33版本。\n\n![jenkins插件管理界面](http://cdn.mjava.top/blog/20191108100855.png)\n\n\n\n## 搜索插件\n\n当你理所应当的去这个界面准备搜索这个插件并更新时。。。。你傻了，，怎么搜不到？？？WTF\n\n![jenkins插件管理界面](http://cdn.mjava.top/blog/20191108102907.png)\n\n\n\n不要慌，天无绝人之路，这里找不到，可以去另外的地方找。浏览器打开这个网站\n\n[Jenkins插件下载](https://plugins.jenkins.io/)\n\n- 进入后在输入框里输入你刚才要下载的插件:\n\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108101610.png)\n\n\n- 选择对应的插件\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108101748.png)\n\n\n- 然后点击右上角\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108101807.png)\n\n\n- 下载刚才提示的1.33版本\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108101832.png)\n\n\n- 下载完成后是一个hpi文件\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108102109.png)\n\n\n## 导入插件\n- 到插件管理界面，找到Upload Plugin\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108102152.png)\n\n- 然后选择刚才下载的插件，点击导入\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108102223.png)\n\n- 可以看到插件正在导入\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108102240.png)\n\n- 导入完成后，重启Jenkins就OK了\n![jenkins插件下载](http://cdn.mjava.top/blog/20191108102254.png)","slug":"jenkins/problem-jenkins-01","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bjz002c2mg5nhbqa8rw","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><pre><code>Jenkins的插件好多都是互相依赖的，如果有的插件版本太低，而另一个插件就会导致用不了，就会出现下面的情况：</code></pre><p><img src=\"http://cdn.mjava.top/blog/20191108102617.png\" alt=\"jenkins插件管理界面\"></p>\n<p>Durable Task Plugin version 1.29 is older than required. To fix, install version 1.33 or later.</p>\n<h2 id=\"查看本地已安装版本\"><a href=\"#查看本地已安装版本\" class=\"headerlink\" title=\"查看本地已安装版本\"></a>查看本地已安装版本</h2><p>可以看到，本地安装的版本和刚才提示的一样，是1.29版本的，刚才提示说太旧了，要更新到1.33版本。</p>\n<p><img src=\"http://cdn.mjava.top/blog/20191108100855.png\" alt=\"jenkins插件管理界面\"></p>\n<h2 id=\"搜索插件\"><a href=\"#搜索插件\" class=\"headerlink\" title=\"搜索插件\"></a>搜索插件</h2><p>当你理所应当的去这个界面准备搜索这个插件并更新时。。。。你傻了，，怎么搜不到？？？WTF</p>\n<p><img src=\"http://cdn.mjava.top/blog/20191108102907.png\" alt=\"jenkins插件管理界面\"></p>\n<p>不要慌，天无绝人之路，这里找不到，可以去另外的地方找。浏览器打开这个网站</p>\n<p><a href=\"https://plugins.jenkins.io/\" rel=\"noopener\" target=\"_blank\">Jenkins插件下载</a></p>\n<ul>\n<li>进入后在输入框里输入你刚才要下载的插件:</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20191108101610.png\" alt=\"jenkins插件下载\"></p>\n<ul>\n<li>选择对应的插件<br><img src=\"http://cdn.mjava.top/blog/20191108101748.png\" alt=\"jenkins插件下载\"></li>\n</ul>\n<ul>\n<li>然后点击右上角<br><img src=\"http://cdn.mjava.top/blog/20191108101807.png\" alt=\"jenkins插件下载\"></li>\n</ul>\n<ul>\n<li>下载刚才提示的1.33版本<br><img src=\"http://cdn.mjava.top/blog/20191108101832.png\" alt=\"jenkins插件下载\"></li>\n</ul>\n<ul>\n<li>下载完成后是一个hpi文件<br><img src=\"http://cdn.mjava.top/blog/20191108102109.png\" alt=\"jenkins插件下载\"></li>\n</ul>\n<h2 id=\"导入插件\"><a href=\"#导入插件\" class=\"headerlink\" title=\"导入插件\"></a>导入插件</h2><ul>\n<li><p>到插件管理界面，找到Upload Plugin<br><img src=\"http://cdn.mjava.top/blog/20191108102152.png\" alt=\"jenkins插件下载\"></p>\n</li>\n<li><p>然后选择刚才下载的插件，点击导入<br><img src=\"http://cdn.mjava.top/blog/20191108102223.png\" alt=\"jenkins插件下载\"></p>\n</li>\n<li><p>可以看到插件正在导入<br><img src=\"http://cdn.mjava.top/blog/20191108102240.png\" alt=\"jenkins插件下载\"></p>\n</li>\n<li><p>导入完成后，重启Jenkins就OK了<br><img src=\"http://cdn.mjava.top/blog/20191108102254.png\" alt=\"jenkins插件下载\"></p>\n</li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><pre><code>Jenkins的插件好多都是互相依赖的，如果有的插件版本太低，而另一个插件就会导致用不了，就会出现下面的情况：</code></pre><p><img src=\"http://cdn.mjava.top/blog/20191108102617.png\" alt=\"jenkins插件管理界面\"></p>\n<p>Durable Task Plugin version 1.29 is older than required. To fix, install version 1.33 or later.</p>\n<h2 id=\"查看本地已安装版本\"><a href=\"#查看本地已安装版本\" class=\"headerlink\" title=\"查看本地已安装版本\"></a>查看本地已安装版本</h2><p>可以看到，本地安装的版本和刚才提示的一样，是1.29版本的，刚才提示说太旧了，要更新到1.33版本。</p>\n<p><img src=\"http://cdn.mjava.top/blog/20191108100855.png\" alt=\"jenkins插件管理界面\"></p>\n<h2 id=\"搜索插件\"><a href=\"#搜索插件\" class=\"headerlink\" title=\"搜索插件\"></a>搜索插件</h2><p>当你理所应当的去这个界面准备搜索这个插件并更新时。。。。你傻了，，怎么搜不到？？？WTF</p>\n<p><img src=\"http://cdn.mjava.top/blog/20191108102907.png\" alt=\"jenkins插件管理界面\"></p>\n<p>不要慌，天无绝人之路，这里找不到，可以去另外的地方找。浏览器打开这个网站</p>\n<p><a href=\"https://plugins.jenkins.io/\" rel=\"noopener\" target=\"_blank\">Jenkins插件下载</a></p>\n<ul>\n<li>进入后在输入框里输入你刚才要下载的插件:</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20191108101610.png\" alt=\"jenkins插件下载\"></p>\n<ul>\n<li>选择对应的插件<br><img src=\"http://cdn.mjava.top/blog/20191108101748.png\" alt=\"jenkins插件下载\"></li>\n</ul>\n<ul>\n<li>然后点击右上角<br><img src=\"http://cdn.mjava.top/blog/20191108101807.png\" alt=\"jenkins插件下载\"></li>\n</ul>\n<ul>\n<li>下载刚才提示的1.33版本<br><img src=\"http://cdn.mjava.top/blog/20191108101832.png\" alt=\"jenkins插件下载\"></li>\n</ul>\n<ul>\n<li>下载完成后是一个hpi文件<br><img src=\"http://cdn.mjava.top/blog/20191108102109.png\" alt=\"jenkins插件下载\"></li>\n</ul>\n<h2 id=\"导入插件\"><a href=\"#导入插件\" class=\"headerlink\" title=\"导入插件\"></a>导入插件</h2><ul>\n<li><p>到插件管理界面，找到Upload Plugin<br><img src=\"http://cdn.mjava.top/blog/20191108102152.png\" alt=\"jenkins插件下载\"></p>\n</li>\n<li><p>然后选择刚才下载的插件，点击导入<br><img src=\"http://cdn.mjava.top/blog/20191108102223.png\" alt=\"jenkins插件下载\"></p>\n</li>\n<li><p>可以看到插件正在导入<br><img src=\"http://cdn.mjava.top/blog/20191108102240.png\" alt=\"jenkins插件下载\"></p>\n</li>\n<li><p>导入完成后，重启Jenkins就OK了<br><img src=\"http://cdn.mjava.top/blog/20191108102254.png\" alt=\"jenkins插件下载\"></p>\n</li>\n</ul>\n"},{"title":"JDKproxy和Cglib初探","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-09-16T07:09:47.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n# JDKproxy和Cglib初探\n\n\n\n## 简介\n\n在Java中，动态代理机制的出现，使得Java开发人员不用手工编写代理类，只要简单地制定一组接口及委托类对象，便能动态地获得代理类。动态代理在Java中有着广泛的应用，比如Spring AOP，Hibernate数据查询、测试框架的后端mock、RPC，Java注解对象获取等。\n\n## JDK原生动态代理(JDKProxy)\n\n`JDKProxy`只能对`实现了接口的类`生成代理，而不能针对`普通类` 。`JDKProxy`原生的`反射API`进行操作，在生成类上比较高效。\n\n### 使用\n\n[](http://cdn.mjava.top/blog/20200729000830.png)\n\n```java\ninterface TestInterface{\n    void test();\n}\nclass TestClass implements TestInterface{\n    @Override\n    public void test(){\n        System.out.println(\"JDK动态代理\");\n    }\n}\n\n//主方法\npublic class JDKProxy {\n    public static void main(String[] args) {\n        TestClass testClass=new TestClass();\n        ProxyHandle proxyHandle=new ProxyHandle(testClass);\n        //使用接口\n        TestInterface testClass1= (TestInterface) Proxy.newProxyInstance(\n                testClass.getClass().getClassLoader(),\n                testClass.getClass().getInterfaces(),proxyHandle);\n        testClass1.test();\n        System.out.println(\"代理类名称：\"+testClass1.getClass());\n    }\n}\n\n//代理\nclass ProxyHandle implements InvocationHandler{\n\n    private Object originaObj;\n    public ProxyHandle(Object o){\n        this.originaObj=o;\n    }\n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        System.out.println(\"前置\");\n        Object object=method.invoke(originaObj,args);\n        System.out.println(\"后置\");\n        return object;\n    }\n}\n```\n\n```\n输出结果：\n\t前置\n    JDK动态代理\n    后置\n    代理类名称：class com.example.demo.aop.$Proxy0\n```\n\n\n\n## Cglib\n\n`Cglib`代理是针对`所有类`（包括实现接口的类和普通的类）实现代理，主要是对指定的类**生成一个子类**，覆盖其中的方法(**所以该类或方法不能声明称final的**) 。`Cglib`使用`ASM框架`直接对字节码进行操作，在类的执行过程中比较高效\n\n### 使用\n\n[](http://cdn.mjava.top/blog/20200729001250.png)\n\n```java\ninterface InterTest{\n    void t1();\n}\n\nclass InterClass implements InterTest{\n    @Override\n    public void t1() {\n        System.out.println(\"我是接口测试方法\");\n    }\n}\n\npublic class CglibTest {\n\n    public static void main(String[] args) {\n        /**\n         * 普通类\n         * */\n        Enhancer enhancer=new Enhancer();\n        enhancer.setSuperclass(CG.class);\n        enhancer.setCallback(new MethodInterceptor() {\n            @Override\n            public Object intercept(Object o, Method method,\n                                    Object[] objects,\n                                    MethodProxy methodProxy) throws Throwable {\n                System.out.println(\"前置\");\n                Object object=methodProxy.invokeSuper(o,objects);\n                System.out.println(\"后置\");\n                return object;\n            }\n        });\n        CG cglibTest= (CG) enhancer.create();\n        cglibTest.test();\n        System.out.println(\"代理类名称1：\"+cglibTest.getClass());\n\n        /*\n         * 实现了接口的类\n         * */\n        Enhancer enhancer2=new Enhancer();\n        enhancer2.setSuperclass(InterClass.class);\n        enhancer2.setCallback(new MethodInterceptor() {\n            @Override\n            public Object intercept(Object o, Method method,\n                                    Object[] objects,\n                                    MethodProxy methodProxy) throws Throwable {\n                System.out.println(\"接口类前置\");\n                Object object=methodProxy.invokeSuper(o,objects);\n                System.out.println(\"接口类后置\");\n                return object;\n            }\n        });\n        InterClass interClass= (InterClass) enhancer2.create();\n        interClass.t1();\n        System.out.println(\"代理类名称2：\"+interClass.getClass());\n    }\n}\n\nclass CG{\n    public void test(){\n        System.out.println(\"代理类测试\");\n    }\n}\n```\n\n```\n输出结果：\n\t前置\n    代理类测试\n    后置\n    代理类名称1：class com.example.demo.aop.CG$$EnhancerByCGLIB$$5c6cbf31\n    \n    接口类前置\n    我是接口测试方法\n    接口类后置\n    代理类名称2：class com.example.demo.aop.InterClass$$EnhancerByCGLIB$$80c75859\n\n```","source":"_posts/java/jdkproxy-cglib.md","raw":"---\ntitle: JDKproxy和Cglib初探\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-09-16 15:09:47\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Java\ncategories:\n- Java\n---\n\n# JDKproxy和Cglib初探\n\n\n\n## 简介\n\n在Java中，动态代理机制的出现，使得Java开发人员不用手工编写代理类，只要简单地制定一组接口及委托类对象，便能动态地获得代理类。动态代理在Java中有着广泛的应用，比如Spring AOP，Hibernate数据查询、测试框架的后端mock、RPC，Java注解对象获取等。\n\n## JDK原生动态代理(JDKProxy)\n\n`JDKProxy`只能对`实现了接口的类`生成代理，而不能针对`普通类` 。`JDKProxy`原生的`反射API`进行操作，在生成类上比较高效。\n\n### 使用\n\n[](http://cdn.mjava.top/blog/20200729000830.png)\n\n```java\ninterface TestInterface{\n    void test();\n}\nclass TestClass implements TestInterface{\n    @Override\n    public void test(){\n        System.out.println(\"JDK动态代理\");\n    }\n}\n\n//主方法\npublic class JDKProxy {\n    public static void main(String[] args) {\n        TestClass testClass=new TestClass();\n        ProxyHandle proxyHandle=new ProxyHandle(testClass);\n        //使用接口\n        TestInterface testClass1= (TestInterface) Proxy.newProxyInstance(\n                testClass.getClass().getClassLoader(),\n                testClass.getClass().getInterfaces(),proxyHandle);\n        testClass1.test();\n        System.out.println(\"代理类名称：\"+testClass1.getClass());\n    }\n}\n\n//代理\nclass ProxyHandle implements InvocationHandler{\n\n    private Object originaObj;\n    public ProxyHandle(Object o){\n        this.originaObj=o;\n    }\n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        System.out.println(\"前置\");\n        Object object=method.invoke(originaObj,args);\n        System.out.println(\"后置\");\n        return object;\n    }\n}\n```\n\n```\n输出结果：\n\t前置\n    JDK动态代理\n    后置\n    代理类名称：class com.example.demo.aop.$Proxy0\n```\n\n\n\n## Cglib\n\n`Cglib`代理是针对`所有类`（包括实现接口的类和普通的类）实现代理，主要是对指定的类**生成一个子类**，覆盖其中的方法(**所以该类或方法不能声明称final的**) 。`Cglib`使用`ASM框架`直接对字节码进行操作，在类的执行过程中比较高效\n\n### 使用\n\n[](http://cdn.mjava.top/blog/20200729001250.png)\n\n```java\ninterface InterTest{\n    void t1();\n}\n\nclass InterClass implements InterTest{\n    @Override\n    public void t1() {\n        System.out.println(\"我是接口测试方法\");\n    }\n}\n\npublic class CglibTest {\n\n    public static void main(String[] args) {\n        /**\n         * 普通类\n         * */\n        Enhancer enhancer=new Enhancer();\n        enhancer.setSuperclass(CG.class);\n        enhancer.setCallback(new MethodInterceptor() {\n            @Override\n            public Object intercept(Object o, Method method,\n                                    Object[] objects,\n                                    MethodProxy methodProxy) throws Throwable {\n                System.out.println(\"前置\");\n                Object object=methodProxy.invokeSuper(o,objects);\n                System.out.println(\"后置\");\n                return object;\n            }\n        });\n        CG cglibTest= (CG) enhancer.create();\n        cglibTest.test();\n        System.out.println(\"代理类名称1：\"+cglibTest.getClass());\n\n        /*\n         * 实现了接口的类\n         * */\n        Enhancer enhancer2=new Enhancer();\n        enhancer2.setSuperclass(InterClass.class);\n        enhancer2.setCallback(new MethodInterceptor() {\n            @Override\n            public Object intercept(Object o, Method method,\n                                    Object[] objects,\n                                    MethodProxy methodProxy) throws Throwable {\n                System.out.println(\"接口类前置\");\n                Object object=methodProxy.invokeSuper(o,objects);\n                System.out.println(\"接口类后置\");\n                return object;\n            }\n        });\n        InterClass interClass= (InterClass) enhancer2.create();\n        interClass.t1();\n        System.out.println(\"代理类名称2：\"+interClass.getClass());\n    }\n}\n\nclass CG{\n    public void test(){\n        System.out.println(\"代理类测试\");\n    }\n}\n```\n\n```\n输出结果：\n\t前置\n    代理类测试\n    后置\n    代理类名称1：class com.example.demo.aop.CG$$EnhancerByCGLIB$$5c6cbf31\n    \n    接口类前置\n    我是接口测试方法\n    接口类后置\n    代理类名称2：class com.example.demo.aop.InterClass$$EnhancerByCGLIB$$80c75859\n\n```","slug":"java/jdkproxy-cglib","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bk1002f2mg54sb14ds2","content":"<h1 id=\"JDKproxy和Cglib初探\"><a href=\"#JDKproxy和Cglib初探\" class=\"headerlink\" title=\"JDKproxy和Cglib初探\"></a>JDKproxy和Cglib初探</h1><h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>在Java中，动态代理机制的出现，使得Java开发人员不用手工编写代理类，只要简单地制定一组接口及委托类对象，便能动态地获得代理类。动态代理在Java中有着广泛的应用，比如Spring AOP，Hibernate数据查询、测试框架的后端mock、RPC，Java注解对象获取等。</p>\n<h2 id=\"JDK原生动态代理-JDKProxy\"><a href=\"#JDK原生动态代理-JDKProxy\" class=\"headerlink\" title=\"JDK原生动态代理(JDKProxy)\"></a>JDK原生动态代理(JDKProxy)</h2><p><code>JDKProxy</code>只能对<code>实现了接口的类</code>生成代理，而不能针对<code>普通类</code> 。<code>JDKProxy</code>原生的<code>反射API</code>进行操作，在生成类上比较高效。</p>\n<h3 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h3><p><a href=\"http://cdn.mjava.top/blog/20200729000830.png\" rel=\"noopener\" target=\"_blank\"></a></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">TestInterface</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">test</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestClass</span> <span class=\"keyword\">implements</span> <span class=\"title\">TestInterface</span></span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">test</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"JDK动态代理\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//主方法</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDKProxy</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        TestClass testClass=<span class=\"keyword\">new</span> TestClass();</span><br><span class=\"line\">        ProxyHandle proxyHandle=<span class=\"keyword\">new</span> ProxyHandle(testClass);</span><br><span class=\"line\">        <span class=\"comment\">//使用接口</span></span><br><span class=\"line\">        TestInterface testClass1= (TestInterface) Proxy.newProxyInstance(</span><br><span class=\"line\">                testClass.getClass().getClassLoader(),</span><br><span class=\"line\">                testClass.getClass().getInterfaces(),proxyHandle);</span><br><span class=\"line\">        testClass1.test();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"代理类名称：\"</span>+testClass1.getClass());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//代理</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ProxyHandle</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object originaObj;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ProxyHandle</span><span class=\"params\">(Object o)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.originaObj=o;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"前置\"</span>);</span><br><span class=\"line\">        Object object=method.invoke(originaObj,args);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"后置\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> object;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">输出结果：</span><br><span class=\"line\">\t前置</span><br><span class=\"line\">    JDK动态代理</span><br><span class=\"line\">    后置</span><br><span class=\"line\">    代理类名称：class com.example.demo.aop.$Proxy0</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Cglib\"><a href=\"#Cglib\" class=\"headerlink\" title=\"Cglib\"></a>Cglib</h2><p><code>Cglib</code>代理是针对<code>所有类</code>（包括实现接口的类和普通的类）实现代理，主要是对指定的类<strong>生成一个子类</strong>，覆盖其中的方法(<strong>所以该类或方法不能声明称final的</strong>) 。<code>Cglib</code>使用<code>ASM框架</code>直接对字节码进行操作，在类的执行过程中比较高效</p>\n<h3 id=\"使用-1\"><a href=\"#使用-1\" class=\"headerlink\" title=\"使用\"></a>使用</h3><p><a href=\"http://cdn.mjava.top/blog/20200729001250.png\" rel=\"noopener\" target=\"_blank\"></a></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">InterTest</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">t1</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">InterClass</span> <span class=\"keyword\">implements</span> <span class=\"title\">InterTest</span></span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">t1</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"我是接口测试方法\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CglibTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 普通类</span></span><br><span class=\"line\"><span class=\"comment\">         * */</span></span><br><span class=\"line\">        Enhancer enhancer=<span class=\"keyword\">new</span> Enhancer();</span><br><span class=\"line\">        enhancer.setSuperclass(CG.class);</span><br><span class=\"line\">        enhancer.setCallback(<span class=\"keyword\">new</span> MethodInterceptor() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">intercept</span><span class=\"params\">(Object o, Method method,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                    Object[] objects,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                    MethodProxy methodProxy)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"前置\"</span>);</span><br><span class=\"line\">                Object object=methodProxy.invokeSuper(o,objects);</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"后置\"</span>);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> object;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        CG cglibTest= (CG) enhancer.create();</span><br><span class=\"line\">        cglibTest.test();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"代理类名称1：\"</span>+cglibTest.getClass());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * 实现了接口的类</span></span><br><span class=\"line\"><span class=\"comment\">         * */</span></span><br><span class=\"line\">        Enhancer enhancer2=<span class=\"keyword\">new</span> Enhancer();</span><br><span class=\"line\">        enhancer2.setSuperclass(InterClass.class);</span><br><span class=\"line\">        enhancer2.setCallback(<span class=\"keyword\">new</span> MethodInterceptor() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">intercept</span><span class=\"params\">(Object o, Method method,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                    Object[] objects,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                    MethodProxy methodProxy)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"接口类前置\"</span>);</span><br><span class=\"line\">                Object object=methodProxy.invokeSuper(o,objects);</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"接口类后置\"</span>);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> object;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        InterClass interClass= (InterClass) enhancer2.create();</span><br><span class=\"line\">        interClass.t1();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"代理类名称2：\"</span>+interClass.getClass());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CG</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">test</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"代理类测试\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">输出结果：</span><br><span class=\"line\">\t前置</span><br><span class=\"line\">    代理类测试</span><br><span class=\"line\">    后置</span><br><span class=\"line\">    代理类名称1：class com.example.demo.aop.CG$$EnhancerByCGLIB$$5c6cbf31</span><br><span class=\"line\">    </span><br><span class=\"line\">    接口类前置</span><br><span class=\"line\">    我是接口测试方法</span><br><span class=\"line\">    接口类后置</span><br><span class=\"line\">    代理类名称2：class com.example.demo.aop.InterClass$$EnhancerByCGLIB$$80c75859</span><br></pre></td></tr></table></figure>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h1 id=\"JDKproxy和Cglib初探\"><a href=\"#JDKproxy和Cglib初探\" class=\"headerlink\" title=\"JDKproxy和Cglib初探\"></a>JDKproxy和Cglib初探</h1><h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>在Java中，动态代理机制的出现，使得Java开发人员不用手工编写代理类，只要简单地制定一组接口及委托类对象，便能动态地获得代理类。动态代理在Java中有着广泛的应用，比如Spring AOP，Hibernate数据查询、测试框架的后端mock、RPC，Java注解对象获取等。</p>\n<h2 id=\"JDK原生动态代理-JDKProxy\"><a href=\"#JDK原生动态代理-JDKProxy\" class=\"headerlink\" title=\"JDK原生动态代理(JDKProxy)\"></a>JDK原生动态代理(JDKProxy)</h2><p><code>JDKProxy</code>只能对<code>实现了接口的类</code>生成代理，而不能针对<code>普通类</code> 。<code>JDKProxy</code>原生的<code>反射API</code>进行操作，在生成类上比较高效。</p>\n<h3 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h3><p><a href=\"http://cdn.mjava.top/blog/20200729000830.png\" rel=\"noopener\" target=\"_blank\"></a></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">TestInterface</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">test</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestClass</span> <span class=\"keyword\">implements</span> <span class=\"title\">TestInterface</span></span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">test</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"JDK动态代理\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//主方法</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JDKProxy</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        TestClass testClass=<span class=\"keyword\">new</span> TestClass();</span><br><span class=\"line\">        ProxyHandle proxyHandle=<span class=\"keyword\">new</span> ProxyHandle(testClass);</span><br><span class=\"line\">        <span class=\"comment\">//使用接口</span></span><br><span class=\"line\">        TestInterface testClass1= (TestInterface) Proxy.newProxyInstance(</span><br><span class=\"line\">                testClass.getClass().getClassLoader(),</span><br><span class=\"line\">                testClass.getClass().getInterfaces(),proxyHandle);</span><br><span class=\"line\">        testClass1.test();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"代理类名称：\"</span>+testClass1.getClass());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//代理</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ProxyHandle</span> <span class=\"keyword\">implements</span> <span class=\"title\">InvocationHandler</span></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object originaObj;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ProxyHandle</span><span class=\"params\">(Object o)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.originaObj=o;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">invoke</span><span class=\"params\">(Object proxy, Method method, Object[] args)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"前置\"</span>);</span><br><span class=\"line\">        Object object=method.invoke(originaObj,args);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"后置\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> object;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">输出结果：</span><br><span class=\"line\">\t前置</span><br><span class=\"line\">    JDK动态代理</span><br><span class=\"line\">    后置</span><br><span class=\"line\">    代理类名称：class com.example.demo.aop.$Proxy0</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Cglib\"><a href=\"#Cglib\" class=\"headerlink\" title=\"Cglib\"></a>Cglib</h2><p><code>Cglib</code>代理是针对<code>所有类</code>（包括实现接口的类和普通的类）实现代理，主要是对指定的类<strong>生成一个子类</strong>，覆盖其中的方法(<strong>所以该类或方法不能声明称final的</strong>) 。<code>Cglib</code>使用<code>ASM框架</code>直接对字节码进行操作，在类的执行过程中比较高效</p>\n<h3 id=\"使用-1\"><a href=\"#使用-1\" class=\"headerlink\" title=\"使用\"></a>使用</h3><p><a href=\"http://cdn.mjava.top/blog/20200729001250.png\" rel=\"noopener\" target=\"_blank\"></a></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">InterTest</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">t1</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">InterClass</span> <span class=\"keyword\">implements</span> <span class=\"title\">InterTest</span></span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">t1</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"我是接口测试方法\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CglibTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">         * 普通类</span></span><br><span class=\"line\"><span class=\"comment\">         * */</span></span><br><span class=\"line\">        Enhancer enhancer=<span class=\"keyword\">new</span> Enhancer();</span><br><span class=\"line\">        enhancer.setSuperclass(CG.class);</span><br><span class=\"line\">        enhancer.setCallback(<span class=\"keyword\">new</span> MethodInterceptor() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">intercept</span><span class=\"params\">(Object o, Method method,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                    Object[] objects,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                    MethodProxy methodProxy)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"前置\"</span>);</span><br><span class=\"line\">                Object object=methodProxy.invokeSuper(o,objects);</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"后置\"</span>);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> object;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        CG cglibTest= (CG) enhancer.create();</span><br><span class=\"line\">        cglibTest.test();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"代理类名称1：\"</span>+cglibTest.getClass());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\">         * 实现了接口的类</span></span><br><span class=\"line\"><span class=\"comment\">         * */</span></span><br><span class=\"line\">        Enhancer enhancer2=<span class=\"keyword\">new</span> Enhancer();</span><br><span class=\"line\">        enhancer2.setSuperclass(InterClass.class);</span><br><span class=\"line\">        enhancer2.setCallback(<span class=\"keyword\">new</span> MethodInterceptor() &#123;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">intercept</span><span class=\"params\">(Object o, Method method,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                    Object[] objects,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                    MethodProxy methodProxy)</span> <span class=\"keyword\">throws</span> Throwable </span>&#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"接口类前置\"</span>);</span><br><span class=\"line\">                Object object=methodProxy.invokeSuper(o,objects);</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"接口类后置\"</span>);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> object;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        InterClass interClass= (InterClass) enhancer2.create();</span><br><span class=\"line\">        interClass.t1();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"代理类名称2：\"</span>+interClass.getClass());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CG</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">test</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"代理类测试\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight plain\"><table><tr><td class=\"code\"><pre><span class=\"line\">输出结果：</span><br><span class=\"line\">\t前置</span><br><span class=\"line\">    代理类测试</span><br><span class=\"line\">    后置</span><br><span class=\"line\">    代理类名称1：class com.example.demo.aop.CG$$EnhancerByCGLIB$$5c6cbf31</span><br><span class=\"line\">    </span><br><span class=\"line\">    接口类前置</span><br><span class=\"line\">    我是接口测试方法</span><br><span class=\"line\">    接口类后置</span><br><span class=\"line\">    代理类名称2：class com.example.demo.aop.InterClass$$EnhancerByCGLIB$$80c75859</span><br></pre></td></tr></table></figure>"},{"title":"Jenkins初始化界面插件安装失败解决方法","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-11-07T09:19:52.000Z","password":null,"summary":null,"_content":"\n## 前言\n\n在初始化安装界面可能由于网络问题会出现插件下载失败，就像下面这个界面\n\n![Jenkins插件安装失败](http://cdn.mjava.top/blog/jenkins_error_2_20191107155729.png)\n\n别着急，直接点击继续，先完成初始化步骤。\n\n\n\n## 设置源\n\n- 插件下载失败，一般都是网络的原因，只要更换到国内的软件源就可以了，点击Manage Jenkins\n![Jenkins](http://cdn.mjava.top/blog/20191107162947.png)\n\n\n- 点击Correct\n![Jenkins](http://cdn.mjava.top/blog/20191107163016.png)\n\n\n- 点击Advanced\n![Jenkins](http://cdn.mjava.top/blog/20191107163040.png)\n\n\n- 下拉找到Update Site\n![Jenkins](http://cdn.mjava.top/blog/20191107163100.png)\n\n\n- 然后把输入框的内容换成\n\n```shell\nhttps://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/2.89/update-center.json\n```\n\n![Jenkins](http://cdn.mjava.top/blog/20191107165325.png)\n\n## 重新下载插件\n\n- 然后重新下载刚才那些下载失败的插件,这里随机选一个\n![Jenkins](http://cdn.mjava.top/blog/20191107165630.png)\n\n\n- 在刚才设置源的那个界面点击 Available，搜索插件，选择，点击install\n![Jenkins](http://cdn.mjava.top/blog/20191107165916.png)\n\n\n- 插件正在安装\n![Jenkins](http://cdn.mjava.top/blog/20191107165947.png)\n\n\n> 安装完全部插件后然后重启Jenkins，插件界面的报错信息才会消失;如果遇到插件下载不下来或搜不到，可以看这篇文章：[Jenkins插件版本太旧的更新方法](https://mjava.top/jenkins/problem-jenkins-01/)\n\n","source":"_posts/jenkins/problem-jenkins-02.md","raw":"---\ntitle: Jenkins初始化界面插件安装失败解决方法\ntop: false\ncover: false\ntoc: true\nmathjax: true\ntags:\n  - Jenkins\ncategories:\n  - Jenkins\ndate: 2019-11-07 17:19:52\npassword:\nsummary:\n---\n\n## 前言\n\n在初始化安装界面可能由于网络问题会出现插件下载失败，就像下面这个界面\n\n![Jenkins插件安装失败](http://cdn.mjava.top/blog/jenkins_error_2_20191107155729.png)\n\n别着急，直接点击继续，先完成初始化步骤。\n\n\n\n## 设置源\n\n- 插件下载失败，一般都是网络的原因，只要更换到国内的软件源就可以了，点击Manage Jenkins\n![Jenkins](http://cdn.mjava.top/blog/20191107162947.png)\n\n\n- 点击Correct\n![Jenkins](http://cdn.mjava.top/blog/20191107163016.png)\n\n\n- 点击Advanced\n![Jenkins](http://cdn.mjava.top/blog/20191107163040.png)\n\n\n- 下拉找到Update Site\n![Jenkins](http://cdn.mjava.top/blog/20191107163100.png)\n\n\n- 然后把输入框的内容换成\n\n```shell\nhttps://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/2.89/update-center.json\n```\n\n![Jenkins](http://cdn.mjava.top/blog/20191107165325.png)\n\n## 重新下载插件\n\n- 然后重新下载刚才那些下载失败的插件,这里随机选一个\n![Jenkins](http://cdn.mjava.top/blog/20191107165630.png)\n\n\n- 在刚才设置源的那个界面点击 Available，搜索插件，选择，点击install\n![Jenkins](http://cdn.mjava.top/blog/20191107165916.png)\n\n\n- 插件正在安装\n![Jenkins](http://cdn.mjava.top/blog/20191107165947.png)\n\n\n> 安装完全部插件后然后重启Jenkins，插件界面的报错信息才会消失;如果遇到插件下载不下来或搜不到，可以看这篇文章：[Jenkins插件版本太旧的更新方法](https://mjava.top/jenkins/problem-jenkins-01/)\n\n","slug":"jenkins/problem-jenkins-02","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bk2002j2mg5ngekpyaz","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在初始化安装界面可能由于网络问题会出现插件下载失败，就像下面这个界面</p>\n<p><img src=\"http://cdn.mjava.top/blog/jenkins_error_2_20191107155729.png\" alt=\"Jenkins插件安装失败\"></p>\n<p>别着急，直接点击继续，先完成初始化步骤。</p>\n<h2 id=\"设置源\"><a href=\"#设置源\" class=\"headerlink\" title=\"设置源\"></a>设置源</h2><ul>\n<li>插件下载失败，一般都是网络的原因，只要更换到国内的软件源就可以了，点击Manage Jenkins<br><img src=\"http://cdn.mjava.top/blog/20191107162947.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>点击Correct<br><img src=\"http://cdn.mjava.top/blog/20191107163016.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>点击Advanced<br><img src=\"http://cdn.mjava.top/blog/20191107163040.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>下拉找到Update Site<br><img src=\"http://cdn.mjava.top/blog/20191107163100.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>然后把输入框的内容换成</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/2.89/update-center.json</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20191107165325.png\" alt=\"Jenkins\"></p>\n<h2 id=\"重新下载插件\"><a href=\"#重新下载插件\" class=\"headerlink\" title=\"重新下载插件\"></a>重新下载插件</h2><ul>\n<li>然后重新下载刚才那些下载失败的插件,这里随机选一个<br><img src=\"http://cdn.mjava.top/blog/20191107165630.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>在刚才设置源的那个界面点击 Available，搜索插件，选择，点击install<br><img src=\"http://cdn.mjava.top/blog/20191107165916.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>插件正在安装<br><img src=\"http://cdn.mjava.top/blog/20191107165947.png\" alt=\"Jenkins\"></li>\n</ul>\n<blockquote>\n<p>安装完全部插件后然后重启Jenkins，插件界面的报错信息才会消失;如果遇到插件下载不下来或搜不到，可以看这篇文章：<a href=\"https://mjava.top/jenkins/problem-jenkins-01/\">Jenkins插件版本太旧的更新方法</a></p>\n</blockquote>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>在初始化安装界面可能由于网络问题会出现插件下载失败，就像下面这个界面</p>\n<p><img src=\"http://cdn.mjava.top/blog/jenkins_error_2_20191107155729.png\" alt=\"Jenkins插件安装失败\"></p>\n<p>别着急，直接点击继续，先完成初始化步骤。</p>\n<h2 id=\"设置源\"><a href=\"#设置源\" class=\"headerlink\" title=\"设置源\"></a>设置源</h2><ul>\n<li>插件下载失败，一般都是网络的原因，只要更换到国内的软件源就可以了，点击Manage Jenkins<br><img src=\"http://cdn.mjava.top/blog/20191107162947.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>点击Correct<br><img src=\"http://cdn.mjava.top/blog/20191107163016.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>点击Advanced<br><img src=\"http://cdn.mjava.top/blog/20191107163040.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>下拉找到Update Site<br><img src=\"http://cdn.mjava.top/blog/20191107163100.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>然后把输入框的内容换成</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/2.89/update-center.json</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20191107165325.png\" alt=\"Jenkins\"></p>\n<h2 id=\"重新下载插件\"><a href=\"#重新下载插件\" class=\"headerlink\" title=\"重新下载插件\"></a>重新下载插件</h2><ul>\n<li>然后重新下载刚才那些下载失败的插件,这里随机选一个<br><img src=\"http://cdn.mjava.top/blog/20191107165630.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>在刚才设置源的那个界面点击 Available，搜索插件，选择，点击install<br><img src=\"http://cdn.mjava.top/blog/20191107165916.png\" alt=\"Jenkins\"></li>\n</ul>\n<ul>\n<li>插件正在安装<br><img src=\"http://cdn.mjava.top/blog/20191107165947.png\" alt=\"Jenkins\"></li>\n</ul>\n<blockquote>\n<p>安装完全部插件后然后重启Jenkins，插件界面的报错信息才会消失;如果遇到插件下载不下来或搜不到，可以看这篇文章：<a href=\"https://mjava.top/jenkins/problem-jenkins-01/\">Jenkins插件版本太旧的更新方法</a></p>\n</blockquote>\n"},{"title":"树莓派安装docker","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-08-30T10:33:03.000Z","password":null,"summary":null,"_content":"\n## 前言\n\n  和平常x86_64架构的电脑安装docker不同，树莓派是ARM架构的，所以安装步骤比较繁琐一点。\n\n\n\n##  使用APT源安装docker\n\n  更新apt软件源及安装必备组件。为了确认所下载软件包的合法性，还需要添加软件源的 GPG 密钥。\n\n```shell\n$sudo apt-get update\n$sudo apt-get install \\\n\t apt-transport-https \\\n     ca-certificates \\\n     curl \\\n     gnupg2 \\\n     lsb-release \\\n     software-properties-common\n$curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/raspbian/gpg | sudo apt-key add -\n```\n\n\n\n## 添加docker ce 软件源\n\n* 首先执行以下一行命令，然后记一下输出的结果\n\n  ```shell\n  $ echo $(lsb_release -cs)\n  stretch\n  ```\n\n* 在/etc/apt/sources.list.d目录下新建文件docker.list\n\n  ```shell\n  $ sudo vi /etc/apt/sources.list.d/docker.list\n  ```\n\n* 在文件里添加下面这行\n\n  ```shell\n  deb [arch=armhf] https://download.docker.com/linux/raspbian $(lsb_release -cs) stable\n  ```\n\n* 把$(lsb_release -cs)改为刚才第一行输出的结果，比如我的输出的是stretch，改完后如下\n\n  ```shell\n  deb [arch=armhf] https://download.docker.com/linux/raspbian stretch stable\n  ```\n\n* 保存，退出\n\n  \n\n## 安装docker ce\n\n  依次执行以下两行命令，即可完成安装\n\n```shell\n$ sudo apt-get update\n$ sudo apt-get install docker-ce\n```\n\n\n\n## 启动\n\n```shell\n$ service docker start           启动\n$ service docker stop            停止\n$ service docker status          状态\n$ service docker restart         重启\n```","source":"_posts/linux/build-docker-pi.md","raw":"---\ntitle: 树莓派安装docker\ntop: false\ncover: false\ntoc: true\nmathjax: true\ntags:\n  - Linux\n  - Docker\n  - RaspberryPi\ncategories:\n  - Linux\ndate: 2019-08-30 18:33:03\npassword:\nsummary:\n---\n\n## 前言\n\n  和平常x86_64架构的电脑安装docker不同，树莓派是ARM架构的，所以安装步骤比较繁琐一点。\n\n\n\n##  使用APT源安装docker\n\n  更新apt软件源及安装必备组件。为了确认所下载软件包的合法性，还需要添加软件源的 GPG 密钥。\n\n```shell\n$sudo apt-get update\n$sudo apt-get install \\\n\t apt-transport-https \\\n     ca-certificates \\\n     curl \\\n     gnupg2 \\\n     lsb-release \\\n     software-properties-common\n$curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/raspbian/gpg | sudo apt-key add -\n```\n\n\n\n## 添加docker ce 软件源\n\n* 首先执行以下一行命令，然后记一下输出的结果\n\n  ```shell\n  $ echo $(lsb_release -cs)\n  stretch\n  ```\n\n* 在/etc/apt/sources.list.d目录下新建文件docker.list\n\n  ```shell\n  $ sudo vi /etc/apt/sources.list.d/docker.list\n  ```\n\n* 在文件里添加下面这行\n\n  ```shell\n  deb [arch=armhf] https://download.docker.com/linux/raspbian $(lsb_release -cs) stable\n  ```\n\n* 把$(lsb_release -cs)改为刚才第一行输出的结果，比如我的输出的是stretch，改完后如下\n\n  ```shell\n  deb [arch=armhf] https://download.docker.com/linux/raspbian stretch stable\n  ```\n\n* 保存，退出\n\n  \n\n## 安装docker ce\n\n  依次执行以下两行命令，即可完成安装\n\n```shell\n$ sudo apt-get update\n$ sudo apt-get install docker-ce\n```\n\n\n\n## 启动\n\n```shell\n$ service docker start           启动\n$ service docker stop            停止\n$ service docker status          状态\n$ service docker restart         重启\n```","slug":"linux/build-docker-pi","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bk3002m2mg5qwyy1q5z","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>  和平常x86_64架构的电脑安装docker不同，树莓派是ARM架构的，所以安装步骤比较繁琐一点。</p>\n<h2 id=\"使用APT源安装docker\"><a href=\"#使用APT源安装docker\" class=\"headerlink\" title=\"使用APT源安装docker\"></a>使用APT源安装docker</h2><p>  更新apt软件源及安装必备组件。为了确认所下载软件包的合法性，还需要添加软件源的 GPG 密钥。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">sudo apt-get update</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">sudo apt-get install \\</span></span><br><span class=\"line\">\t apt-transport-https \\</span><br><span class=\"line\">     ca-certificates \\</span><br><span class=\"line\">     curl \\</span><br><span class=\"line\">     gnupg2 \\</span><br><span class=\"line\">     lsb-release \\</span><br><span class=\"line\">     software-properties-common</span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/raspbian/gpg | sudo apt-key add -</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"添加docker-ce-软件源\"><a href=\"#添加docker-ce-软件源\" class=\"headerlink\" title=\"添加docker ce 软件源\"></a>添加docker ce 软件源</h2><ul>\n<li><p>首先执行以下一行命令，然后记一下输出的结果</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> <span class=\"built_in\">echo</span> $(lsb_release -cs)</span></span><br><span class=\"line\">stretch</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>在/etc/apt/sources.list.d目录下新建文件docker.list</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo vi /etc/apt/sources.list.d/docker.list</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>在文件里添加下面这行</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">deb [arch=armhf] https://download.docker.com/linux/raspbian $(lsb_release -cs) stable</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>把$(lsb_release -cs)改为刚才第一行输出的结果，比如我的输出的是stretch，改完后如下</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">deb [arch=armhf] https://download.docker.com/linux/raspbian stretch stable</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>保存，退出</p>\n</li>\n</ul>\n<h2 id=\"安装docker-ce\"><a href=\"#安装docker-ce\" class=\"headerlink\" title=\"安装docker ce\"></a>安装docker ce</h2><p>  依次执行以下两行命令，即可完成安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo apt-get update</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo apt-get install docker-ce</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"启动\"><a href=\"#启动\" class=\"headerlink\" title=\"启动\"></a>启动</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> service docker start           启动</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> service docker stop            停止</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> service docker status          状态</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> service docker restart         重启</span></span><br></pre></td></tr></table></figure>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>  和平常x86_64架构的电脑安装docker不同，树莓派是ARM架构的，所以安装步骤比较繁琐一点。</p>\n<h2 id=\"使用APT源安装docker\"><a href=\"#使用APT源安装docker\" class=\"headerlink\" title=\"使用APT源安装docker\"></a>使用APT源安装docker</h2><p>  更新apt软件源及安装必备组件。为了确认所下载软件包的合法性，还需要添加软件源的 GPG 密钥。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">sudo apt-get update</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">sudo apt-get install \\</span></span><br><span class=\"line\">\t apt-transport-https \\</span><br><span class=\"line\">     ca-certificates \\</span><br><span class=\"line\">     curl \\</span><br><span class=\"line\">     gnupg2 \\</span><br><span class=\"line\">     lsb-release \\</span><br><span class=\"line\">     software-properties-common</span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/raspbian/gpg | sudo apt-key add -</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"添加docker-ce-软件源\"><a href=\"#添加docker-ce-软件源\" class=\"headerlink\" title=\"添加docker ce 软件源\"></a>添加docker ce 软件源</h2><ul>\n<li><p>首先执行以下一行命令，然后记一下输出的结果</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> <span class=\"built_in\">echo</span> $(lsb_release -cs)</span></span><br><span class=\"line\">stretch</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>在/etc/apt/sources.list.d目录下新建文件docker.list</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo vi /etc/apt/sources.list.d/docker.list</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>在文件里添加下面这行</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">deb [arch=armhf] https://download.docker.com/linux/raspbian $(lsb_release -cs) stable</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>把$(lsb_release -cs)改为刚才第一行输出的结果，比如我的输出的是stretch，改完后如下</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">deb [arch=armhf] https://download.docker.com/linux/raspbian stretch stable</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>保存，退出</p>\n</li>\n</ul>\n<h2 id=\"安装docker-ce\"><a href=\"#安装docker-ce\" class=\"headerlink\" title=\"安装docker ce\"></a>安装docker ce</h2><p>  依次执行以下两行命令，即可完成安装</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo apt-get update</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> sudo apt-get install docker-ce</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"启动\"><a href=\"#启动\" class=\"headerlink\" title=\"启动\"></a>启动</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> service docker start           启动</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> service docker stop            停止</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> service docker status          状态</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> service docker restart         重启</span></span><br></pre></td></tr></table></figure>"},{"title":"Hexo使用UUID生成文章路径","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-01-27T09:51:05.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 教程\n1. 编写一个名为**hexoN**的脚本文件\n\n```shell\n#!/bin/bash\nuuid=$(sudo cat /proc/sys/kernel/random/uuid)\necho $uuid\nhexo new $uuid\n```\n\n2. 添加执行权限\n\n```shell\nchmod +x hexoN\n```\n\n3. 在用户根目录的`.zshrc`(因为我用的是ohmyzsh，所以是这个文件，一般是`.bashrc`，也可直接加载系统文件`/etc/profile`中)追加一条\n\n``` shell\n# 后面地址是存放这个脚本的文件夹路径 根据实际更改\nexport PATH=$PATH:/home/zheng/software/shell\n```\n\n4. 执行命令是刚才追加的内容生效\n\n```shell\nsource .zshrc\n```\n\n<!-- more -->\n\n## 使用\n\n到Hexo博客的根目录执行\n\n![20210127180305](http://cdn.mjava.top/20210127180305.png)","source":"_posts/linux/79b5fe12-9c60-4b93-be92-dffb00fa39c7.md","raw":"---\ntitle: Hexo使用UUID生成文章路径\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-01-27 17:51:05\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Shell\n- Linux\ncategories:\n- Linux\n---\n\n## 教程\n1. 编写一个名为**hexoN**的脚本文件\n\n```shell\n#!/bin/bash\nuuid=$(sudo cat /proc/sys/kernel/random/uuid)\necho $uuid\nhexo new $uuid\n```\n\n2. 添加执行权限\n\n```shell\nchmod +x hexoN\n```\n\n3. 在用户根目录的`.zshrc`(因为我用的是ohmyzsh，所以是这个文件，一般是`.bashrc`，也可直接加载系统文件`/etc/profile`中)追加一条\n\n``` shell\n# 后面地址是存放这个脚本的文件夹路径 根据实际更改\nexport PATH=$PATH:/home/zheng/software/shell\n```\n\n4. 执行命令是刚才追加的内容生效\n\n```shell\nsource .zshrc\n```\n\n<!-- more -->\n\n## 使用\n\n到Hexo博客的根目录执行\n\n![20210127180305](http://cdn.mjava.top/20210127180305.png)","slug":"linux/79b5fe12-9c60-4b93-be92-dffb00fa39c7","published":1,"updated":"2021-01-27T10:06:47.267Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bk4002q2mg5vwgm5itk","content":"<h2 id=\"教程\"><a href=\"#教程\" class=\"headerlink\" title=\"教程\"></a>教程</h2><ol>\n<li>编写一个名为<strong>hexoN</strong>的脚本文件</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">uuid=$(sudo cat /proc/sys/kernel/random/uuid)</span><br><span class=\"line\">echo $uuid</span><br><span class=\"line\">hexo new $uuid</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>添加执行权限</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">chmod +x hexoN</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>在用户根目录的<code>.zshrc</code>(因为我用的是ohmyzsh，所以是这个文件，一般是<code>.bashrc</code>，也可直接加载系统文件<code>/etc/profile</code>中)追加一条</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 后面地址是存放这个脚本的文件夹路径 根据实际更改</span></span><br><span class=\"line\">export PATH=$PATH:/home/zheng/software/shell</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>执行命令是刚才追加的内容生效</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">source .zshrc</span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<h2 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h2><p>到Hexo博客的根目录执行</p>\n<p><img src=\"http://cdn.mjava.top/20210127180305.png\" alt=\"20210127180305\"></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"<h2 id=\"教程\"><a href=\"#教程\" class=\"headerlink\" title=\"教程\"></a>教程</h2><ol>\n<li>编写一个名为<strong>hexoN</strong>的脚本文件</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">!/bin/bash</span></span><br><span class=\"line\">uuid=$(sudo cat /proc/sys/kernel/random/uuid)</span><br><span class=\"line\">echo $uuid</span><br><span class=\"line\">hexo new $uuid</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li>添加执行权限</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">chmod +x hexoN</span><br></pre></td></tr></table></figure>\n\n<ol start=\"3\">\n<li>在用户根目录的<code>.zshrc</code>(因为我用的是ohmyzsh，所以是这个文件，一般是<code>.bashrc</code>，也可直接加载系统文件<code>/etc/profile</code>中)追加一条</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> 后面地址是存放这个脚本的文件夹路径 根据实际更改</span></span><br><span class=\"line\">export PATH=$PATH:/home/zheng/software/shell</span><br></pre></td></tr></table></figure>\n\n<ol start=\"4\">\n<li>执行命令是刚才追加的内容生效</li>\n</ol>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">source .zshrc</span><br></pre></td></tr></table></figure>","more":"<h2 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h2><p>到Hexo博客的根目录执行</p>\n<p><img src=\"http://cdn.mjava.top/20210127180305.png\" alt=\"20210127180305\"></p>"},{"title":"JDK时区问题","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-08-27T07:26:30.000Z","password":null,"summary":null,"_content":"\n\n今天碰到一个大坑，弄了快一个小时才解决掉；\n\n一个管理台后端服务，用docker隔离了三个容器，oracle,nginx,tomcat;后发现管理台查出来的时间和现实时间相差8个小时，一查是linux时区问题；\n\n---\n\n* 于是改之,三台容器都输入一下代码\n\n```shell\ncp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n```\n\n测试了一下，发现问题docker容器的时区是正确了，可是问题并未得到解决，数据库时间还是慢了8个小时。\n\n---\n\n* 于是又查资料，换另外一种设置时区的方法；\n\n```shell\nvi /etc/sysconfig/clock\n```\n\n在里面输入如下内容\n\n```shell\nZONE=\"Asia/Shanghai\"\nUTC=false\nARC=false\n```\n\n保存，重启，测试。。。。。发现还是一样,快疯了\n\n---\n\n* 第三种方法，设置TZ环境变量\n\n> 设置环境变量可以在设置系统级别的/etc/profile  ,也可以设置用户级别的home目录的.bashrc。由于用的是docker，防止变量重启失效，只能在.bashrc里设置。在.bashrc加入如下内容：\n\n```shell\nexport TZ='CST-8'\n```\n\n保存：然后执行\n\n```shell\nsource .bashrc\n```\n\n使设置立即生效。\n\n重启容器，测试，发现时间正常了。。。。哈哈哈哈\n\n---\n\n## 总结\n\n上面问题出在jdk的new Date()方法，所以只要设置jdk所在的那个docker容器的变量就可以，不用每个都设置。jdk的new Date()方法每次调用都会去取环境变量TZ的时区，TZ是TimeZone的缩写，容器内部操作系统并未指定时区（TimeZone）信息，系统默认使用世界标准时（UTC+0),所以导致new Date()出来的数据存库会比当前时间慢8个小时；\n","source":"_posts/linux/problem-jdk-timezone.md","raw":"---\ntitle: JDK时区问题\ntop: false\ncover: false\ntoc: true\nmathjax: true\ntags:\n  - Java\n  - Linux\ncategories:\n  - Linux\ndate: 2019-08-27 15:26:30\npassword:\nsummary:\n---\n\n\n今天碰到一个大坑，弄了快一个小时才解决掉；\n\n一个管理台后端服务，用docker隔离了三个容器，oracle,nginx,tomcat;后发现管理台查出来的时间和现实时间相差8个小时，一查是linux时区问题；\n\n---\n\n* 于是改之,三台容器都输入一下代码\n\n```shell\ncp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n```\n\n测试了一下，发现问题docker容器的时区是正确了，可是问题并未得到解决，数据库时间还是慢了8个小时。\n\n---\n\n* 于是又查资料，换另外一种设置时区的方法；\n\n```shell\nvi /etc/sysconfig/clock\n```\n\n在里面输入如下内容\n\n```shell\nZONE=\"Asia/Shanghai\"\nUTC=false\nARC=false\n```\n\n保存，重启，测试。。。。。发现还是一样,快疯了\n\n---\n\n* 第三种方法，设置TZ环境变量\n\n> 设置环境变量可以在设置系统级别的/etc/profile  ,也可以设置用户级别的home目录的.bashrc。由于用的是docker，防止变量重启失效，只能在.bashrc里设置。在.bashrc加入如下内容：\n\n```shell\nexport TZ='CST-8'\n```\n\n保存：然后执行\n\n```shell\nsource .bashrc\n```\n\n使设置立即生效。\n\n重启容器，测试，发现时间正常了。。。。哈哈哈哈\n\n---\n\n## 总结\n\n上面问题出在jdk的new Date()方法，所以只要设置jdk所在的那个docker容器的变量就可以，不用每个都设置。jdk的new Date()方法每次调用都会去取环境变量TZ的时区，TZ是TimeZone的缩写，容器内部操作系统并未指定时区（TimeZone）信息，系统默认使用世界标准时（UTC+0),所以导致new Date()出来的数据存库会比当前时间慢8个小时；\n","slug":"linux/problem-jdk-timezone","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bk5002u2mg57o40uo2e","content":"<p>今天碰到一个大坑，弄了快一个小时才解决掉；</p>\n<p>一个管理台后端服务，用docker隔离了三个容器，oracle,nginx,tomcat;后发现管理台查出来的时间和现实时间相差8个小时，一查是linux时区问题；</p>\n<hr>\n<ul>\n<li>于是改之,三台容器都输入一下代码</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></pre></td></tr></table></figure>\n\n<p>测试了一下，发现问题docker容器的时区是正确了，可是问题并未得到解决，数据库时间还是慢了8个小时。</p>\n<hr>\n<ul>\n<li>于是又查资料，换另外一种设置时区的方法；</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">vi /etc/sysconfig/clock</span><br></pre></td></tr></table></figure>\n\n<p>在里面输入如下内容</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">ZONE=\"Asia/Shanghai\"</span><br><span class=\"line\">UTC=false</span><br><span class=\"line\">ARC=false</span><br></pre></td></tr></table></figure>\n\n<p>保存，重启，测试。。。。。发现还是一样,快疯了</p>\n<hr>\n<ul>\n<li>第三种方法，设置TZ环境变量</li>\n</ul>\n<blockquote>\n<p>设置环境变量可以在设置系统级别的/etc/profile  ,也可以设置用户级别的home目录的.bashrc。由于用的是docker，防止变量重启失效，只能在.bashrc里设置。在.bashrc加入如下内容：</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">export TZ='CST-8'</span><br></pre></td></tr></table></figure>\n\n<p>保存：然后执行</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">source .bashrc</span><br></pre></td></tr></table></figure>\n\n<p>使设置立即生效。</p>\n<p>重启容器，测试，发现时间正常了。。。。哈哈哈哈</p>\n<hr>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>上面问题出在jdk的new Date()方法，所以只要设置jdk所在的那个docker容器的变量就可以，不用每个都设置。jdk的new Date()方法每次调用都会去取环境变量TZ的时区，TZ是TimeZone的缩写，容器内部操作系统并未指定时区（TimeZone）信息，系统默认使用世界标准时（UTC+0),所以导致new Date()出来的数据存库会比当前时间慢8个小时；</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p>今天碰到一个大坑，弄了快一个小时才解决掉；</p>\n<p>一个管理台后端服务，用docker隔离了三个容器，oracle,nginx,tomcat;后发现管理台查出来的时间和现实时间相差8个小时，一查是linux时区问题；</p>\n<hr>\n<ul>\n<li>于是改之,三台容器都输入一下代码</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></pre></td></tr></table></figure>\n\n<p>测试了一下，发现问题docker容器的时区是正确了，可是问题并未得到解决，数据库时间还是慢了8个小时。</p>\n<hr>\n<ul>\n<li>于是又查资料，换另外一种设置时区的方法；</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">vi /etc/sysconfig/clock</span><br></pre></td></tr></table></figure>\n\n<p>在里面输入如下内容</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">ZONE=\"Asia/Shanghai\"</span><br><span class=\"line\">UTC=false</span><br><span class=\"line\">ARC=false</span><br></pre></td></tr></table></figure>\n\n<p>保存，重启，测试。。。。。发现还是一样,快疯了</p>\n<hr>\n<ul>\n<li>第三种方法，设置TZ环境变量</li>\n</ul>\n<blockquote>\n<p>设置环境变量可以在设置系统级别的/etc/profile  ,也可以设置用户级别的home目录的.bashrc。由于用的是docker，防止变量重启失效，只能在.bashrc里设置。在.bashrc加入如下内容：</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">export TZ='CST-8'</span><br></pre></td></tr></table></figure>\n\n<p>保存：然后执行</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">source .bashrc</span><br></pre></td></tr></table></figure>\n\n<p>使设置立即生效。</p>\n<p>重启容器，测试，发现时间正常了。。。。哈哈哈哈</p>\n<hr>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>上面问题出在jdk的new Date()方法，所以只要设置jdk所在的那个docker容器的变量就可以，不用每个都设置。jdk的new Date()方法每次调用都会去取环境变量TZ的时区，TZ是TimeZone的缩写，容器内部操作系统并未指定时区（TimeZone）信息，系统默认使用世界标准时（UTC+0),所以导致new Date()出来的数据存库会比当前时间慢8个小时；</p>\n"},{"title":"Jenkins教程-集成SonarQube","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-13T07:38:02.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n## 什么是SonarQube?\n\n看看维基百科的说明：\n![](http://cdn.mjava.top/Fi9bL7TAwFmCYPt3Cz_d0TIwm9rQ)\n\n### SonarQube与CI/CD架构图\n![SonarQube与CI/CD架构图](http://cdn.mjava.top/FpResgoc3tny2jvGqaqudPwCwstj)\n\n## Docker运行SonarQube\n\n简单了解之后，开始安装SonarQube.这里用Docker安装\n\n> 注：这里用mysql来存储SonarQube的数据，SonarQube7.9起已经不在支持mysql了，可以安装官方推荐的PostgreSQL\n\n- SonarQube 6.7.7\n- Docker-CE 19.03.1\n- Mysql 5.7\n\n### 安装\n\n直接运行这个docker命令来安装，网上其他的教程有什么挂载文件什么的，我试了都会安装失败，原因还是因为权限原因，因为SonarQube不是以root用户运行的，导致没权限读写挂载出来的文件夹．\n\n> 注意：创建容器前一定要先保证你连的容器有对应的数据库\n\n```shell\ndocker run -d --name sonarqube -p 9099:9000 -p 9092:9092 --link=dev_mysql:mysql -e SONARQUBE_JDBC_USERNAME=app -e SONARQUBE_JDBC_PASSWORD=app -e SONARQUBE_JDBC_URL=\"jdbc:mysql://mysql:3306/sonar?useUnicode=true&characterEncoding=utf8&rewriteBatchedStatements=true&useConfigs=maxPerformance&useSSL=false\" --restart=always sonarqube:6.7.7-community\n```\n\n- --link=dev_mysql:mysql     这个命令我链接到了我的mysql容器，dev_mysql是容器的名字，mysql是在SonarQube容器里的别名，所以链接数据库时直接用mysql这个别名就可了．\n\n- SONARQUBE_JDBC_USERNAME ：数据库的账户\n\n- SONARQUBE_JDBC_PASSWORD ：数据库密码\n\n\n\n### 访问\n\n安装好后直接访问<font color=orange>9099</font>端口，登录的账户和密码默认都是<font color=orange>admin</font>．首页就是这个样子的．\n\n![](http://cdn.mjava.top/Fs08WpcVDcL3n32MxoCNPDMtu1r5)\n\n\n## Jenkins集成SonarQube\n\nJenkins和SonarQube都是运行在Docker容器里的\n\n### 下载和安装插件\n\n直接下载最新版的，然后导入，导入的方法可以看[插件导入方法](https://mjava.top/jenkins/problem-jenkins-01/)\n\n- 插件下载地址：https://updates.jenkins.io/download/plugins/sonar/\n\n\n\n### SonarQube生成Token\n\n进入SonarQube管理界面\n\nAdministration->Security->Users\n\n![](http://cdn.mjava.top/FpFSYEgJfsJIwgNMA6tHHZtdAtpV)\n\n\n\n然后随便输入一个名字，点击生成，记下Token\n\n![](http://cdn.mjava.top/FhTOSglZYOrP5poo_mmR3SGoobsD)\n\n\n\n### 添加全局凭证\n\n类型选Secret text,然后Secret和ID输入框都填入刚才生成的Token\n\n![](http://cdn.mjava.top/FrKo5EjJ9-78uYbDjBpiuVkeu-_5)\n\n### 设置SonarQube servers\n\n进入　系统管理->系统设置->SonarQube servers　　　　<font color=orange>设置好后点保存</font>\n\n> 因为我SonarQube和Jenkins安装在同一台机器不同的Docker容器里的,所以这里URL直接填SonarQube的Docker容器的IP和端口\n\n![](http://cdn.mjava.top/FpevTpJePMDg9-HSoQoSOCNORHL8)\n\n\n\n### 安装SonarQube Scanner\n\n#### 下载压缩包\n\n- 下载SonarQube Scanner压缩包：[SonarQube Scanner](https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-4.2.0.1873-linux.zip)\n\n#### 解压到Jenkins挂载出来的目录里\n\n只有解压到挂载出来的Jenkins的目录里，Docker容器安装的Jenkins才能读取到,<font color=orange>**我这里是宿主机的/opt/jenkins挂载到了Jenkins容器里的/var/jenkins_home目录上，所以我只要解压到宿主机的/opt/jenkins目录中就可以了**</font>\n\n#### Jenkins配置全局工具\n\n进入　系统管理->全局工具配置->SonarQube Scanner     找到模块后点击<font color=orange>新增SonarQube Scanner</font>\n\n<font color=orange>SONAR_RUNNER_HOME填你Jenkins这个Docker容器里的路径</font>\n\n![](http://cdn.mjava.top/Fpgv2yqskGjp37mfoxHC6MGtIAPt)\n\n\n\n## 构建一个Maven项目\n\n网上很多教程说要勾上这个选项：\n\n![](http://cdn.mjava.top/FsSrQCDF5O9x4sufLZkFRz40toHI)\n其实这个是可选的，下面有一句话：<font color=orange>These variables are useful when configuring a SonarQube analysis using standard build steps such as Maven, Gradle, Ant, and command line scripts.This feature is not needed if you're using \"SonarQube Scanner\" or \"SonarScanner for MSBuild\" build steps.</font>\n\n翻译过来就是：![](http://cdn.mjava.top/FrM7HmTx_APStJMI0OHlMQO6WL3W)\n因为我们这里用的就是<font color=orange>SonarQube Scanner</font>,所以这个我们是可以不用勾上的，但是勾上也没影响；\n\n\n\n\n\n### 开始构建\n- 具体怎么构建项目可以看：[Jenkins教程-创建Maven项目](https://mjava.top/jenkins/build-jenkins-mavne/),这里就不多介绍了\n\n#### 添加Execute SonarQube Scanner\n\n在原来构建的基础上加上<font color=orange>Execute SonarQube Scanner</font>，就可以了\n\n![](http://cdn.mjava.top/FgZ021lPaTWzgOPsG7veK1cn7lIB)\n\n在<font color=orange>Analysis properties</font>里填上构建的参数\n\n![](http://cdn.mjava.top/FiFA65-xUZCh62Y5HfIgxQzvMx7D)\n\n>唯一的项目标识符（必填）\n>sonar.projectKey =tiny-config1\n>\n>项目元数据（以前是必需的，自SonarQube 6.1起是可选的）\n>sonar.projectName =tiny-config1\n>sonar.projectVersion = 1.0\n>\n>源目录的路径（必需）\n>sonar.sources = srcDir1，srcDir2\n>\n>测试源目录的路径（可选）\n>sonar.tests = testDir1，testDir2\n>\n>Java项目编译类的路径（可选）\n>sonar.java.binaries = bin\n>\n>逗号分隔的库路径列表（可选）\n>sonar.java.libraries = path / to / library.jar，path / to / classes / dir\n>\n>附加参数\n>sonar.my.property =value\n\n保存后就可以正常构建了．\n\n#### 错误解决（没有错误可跳过这段）\n如果在构建项目的时候,Jenkins控制台如果报一下错误，这是因为SonarQube的Java版本太低造成的\n![](http://cdn.mjava.top/FnTRL4pSwrKk5Xwbzobo89VKHf5m)\n\n##### 升级SonarQube的Java版本\n\n进入SonarQube的管理台： Administration->Marketplace->SonarJava\n\n> 如果你版本没升级，右边会有个update按钮，点击就可以升级了，升级完后重启SonarQube;这边因为我已经升级过了，所以没有这个按钮\n\n![](http://cdn.mjava.top/FgbCXvUiteJ9iGCCYC6qbInX0VSX)\n\n\n\n### 构建完成后\n\nJenkins控制台显示SUCCESS就表示构建成功了\n\n![](http://cdn.mjava.top/FoijfnBHiJAZ7lA7YqmdQb-bEqUF)\n\n这时候就可以点击构建项目的SonarQube直接跳转到SonarQube控制台了\n\n![](http://cdn.mjava.top/FhXgRD7rBp5RBc2D6uBmH5mIBNKJ)\n\n\n这里就可以看到结果了\n\n![](http://cdn.mjava.top/FkPydWtLuuliKAq1hc8Ex45nnTlu)\n\n\n## 总结\n\n到这里就可以根据SonarQube的提示区改BUG了．这BUG有点多＝＿＝！.\n\n在搭建过程中，最主要的就是那个SonarQube Scanner这个的安装了，因为Jenkins都是Docker化的，所以他可以选择自动安装，但是我这边选择自动安装却没用，所以就自己下载了SonarQube Scnner的包挂载到Jenkins容器里区，然后直接指定SonarQube Scnner的目录就可以了；","source":"_posts/jenkins/build-jenkins-sonarqube.md","raw":"---\ntitle: Jenkins教程-集成SonarQube\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-13 15:38:02\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Jenkins\n- SonarQube\n- Docker\ncategories:\n- Jenkins\n---\n\n\n\n## 什么是SonarQube?\n\n看看维基百科的说明：\n![](http://cdn.mjava.top/Fi9bL7TAwFmCYPt3Cz_d0TIwm9rQ)\n\n### SonarQube与CI/CD架构图\n![SonarQube与CI/CD架构图](http://cdn.mjava.top/FpResgoc3tny2jvGqaqudPwCwstj)\n\n## Docker运行SonarQube\n\n简单了解之后，开始安装SonarQube.这里用Docker安装\n\n> 注：这里用mysql来存储SonarQube的数据，SonarQube7.9起已经不在支持mysql了，可以安装官方推荐的PostgreSQL\n\n- SonarQube 6.7.7\n- Docker-CE 19.03.1\n- Mysql 5.7\n\n### 安装\n\n直接运行这个docker命令来安装，网上其他的教程有什么挂载文件什么的，我试了都会安装失败，原因还是因为权限原因，因为SonarQube不是以root用户运行的，导致没权限读写挂载出来的文件夹．\n\n> 注意：创建容器前一定要先保证你连的容器有对应的数据库\n\n```shell\ndocker run -d --name sonarqube -p 9099:9000 -p 9092:9092 --link=dev_mysql:mysql -e SONARQUBE_JDBC_USERNAME=app -e SONARQUBE_JDBC_PASSWORD=app -e SONARQUBE_JDBC_URL=\"jdbc:mysql://mysql:3306/sonar?useUnicode=true&characterEncoding=utf8&rewriteBatchedStatements=true&useConfigs=maxPerformance&useSSL=false\" --restart=always sonarqube:6.7.7-community\n```\n\n- --link=dev_mysql:mysql     这个命令我链接到了我的mysql容器，dev_mysql是容器的名字，mysql是在SonarQube容器里的别名，所以链接数据库时直接用mysql这个别名就可了．\n\n- SONARQUBE_JDBC_USERNAME ：数据库的账户\n\n- SONARQUBE_JDBC_PASSWORD ：数据库密码\n\n\n\n### 访问\n\n安装好后直接访问<font color=orange>9099</font>端口，登录的账户和密码默认都是<font color=orange>admin</font>．首页就是这个样子的．\n\n![](http://cdn.mjava.top/Fs08WpcVDcL3n32MxoCNPDMtu1r5)\n\n\n## Jenkins集成SonarQube\n\nJenkins和SonarQube都是运行在Docker容器里的\n\n### 下载和安装插件\n\n直接下载最新版的，然后导入，导入的方法可以看[插件导入方法](https://mjava.top/jenkins/problem-jenkins-01/)\n\n- 插件下载地址：https://updates.jenkins.io/download/plugins/sonar/\n\n\n\n### SonarQube生成Token\n\n进入SonarQube管理界面\n\nAdministration->Security->Users\n\n![](http://cdn.mjava.top/FpFSYEgJfsJIwgNMA6tHHZtdAtpV)\n\n\n\n然后随便输入一个名字，点击生成，记下Token\n\n![](http://cdn.mjava.top/FhTOSglZYOrP5poo_mmR3SGoobsD)\n\n\n\n### 添加全局凭证\n\n类型选Secret text,然后Secret和ID输入框都填入刚才生成的Token\n\n![](http://cdn.mjava.top/FrKo5EjJ9-78uYbDjBpiuVkeu-_5)\n\n### 设置SonarQube servers\n\n进入　系统管理->系统设置->SonarQube servers　　　　<font color=orange>设置好后点保存</font>\n\n> 因为我SonarQube和Jenkins安装在同一台机器不同的Docker容器里的,所以这里URL直接填SonarQube的Docker容器的IP和端口\n\n![](http://cdn.mjava.top/FpevTpJePMDg9-HSoQoSOCNORHL8)\n\n\n\n### 安装SonarQube Scanner\n\n#### 下载压缩包\n\n- 下载SonarQube Scanner压缩包：[SonarQube Scanner](https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-4.2.0.1873-linux.zip)\n\n#### 解压到Jenkins挂载出来的目录里\n\n只有解压到挂载出来的Jenkins的目录里，Docker容器安装的Jenkins才能读取到,<font color=orange>**我这里是宿主机的/opt/jenkins挂载到了Jenkins容器里的/var/jenkins_home目录上，所以我只要解压到宿主机的/opt/jenkins目录中就可以了**</font>\n\n#### Jenkins配置全局工具\n\n进入　系统管理->全局工具配置->SonarQube Scanner     找到模块后点击<font color=orange>新增SonarQube Scanner</font>\n\n<font color=orange>SONAR_RUNNER_HOME填你Jenkins这个Docker容器里的路径</font>\n\n![](http://cdn.mjava.top/Fpgv2yqskGjp37mfoxHC6MGtIAPt)\n\n\n\n## 构建一个Maven项目\n\n网上很多教程说要勾上这个选项：\n\n![](http://cdn.mjava.top/FsSrQCDF5O9x4sufLZkFRz40toHI)\n其实这个是可选的，下面有一句话：<font color=orange>These variables are useful when configuring a SonarQube analysis using standard build steps such as Maven, Gradle, Ant, and command line scripts.This feature is not needed if you're using \"SonarQube Scanner\" or \"SonarScanner for MSBuild\" build steps.</font>\n\n翻译过来就是：![](http://cdn.mjava.top/FrM7HmTx_APStJMI0OHlMQO6WL3W)\n因为我们这里用的就是<font color=orange>SonarQube Scanner</font>,所以这个我们是可以不用勾上的，但是勾上也没影响；\n\n\n\n\n\n### 开始构建\n- 具体怎么构建项目可以看：[Jenkins教程-创建Maven项目](https://mjava.top/jenkins/build-jenkins-mavne/),这里就不多介绍了\n\n#### 添加Execute SonarQube Scanner\n\n在原来构建的基础上加上<font color=orange>Execute SonarQube Scanner</font>，就可以了\n\n![](http://cdn.mjava.top/FgZ021lPaTWzgOPsG7veK1cn7lIB)\n\n在<font color=orange>Analysis properties</font>里填上构建的参数\n\n![](http://cdn.mjava.top/FiFA65-xUZCh62Y5HfIgxQzvMx7D)\n\n>唯一的项目标识符（必填）\n>sonar.projectKey =tiny-config1\n>\n>项目元数据（以前是必需的，自SonarQube 6.1起是可选的）\n>sonar.projectName =tiny-config1\n>sonar.projectVersion = 1.0\n>\n>源目录的路径（必需）\n>sonar.sources = srcDir1，srcDir2\n>\n>测试源目录的路径（可选）\n>sonar.tests = testDir1，testDir2\n>\n>Java项目编译类的路径（可选）\n>sonar.java.binaries = bin\n>\n>逗号分隔的库路径列表（可选）\n>sonar.java.libraries = path / to / library.jar，path / to / classes / dir\n>\n>附加参数\n>sonar.my.property =value\n\n保存后就可以正常构建了．\n\n#### 错误解决（没有错误可跳过这段）\n如果在构建项目的时候,Jenkins控制台如果报一下错误，这是因为SonarQube的Java版本太低造成的\n![](http://cdn.mjava.top/FnTRL4pSwrKk5Xwbzobo89VKHf5m)\n\n##### 升级SonarQube的Java版本\n\n进入SonarQube的管理台： Administration->Marketplace->SonarJava\n\n> 如果你版本没升级，右边会有个update按钮，点击就可以升级了，升级完后重启SonarQube;这边因为我已经升级过了，所以没有这个按钮\n\n![](http://cdn.mjava.top/FgbCXvUiteJ9iGCCYC6qbInX0VSX)\n\n\n\n### 构建完成后\n\nJenkins控制台显示SUCCESS就表示构建成功了\n\n![](http://cdn.mjava.top/FoijfnBHiJAZ7lA7YqmdQb-bEqUF)\n\n这时候就可以点击构建项目的SonarQube直接跳转到SonarQube控制台了\n\n![](http://cdn.mjava.top/FhXgRD7rBp5RBc2D6uBmH5mIBNKJ)\n\n\n这里就可以看到结果了\n\n![](http://cdn.mjava.top/FkPydWtLuuliKAq1hc8Ex45nnTlu)\n\n\n## 总结\n\n到这里就可以根据SonarQube的提示区改BUG了．这BUG有点多＝＿＝！.\n\n在搭建过程中，最主要的就是那个SonarQube Scanner这个的安装了，因为Jenkins都是Docker化的，所以他可以选择自动安装，但是我这边选择自动安装却没用，所以就自己下载了SonarQube Scnner的包挂载到Jenkins容器里区，然后直接指定SonarQube Scnner的目录就可以了；","slug":"jenkins/build-jenkins-sonarqube","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bk6002x2mg5bfpglmf8","content":"<h2 id=\"什么是SonarQube\"><a href=\"#什么是SonarQube\" class=\"headerlink\" title=\"什么是SonarQube?\"></a>什么是SonarQube?</h2><p>看看维基百科的说明：<br><img src=\"http://cdn.mjava.top/Fi9bL7TAwFmCYPt3Cz_d0TIwm9rQ\" alt></p>\n<h3 id=\"SonarQube与CI-CD架构图\"><a href=\"#SonarQube与CI-CD架构图\" class=\"headerlink\" title=\"SonarQube与CI/CD架构图\"></a>SonarQube与CI/CD架构图</h3><p><img src=\"http://cdn.mjava.top/FpResgoc3tny2jvGqaqudPwCwstj\" alt=\"SonarQube与CI/CD架构图\"></p>\n<h2 id=\"Docker运行SonarQube\"><a href=\"#Docker运行SonarQube\" class=\"headerlink\" title=\"Docker运行SonarQube\"></a>Docker运行SonarQube</h2><p>简单了解之后，开始安装SonarQube.这里用Docker安装</p>\n<blockquote>\n<p>注：这里用mysql来存储SonarQube的数据，SonarQube7.9起已经不在支持mysql了，可以安装官方推荐的PostgreSQL</p>\n</blockquote>\n<ul>\n<li>SonarQube 6.7.7</li>\n<li>Docker-CE 19.03.1</li>\n<li>Mysql 5.7</li>\n</ul>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><p>直接运行这个docker命令来安装，网上其他的教程有什么挂载文件什么的，我试了都会安装失败，原因还是因为权限原因，因为SonarQube不是以root用户运行的，导致没权限读写挂载出来的文件夹．</p>\n<blockquote>\n<p>注意：创建容器前一定要先保证你连的容器有对应的数据库</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -d --name sonarqube -p 9099:9000 -p 9092:9092 --link=dev_mysql:mysql -e SONARQUBE_JDBC_USERNAME=app -e SONARQUBE_JDBC_PASSWORD=app -e SONARQUBE_JDBC_URL=\"jdbc:mysql://mysql:3306/sonar?useUnicode=true&amp;characterEncoding=utf8&amp;rewriteBatchedStatements=true&amp;useConfigs=maxPerformance&amp;useSSL=false\" --restart=always sonarqube:6.7.7-community</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>–link=dev_mysql:mysql     这个命令我链接到了我的mysql容器，dev_mysql是容器的名字，mysql是在SonarQube容器里的别名，所以链接数据库时直接用mysql这个别名就可了．</p>\n</li>\n<li><p>SONARQUBE_JDBC_USERNAME ：数据库的账户</p>\n</li>\n<li><p>SONARQUBE_JDBC_PASSWORD ：数据库密码</p>\n</li>\n</ul>\n<h3 id=\"访问\"><a href=\"#访问\" class=\"headerlink\" title=\"访问\"></a>访问</h3><p>安装好后直接访问<font color=\"orange\">9099</font>端口，登录的账户和密码默认都是<font color=\"orange\">admin</font>．首页就是这个样子的．</p>\n<p><img src=\"http://cdn.mjava.top/Fs08WpcVDcL3n32MxoCNPDMtu1r5\" alt></p>\n<h2 id=\"Jenkins集成SonarQube\"><a href=\"#Jenkins集成SonarQube\" class=\"headerlink\" title=\"Jenkins集成SonarQube\"></a>Jenkins集成SonarQube</h2><p>Jenkins和SonarQube都是运行在Docker容器里的</p>\n<h3 id=\"下载和安装插件\"><a href=\"#下载和安装插件\" class=\"headerlink\" title=\"下载和安装插件\"></a>下载和安装插件</h3><p>直接下载最新版的，然后导入，导入的方法可以看<a href=\"https://mjava.top/jenkins/problem-jenkins-01/\">插件导入方法</a></p>\n<ul>\n<li>插件下载地址：<a href=\"https://updates.jenkins.io/download/plugins/sonar/\" rel=\"noopener\" target=\"_blank\">https://updates.jenkins.io/download/plugins/sonar/</a></li>\n</ul>\n<h3 id=\"SonarQube生成Token\"><a href=\"#SonarQube生成Token\" class=\"headerlink\" title=\"SonarQube生成Token\"></a>SonarQube生成Token</h3><p>进入SonarQube管理界面</p>\n<p>Administration-&gt;Security-&gt;Users</p>\n<p><img src=\"http://cdn.mjava.top/FpFSYEgJfsJIwgNMA6tHHZtdAtpV\" alt></p>\n<p>然后随便输入一个名字，点击生成，记下Token</p>\n<p><img src=\"http://cdn.mjava.top/FhTOSglZYOrP5poo_mmR3SGoobsD\" alt></p>\n<h3 id=\"添加全局凭证\"><a href=\"#添加全局凭证\" class=\"headerlink\" title=\"添加全局凭证\"></a>添加全局凭证</h3><p>类型选Secret text,然后Secret和ID输入框都填入刚才生成的Token</p>\n<p><img src=\"http://cdn.mjava.top/FrKo5EjJ9-78uYbDjBpiuVkeu-_5\" alt></p>\n<h3 id=\"设置SonarQube-servers\"><a href=\"#设置SonarQube-servers\" class=\"headerlink\" title=\"设置SonarQube servers\"></a>设置SonarQube servers</h3><p>进入　系统管理-&gt;系统设置-&gt;SonarQube servers　　　　<font color=\"orange\">设置好后点保存</font></p>\n<blockquote>\n<p>因为我SonarQube和Jenkins安装在同一台机器不同的Docker容器里的,所以这里URL直接填SonarQube的Docker容器的IP和端口</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/FpevTpJePMDg9-HSoQoSOCNORHL8\" alt></p>\n<h3 id=\"安装SonarQube-Scanner\"><a href=\"#安装SonarQube-Scanner\" class=\"headerlink\" title=\"安装SonarQube Scanner\"></a>安装SonarQube Scanner</h3><h4 id=\"下载压缩包\"><a href=\"#下载压缩包\" class=\"headerlink\" title=\"下载压缩包\"></a>下载压缩包</h4><ul>\n<li>下载SonarQube Scanner压缩包：<a href=\"https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-4.2.0.1873-linux.zip\" rel=\"noopener\" target=\"_blank\">SonarQube Scanner</a></li>\n</ul>\n<h4 id=\"解压到Jenkins挂载出来的目录里\"><a href=\"#解压到Jenkins挂载出来的目录里\" class=\"headerlink\" title=\"解压到Jenkins挂载出来的目录里\"></a>解压到Jenkins挂载出来的目录里</h4><p>只有解压到挂载出来的Jenkins的目录里，Docker容器安装的Jenkins才能读取到,<font color=\"orange\"><strong>我这里是宿主机的/opt/jenkins挂载到了Jenkins容器里的/var/jenkins_home目录上，所以我只要解压到宿主机的/opt/jenkins目录中就可以了</strong></font></p>\n<h4 id=\"Jenkins配置全局工具\"><a href=\"#Jenkins配置全局工具\" class=\"headerlink\" title=\"Jenkins配置全局工具\"></a>Jenkins配置全局工具</h4><p>进入　系统管理-&gt;全局工具配置-&gt;SonarQube Scanner     找到模块后点击<font color=\"orange\">新增SonarQube Scanner</font></p>\n<p><font color=\"orange\">SONAR_RUNNER_HOME填你Jenkins这个Docker容器里的路径</font></p>\n<p><img src=\"http://cdn.mjava.top/Fpgv2yqskGjp37mfoxHC6MGtIAPt\" alt></p>\n<h2 id=\"构建一个Maven项目\"><a href=\"#构建一个Maven项目\" class=\"headerlink\" title=\"构建一个Maven项目\"></a>构建一个Maven项目</h2><p>网上很多教程说要勾上这个选项：</p>\n<p><img src=\"http://cdn.mjava.top/FsSrQCDF5O9x4sufLZkFRz40toHI\" alt><br>其实这个是可选的，下面有一句话：<font color=\"orange\">These variables are useful when configuring a SonarQube analysis using standard build steps such as Maven, Gradle, Ant, and command line scripts.This feature is not needed if you’re using “SonarQube Scanner” or “SonarScanner for MSBuild” build steps.</font></p>\n<p>翻译过来就是：<img src=\"http://cdn.mjava.top/FrM7HmTx_APStJMI0OHlMQO6WL3W\" alt><br>因为我们这里用的就是<font color=\"orange\">SonarQube Scanner</font>,所以这个我们是可以不用勾上的，但是勾上也没影响；</p>\n<h3 id=\"开始构建\"><a href=\"#开始构建\" class=\"headerlink\" title=\"开始构建\"></a>开始构建</h3><ul>\n<li>具体怎么构建项目可以看：<a href=\"https://mjava.top/jenkins/build-jenkins-mavne/\">Jenkins教程-创建Maven项目</a>,这里就不多介绍了</li>\n</ul>\n<h4 id=\"添加Execute-SonarQube-Scanner\"><a href=\"#添加Execute-SonarQube-Scanner\" class=\"headerlink\" title=\"添加Execute SonarQube Scanner\"></a>添加Execute SonarQube Scanner</h4><p>在原来构建的基础上加上<font color=\"orange\">Execute SonarQube Scanner</font>，就可以了</p>\n<p><img src=\"http://cdn.mjava.top/FgZ021lPaTWzgOPsG7veK1cn7lIB\" alt></p>\n<p>在<font color=\"orange\">Analysis properties</font>里填上构建的参数</p>\n<p><img src=\"http://cdn.mjava.top/FiFA65-xUZCh62Y5HfIgxQzvMx7D\" alt></p>\n<blockquote>\n<p>唯一的项目标识符（必填）<br>sonar.projectKey =tiny-config1</p>\n<p>项目元数据（以前是必需的，自SonarQube 6.1起是可选的）<br>sonar.projectName =tiny-config1<br>sonar.projectVersion = 1.0</p>\n<p>源目录的路径（必需）<br>sonar.sources = srcDir1，srcDir2</p>\n<p>测试源目录的路径（可选）<br>sonar.tests = testDir1，testDir2</p>\n<p>Java项目编译类的路径（可选）<br>sonar.java.binaries = bin</p>\n<p>逗号分隔的库路径列表（可选）<br>sonar.java.libraries = path / to / library.jar，path / to / classes / dir</p>\n<p>附加参数<br>sonar.my.property =value</p>\n</blockquote>\n<p>保存后就可以正常构建了．</p>\n<h4 id=\"错误解决（没有错误可跳过这段）\"><a href=\"#错误解决（没有错误可跳过这段）\" class=\"headerlink\" title=\"错误解决（没有错误可跳过这段）\"></a>错误解决（没有错误可跳过这段）</h4><p>如果在构建项目的时候,Jenkins控制台如果报一下错误，这是因为SonarQube的Java版本太低造成的<br><img src=\"http://cdn.mjava.top/FnTRL4pSwrKk5Xwbzobo89VKHf5m\" alt></p>\n<h5 id=\"升级SonarQube的Java版本\"><a href=\"#升级SonarQube的Java版本\" class=\"headerlink\" title=\"升级SonarQube的Java版本\"></a>升级SonarQube的Java版本</h5><p>进入SonarQube的管理台： Administration-&gt;Marketplace-&gt;SonarJava</p>\n<blockquote>\n<p>如果你版本没升级，右边会有个update按钮，点击就可以升级了，升级完后重启SonarQube;这边因为我已经升级过了，所以没有这个按钮</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/FgbCXvUiteJ9iGCCYC6qbInX0VSX\" alt></p>\n<h3 id=\"构建完成后\"><a href=\"#构建完成后\" class=\"headerlink\" title=\"构建完成后\"></a>构建完成后</h3><p>Jenkins控制台显示SUCCESS就表示构建成功了</p>\n<p><img src=\"http://cdn.mjava.top/FoijfnBHiJAZ7lA7YqmdQb-bEqUF\" alt></p>\n<p>这时候就可以点击构建项目的SonarQube直接跳转到SonarQube控制台了</p>\n<p><img src=\"http://cdn.mjava.top/FhXgRD7rBp5RBc2D6uBmH5mIBNKJ\" alt></p>\n<p>这里就可以看到结果了</p>\n<p><img src=\"http://cdn.mjava.top/FkPydWtLuuliKAq1hc8Ex45nnTlu\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>到这里就可以根据SonarQube的提示区改BUG了．这BUG有点多＝＿＝！.</p>\n<p>在搭建过程中，最主要的就是那个SonarQube Scanner这个的安装了，因为Jenkins都是Docker化的，所以他可以选择自动安装，但是我这边选择自动安装却没用，所以就自己下载了SonarQube Scnner的包挂载到Jenkins容器里区，然后直接指定SonarQube Scnner的目录就可以了；</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"什么是SonarQube\"><a href=\"#什么是SonarQube\" class=\"headerlink\" title=\"什么是SonarQube?\"></a>什么是SonarQube?</h2><p>看看维基百科的说明：<br><img src=\"http://cdn.mjava.top/Fi9bL7TAwFmCYPt3Cz_d0TIwm9rQ\" alt></p>\n<h3 id=\"SonarQube与CI-CD架构图\"><a href=\"#SonarQube与CI-CD架构图\" class=\"headerlink\" title=\"SonarQube与CI/CD架构图\"></a>SonarQube与CI/CD架构图</h3><p><img src=\"http://cdn.mjava.top/FpResgoc3tny2jvGqaqudPwCwstj\" alt=\"SonarQube与CI/CD架构图\"></p>\n<h2 id=\"Docker运行SonarQube\"><a href=\"#Docker运行SonarQube\" class=\"headerlink\" title=\"Docker运行SonarQube\"></a>Docker运行SonarQube</h2><p>简单了解之后，开始安装SonarQube.这里用Docker安装</p>\n<blockquote>\n<p>注：这里用mysql来存储SonarQube的数据，SonarQube7.9起已经不在支持mysql了，可以安装官方推荐的PostgreSQL</p>\n</blockquote>\n<ul>\n<li>SonarQube 6.7.7</li>\n<li>Docker-CE 19.03.1</li>\n<li>Mysql 5.7</li>\n</ul>\n<h3 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h3><p>直接运行这个docker命令来安装，网上其他的教程有什么挂载文件什么的，我试了都会安装失败，原因还是因为权限原因，因为SonarQube不是以root用户运行的，导致没权限读写挂载出来的文件夹．</p>\n<blockquote>\n<p>注意：创建容器前一定要先保证你连的容器有对应的数据库</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -d --name sonarqube -p 9099:9000 -p 9092:9092 --link=dev_mysql:mysql -e SONARQUBE_JDBC_USERNAME=app -e SONARQUBE_JDBC_PASSWORD=app -e SONARQUBE_JDBC_URL=\"jdbc:mysql://mysql:3306/sonar?useUnicode=true&amp;characterEncoding=utf8&amp;rewriteBatchedStatements=true&amp;useConfigs=maxPerformance&amp;useSSL=false\" --restart=always sonarqube:6.7.7-community</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>–link=dev_mysql:mysql     这个命令我链接到了我的mysql容器，dev_mysql是容器的名字，mysql是在SonarQube容器里的别名，所以链接数据库时直接用mysql这个别名就可了．</p>\n</li>\n<li><p>SONARQUBE_JDBC_USERNAME ：数据库的账户</p>\n</li>\n<li><p>SONARQUBE_JDBC_PASSWORD ：数据库密码</p>\n</li>\n</ul>\n<h3 id=\"访问\"><a href=\"#访问\" class=\"headerlink\" title=\"访问\"></a>访问</h3><p>安装好后直接访问<font color=\"orange\">9099</font>端口，登录的账户和密码默认都是<font color=\"orange\">admin</font>．首页就是这个样子的．</p>\n<p><img src=\"http://cdn.mjava.top/Fs08WpcVDcL3n32MxoCNPDMtu1r5\" alt></p>\n<h2 id=\"Jenkins集成SonarQube\"><a href=\"#Jenkins集成SonarQube\" class=\"headerlink\" title=\"Jenkins集成SonarQube\"></a>Jenkins集成SonarQube</h2><p>Jenkins和SonarQube都是运行在Docker容器里的</p>\n<h3 id=\"下载和安装插件\"><a href=\"#下载和安装插件\" class=\"headerlink\" title=\"下载和安装插件\"></a>下载和安装插件</h3><p>直接下载最新版的，然后导入，导入的方法可以看<a href=\"https://mjava.top/jenkins/problem-jenkins-01/\">插件导入方法</a></p>\n<ul>\n<li>插件下载地址：<a href=\"https://updates.jenkins.io/download/plugins/sonar/\" rel=\"noopener\" target=\"_blank\">https://updates.jenkins.io/download/plugins/sonar/</a></li>\n</ul>\n<h3 id=\"SonarQube生成Token\"><a href=\"#SonarQube生成Token\" class=\"headerlink\" title=\"SonarQube生成Token\"></a>SonarQube生成Token</h3><p>进入SonarQube管理界面</p>\n<p>Administration-&gt;Security-&gt;Users</p>\n<p><img src=\"http://cdn.mjava.top/FpFSYEgJfsJIwgNMA6tHHZtdAtpV\" alt></p>\n<p>然后随便输入一个名字，点击生成，记下Token</p>\n<p><img src=\"http://cdn.mjava.top/FhTOSglZYOrP5poo_mmR3SGoobsD\" alt></p>\n<h3 id=\"添加全局凭证\"><a href=\"#添加全局凭证\" class=\"headerlink\" title=\"添加全局凭证\"></a>添加全局凭证</h3><p>类型选Secret text,然后Secret和ID输入框都填入刚才生成的Token</p>\n<p><img src=\"http://cdn.mjava.top/FrKo5EjJ9-78uYbDjBpiuVkeu-_5\" alt></p>\n<h3 id=\"设置SonarQube-servers\"><a href=\"#设置SonarQube-servers\" class=\"headerlink\" title=\"设置SonarQube servers\"></a>设置SonarQube servers</h3><p>进入　系统管理-&gt;系统设置-&gt;SonarQube servers　　　　<font color=\"orange\">设置好后点保存</font></p>\n<blockquote>\n<p>因为我SonarQube和Jenkins安装在同一台机器不同的Docker容器里的,所以这里URL直接填SonarQube的Docker容器的IP和端口</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/FpevTpJePMDg9-HSoQoSOCNORHL8\" alt></p>\n<h3 id=\"安装SonarQube-Scanner\"><a href=\"#安装SonarQube-Scanner\" class=\"headerlink\" title=\"安装SonarQube Scanner\"></a>安装SonarQube Scanner</h3><h4 id=\"下载压缩包\"><a href=\"#下载压缩包\" class=\"headerlink\" title=\"下载压缩包\"></a>下载压缩包</h4><ul>\n<li>下载SonarQube Scanner压缩包：<a href=\"https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/sonar-scanner-cli-4.2.0.1873-linux.zip\" rel=\"noopener\" target=\"_blank\">SonarQube Scanner</a></li>\n</ul>\n<h4 id=\"解压到Jenkins挂载出来的目录里\"><a href=\"#解压到Jenkins挂载出来的目录里\" class=\"headerlink\" title=\"解压到Jenkins挂载出来的目录里\"></a>解压到Jenkins挂载出来的目录里</h4><p>只有解压到挂载出来的Jenkins的目录里，Docker容器安装的Jenkins才能读取到,<font color=\"orange\"><strong>我这里是宿主机的/opt/jenkins挂载到了Jenkins容器里的/var/jenkins_home目录上，所以我只要解压到宿主机的/opt/jenkins目录中就可以了</strong></font></p>\n<h4 id=\"Jenkins配置全局工具\"><a href=\"#Jenkins配置全局工具\" class=\"headerlink\" title=\"Jenkins配置全局工具\"></a>Jenkins配置全局工具</h4><p>进入　系统管理-&gt;全局工具配置-&gt;SonarQube Scanner     找到模块后点击<font color=\"orange\">新增SonarQube Scanner</font></p>\n<p><font color=\"orange\">SONAR_RUNNER_HOME填你Jenkins这个Docker容器里的路径</font></p>\n<p><img src=\"http://cdn.mjava.top/Fpgv2yqskGjp37mfoxHC6MGtIAPt\" alt></p>\n<h2 id=\"构建一个Maven项目\"><a href=\"#构建一个Maven项目\" class=\"headerlink\" title=\"构建一个Maven项目\"></a>构建一个Maven项目</h2><p>网上很多教程说要勾上这个选项：</p>\n<p><img src=\"http://cdn.mjava.top/FsSrQCDF5O9x4sufLZkFRz40toHI\" alt><br>其实这个是可选的，下面有一句话：<font color=\"orange\">These variables are useful when configuring a SonarQube analysis using standard build steps such as Maven, Gradle, Ant, and command line scripts.This feature is not needed if you’re using “SonarQube Scanner” or “SonarScanner for MSBuild” build steps.</font></p>\n<p>翻译过来就是：<img src=\"http://cdn.mjava.top/FrM7HmTx_APStJMI0OHlMQO6WL3W\" alt><br>因为我们这里用的就是<font color=\"orange\">SonarQube Scanner</font>,所以这个我们是可以不用勾上的，但是勾上也没影响；</p>\n<h3 id=\"开始构建\"><a href=\"#开始构建\" class=\"headerlink\" title=\"开始构建\"></a>开始构建</h3><ul>\n<li>具体怎么构建项目可以看：<a href=\"https://mjava.top/jenkins/build-jenkins-mavne/\">Jenkins教程-创建Maven项目</a>,这里就不多介绍了</li>\n</ul>\n<h4 id=\"添加Execute-SonarQube-Scanner\"><a href=\"#添加Execute-SonarQube-Scanner\" class=\"headerlink\" title=\"添加Execute SonarQube Scanner\"></a>添加Execute SonarQube Scanner</h4><p>在原来构建的基础上加上<font color=\"orange\">Execute SonarQube Scanner</font>，就可以了</p>\n<p><img src=\"http://cdn.mjava.top/FgZ021lPaTWzgOPsG7veK1cn7lIB\" alt></p>\n<p>在<font color=\"orange\">Analysis properties</font>里填上构建的参数</p>\n<p><img src=\"http://cdn.mjava.top/FiFA65-xUZCh62Y5HfIgxQzvMx7D\" alt></p>\n<blockquote>\n<p>唯一的项目标识符（必填）<br>sonar.projectKey =tiny-config1</p>\n<p>项目元数据（以前是必需的，自SonarQube 6.1起是可选的）<br>sonar.projectName =tiny-config1<br>sonar.projectVersion = 1.0</p>\n<p>源目录的路径（必需）<br>sonar.sources = srcDir1，srcDir2</p>\n<p>测试源目录的路径（可选）<br>sonar.tests = testDir1，testDir2</p>\n<p>Java项目编译类的路径（可选）<br>sonar.java.binaries = bin</p>\n<p>逗号分隔的库路径列表（可选）<br>sonar.java.libraries = path / to / library.jar，path / to / classes / dir</p>\n<p>附加参数<br>sonar.my.property =value</p>\n</blockquote>\n<p>保存后就可以正常构建了．</p>\n<h4 id=\"错误解决（没有错误可跳过这段）\"><a href=\"#错误解决（没有错误可跳过这段）\" class=\"headerlink\" title=\"错误解决（没有错误可跳过这段）\"></a>错误解决（没有错误可跳过这段）</h4><p>如果在构建项目的时候,Jenkins控制台如果报一下错误，这是因为SonarQube的Java版本太低造成的<br><img src=\"http://cdn.mjava.top/FnTRL4pSwrKk5Xwbzobo89VKHf5m\" alt></p>\n<h5 id=\"升级SonarQube的Java版本\"><a href=\"#升级SonarQube的Java版本\" class=\"headerlink\" title=\"升级SonarQube的Java版本\"></a>升级SonarQube的Java版本</h5><p>进入SonarQube的管理台： Administration-&gt;Marketplace-&gt;SonarJava</p>\n<blockquote>\n<p>如果你版本没升级，右边会有个update按钮，点击就可以升级了，升级完后重启SonarQube;这边因为我已经升级过了，所以没有这个按钮</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/FgbCXvUiteJ9iGCCYC6qbInX0VSX\" alt></p>\n<h3 id=\"构建完成后\"><a href=\"#构建完成后\" class=\"headerlink\" title=\"构建完成后\"></a>构建完成后</h3><p>Jenkins控制台显示SUCCESS就表示构建成功了</p>\n<p><img src=\"http://cdn.mjava.top/FoijfnBHiJAZ7lA7YqmdQb-bEqUF\" alt></p>\n<p>这时候就可以点击构建项目的SonarQube直接跳转到SonarQube控制台了</p>\n<p><img src=\"http://cdn.mjava.top/FhXgRD7rBp5RBc2D6uBmH5mIBNKJ\" alt></p>\n<p>这里就可以看到结果了</p>\n<p><img src=\"http://cdn.mjava.top/FkPydWtLuuliKAq1hc8Ex45nnTlu\" alt></p>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>到这里就可以根据SonarQube的提示区改BUG了．这BUG有点多＝＿＝！.</p>\n<p>在搭建过程中，最主要的就是那个SonarQube Scanner这个的安装了，因为Jenkins都是Docker化的，所以他可以选择自动安装，但是我这边选择自动安装却没用，所以就自己下载了SonarQube Scnner的包挂载到Jenkins容器里区，然后直接指定SonarQube Scnner的目录就可以了；</p>\n"},{"title":"使用GitHub Actions编译树莓派内核","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-01-26T07:56:07.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 仓库地址\n\n仓库地址：https://github.com/GreyCode9/make-raspberrypi-kernel\n\n## 创建秘钥\n\n1. 点击Github右上角头像 -> Settings -> Developer settings -> Personal access tokens -> Generate new token\n\n<!-- more -->\n\n1. 或者直接点这个链接进入： https://github.com/settings/tokens\n\n   ![20210126150521](http://cdn.mjava.top/20210126150521.png)\n\n![20210126150712](http://cdn.mjava.top/20210126150712.png)\n\n<font color=red>创建后保存这个秘钥(秘钥只显示一次)</font>\n\n## 创建仓库\n\n创建仓库**[make-raspberrypi-kernel](https://github.com/GreyCode9/make-raspberrypi-kernel)**\n\n然后点击仓库的Settings -> Secrets ->New repository secret\n\n**然后填入刚才生成的秘钥**\n\n![20210126151157](http://cdn.mjava.top/20210126151157.png)\n\n\n\n## 创建Actions\n\n接着点击**Actions** ,创建一个Actions，然后填入如下内容\n\n``` yaml\nname: Make RaspberryPi Kernel\n\non:\n  push:\n    tags: \n      - 'v*' # 当推送的Tag为v开头的，就会触发构建\n\nenv:\n  USE_SSH_CONFIG: true # 是否使用ssh连接进行 true:使用 false:不使用\n\njobs:\n  build:\n\n    runs-on: ubuntu-18.04\n\n    steps:\n      - uses: actions/checkout@v2\n      - name: pull RaspberryPi Kernel linux\n        run: |\n          cd ../\n          git clone https://github.com/raspberrypi/linux.git\n      - name: pull RaspberryPi Kernel Tool\n        run: |\n          cd ../\n          git clone https://github.com/raspberrypi/tools.git\n      - name: Move .config\n        if: env.USE_SSH_CONFIG == 'false'\n        run: |\n          cp .config ../linux\n      - name: Setup Debug Session # 用SSH连接Actions\n        if: env.USE_SSH_CONFIG == 'true'\n        uses: csexton/debugger-action@master\n      - name: Make\n        run: |\n          cd ../\n          export WORKPATH=$(pwd)\n          export PATH=$PATH:$WORKPATH/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin\n          export PATH=$PATH:$WORKPATH/tools/arm-bcm2708/arm-bcm2708-linux-gnueabi/bin\n          cd linux/\n          make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage modules dtbs -j8\n      - name: Create Release\n        id: create_release\n        uses: actions/create-release@master\n        env:\n          GITHUB_TOKEN: ${{ secrets.TOKEN }} # 之前GitHub添加的Token\n        with:\n          tag_name: ${{ github.ref }} # (tag)标签名称\n          release_name: Release ${{ github.ref }}\n          draft: false # 是否是草稿\n          prerelease: false # 是否是预发布\n      # 上传构建结果到 Release（把打包的tgz上传到Release）\n      - name: build TAR PACKAGE\n        run: |\n          tar -czvf raspberrypi-kernel.tar.gz ../linux/arch/arm/boot\n      - name: Upload Release Asset\n        id: upload-release-asset\n        uses: actions/upload-release-asset@master\n        env:\n          GITHUB_TOKEN: ${{ secrets.TOKEN }}\n        with:\n          upload_url: ${{ steps.create_release.outputs.upload_url }} # 上传地址，通过创建Release获取到的\n          asset_path: ./raspberrypi-kernel.tar.gz # 要上传文件\n          asset_name: raspberrypi-kernel.tar.gz # 上传后的文件名\n          asset_content_type: application/gzip\n\n\n```\n\n- 可以在本地配置好`.config`文件然后上传到仓库，然后把Actions的配置文件中的`USE_SSH_CONFIG`字段改成`false`。\n- 也可以直接在`Actions`中进行配置`.config`文件，需要把`USE_SSH_CONFIG`字段改成`true`。\n\n## 触发构建\n\n当上面完成后，就可以把代码pull到本地，然后根据自己的需求配置`.config`文件。执行命令\n\n```shell\ngit tag -a v1.0 -m 'build kernel'\ngit push origin v1.0\n```\n\n推送完成后，就可以看到Actions正在构建了\n\n![20210126152258](http://cdn.mjava.top/20210126152258.png)\n\n构建完成后，就可以在`Release`下载构建好的内核文件了\n\n![20210126152413](http://cdn.mjava.top/20210126152413.png)\n\n![20210126152413](http://cdn.mjava.top/20210126152428.png)\n\n## 资料索引\n\n- https://www.cnblogs.com/YAN-HUA/p/13530906.html\n- http://doc.openluat.com/article/166/0\n- https://www.daimajiaoliu.com/daima/4793af6f2900402","source":"_posts/linux/github-actions-build-pi-kernerl.md","raw":"---\ntitle: 使用GitHub Actions编译树莓派内核\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-01-26 15:56:07\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Github Actions\n- Linux\ncategories:\n- Linux\n---\n\n## 仓库地址\n\n仓库地址：https://github.com/GreyCode9/make-raspberrypi-kernel\n\n## 创建秘钥\n\n1. 点击Github右上角头像 -> Settings -> Developer settings -> Personal access tokens -> Generate new token\n\n<!-- more -->\n\n1. 或者直接点这个链接进入： https://github.com/settings/tokens\n\n   ![20210126150521](http://cdn.mjava.top/20210126150521.png)\n\n![20210126150712](http://cdn.mjava.top/20210126150712.png)\n\n<font color=red>创建后保存这个秘钥(秘钥只显示一次)</font>\n\n## 创建仓库\n\n创建仓库**[make-raspberrypi-kernel](https://github.com/GreyCode9/make-raspberrypi-kernel)**\n\n然后点击仓库的Settings -> Secrets ->New repository secret\n\n**然后填入刚才生成的秘钥**\n\n![20210126151157](http://cdn.mjava.top/20210126151157.png)\n\n\n\n## 创建Actions\n\n接着点击**Actions** ,创建一个Actions，然后填入如下内容\n\n``` yaml\nname: Make RaspberryPi Kernel\n\non:\n  push:\n    tags: \n      - 'v*' # 当推送的Tag为v开头的，就会触发构建\n\nenv:\n  USE_SSH_CONFIG: true # 是否使用ssh连接进行 true:使用 false:不使用\n\njobs:\n  build:\n\n    runs-on: ubuntu-18.04\n\n    steps:\n      - uses: actions/checkout@v2\n      - name: pull RaspberryPi Kernel linux\n        run: |\n          cd ../\n          git clone https://github.com/raspberrypi/linux.git\n      - name: pull RaspberryPi Kernel Tool\n        run: |\n          cd ../\n          git clone https://github.com/raspberrypi/tools.git\n      - name: Move .config\n        if: env.USE_SSH_CONFIG == 'false'\n        run: |\n          cp .config ../linux\n      - name: Setup Debug Session # 用SSH连接Actions\n        if: env.USE_SSH_CONFIG == 'true'\n        uses: csexton/debugger-action@master\n      - name: Make\n        run: |\n          cd ../\n          export WORKPATH=$(pwd)\n          export PATH=$PATH:$WORKPATH/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin\n          export PATH=$PATH:$WORKPATH/tools/arm-bcm2708/arm-bcm2708-linux-gnueabi/bin\n          cd linux/\n          make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage modules dtbs -j8\n      - name: Create Release\n        id: create_release\n        uses: actions/create-release@master\n        env:\n          GITHUB_TOKEN: ${{ secrets.TOKEN }} # 之前GitHub添加的Token\n        with:\n          tag_name: ${{ github.ref }} # (tag)标签名称\n          release_name: Release ${{ github.ref }}\n          draft: false # 是否是草稿\n          prerelease: false # 是否是预发布\n      # 上传构建结果到 Release（把打包的tgz上传到Release）\n      - name: build TAR PACKAGE\n        run: |\n          tar -czvf raspberrypi-kernel.tar.gz ../linux/arch/arm/boot\n      - name: Upload Release Asset\n        id: upload-release-asset\n        uses: actions/upload-release-asset@master\n        env:\n          GITHUB_TOKEN: ${{ secrets.TOKEN }}\n        with:\n          upload_url: ${{ steps.create_release.outputs.upload_url }} # 上传地址，通过创建Release获取到的\n          asset_path: ./raspberrypi-kernel.tar.gz # 要上传文件\n          asset_name: raspberrypi-kernel.tar.gz # 上传后的文件名\n          asset_content_type: application/gzip\n\n\n```\n\n- 可以在本地配置好`.config`文件然后上传到仓库，然后把Actions的配置文件中的`USE_SSH_CONFIG`字段改成`false`。\n- 也可以直接在`Actions`中进行配置`.config`文件，需要把`USE_SSH_CONFIG`字段改成`true`。\n\n## 触发构建\n\n当上面完成后，就可以把代码pull到本地，然后根据自己的需求配置`.config`文件。执行命令\n\n```shell\ngit tag -a v1.0 -m 'build kernel'\ngit push origin v1.0\n```\n\n推送完成后，就可以看到Actions正在构建了\n\n![20210126152258](http://cdn.mjava.top/20210126152258.png)\n\n构建完成后，就可以在`Release`下载构建好的内核文件了\n\n![20210126152413](http://cdn.mjava.top/20210126152413.png)\n\n![20210126152413](http://cdn.mjava.top/20210126152428.png)\n\n## 资料索引\n\n- https://www.cnblogs.com/YAN-HUA/p/13530906.html\n- http://doc.openluat.com/article/166/0\n- https://www.daimajiaoliu.com/daima/4793af6f2900402","slug":"linux/github-actions-build-pi-kernerl","published":1,"updated":"2021-01-27T07:53:35.918Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bk700302mg51fec42wx","content":"<h2 id=\"仓库地址\"><a href=\"#仓库地址\" class=\"headerlink\" title=\"仓库地址\"></a>仓库地址</h2><p>仓库地址：<a href=\"https://github.com/GreyCode9/make-raspberrypi-kernel\" rel=\"noopener\" target=\"_blank\">https://github.com/GreyCode9/make-raspberrypi-kernel</a></p>\n<h2 id=\"创建秘钥\"><a href=\"#创建秘钥\" class=\"headerlink\" title=\"创建秘钥\"></a>创建秘钥</h2><ol>\n<li>点击Github右上角头像 -&gt; Settings -&gt; Developer settings -&gt; Personal access tokens -&gt; Generate new token</li>\n</ol>\n<a id=\"more\"></a>\n\n<ol>\n<li><p>或者直接点这个链接进入： <a href=\"https://github.com/settings/tokens\" rel=\"noopener\" target=\"_blank\">https://github.com/settings/tokens</a></p>\n<p><img src=\"http://cdn.mjava.top/20210126150521.png\" alt=\"20210126150521\"></p>\n</li>\n</ol>\n<p><img src=\"http://cdn.mjava.top/20210126150712.png\" alt=\"20210126150712\"></p>\n<p><font color=\"red\">创建后保存这个秘钥(秘钥只显示一次)</font></p>\n<h2 id=\"创建仓库\"><a href=\"#创建仓库\" class=\"headerlink\" title=\"创建仓库\"></a>创建仓库</h2><p>创建仓库<strong><a href=\"https://github.com/GreyCode9/make-raspberrypi-kernel\" rel=\"noopener\" target=\"_blank\">make-raspberrypi-kernel</a></strong></p>\n<p>然后点击仓库的Settings -&gt; Secrets -&gt;New repository secret</p>\n<p><strong>然后填入刚才生成的秘钥</strong></p>\n<p><img src=\"http://cdn.mjava.top/20210126151157.png\" alt=\"20210126151157\"></p>\n<h2 id=\"创建Actions\"><a href=\"#创建Actions\" class=\"headerlink\" title=\"创建Actions\"></a>创建Actions</h2><p>接着点击<strong>Actions</strong> ,创建一个Actions，然后填入如下内容</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Make</span> <span class=\"string\">RaspberryPi</span> <span class=\"string\">Kernel</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span></span><br><span class=\"line\"><span class=\"attr\">  push:</span></span><br><span class=\"line\"><span class=\"attr\">    tags:</span> </span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">'v*'</span> <span class=\"comment\"># 当推送的Tag为v开头的，就会触发构建</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">env:</span></span><br><span class=\"line\"><span class=\"attr\">  USE_SSH_CONFIG:</span> <span class=\"literal\">true</span> <span class=\"comment\"># 是否使用ssh连接进行 true:使用 false:不使用</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\"><span class=\"attr\">  build:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">    runs-on:</span> <span class=\"string\">ubuntu-18.04</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">    steps:</span></span><br><span class=\"line\"><span class=\"attr\">      - uses:</span> <span class=\"string\">actions/checkout@v2</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">pull</span> <span class=\"string\">RaspberryPi</span> <span class=\"string\">Kernel</span> <span class=\"string\">linux</span></span><br><span class=\"line\"><span class=\"attr\">        run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          cd ../</span></span><br><span class=\"line\"><span class=\"string\">          git clone https://github.com/raspberrypi/linux.git</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">      - name:</span> <span class=\"string\">pull</span> <span class=\"string\">RaspberryPi</span> <span class=\"string\">Kernel</span> <span class=\"string\">Tool</span></span><br><span class=\"line\"><span class=\"attr\">        run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          cd ../</span></span><br><span class=\"line\"><span class=\"string\">          git clone https://github.com/raspberrypi/tools.git</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">      - name:</span> <span class=\"string\">Move</span> <span class=\"string\">.config</span></span><br><span class=\"line\"><span class=\"attr\">        if:</span> <span class=\"string\">env.USE_SSH_CONFIG</span> <span class=\"string\">==</span> <span class=\"string\">'false'</span></span><br><span class=\"line\"><span class=\"attr\">        run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          cp .config ../linux</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">      - name:</span> <span class=\"string\">Setup</span> <span class=\"string\">Debug</span> <span class=\"string\">Session</span> <span class=\"comment\"># 用SSH连接Actions</span></span><br><span class=\"line\"><span class=\"attr\">        if:</span> <span class=\"string\">env.USE_SSH_CONFIG</span> <span class=\"string\">==</span> <span class=\"string\">'true'</span></span><br><span class=\"line\"><span class=\"attr\">        uses:</span> <span class=\"string\">csexton/debugger-action@master</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">Make</span></span><br><span class=\"line\"><span class=\"attr\">        run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          cd ../</span></span><br><span class=\"line\"><span class=\"string\">          export WORKPATH=$(pwd)</span></span><br><span class=\"line\"><span class=\"string\">          export PATH=$PATH:$WORKPATH/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin</span></span><br><span class=\"line\"><span class=\"string\">          export PATH=$PATH:$WORKPATH/tools/arm-bcm2708/arm-bcm2708-linux-gnueabi/bin</span></span><br><span class=\"line\"><span class=\"string\">          cd linux/</span></span><br><span class=\"line\"><span class=\"string\">          make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage modules dtbs -j8</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">      - name:</span> <span class=\"string\">Create</span> <span class=\"string\">Release</span></span><br><span class=\"line\"><span class=\"attr\">        id:</span> <span class=\"string\">create_release</span></span><br><span class=\"line\"><span class=\"attr\">        uses:</span> <span class=\"string\">actions/create-release@master</span></span><br><span class=\"line\"><span class=\"attr\">        env:</span></span><br><span class=\"line\"><span class=\"attr\">          GITHUB_TOKEN:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.TOKEN</span> <span class=\"string\">&#125;&#125;</span> <span class=\"comment\"># 之前GitHub添加的Token</span></span><br><span class=\"line\"><span class=\"attr\">        with:</span></span><br><span class=\"line\"><span class=\"attr\">          tag_name:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">github.ref</span> <span class=\"string\">&#125;&#125;</span> <span class=\"comment\"># (tag)标签名称</span></span><br><span class=\"line\"><span class=\"attr\">          release_name:</span> <span class=\"string\">Release</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">github.ref</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\"><span class=\"attr\">          draft:</span> <span class=\"literal\">false</span> <span class=\"comment\"># 是否是草稿</span></span><br><span class=\"line\"><span class=\"attr\">          prerelease:</span> <span class=\"literal\">false</span> <span class=\"comment\"># 是否是预发布</span></span><br><span class=\"line\">      <span class=\"comment\"># 上传构建结果到 Release（把打包的tgz上传到Release）</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">build</span> <span class=\"string\">TAR</span> <span class=\"string\">PACKAGE</span></span><br><span class=\"line\"><span class=\"attr\">        run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          tar -czvf raspberrypi-kernel.tar.gz ../linux/arch/arm/boot</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">      - name:</span> <span class=\"string\">Upload</span> <span class=\"string\">Release</span> <span class=\"string\">Asset</span></span><br><span class=\"line\"><span class=\"attr\">        id:</span> <span class=\"string\">upload-release-asset</span></span><br><span class=\"line\"><span class=\"attr\">        uses:</span> <span class=\"string\">actions/upload-release-asset@master</span></span><br><span class=\"line\"><span class=\"attr\">        env:</span></span><br><span class=\"line\"><span class=\"attr\">          GITHUB_TOKEN:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.TOKEN</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\"><span class=\"attr\">        with:</span></span><br><span class=\"line\"><span class=\"attr\">          upload_url:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">steps.create_release.outputs.upload_url</span> <span class=\"string\">&#125;&#125;</span> <span class=\"comment\"># 上传地址，通过创建Release获取到的</span></span><br><span class=\"line\"><span class=\"attr\">          asset_path:</span> <span class=\"string\">./raspberrypi-kernel.tar.gz</span> <span class=\"comment\"># 要上传文件</span></span><br><span class=\"line\"><span class=\"attr\">          asset_name:</span> <span class=\"string\">raspberrypi-kernel.tar.gz</span> <span class=\"comment\"># 上传后的文件名</span></span><br><span class=\"line\"><span class=\"attr\">          asset_content_type:</span> <span class=\"string\">application/gzip</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>可以在本地配置好<code>.config</code>文件然后上传到仓库，然后把Actions的配置文件中的<code>USE_SSH_CONFIG</code>字段改成<code>false</code>。</li>\n<li>也可以直接在<code>Actions</code>中进行配置<code>.config</code>文件，需要把<code>USE_SSH_CONFIG</code>字段改成<code>true</code>。</li>\n</ul>\n<h2 id=\"触发构建\"><a href=\"#触发构建\" class=\"headerlink\" title=\"触发构建\"></a>触发构建</h2><p>当上面完成后，就可以把代码pull到本地，然后根据自己的需求配置<code>.config</code>文件。执行命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git tag -a v1.0 -m 'build kernel'</span><br><span class=\"line\">git push origin v1.0</span><br></pre></td></tr></table></figure>\n\n<p>推送完成后，就可以看到Actions正在构建了</p>\n<p><img src=\"http://cdn.mjava.top/20210126152258.png\" alt=\"20210126152258\"></p>\n<p>构建完成后，就可以在<code>Release</code>下载构建好的内核文件了</p>\n<p><img src=\"http://cdn.mjava.top/20210126152413.png\" alt=\"20210126152413\"></p>\n<p><img src=\"http://cdn.mjava.top/20210126152428.png\" alt=\"20210126152413\"></p>\n<h2 id=\"资料索引\"><a href=\"#资料索引\" class=\"headerlink\" title=\"资料索引\"></a>资料索引</h2><ul>\n<li><a href=\"https://www.cnblogs.com/YAN-HUA/p/13530906.html\" rel=\"noopener\" target=\"_blank\">https://www.cnblogs.com/YAN-HUA/p/13530906.html</a></li>\n<li><a href=\"http://doc.openluat.com/article/166/0\" rel=\"noopener\" target=\"_blank\">http://doc.openluat.com/article/166/0</a></li>\n<li><a href=\"https://www.daimajiaoliu.com/daima/4793af6f2900402\" rel=\"noopener\" target=\"_blank\">https://www.daimajiaoliu.com/daima/4793af6f2900402</a></li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"<h2 id=\"仓库地址\"><a href=\"#仓库地址\" class=\"headerlink\" title=\"仓库地址\"></a>仓库地址</h2><p>仓库地址：<a href=\"https://github.com/GreyCode9/make-raspberrypi-kernel\" rel=\"noopener\" target=\"_blank\">https://github.com/GreyCode9/make-raspberrypi-kernel</a></p>\n<h2 id=\"创建秘钥\"><a href=\"#创建秘钥\" class=\"headerlink\" title=\"创建秘钥\"></a>创建秘钥</h2><ol>\n<li>点击Github右上角头像 -&gt; Settings -&gt; Developer settings -&gt; Personal access tokens -&gt; Generate new token</li>\n</ol>","more":"<ol>\n<li><p>或者直接点这个链接进入： <a href=\"https://github.com/settings/tokens\" rel=\"noopener\" target=\"_blank\">https://github.com/settings/tokens</a></p>\n<p><img src=\"http://cdn.mjava.top/20210126150521.png\" alt=\"20210126150521\"></p>\n</li>\n</ol>\n<p><img src=\"http://cdn.mjava.top/20210126150712.png\" alt=\"20210126150712\"></p>\n<p><font color=\"red\">创建后保存这个秘钥(秘钥只显示一次)</font></p>\n<h2 id=\"创建仓库\"><a href=\"#创建仓库\" class=\"headerlink\" title=\"创建仓库\"></a>创建仓库</h2><p>创建仓库<strong><a href=\"https://github.com/GreyCode9/make-raspberrypi-kernel\" rel=\"noopener\" target=\"_blank\">make-raspberrypi-kernel</a></strong></p>\n<p>然后点击仓库的Settings -&gt; Secrets -&gt;New repository secret</p>\n<p><strong>然后填入刚才生成的秘钥</strong></p>\n<p><img src=\"http://cdn.mjava.top/20210126151157.png\" alt=\"20210126151157\"></p>\n<h2 id=\"创建Actions\"><a href=\"#创建Actions\" class=\"headerlink\" title=\"创建Actions\"></a>创建Actions</h2><p>接着点击<strong>Actions</strong> ,创建一个Actions，然后填入如下内容</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">name:</span> <span class=\"string\">Make</span> <span class=\"string\">RaspberryPi</span> <span class=\"string\">Kernel</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">on:</span></span><br><span class=\"line\"><span class=\"attr\">  push:</span></span><br><span class=\"line\"><span class=\"attr\">    tags:</span> </span><br><span class=\"line\"><span class=\"bullet\">      -</span> <span class=\"string\">'v*'</span> <span class=\"comment\"># 当推送的Tag为v开头的，就会触发构建</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">env:</span></span><br><span class=\"line\"><span class=\"attr\">  USE_SSH_CONFIG:</span> <span class=\"literal\">true</span> <span class=\"comment\"># 是否使用ssh连接进行 true:使用 false:不使用</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">jobs:</span></span><br><span class=\"line\"><span class=\"attr\">  build:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">    runs-on:</span> <span class=\"string\">ubuntu-18.04</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">    steps:</span></span><br><span class=\"line\"><span class=\"attr\">      - uses:</span> <span class=\"string\">actions/checkout@v2</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">pull</span> <span class=\"string\">RaspberryPi</span> <span class=\"string\">Kernel</span> <span class=\"string\">linux</span></span><br><span class=\"line\"><span class=\"attr\">        run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          cd ../</span></span><br><span class=\"line\"><span class=\"string\">          git clone https://github.com/raspberrypi/linux.git</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">      - name:</span> <span class=\"string\">pull</span> <span class=\"string\">RaspberryPi</span> <span class=\"string\">Kernel</span> <span class=\"string\">Tool</span></span><br><span class=\"line\"><span class=\"attr\">        run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          cd ../</span></span><br><span class=\"line\"><span class=\"string\">          git clone https://github.com/raspberrypi/tools.git</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">      - name:</span> <span class=\"string\">Move</span> <span class=\"string\">.config</span></span><br><span class=\"line\"><span class=\"attr\">        if:</span> <span class=\"string\">env.USE_SSH_CONFIG</span> <span class=\"string\">==</span> <span class=\"string\">'false'</span></span><br><span class=\"line\"><span class=\"attr\">        run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          cp .config ../linux</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">      - name:</span> <span class=\"string\">Setup</span> <span class=\"string\">Debug</span> <span class=\"string\">Session</span> <span class=\"comment\"># 用SSH连接Actions</span></span><br><span class=\"line\"><span class=\"attr\">        if:</span> <span class=\"string\">env.USE_SSH_CONFIG</span> <span class=\"string\">==</span> <span class=\"string\">'true'</span></span><br><span class=\"line\"><span class=\"attr\">        uses:</span> <span class=\"string\">csexton/debugger-action@master</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">Make</span></span><br><span class=\"line\"><span class=\"attr\">        run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          cd ../</span></span><br><span class=\"line\"><span class=\"string\">          export WORKPATH=$(pwd)</span></span><br><span class=\"line\"><span class=\"string\">          export PATH=$PATH:$WORKPATH/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin</span></span><br><span class=\"line\"><span class=\"string\">          export PATH=$PATH:$WORKPATH/tools/arm-bcm2708/arm-bcm2708-linux-gnueabi/bin</span></span><br><span class=\"line\"><span class=\"string\">          cd linux/</span></span><br><span class=\"line\"><span class=\"string\">          make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage modules dtbs -j8</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">      - name:</span> <span class=\"string\">Create</span> <span class=\"string\">Release</span></span><br><span class=\"line\"><span class=\"attr\">        id:</span> <span class=\"string\">create_release</span></span><br><span class=\"line\"><span class=\"attr\">        uses:</span> <span class=\"string\">actions/create-release@master</span></span><br><span class=\"line\"><span class=\"attr\">        env:</span></span><br><span class=\"line\"><span class=\"attr\">          GITHUB_TOKEN:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.TOKEN</span> <span class=\"string\">&#125;&#125;</span> <span class=\"comment\"># 之前GitHub添加的Token</span></span><br><span class=\"line\"><span class=\"attr\">        with:</span></span><br><span class=\"line\"><span class=\"attr\">          tag_name:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">github.ref</span> <span class=\"string\">&#125;&#125;</span> <span class=\"comment\"># (tag)标签名称</span></span><br><span class=\"line\"><span class=\"attr\">          release_name:</span> <span class=\"string\">Release</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">github.ref</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\"><span class=\"attr\">          draft:</span> <span class=\"literal\">false</span> <span class=\"comment\"># 是否是草稿</span></span><br><span class=\"line\"><span class=\"attr\">          prerelease:</span> <span class=\"literal\">false</span> <span class=\"comment\"># 是否是预发布</span></span><br><span class=\"line\">      <span class=\"comment\"># 上传构建结果到 Release（把打包的tgz上传到Release）</span></span><br><span class=\"line\"><span class=\"attr\">      - name:</span> <span class=\"string\">build</span> <span class=\"string\">TAR</span> <span class=\"string\">PACKAGE</span></span><br><span class=\"line\"><span class=\"attr\">        run:</span> <span class=\"string\">|</span></span><br><span class=\"line\"><span class=\"string\">          tar -czvf raspberrypi-kernel.tar.gz ../linux/arch/arm/boot</span></span><br><span class=\"line\"><span class=\"string\"></span><span class=\"attr\">      - name:</span> <span class=\"string\">Upload</span> <span class=\"string\">Release</span> <span class=\"string\">Asset</span></span><br><span class=\"line\"><span class=\"attr\">        id:</span> <span class=\"string\">upload-release-asset</span></span><br><span class=\"line\"><span class=\"attr\">        uses:</span> <span class=\"string\">actions/upload-release-asset@master</span></span><br><span class=\"line\"><span class=\"attr\">        env:</span></span><br><span class=\"line\"><span class=\"attr\">          GITHUB_TOKEN:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">secrets.TOKEN</span> <span class=\"string\">&#125;&#125;</span></span><br><span class=\"line\"><span class=\"attr\">        with:</span></span><br><span class=\"line\"><span class=\"attr\">          upload_url:</span> <span class=\"string\">$&#123;&#123;</span> <span class=\"string\">steps.create_release.outputs.upload_url</span> <span class=\"string\">&#125;&#125;</span> <span class=\"comment\"># 上传地址，通过创建Release获取到的</span></span><br><span class=\"line\"><span class=\"attr\">          asset_path:</span> <span class=\"string\">./raspberrypi-kernel.tar.gz</span> <span class=\"comment\"># 要上传文件</span></span><br><span class=\"line\"><span class=\"attr\">          asset_name:</span> <span class=\"string\">raspberrypi-kernel.tar.gz</span> <span class=\"comment\"># 上传后的文件名</span></span><br><span class=\"line\"><span class=\"attr\">          asset_content_type:</span> <span class=\"string\">application/gzip</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>可以在本地配置好<code>.config</code>文件然后上传到仓库，然后把Actions的配置文件中的<code>USE_SSH_CONFIG</code>字段改成<code>false</code>。</li>\n<li>也可以直接在<code>Actions</code>中进行配置<code>.config</code>文件，需要把<code>USE_SSH_CONFIG</code>字段改成<code>true</code>。</li>\n</ul>\n<h2 id=\"触发构建\"><a href=\"#触发构建\" class=\"headerlink\" title=\"触发构建\"></a>触发构建</h2><p>当上面完成后，就可以把代码pull到本地，然后根据自己的需求配置<code>.config</code>文件。执行命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">git tag -a v1.0 -m 'build kernel'</span><br><span class=\"line\">git push origin v1.0</span><br></pre></td></tr></table></figure>\n\n<p>推送完成后，就可以看到Actions正在构建了</p>\n<p><img src=\"http://cdn.mjava.top/20210126152258.png\" alt=\"20210126152258\"></p>\n<p>构建完成后，就可以在<code>Release</code>下载构建好的内核文件了</p>\n<p><img src=\"http://cdn.mjava.top/20210126152413.png\" alt=\"20210126152413\"></p>\n<p><img src=\"http://cdn.mjava.top/20210126152428.png\" alt=\"20210126152413\"></p>\n<h2 id=\"资料索引\"><a href=\"#资料索引\" class=\"headerlink\" title=\"资料索引\"></a>资料索引</h2><ul>\n<li><a href=\"https://www.cnblogs.com/YAN-HUA/p/13530906.html\" rel=\"noopener\" target=\"_blank\">https://www.cnblogs.com/YAN-HUA/p/13530906.html</a></li>\n<li><a href=\"http://doc.openluat.com/article/166/0\" rel=\"noopener\" target=\"_blank\">http://doc.openluat.com/article/166/0</a></li>\n<li><a href=\"https://www.daimajiaoliu.com/daima/4793af6f2900402\" rel=\"noopener\" target=\"_blank\">https://www.daimajiaoliu.com/daima/4793af6f2900402</a></li>\n</ul>"},{"title":"更新驱动到mysql-connector-java-8遇到的一些问题","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-12-25T09:07:12.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n# 更新驱动到mysql-connector-java-8遇到的一些问题\n\n\n\n## 问题\n\n### POM\n\n```java\n<dependency>\n    <groupId>mysql</groupId>\n    <artifactId>mysql-connector-java</artifactId>\n    <version>8.0.16</version>\n</dependency>\n```\n\n## application.properties\n\n```properties\nspring.datasource.driver-class-name=com.mysql.jdbc.Driver\n```\n\n\n\n项目是`SpringBoot`构建的,数据库版本是:`MySQL5.7`,用了`mysql-connector-java-8`来链接数据库,`application.properties`也配置成`spring.datasource.driver-class-name=com.mysql.jdbc.Driver`,中间遇到了几个问题;\n\n### 问题一\n\n#### 描述\n\n如上配置后,控制台报了一下错误:\n\n```shell\nLoading class `com.mysql.jdbc.Driver'. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver'. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.\n```\n\n翻译过来后就是:\n\n加载类` com.mysql.jdbc.Driver`。 不推荐使用。 新的驱动程序类为` com.mysql.cj.jdbc.Driver`。 通过SPI自动注册驱动程序，通常不需要手动加载驱动程序类。\n\n#### 解决\n\n根据提示,解决方法有<font color=orange>两种</font>:\n\n- 更改`application.properties`文件\n\n```properties\nspring.datasource.driver-class-name=com.mysql.jdbc.Driver\n//改成下面这样\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\n```\n\n- 去掉`application.properties`文件中的`spring.datasource.driver-class-name`,因为它说会通过SPI自动注册的;\n\n### 问题二\n\n#### 描述\n\n数据库的数据时间总是和实际时间差8个小时\n\n#### 解决\n\n在数据库url添加`serverTimezone=GMT%2B8`\n\n```properties\nspring.datasource.url=jdbc:mysql://10.25.0.01:3307/db?useUnicode=true&autoReconnect=true&characterEncoding=UTF-8&serverTimezone=GMT%2B8\n```\n\n## 总结\n\n`mysql-connector-java`5.X的版本驱动名是:`com.mysql.jdbc.Driver`; 6.X及以上版本的驱动名是:`com.mysql.cj.jdbc.Driver`","source":"_posts/mysql/mysql-update-driver-connector-8.md","raw":"---\ntitle: 更新驱动到mysql-connector-java-8遇到的一些问题\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-12-25 17:07:12\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Pit\n- MySQL\ncategories:\n- MySQL\n---\n\n# 更新驱动到mysql-connector-java-8遇到的一些问题\n\n\n\n## 问题\n\n### POM\n\n```java\n<dependency>\n    <groupId>mysql</groupId>\n    <artifactId>mysql-connector-java</artifactId>\n    <version>8.0.16</version>\n</dependency>\n```\n\n## application.properties\n\n```properties\nspring.datasource.driver-class-name=com.mysql.jdbc.Driver\n```\n\n\n\n项目是`SpringBoot`构建的,数据库版本是:`MySQL5.7`,用了`mysql-connector-java-8`来链接数据库,`application.properties`也配置成`spring.datasource.driver-class-name=com.mysql.jdbc.Driver`,中间遇到了几个问题;\n\n### 问题一\n\n#### 描述\n\n如上配置后,控制台报了一下错误:\n\n```shell\nLoading class `com.mysql.jdbc.Driver'. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver'. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.\n```\n\n翻译过来后就是:\n\n加载类` com.mysql.jdbc.Driver`。 不推荐使用。 新的驱动程序类为` com.mysql.cj.jdbc.Driver`。 通过SPI自动注册驱动程序，通常不需要手动加载驱动程序类。\n\n#### 解决\n\n根据提示,解决方法有<font color=orange>两种</font>:\n\n- 更改`application.properties`文件\n\n```properties\nspring.datasource.driver-class-name=com.mysql.jdbc.Driver\n//改成下面这样\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\n```\n\n- 去掉`application.properties`文件中的`spring.datasource.driver-class-name`,因为它说会通过SPI自动注册的;\n\n### 问题二\n\n#### 描述\n\n数据库的数据时间总是和实际时间差8个小时\n\n#### 解决\n\n在数据库url添加`serverTimezone=GMT%2B8`\n\n```properties\nspring.datasource.url=jdbc:mysql://10.25.0.01:3307/db?useUnicode=true&autoReconnect=true&characterEncoding=UTF-8&serverTimezone=GMT%2B8\n```\n\n## 总结\n\n`mysql-connector-java`5.X的版本驱动名是:`com.mysql.jdbc.Driver`; 6.X及以上版本的驱动名是:`com.mysql.cj.jdbc.Driver`","slug":"mysql/mysql-update-driver-connector-8","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bk800342mg5f9k3fsgk","content":"<h1 id=\"更新驱动到mysql-connector-java-8遇到的一些问题\"><a href=\"#更新驱动到mysql-connector-java-8遇到的一些问题\" class=\"headerlink\" title=\"更新驱动到mysql-connector-java-8遇到的一些问题\"></a>更新驱动到mysql-connector-java-8遇到的一些问题</h1><h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><h3 id=\"POM\"><a href=\"#POM\" class=\"headerlink\" title=\"POM\"></a>POM</h3><figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;8.0.16&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"application-properties\"><a href=\"#application-properties\" class=\"headerlink\" title=\"application.properties\"></a>application.properties</h2><figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">spring.datasource.driver-class-name</span>=<span class=\"string\">com.mysql.jdbc.Driver</span></span><br></pre></td></tr></table></figure>\n\n<p>项目是<code>SpringBoot</code>构建的,数据库版本是:<code>MySQL5.7</code>,用了<code>mysql-connector-java-8</code>来链接数据库,<code>application.properties</code>也配置成<code>spring.datasource.driver-class-name=com.mysql.jdbc.Driver</code>,中间遇到了几个问题;</p>\n<h3 id=\"问题一\"><a href=\"#问题一\" class=\"headerlink\" title=\"问题一\"></a>问题一</h3><h4 id=\"描述\"><a href=\"#描述\" class=\"headerlink\" title=\"描述\"></a>描述</h4><p>如上配置后,控制台报了一下错误:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">Loading class `com.mysql.jdbc.Driver'. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver'. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.</span><br></pre></td></tr></table></figure>\n\n<p>翻译过来后就是:</p>\n<p>加载类<code>com.mysql.jdbc.Driver</code>。 不推荐使用。 新的驱动程序类为<code>com.mysql.cj.jdbc.Driver</code>。 通过SPI自动注册驱动程序，通常不需要手动加载驱动程序类。</p>\n<h4 id=\"解决\"><a href=\"#解决\" class=\"headerlink\" title=\"解决\"></a>解决</h4><p>根据提示,解决方法有<font color=\"orange\">两种</font>:</p>\n<ul>\n<li>更改<code>application.properties</code>文件</li>\n</ul>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">spring.datasource.driver-class-name</span>=<span class=\"string\">com.mysql.jdbc.Driver</span></span><br><span class=\"line\"><span class=\"attr\">//改成下面这样</span></span><br><span class=\"line\"><span class=\"meta\">spring.datasource.driver-class-name</span>=<span class=\"string\">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>去掉<code>application.properties</code>文件中的<code>spring.datasource.driver-class-name</code>,因为它说会通过SPI自动注册的;</li>\n</ul>\n<h3 id=\"问题二\"><a href=\"#问题二\" class=\"headerlink\" title=\"问题二\"></a>问题二</h3><h4 id=\"描述-1\"><a href=\"#描述-1\" class=\"headerlink\" title=\"描述\"></a>描述</h4><p>数据库的数据时间总是和实际时间差8个小时</p>\n<h4 id=\"解决-1\"><a href=\"#解决-1\" class=\"headerlink\" title=\"解决\"></a>解决</h4><p>在数据库url添加<code>serverTimezone=GMT%2B8</code></p>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">spring.datasource.url</span>=<span class=\"string\">jdbc:mysql://10.25.0.01:3307/db?useUnicode=true&amp;autoReconnect=true&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT%2B8</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p><code>mysql-connector-java</code>5.X的版本驱动名是:<code>com.mysql.jdbc.Driver</code>; 6.X及以上版本的驱动名是:<code>com.mysql.cj.jdbc.Driver</code></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h1 id=\"更新驱动到mysql-connector-java-8遇到的一些问题\"><a href=\"#更新驱动到mysql-connector-java-8遇到的一些问题\" class=\"headerlink\" title=\"更新驱动到mysql-connector-java-8遇到的一些问题\"></a>更新驱动到mysql-connector-java-8遇到的一些问题</h1><h2 id=\"问题\"><a href=\"#问题\" class=\"headerlink\" title=\"问题\"></a>问题</h2><h3 id=\"POM\"><a href=\"#POM\" class=\"headerlink\" title=\"POM\"></a>POM</h3><figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;8.0.16&lt;/version&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"application-properties\"><a href=\"#application-properties\" class=\"headerlink\" title=\"application.properties\"></a>application.properties</h2><figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">spring.datasource.driver-class-name</span>=<span class=\"string\">com.mysql.jdbc.Driver</span></span><br></pre></td></tr></table></figure>\n\n<p>项目是<code>SpringBoot</code>构建的,数据库版本是:<code>MySQL5.7</code>,用了<code>mysql-connector-java-8</code>来链接数据库,<code>application.properties</code>也配置成<code>spring.datasource.driver-class-name=com.mysql.jdbc.Driver</code>,中间遇到了几个问题;</p>\n<h3 id=\"问题一\"><a href=\"#问题一\" class=\"headerlink\" title=\"问题一\"></a>问题一</h3><h4 id=\"描述\"><a href=\"#描述\" class=\"headerlink\" title=\"描述\"></a>描述</h4><p>如上配置后,控制台报了一下错误:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">Loading class `com.mysql.jdbc.Driver'. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver'. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.</span><br></pre></td></tr></table></figure>\n\n<p>翻译过来后就是:</p>\n<p>加载类<code>com.mysql.jdbc.Driver</code>。 不推荐使用。 新的驱动程序类为<code>com.mysql.cj.jdbc.Driver</code>。 通过SPI自动注册驱动程序，通常不需要手动加载驱动程序类。</p>\n<h4 id=\"解决\"><a href=\"#解决\" class=\"headerlink\" title=\"解决\"></a>解决</h4><p>根据提示,解决方法有<font color=\"orange\">两种</font>:</p>\n<ul>\n<li>更改<code>application.properties</code>文件</li>\n</ul>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">spring.datasource.driver-class-name</span>=<span class=\"string\">com.mysql.jdbc.Driver</span></span><br><span class=\"line\"><span class=\"attr\">//改成下面这样</span></span><br><span class=\"line\"><span class=\"meta\">spring.datasource.driver-class-name</span>=<span class=\"string\">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>去掉<code>application.properties</code>文件中的<code>spring.datasource.driver-class-name</code>,因为它说会通过SPI自动注册的;</li>\n</ul>\n<h3 id=\"问题二\"><a href=\"#问题二\" class=\"headerlink\" title=\"问题二\"></a>问题二</h3><h4 id=\"描述-1\"><a href=\"#描述-1\" class=\"headerlink\" title=\"描述\"></a>描述</h4><p>数据库的数据时间总是和实际时间差8个小时</p>\n<h4 id=\"解决-1\"><a href=\"#解决-1\" class=\"headerlink\" title=\"解决\"></a>解决</h4><p>在数据库url添加<code>serverTimezone=GMT%2B8</code></p>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">spring.datasource.url</span>=<span class=\"string\">jdbc:mysql://10.25.0.01:3307/db?useUnicode=true&amp;autoReconnect=true&amp;characterEncoding=UTF-8&amp;serverTimezone=GMT%2B8</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p><code>mysql-connector-java</code>5.X的版本驱动名是:<code>com.mysql.jdbc.Driver</code>; 6.X及以上版本的驱动名是:<code>com.mysql.cj.jdbc.Driver</code></p>\n"},{"title":"插入emoji到mysql时提示了一个表里不存在的字段的错误","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-04-29T09:16:27.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 1.问题描述\n\n由于公司前端有需求，需要在`tiny_user_info`表的`nickname`这个字段里存入emoji表情，于是我熟练地将这个字段修改为`utf8mb4`，改好后测试插入一条带emoji数据。于是报了这个错误：\n\n```shell\n[2020-04-29 15:57:25] [HY000][1366] Incorrect string value: '\\xF0\\x9F\\x98\\x98' for column 'user_name' at row 14\n```\n\n当时我就傻了，我这个表里也没有`user_name`这个字段啊，怎么会报这个字段错误,我明明修改的是`nickname`这个字段啊。于是google和百度搜了一圈，无解。\n\n## ２.解决方案\n\n试了好几种方法，删字段，重新建。删表，重新建。都不行。。。。。静下心来，于是打算从mysql服务器入手。进入到mysql对应库的文件夹，发现`tiny_user_info`这个表有三个文件\n\n![](http://cdn.mjava.top/blog/20200429171012.png)\n\n和常见的多了一个`TRG`文件。这是一个触发器文件，打开一看，发现了`user_name`字段。。。。。。\n\n\n\n原来是同事在这个表里加了个触发器，当`tiny_user_info`里新增数据时，会触发新增到另一张表里，`nickname`的值同时会插入到另一张表的`user_name`字段，而他那张表的字段没有设置`utf8mb4编码`,所以导致插入失败。于是叫同事把他那张表设置一下`utf8mb4`编码后，就可以正常插入了。","source":"_posts/mysql/mysql-utf8mb4-error.md","raw":"---\ntitle: 插入emoji到mysql时提示了一个表里不存在的字段的错误\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-04-29 17:16:27\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Pit\n- MySQL\ncategories:\n- MySQL\n---\n\n## 1.问题描述\n\n由于公司前端有需求，需要在`tiny_user_info`表的`nickname`这个字段里存入emoji表情，于是我熟练地将这个字段修改为`utf8mb4`，改好后测试插入一条带emoji数据。于是报了这个错误：\n\n```shell\n[2020-04-29 15:57:25] [HY000][1366] Incorrect string value: '\\xF0\\x9F\\x98\\x98' for column 'user_name' at row 14\n```\n\n当时我就傻了，我这个表里也没有`user_name`这个字段啊，怎么会报这个字段错误,我明明修改的是`nickname`这个字段啊。于是google和百度搜了一圈，无解。\n\n## ２.解决方案\n\n试了好几种方法，删字段，重新建。删表，重新建。都不行。。。。。静下心来，于是打算从mysql服务器入手。进入到mysql对应库的文件夹，发现`tiny_user_info`这个表有三个文件\n\n![](http://cdn.mjava.top/blog/20200429171012.png)\n\n和常见的多了一个`TRG`文件。这是一个触发器文件，打开一看，发现了`user_name`字段。。。。。。\n\n\n\n原来是同事在这个表里加了个触发器，当`tiny_user_info`里新增数据时，会触发新增到另一张表里，`nickname`的值同时会插入到另一张表的`user_name`字段，而他那张表的字段没有设置`utf8mb4编码`,所以导致插入失败。于是叫同事把他那张表设置一下`utf8mb4`编码后，就可以正常插入了。","slug":"mysql/mysql-utf8mb4-error","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bk900362mg5cic55g1p","content":"<h2 id=\"1-问题描述\"><a href=\"#1-问题描述\" class=\"headerlink\" title=\"1.问题描述\"></a>1.问题描述</h2><p>由于公司前端有需求，需要在<code>tiny_user_info</code>表的<code>nickname</code>这个字段里存入emoji表情，于是我熟练地将这个字段修改为<code>utf8mb4</code>，改好后测试插入一条带emoji数据。于是报了这个错误：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">[2020-04-29 15:57:25] [HY000][1366] Incorrect string value: '\\xF0\\x9F\\x98\\x98' for column 'user_name' at row 14</span><br></pre></td></tr></table></figure>\n\n<p>当时我就傻了，我这个表里也没有<code>user_name</code>这个字段啊，怎么会报这个字段错误,我明明修改的是<code>nickname</code>这个字段啊。于是google和百度搜了一圈，无解。</p>\n<h2 id=\"２-解决方案\"><a href=\"#２-解决方案\" class=\"headerlink\" title=\"２.解决方案\"></a>２.解决方案</h2><p>试了好几种方法，删字段，重新建。删表，重新建。都不行。。。。。静下心来，于是打算从mysql服务器入手。进入到mysql对应库的文件夹，发现<code>tiny_user_info</code>这个表有三个文件</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200429171012.png\" alt></p>\n<p>和常见的多了一个<code>TRG</code>文件。这是一个触发器文件，打开一看，发现了<code>user_name</code>字段。。。。。。</p>\n<p>原来是同事在这个表里加了个触发器，当<code>tiny_user_info</code>里新增数据时，会触发新增到另一张表里，<code>nickname</code>的值同时会插入到另一张表的<code>user_name</code>字段，而他那张表的字段没有设置<code>utf8mb4编码</code>,所以导致插入失败。于是叫同事把他那张表设置一下<code>utf8mb4</code>编码后，就可以正常插入了。</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"1-问题描述\"><a href=\"#1-问题描述\" class=\"headerlink\" title=\"1.问题描述\"></a>1.问题描述</h2><p>由于公司前端有需求，需要在<code>tiny_user_info</code>表的<code>nickname</code>这个字段里存入emoji表情，于是我熟练地将这个字段修改为<code>utf8mb4</code>，改好后测试插入一条带emoji数据。于是报了这个错误：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">[2020-04-29 15:57:25] [HY000][1366] Incorrect string value: '\\xF0\\x9F\\x98\\x98' for column 'user_name' at row 14</span><br></pre></td></tr></table></figure>\n\n<p>当时我就傻了，我这个表里也没有<code>user_name</code>这个字段啊，怎么会报这个字段错误,我明明修改的是<code>nickname</code>这个字段啊。于是google和百度搜了一圈，无解。</p>\n<h2 id=\"２-解决方案\"><a href=\"#２-解决方案\" class=\"headerlink\" title=\"２.解决方案\"></a>２.解决方案</h2><p>试了好几种方法，删字段，重新建。删表，重新建。都不行。。。。。静下心来，于是打算从mysql服务器入手。进入到mysql对应库的文件夹，发现<code>tiny_user_info</code>这个表有三个文件</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200429171012.png\" alt></p>\n<p>和常见的多了一个<code>TRG</code>文件。这是一个触发器文件，打开一看，发现了<code>user_name</code>字段。。。。。。</p>\n<p>原来是同事在这个表里加了个触发器，当<code>tiny_user_info</code>里新增数据时，会触发新增到另一张表里，<code>nickname</code>的值同时会插入到另一张表的<code>user_name</code>字段，而他那张表的字段没有设置<code>utf8mb4编码</code>,所以导致插入失败。于是叫同事把他那张表设置一下<code>utf8mb4</code>编码后，就可以正常插入了。</p>\n"},{"title":"fastDFS安装使用教程","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-05-07T05:34:10.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## FastDFS简介\n\nFastDFS 是一个开源的高性能分布式文件系统（DFS）。 它的主要功能包括：文件存储，文件同步和文件访问，以及高容量和负载平衡。主要解决了海量数据存储问题，特别适合以中小文件（建议范围：4KB < file_size <500MB）为载体的在线服务。\n\nFastDFS 系统有三个角色：跟踪服务器(Tracker Server)、存储服务器(Storage Server)和客户端(Client)。\n\n- **Tracker Server**：跟踪服务器，主要做调度工作，起到均衡的作用；负责管理所有的 storage server和 group，每个 storage 在启动后会连接 Tracker，告知自己所属 group 等信息，并保持周期性心跳。\n\n- **Storage Server**：存储服务器，主要提供容量和备份服务；以 group 为单位，每个 group 内可以有多台 storage server，数据互为备份。\n\n- **Client**：客户端，上传下载数据的服务器，也就是我们自己的项目所部署在的服务器。\n\n- 结构图![](http://cdn.mjava.top/blog/20200507152801.webp)\n\n\n\n- 上传文件流程![](http://cdn.mjava.top/blog/20200507152857.webp)\n\n## 安装环境\n\n| 系统及软件版本        | Git开源地址                                   |\n| --------------------- | --------------------------------------------- |\n| Centos 7              | #                                             |\n| libfastcommon V1.0.43 | https://github.com/happyfish100/fastdfs       |\n| fastdfs V6.06         | https://github.com/happyfish100/libfastcommon |\n\n> 我虚拟机装的Centos7的ip地址是172.16.54.137\n\n## 安装前工作\n\n### 关闭防火墙\n> 为了方便，先关闭防火墙。线上环境安装可安装后开放对应端口。\n\n```shell\nservice firewalld stop\n```\n\n\n\n### 下载所需安装包\n\n- libfastcommon\n\n```shell\nwget https://github.com/happyfish100/libfastcommon/archive/V1.0.43.tar.gz -O libfastcommon.tar.gz\n```\n\n- fastDFS\n\n```shell\nwget https://github.com/happyfish100/fastdfs/archive/V6.06.tar.gz -O fastdfs.tar.gz\n```\n\n\n\n### 安装fastDFS环境\n\n- 解压安装`libfastcommon`\n\n```shell\ntar -zxvf libfastcommon.tar.gz && cd libfastcommon-1.0.43/ && ./make.sh && ./make.sh install\n```\n\n\n\n## 安装fastDFS\n\n### 解压安装\n\n```shell\ntar -zxvf fastdfs.tar.gz && cd fastdfs-6.06/ && ./make.sh && ./make.sh install\n```\n> 安装好fastDFS后，在`/etc/fdfs/`目录下会生成4个示例的配置文件\n>\n> - client.conf.sample\tfastDFS客户端配置文件\n> - storage.conf.sample\n> - storage_ids.conf.sample    当storage超过1个时，可以用这个配置文件来配置管理\n> - tracker.conf.sample\n\n\n### 配置并启动Tracker\n\n进入`/etc/fdfs/`复制一份`Tracker`配置文件，\n\n```shell\ncd /etc/fdfs/ && cp tracker.conf.sample tracker.conf\n```\n\n\n\n修改`tracker.conf`配置文件里的`base_path`目录\n\n```shell\nbase_path=/data/fastdfs/tracker\n```\n\n创建对应的文件夹\n\n```shell\nmkdir -p /data/fastdfs/tracker\n```\n\n\n\n服务命令\n\n```shell\n#启动Tracker\nservice fdfs_trackerd start\n\n#关闭Tracker\nservice fdfs_trackerd stop\n\n#开机自启\nsystemctl enable fdfs_trackerd\n```\n\n\n\n### 配置并启动Storage\n\n进入`/etc/fdfs/`复制一份`Storage`配置文件，\n\n```shell\ncd /etc/fdfs && cp storage.conf.sample storage.conf\n```\n\n\n\n修改`storage.conf`配置文件\n\n```shell\nbase_path=/data/fastdfs/storage\n\n#存放文件地址\nstore_path0=/data/fastdfs/file\n\n#更改为你的tracker地址\ntracker_server=172.16.54.137:22122\n```\n\n\n\n创建对应的文件夹\n\n```shell\nmkdir -p /data/fastdfs/storage && mkdir -p /data/fastdfs/file\n```\n\n\n\n服务命令\n\n```shell\n#启动Storage\nservice fdfs_storaged start\n\n#关闭Storage\nservice fdfs_storaged stop\n\n#开机自启\nsystemctl enable fdfs_storaged\n```\n\n\n\n### 上传文件测试\n\n> 上传文件可以用他自带的客户端进行测试，使用客户端前，要复制一份`client.conf`并修改一下里面的内容\n\n```shell\n#复制一份客户端配置文件\ncd /etc/fdfs && cp client.conf.sample client.conf\n```\n\n\n\n修改`client.config`配置文件\n\n```shell\nbase_path=/data/fastdfs/client\n\n#更改为你的tracker地址\ntracker_server=172.16.54.137:22122\n```\n\n\n\n创建对应文件夹\n\n```shell\nmkdir -p /data/fastdfs/client\n```\n\n\n\n使用方法\n\n```shell\n/usr/bin/fdfs_upload_file /etc/fdfs/client.conf [filename]\n\n#上传成功后返回\ngroup1/M00/00/00/rBA2iV6yvU2AEXUfAAACGTXt3Kw94.yaml\n```\n\n![](http://cdn.mjava.top/blog/20200506215501.png)\n\n## 安装Nginx\n\n> 为了方便，这里直接使用nginx的docker镜像来进行安装。docker安装请自行查找资料\n\n首先创建一个文件夹，存放nginx的配置文件\n\n```shell\n#创建文件夹\nmkdir -p /data/nginx\n#进入文件夹并下载nginx配置文件\ncd /data/nginx && wget http://cdn.mjava.top/file/nginx.conf\n```\n\n> 配置文件已经修改过了，直接下载即可使用\n\n\n\n然后运行docker命令（第一次运行会自动下载nginx镜像）\n\n```shell\ndocker run -d -p 81:80 -v /data/nginx/nginx.conf:/etc/nginx/nginx.conf -v /data/:/data/ --name fastDFS-nginx nginx\n```\n\n\n\n然后就可以通过`http://ip:port/[filePth]`访问上传到fastDFS的文件了\n\n```shell\n#例如刚才上传的文件 可以通过如下地址访问\nhttp://172.16.54.137:81/group1/M00/00/00/rBA2iV6yvU2AEXUfAAACGTXt3Kw94.yaml\n```\n\n\n\n## 拓展\n\n这里只是示例了单机的fastDFS安装，一般fastDFS都是分布式安装的。具体可以通过下载这个结构图去进行安装。此时如果配置了多个group，则需要安装`fastdfs-nginx-module`这个nginx的模块。\n\n![](http://cdn.mjava.top/blog/20200507132841.png)","source":"_posts/linux/linux-fastdfs-install.md","raw":"---\ntitle: fastDFS安装使用教程\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-05-07 13:34:10\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Linux\n- fastDFS\ncategories:\n- Linux\n---\n\n## FastDFS简介\n\nFastDFS 是一个开源的高性能分布式文件系统（DFS）。 它的主要功能包括：文件存储，文件同步和文件访问，以及高容量和负载平衡。主要解决了海量数据存储问题，特别适合以中小文件（建议范围：4KB < file_size <500MB）为载体的在线服务。\n\nFastDFS 系统有三个角色：跟踪服务器(Tracker Server)、存储服务器(Storage Server)和客户端(Client)。\n\n- **Tracker Server**：跟踪服务器，主要做调度工作，起到均衡的作用；负责管理所有的 storage server和 group，每个 storage 在启动后会连接 Tracker，告知自己所属 group 等信息，并保持周期性心跳。\n\n- **Storage Server**：存储服务器，主要提供容量和备份服务；以 group 为单位，每个 group 内可以有多台 storage server，数据互为备份。\n\n- **Client**：客户端，上传下载数据的服务器，也就是我们自己的项目所部署在的服务器。\n\n- 结构图![](http://cdn.mjava.top/blog/20200507152801.webp)\n\n\n\n- 上传文件流程![](http://cdn.mjava.top/blog/20200507152857.webp)\n\n## 安装环境\n\n| 系统及软件版本        | Git开源地址                                   |\n| --------------------- | --------------------------------------------- |\n| Centos 7              | #                                             |\n| libfastcommon V1.0.43 | https://github.com/happyfish100/fastdfs       |\n| fastdfs V6.06         | https://github.com/happyfish100/libfastcommon |\n\n> 我虚拟机装的Centos7的ip地址是172.16.54.137\n\n## 安装前工作\n\n### 关闭防火墙\n> 为了方便，先关闭防火墙。线上环境安装可安装后开放对应端口。\n\n```shell\nservice firewalld stop\n```\n\n\n\n### 下载所需安装包\n\n- libfastcommon\n\n```shell\nwget https://github.com/happyfish100/libfastcommon/archive/V1.0.43.tar.gz -O libfastcommon.tar.gz\n```\n\n- fastDFS\n\n```shell\nwget https://github.com/happyfish100/fastdfs/archive/V6.06.tar.gz -O fastdfs.tar.gz\n```\n\n\n\n### 安装fastDFS环境\n\n- 解压安装`libfastcommon`\n\n```shell\ntar -zxvf libfastcommon.tar.gz && cd libfastcommon-1.0.43/ && ./make.sh && ./make.sh install\n```\n\n\n\n## 安装fastDFS\n\n### 解压安装\n\n```shell\ntar -zxvf fastdfs.tar.gz && cd fastdfs-6.06/ && ./make.sh && ./make.sh install\n```\n> 安装好fastDFS后，在`/etc/fdfs/`目录下会生成4个示例的配置文件\n>\n> - client.conf.sample\tfastDFS客户端配置文件\n> - storage.conf.sample\n> - storage_ids.conf.sample    当storage超过1个时，可以用这个配置文件来配置管理\n> - tracker.conf.sample\n\n\n### 配置并启动Tracker\n\n进入`/etc/fdfs/`复制一份`Tracker`配置文件，\n\n```shell\ncd /etc/fdfs/ && cp tracker.conf.sample tracker.conf\n```\n\n\n\n修改`tracker.conf`配置文件里的`base_path`目录\n\n```shell\nbase_path=/data/fastdfs/tracker\n```\n\n创建对应的文件夹\n\n```shell\nmkdir -p /data/fastdfs/tracker\n```\n\n\n\n服务命令\n\n```shell\n#启动Tracker\nservice fdfs_trackerd start\n\n#关闭Tracker\nservice fdfs_trackerd stop\n\n#开机自启\nsystemctl enable fdfs_trackerd\n```\n\n\n\n### 配置并启动Storage\n\n进入`/etc/fdfs/`复制一份`Storage`配置文件，\n\n```shell\ncd /etc/fdfs && cp storage.conf.sample storage.conf\n```\n\n\n\n修改`storage.conf`配置文件\n\n```shell\nbase_path=/data/fastdfs/storage\n\n#存放文件地址\nstore_path0=/data/fastdfs/file\n\n#更改为你的tracker地址\ntracker_server=172.16.54.137:22122\n```\n\n\n\n创建对应的文件夹\n\n```shell\nmkdir -p /data/fastdfs/storage && mkdir -p /data/fastdfs/file\n```\n\n\n\n服务命令\n\n```shell\n#启动Storage\nservice fdfs_storaged start\n\n#关闭Storage\nservice fdfs_storaged stop\n\n#开机自启\nsystemctl enable fdfs_storaged\n```\n\n\n\n### 上传文件测试\n\n> 上传文件可以用他自带的客户端进行测试，使用客户端前，要复制一份`client.conf`并修改一下里面的内容\n\n```shell\n#复制一份客户端配置文件\ncd /etc/fdfs && cp client.conf.sample client.conf\n```\n\n\n\n修改`client.config`配置文件\n\n```shell\nbase_path=/data/fastdfs/client\n\n#更改为你的tracker地址\ntracker_server=172.16.54.137:22122\n```\n\n\n\n创建对应文件夹\n\n```shell\nmkdir -p /data/fastdfs/client\n```\n\n\n\n使用方法\n\n```shell\n/usr/bin/fdfs_upload_file /etc/fdfs/client.conf [filename]\n\n#上传成功后返回\ngroup1/M00/00/00/rBA2iV6yvU2AEXUfAAACGTXt3Kw94.yaml\n```\n\n![](http://cdn.mjava.top/blog/20200506215501.png)\n\n## 安装Nginx\n\n> 为了方便，这里直接使用nginx的docker镜像来进行安装。docker安装请自行查找资料\n\n首先创建一个文件夹，存放nginx的配置文件\n\n```shell\n#创建文件夹\nmkdir -p /data/nginx\n#进入文件夹并下载nginx配置文件\ncd /data/nginx && wget http://cdn.mjava.top/file/nginx.conf\n```\n\n> 配置文件已经修改过了，直接下载即可使用\n\n\n\n然后运行docker命令（第一次运行会自动下载nginx镜像）\n\n```shell\ndocker run -d -p 81:80 -v /data/nginx/nginx.conf:/etc/nginx/nginx.conf -v /data/:/data/ --name fastDFS-nginx nginx\n```\n\n\n\n然后就可以通过`http://ip:port/[filePth]`访问上传到fastDFS的文件了\n\n```shell\n#例如刚才上传的文件 可以通过如下地址访问\nhttp://172.16.54.137:81/group1/M00/00/00/rBA2iV6yvU2AEXUfAAACGTXt3Kw94.yaml\n```\n\n\n\n## 拓展\n\n这里只是示例了单机的fastDFS安装，一般fastDFS都是分布式安装的。具体可以通过下载这个结构图去进行安装。此时如果配置了多个group，则需要安装`fastdfs-nginx-module`这个nginx的模块。\n\n![](http://cdn.mjava.top/blog/20200507132841.png)","slug":"linux/linux-fastdfs-install","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bkb003a2mg5h7s9z089","content":"<h2 id=\"FastDFS简介\"><a href=\"#FastDFS简介\" class=\"headerlink\" title=\"FastDFS简介\"></a>FastDFS简介</h2><p>FastDFS 是一个开源的高性能分布式文件系统（DFS）。 它的主要功能包括：文件存储，文件同步和文件访问，以及高容量和负载平衡。主要解决了海量数据存储问题，特别适合以中小文件（建议范围：4KB &lt; file_size &lt;500MB）为载体的在线服务。</p>\n<p>FastDFS 系统有三个角色：跟踪服务器(Tracker Server)、存储服务器(Storage Server)和客户端(Client)。</p>\n<ul>\n<li><p><strong>Tracker Server</strong>：跟踪服务器，主要做调度工作，起到均衡的作用；负责管理所有的 storage server和 group，每个 storage 在启动后会连接 Tracker，告知自己所属 group 等信息，并保持周期性心跳。</p>\n</li>\n<li><p><strong>Storage Server</strong>：存储服务器，主要提供容量和备份服务；以 group 为单位，每个 group 内可以有多台 storage server，数据互为备份。</p>\n</li>\n<li><p><strong>Client</strong>：客户端，上传下载数据的服务器，也就是我们自己的项目所部署在的服务器。</p>\n</li>\n<li><p>结构图<img src=\"http://cdn.mjava.top/blog/20200507152801.webp\" alt></p>\n</li>\n</ul>\n<ul>\n<li>上传文件流程<img src=\"http://cdn.mjava.top/blog/20200507152857.webp\" alt></li>\n</ul>\n<h2 id=\"安装环境\"><a href=\"#安装环境\" class=\"headerlink\" title=\"安装环境\"></a>安装环境</h2><table>\n<thead>\n<tr>\n<th>系统及软件版本</th>\n<th>Git开源地址</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Centos 7</td>\n<td>#</td>\n</tr>\n<tr>\n<td>libfastcommon V1.0.43</td>\n<td><a href=\"https://github.com/happyfish100/fastdfs\" rel=\"noopener\" target=\"_blank\">https://github.com/happyfish100/fastdfs</a></td>\n</tr>\n<tr>\n<td>fastdfs V6.06</td>\n<td><a href=\"https://github.com/happyfish100/libfastcommon\" rel=\"noopener\" target=\"_blank\">https://github.com/happyfish100/libfastcommon</a></td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>我虚拟机装的Centos7的ip地址是172.16.54.137</p>\n</blockquote>\n<h2 id=\"安装前工作\"><a href=\"#安装前工作\" class=\"headerlink\" title=\"安装前工作\"></a>安装前工作</h2><h3 id=\"关闭防火墙\"><a href=\"#关闭防火墙\" class=\"headerlink\" title=\"关闭防火墙\"></a>关闭防火墙</h3><blockquote>\n<p>为了方便，先关闭防火墙。线上环境安装可安装后开放对应端口。</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">service firewalld stop</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"下载所需安装包\"><a href=\"#下载所需安装包\" class=\"headerlink\" title=\"下载所需安装包\"></a>下载所需安装包</h3><ul>\n<li>libfastcommon</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">wget https://github.com/happyfish100/libfastcommon/archive/V1.0.43.tar.gz -O libfastcommon.tar.gz</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>fastDFS</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">wget https://github.com/happyfish100/fastdfs/archive/V6.06.tar.gz -O fastdfs.tar.gz</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"安装fastDFS环境\"><a href=\"#安装fastDFS环境\" class=\"headerlink\" title=\"安装fastDFS环境\"></a>安装fastDFS环境</h3><ul>\n<li>解压安装<code>libfastcommon</code></li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">tar -zxvf libfastcommon.tar.gz &amp;&amp; cd libfastcommon-1.0.43/ &amp;&amp; ./make.sh &amp;&amp; ./make.sh install</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"安装fastDFS\"><a href=\"#安装fastDFS\" class=\"headerlink\" title=\"安装fastDFS\"></a>安装fastDFS</h2><h3 id=\"解压安装\"><a href=\"#解压安装\" class=\"headerlink\" title=\"解压安装\"></a>解压安装</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">tar -zxvf fastdfs.tar.gz &amp;&amp; cd fastdfs-6.06/ &amp;&amp; ./make.sh &amp;&amp; ./make.sh install</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>安装好fastDFS后，在<code>/etc/fdfs/</code>目录下会生成4个示例的配置文件</p>\n<ul>\n<li>client.conf.sample    fastDFS客户端配置文件</li>\n<li>storage.conf.sample</li>\n<li>storage_ids.conf.sample    当storage超过1个时，可以用这个配置文件来配置管理</li>\n<li>tracker.conf.sample</li>\n</ul>\n</blockquote>\n<h3 id=\"配置并启动Tracker\"><a href=\"#配置并启动Tracker\" class=\"headerlink\" title=\"配置并启动Tracker\"></a>配置并启动Tracker</h3><p>进入<code>/etc/fdfs/</code>复制一份<code>Tracker</code>配置文件，</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd /etc/fdfs/ &amp;&amp; cp tracker.conf.sample tracker.conf</span><br></pre></td></tr></table></figure>\n\n<p>修改<code>tracker.conf</code>配置文件里的<code>base_path</code>目录</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">base_path=/data/fastdfs/tracker</span><br></pre></td></tr></table></figure>\n\n<p>创建对应的文件夹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/fastdfs/tracker</span><br></pre></td></tr></table></figure>\n\n<p>服务命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">启动Tracker</span></span><br><span class=\"line\">service fdfs_trackerd start</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">关闭Tracker</span></span><br><span class=\"line\">service fdfs_trackerd stop</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">开机自启</span></span><br><span class=\"line\">systemctl enable fdfs_trackerd</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"配置并启动Storage\"><a href=\"#配置并启动Storage\" class=\"headerlink\" title=\"配置并启动Storage\"></a>配置并启动Storage</h3><p>进入<code>/etc/fdfs/</code>复制一份<code>Storage</code>配置文件，</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd /etc/fdfs &amp;&amp; cp storage.conf.sample storage.conf</span><br></pre></td></tr></table></figure>\n\n<p>修改<code>storage.conf</code>配置文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">base_path=/data/fastdfs/storage</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">存放文件地址</span></span><br><span class=\"line\">store_path0=/data/fastdfs/file</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">更改为你的tracker地址</span></span><br><span class=\"line\">tracker_server=172.16.54.137:22122</span><br></pre></td></tr></table></figure>\n\n<p>创建对应的文件夹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/fastdfs/storage &amp;&amp; mkdir -p /data/fastdfs/file</span><br></pre></td></tr></table></figure>\n\n<p>服务命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">启动Storage</span></span><br><span class=\"line\">service fdfs_storaged start</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">关闭Storage</span></span><br><span class=\"line\">service fdfs_storaged stop</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">开机自启</span></span><br><span class=\"line\">systemctl enable fdfs_storaged</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"上传文件测试\"><a href=\"#上传文件测试\" class=\"headerlink\" title=\"上传文件测试\"></a>上传文件测试</h3><blockquote>\n<p>上传文件可以用他自带的客户端进行测试，使用客户端前，要复制一份<code>client.conf</code>并修改一下里面的内容</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">复制一份客户端配置文件</span></span><br><span class=\"line\">cd /etc/fdfs &amp;&amp; cp client.conf.sample client.conf</span><br></pre></td></tr></table></figure>\n\n<p>修改<code>client.config</code>配置文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">base_path=/data/fastdfs/client</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">更改为你的tracker地址</span></span><br><span class=\"line\">tracker_server=172.16.54.137:22122</span><br></pre></td></tr></table></figure>\n\n<p>创建对应文件夹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/fastdfs/client</span><br></pre></td></tr></table></figure>\n\n<p>使用方法</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">/usr/bin/fdfs_upload_file /etc/fdfs/client.conf [filename]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">上传成功后返回</span></span><br><span class=\"line\">group1/M00/00/00/rBA2iV6yvU2AEXUfAAACGTXt3Kw94.yaml</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20200506215501.png\" alt></p>\n<h2 id=\"安装Nginx\"><a href=\"#安装Nginx\" class=\"headerlink\" title=\"安装Nginx\"></a>安装Nginx</h2><blockquote>\n<p>为了方便，这里直接使用nginx的docker镜像来进行安装。docker安装请自行查找资料</p>\n</blockquote>\n<p>首先创建一个文件夹，存放nginx的配置文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">创建文件夹</span></span><br><span class=\"line\">mkdir -p /data/nginx</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">进入文件夹并下载nginx配置文件</span></span><br><span class=\"line\">cd /data/nginx &amp;&amp; wget http://cdn.mjava.top/file/nginx.conf</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>配置文件已经修改过了，直接下载即可使用</p>\n</blockquote>\n<p>然后运行docker命令（第一次运行会自动下载nginx镜像）</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -d -p 81:80 -v /data/nginx/nginx.conf:/etc/nginx/nginx.conf -v /data/:/data/ --name fastDFS-nginx nginx</span><br></pre></td></tr></table></figure>\n\n<p>然后就可以通过<code>http://ip:port/[filePth]</code>访问上传到fastDFS的文件了</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">例如刚才上传的文件 可以通过如下地址访问</span></span><br><span class=\"line\">http://172.16.54.137:81/group1/M00/00/00/rBA2iV6yvU2AEXUfAAACGTXt3Kw94.yaml</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"拓展\"><a href=\"#拓展\" class=\"headerlink\" title=\"拓展\"></a>拓展</h2><p>这里只是示例了单机的fastDFS安装，一般fastDFS都是分布式安装的。具体可以通过下载这个结构图去进行安装。此时如果配置了多个group，则需要安装<code>fastdfs-nginx-module</code>这个nginx的模块。</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200507132841.png\" alt></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"FastDFS简介\"><a href=\"#FastDFS简介\" class=\"headerlink\" title=\"FastDFS简介\"></a>FastDFS简介</h2><p>FastDFS 是一个开源的高性能分布式文件系统（DFS）。 它的主要功能包括：文件存储，文件同步和文件访问，以及高容量和负载平衡。主要解决了海量数据存储问题，特别适合以中小文件（建议范围：4KB &lt; file_size &lt;500MB）为载体的在线服务。</p>\n<p>FastDFS 系统有三个角色：跟踪服务器(Tracker Server)、存储服务器(Storage Server)和客户端(Client)。</p>\n<ul>\n<li><p><strong>Tracker Server</strong>：跟踪服务器，主要做调度工作，起到均衡的作用；负责管理所有的 storage server和 group，每个 storage 在启动后会连接 Tracker，告知自己所属 group 等信息，并保持周期性心跳。</p>\n</li>\n<li><p><strong>Storage Server</strong>：存储服务器，主要提供容量和备份服务；以 group 为单位，每个 group 内可以有多台 storage server，数据互为备份。</p>\n</li>\n<li><p><strong>Client</strong>：客户端，上传下载数据的服务器，也就是我们自己的项目所部署在的服务器。</p>\n</li>\n<li><p>结构图<img src=\"http://cdn.mjava.top/blog/20200507152801.webp\" alt></p>\n</li>\n</ul>\n<ul>\n<li>上传文件流程<img src=\"http://cdn.mjava.top/blog/20200507152857.webp\" alt></li>\n</ul>\n<h2 id=\"安装环境\"><a href=\"#安装环境\" class=\"headerlink\" title=\"安装环境\"></a>安装环境</h2><table>\n<thead>\n<tr>\n<th>系统及软件版本</th>\n<th>Git开源地址</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>Centos 7</td>\n<td>#</td>\n</tr>\n<tr>\n<td>libfastcommon V1.0.43</td>\n<td><a href=\"https://github.com/happyfish100/fastdfs\" rel=\"noopener\" target=\"_blank\">https://github.com/happyfish100/fastdfs</a></td>\n</tr>\n<tr>\n<td>fastdfs V6.06</td>\n<td><a href=\"https://github.com/happyfish100/libfastcommon\" rel=\"noopener\" target=\"_blank\">https://github.com/happyfish100/libfastcommon</a></td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>我虚拟机装的Centos7的ip地址是172.16.54.137</p>\n</blockquote>\n<h2 id=\"安装前工作\"><a href=\"#安装前工作\" class=\"headerlink\" title=\"安装前工作\"></a>安装前工作</h2><h3 id=\"关闭防火墙\"><a href=\"#关闭防火墙\" class=\"headerlink\" title=\"关闭防火墙\"></a>关闭防火墙</h3><blockquote>\n<p>为了方便，先关闭防火墙。线上环境安装可安装后开放对应端口。</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">service firewalld stop</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"下载所需安装包\"><a href=\"#下载所需安装包\" class=\"headerlink\" title=\"下载所需安装包\"></a>下载所需安装包</h3><ul>\n<li>libfastcommon</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">wget https://github.com/happyfish100/libfastcommon/archive/V1.0.43.tar.gz -O libfastcommon.tar.gz</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>fastDFS</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">wget https://github.com/happyfish100/fastdfs/archive/V6.06.tar.gz -O fastdfs.tar.gz</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"安装fastDFS环境\"><a href=\"#安装fastDFS环境\" class=\"headerlink\" title=\"安装fastDFS环境\"></a>安装fastDFS环境</h3><ul>\n<li>解压安装<code>libfastcommon</code></li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">tar -zxvf libfastcommon.tar.gz &amp;&amp; cd libfastcommon-1.0.43/ &amp;&amp; ./make.sh &amp;&amp; ./make.sh install</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"安装fastDFS\"><a href=\"#安装fastDFS\" class=\"headerlink\" title=\"安装fastDFS\"></a>安装fastDFS</h2><h3 id=\"解压安装\"><a href=\"#解压安装\" class=\"headerlink\" title=\"解压安装\"></a>解压安装</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">tar -zxvf fastdfs.tar.gz &amp;&amp; cd fastdfs-6.06/ &amp;&amp; ./make.sh &amp;&amp; ./make.sh install</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>安装好fastDFS后，在<code>/etc/fdfs/</code>目录下会生成4个示例的配置文件</p>\n<ul>\n<li>client.conf.sample    fastDFS客户端配置文件</li>\n<li>storage.conf.sample</li>\n<li>storage_ids.conf.sample    当storage超过1个时，可以用这个配置文件来配置管理</li>\n<li>tracker.conf.sample</li>\n</ul>\n</blockquote>\n<h3 id=\"配置并启动Tracker\"><a href=\"#配置并启动Tracker\" class=\"headerlink\" title=\"配置并启动Tracker\"></a>配置并启动Tracker</h3><p>进入<code>/etc/fdfs/</code>复制一份<code>Tracker</code>配置文件，</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd /etc/fdfs/ &amp;&amp; cp tracker.conf.sample tracker.conf</span><br></pre></td></tr></table></figure>\n\n<p>修改<code>tracker.conf</code>配置文件里的<code>base_path</code>目录</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">base_path=/data/fastdfs/tracker</span><br></pre></td></tr></table></figure>\n\n<p>创建对应的文件夹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/fastdfs/tracker</span><br></pre></td></tr></table></figure>\n\n<p>服务命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">启动Tracker</span></span><br><span class=\"line\">service fdfs_trackerd start</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">关闭Tracker</span></span><br><span class=\"line\">service fdfs_trackerd stop</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">开机自启</span></span><br><span class=\"line\">systemctl enable fdfs_trackerd</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"配置并启动Storage\"><a href=\"#配置并启动Storage\" class=\"headerlink\" title=\"配置并启动Storage\"></a>配置并启动Storage</h3><p>进入<code>/etc/fdfs/</code>复制一份<code>Storage</code>配置文件，</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">cd /etc/fdfs &amp;&amp; cp storage.conf.sample storage.conf</span><br></pre></td></tr></table></figure>\n\n<p>修改<code>storage.conf</code>配置文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">base_path=/data/fastdfs/storage</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">存放文件地址</span></span><br><span class=\"line\">store_path0=/data/fastdfs/file</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">更改为你的tracker地址</span></span><br><span class=\"line\">tracker_server=172.16.54.137:22122</span><br></pre></td></tr></table></figure>\n\n<p>创建对应的文件夹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/fastdfs/storage &amp;&amp; mkdir -p /data/fastdfs/file</span><br></pre></td></tr></table></figure>\n\n<p>服务命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">启动Storage</span></span><br><span class=\"line\">service fdfs_storaged start</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">关闭Storage</span></span><br><span class=\"line\">service fdfs_storaged stop</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">开机自启</span></span><br><span class=\"line\">systemctl enable fdfs_storaged</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"上传文件测试\"><a href=\"#上传文件测试\" class=\"headerlink\" title=\"上传文件测试\"></a>上传文件测试</h3><blockquote>\n<p>上传文件可以用他自带的客户端进行测试，使用客户端前，要复制一份<code>client.conf</code>并修改一下里面的内容</p>\n</blockquote>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">复制一份客户端配置文件</span></span><br><span class=\"line\">cd /etc/fdfs &amp;&amp; cp client.conf.sample client.conf</span><br></pre></td></tr></table></figure>\n\n<p>修改<code>client.config</code>配置文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">base_path=/data/fastdfs/client</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">更改为你的tracker地址</span></span><br><span class=\"line\">tracker_server=172.16.54.137:22122</span><br></pre></td></tr></table></figure>\n\n<p>创建对应文件夹</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/fastdfs/client</span><br></pre></td></tr></table></figure>\n\n<p>使用方法</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">/usr/bin/fdfs_upload_file /etc/fdfs/client.conf [filename]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">上传成功后返回</span></span><br><span class=\"line\">group1/M00/00/00/rBA2iV6yvU2AEXUfAAACGTXt3Kw94.yaml</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20200506215501.png\" alt></p>\n<h2 id=\"安装Nginx\"><a href=\"#安装Nginx\" class=\"headerlink\" title=\"安装Nginx\"></a>安装Nginx</h2><blockquote>\n<p>为了方便，这里直接使用nginx的docker镜像来进行安装。docker安装请自行查找资料</p>\n</blockquote>\n<p>首先创建一个文件夹，存放nginx的配置文件</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">创建文件夹</span></span><br><span class=\"line\">mkdir -p /data/nginx</span><br><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">进入文件夹并下载nginx配置文件</span></span><br><span class=\"line\">cd /data/nginx &amp;&amp; wget http://cdn.mjava.top/file/nginx.conf</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>配置文件已经修改过了，直接下载即可使用</p>\n</blockquote>\n<p>然后运行docker命令（第一次运行会自动下载nginx镜像）</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">docker run -d -p 81:80 -v /data/nginx/nginx.conf:/etc/nginx/nginx.conf -v /data/:/data/ --name fastDFS-nginx nginx</span><br></pre></td></tr></table></figure>\n\n<p>然后就可以通过<code>http://ip:port/[filePth]</code>访问上传到fastDFS的文件了</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\">例如刚才上传的文件 可以通过如下地址访问</span></span><br><span class=\"line\">http://172.16.54.137:81/group1/M00/00/00/rBA2iV6yvU2AEXUfAAACGTXt3Kw94.yaml</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"拓展\"><a href=\"#拓展\" class=\"headerlink\" title=\"拓展\"></a>拓展</h2><p>这里只是示例了单机的fastDFS安装，一般fastDFS都是分布式安装的。具体可以通过下载这个结构图去进行安装。此时如果配置了多个group，则需要安装<code>fastdfs-nginx-module</code>这个nginx的模块。</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200507132841.png\" alt></p>\n"},{"title":"Git常用命令","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-09-16T07:16:56.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n## Git简介\n\nGit 是用于 Linux[内核](https://baike.baidu.com/item/内核)开发的[版本控制](https://baike.baidu.com/item/版本控制)工具。与常用的版本控制工具 CVS, Subversion 等不同，它采用了分布式版本库的方式，不必服务器端软件支持（wingeddevil注：这得分是用什么样的服务端，使用http协议或者git协议等不太一样。并且在push和pull的时候和服务器端还是有交互的。），使[源代码](https://baike.baidu.com/item/源代码)的发布和交流极其方便。 Git 的速度很快，这对于诸如 Linux kernel 这样的大项目来说自然很重要。 Git 最为出色的是它的合并跟踪（merge tracing）能力。\n\ngit对于很多人来说,真的是又爱又恨,用的好可以提示开发效率;用不好,解决各种冲突就要累的你半死\n\n\n\n## git结构\n\n> 网上有 我就不画了\n\n![git结构图](http://cdn.mjava.top/blog/20200605001853.png)\n\n\n\n- workspace    相当于就是我们的本地电脑上的文件\n\n- Index    缓存区\n- Repository    本地仓库\n- Remote    远程仓库(github/gitlab/gitee)\n\n\n\n## git命令\n\ngit官方提供的命令多达几百个,可是我们日常却用不到这么多\n\n所以我就整理了一下日常使用的命令\n\n现在关注微信公招:`灰色Code`\n\n回复关键字:`git`\n\n就可以获取思维导图高清图片及导图源地址\n\n![](http://cdn.mjava.top/blog/20200605002904.jpg)","source":"_posts/recommend/git-commend-note.md","raw":"---\ntitle: Git常用命令\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-09-16 15:16:56\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Git\ncategories:\n- Java\n---\n\n\n\n## Git简介\n\nGit 是用于 Linux[内核](https://baike.baidu.com/item/内核)开发的[版本控制](https://baike.baidu.com/item/版本控制)工具。与常用的版本控制工具 CVS, Subversion 等不同，它采用了分布式版本库的方式，不必服务器端软件支持（wingeddevil注：这得分是用什么样的服务端，使用http协议或者git协议等不太一样。并且在push和pull的时候和服务器端还是有交互的。），使[源代码](https://baike.baidu.com/item/源代码)的发布和交流极其方便。 Git 的速度很快，这对于诸如 Linux kernel 这样的大项目来说自然很重要。 Git 最为出色的是它的合并跟踪（merge tracing）能力。\n\ngit对于很多人来说,真的是又爱又恨,用的好可以提示开发效率;用不好,解决各种冲突就要累的你半死\n\n\n\n## git结构\n\n> 网上有 我就不画了\n\n![git结构图](http://cdn.mjava.top/blog/20200605001853.png)\n\n\n\n- workspace    相当于就是我们的本地电脑上的文件\n\n- Index    缓存区\n- Repository    本地仓库\n- Remote    远程仓库(github/gitlab/gitee)\n\n\n\n## git命令\n\ngit官方提供的命令多达几百个,可是我们日常却用不到这么多\n\n所以我就整理了一下日常使用的命令\n\n现在关注微信公招:`灰色Code`\n\n回复关键字:`git`\n\n就可以获取思维导图高清图片及导图源地址\n\n![](http://cdn.mjava.top/blog/20200605002904.jpg)","slug":"recommend/git-commend-note","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bkc003d2mg5nzx3wbuo","content":"<h2 id=\"Git简介\"><a href=\"#Git简介\" class=\"headerlink\" title=\"Git简介\"></a>Git简介</h2><p>Git 是用于 Linux<a href=\"https://baike.baidu.com/item/内核\" rel=\"noopener\" target=\"_blank\">内核</a>开发的<a href=\"https://baike.baidu.com/item/版本控制\" rel=\"noopener\" target=\"_blank\">版本控制</a>工具。与常用的版本控制工具 CVS, Subversion 等不同，它采用了分布式版本库的方式，不必服务器端软件支持（wingeddevil注：这得分是用什么样的服务端，使用http协议或者git协议等不太一样。并且在push和pull的时候和服务器端还是有交互的。），使<a href=\"https://baike.baidu.com/item/源代码\" rel=\"noopener\" target=\"_blank\">源代码</a>的发布和交流极其方便。 Git 的速度很快，这对于诸如 Linux kernel 这样的大项目来说自然很重要。 Git 最为出色的是它的合并跟踪（merge tracing）能力。</p>\n<p>git对于很多人来说,真的是又爱又恨,用的好可以提示开发效率;用不好,解决各种冲突就要累的你半死</p>\n<h2 id=\"git结构\"><a href=\"#git结构\" class=\"headerlink\" title=\"git结构\"></a>git结构</h2><blockquote>\n<p>网上有 我就不画了</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200605001853.png\" alt=\"git结构图\"></p>\n<ul>\n<li><p>workspace    相当于就是我们的本地电脑上的文件</p>\n</li>\n<li><p>Index    缓存区</p>\n</li>\n<li><p>Repository    本地仓库</p>\n</li>\n<li><p>Remote    远程仓库(github/gitlab/gitee)</p>\n</li>\n</ul>\n<h2 id=\"git命令\"><a href=\"#git命令\" class=\"headerlink\" title=\"git命令\"></a>git命令</h2><p>git官方提供的命令多达几百个,可是我们日常却用不到这么多</p>\n<p>所以我就整理了一下日常使用的命令</p>\n<p>现在关注微信公招:<code>灰色Code</code></p>\n<p>回复关键字:<code>git</code></p>\n<p>就可以获取思维导图高清图片及导图源地址</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200605002904.jpg\" alt></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"Git简介\"><a href=\"#Git简介\" class=\"headerlink\" title=\"Git简介\"></a>Git简介</h2><p>Git 是用于 Linux<a href=\"https://baike.baidu.com/item/内核\" rel=\"noopener\" target=\"_blank\">内核</a>开发的<a href=\"https://baike.baidu.com/item/版本控制\" rel=\"noopener\" target=\"_blank\">版本控制</a>工具。与常用的版本控制工具 CVS, Subversion 等不同，它采用了分布式版本库的方式，不必服务器端软件支持（wingeddevil注：这得分是用什么样的服务端，使用http协议或者git协议等不太一样。并且在push和pull的时候和服务器端还是有交互的。），使<a href=\"https://baike.baidu.com/item/源代码\" rel=\"noopener\" target=\"_blank\">源代码</a>的发布和交流极其方便。 Git 的速度很快，这对于诸如 Linux kernel 这样的大项目来说自然很重要。 Git 最为出色的是它的合并跟踪（merge tracing）能力。</p>\n<p>git对于很多人来说,真的是又爱又恨,用的好可以提示开发效率;用不好,解决各种冲突就要累的你半死</p>\n<h2 id=\"git结构\"><a href=\"#git结构\" class=\"headerlink\" title=\"git结构\"></a>git结构</h2><blockquote>\n<p>网上有 我就不画了</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200605001853.png\" alt=\"git结构图\"></p>\n<ul>\n<li><p>workspace    相当于就是我们的本地电脑上的文件</p>\n</li>\n<li><p>Index    缓存区</p>\n</li>\n<li><p>Repository    本地仓库</p>\n</li>\n<li><p>Remote    远程仓库(github/gitlab/gitee)</p>\n</li>\n</ul>\n<h2 id=\"git命令\"><a href=\"#git命令\" class=\"headerlink\" title=\"git命令\"></a>git命令</h2><p>git官方提供的命令多达几百个,可是我们日常却用不到这么多</p>\n<p>所以我就整理了一下日常使用的命令</p>\n<p>现在关注微信公招:<code>灰色Code</code></p>\n<p>回复关键字:<code>git</code></p>\n<p>就可以获取思维导图高清图片及导图源地址</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200605002904.jpg\" alt></p>\n"},{"title":"创建一个自定义注解","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-06-22T08:23:56.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 前言\n\n平时在用springBoot的使用，常常会用到`@Service`，`@Compent`等等注解，简化了我们的开发流程，提升了开发效率.那如何自己来写一个注解呢？下面就来介绍一下。\n\n\n\n## 写一个注解\n\n创建一个注解主要分两部分，一部分是创建**注解类**，一部分是创建一个**切面类**。\n\n### 创建注解类\n\n```java\n@Target({ElementType.METHOD})\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface MyAnn {\n    String value() default \"d\";\n}\n```\n\n创建注解类的关键字就是`@interface`，这个注解类设置了一个`value`变量，默认值为d；\n\n在注解类上面还有`@Target`和`@Retention`注解，下面来说说创建注解类时需要用到的几个注解：\n\n#### `@Target`\n\n用来标记这个注解可以用于哪些地方，与`ElementType`枚举类搭配使用，那这个枚举类里面有什么内容呢？\n\n```java\npublic enum ElementType {\n    /** 类，接口（包括注释类型）或枚举声明*/\n    TYPE,\n\n    /** 字段声明（包括枚举常量）*/\n    FIELD,\n\n    /** 方法声明*/\n    METHOD,\n\n    /** 形式参数（形参-调用方法时传入的参数）声明 */\n    PARAMETER,\n\n    /** 构造函数声明 */\n    CONSTRUCTOR,\n\n    /** 局部变量声明 */\n    LOCAL_VARIABLE,\n\n    /** 注释类型声明 */\n    ANNOTATION_TYPE,\n\n    /** 包声明 */\n    PACKAGE,\n\n    /**\n     * 类型参数声明\n     * java8新特性：\n     * @since 1.8\n     */\n    TYPE_PARAMETER,\n\n    /**\n     * 任何类型声明 \n     * java8新特性：\n     * @since 1.8\n     */\n    TYPE_USE\n}\n```\n\n#### `@Retention`\n\n该注解表示自定义注解的生命周期\n\n```java\npublic enum RetentionPolicy {\n    /**\n     * 注释将被编译器丢弃。\n     */\n    SOURCE,\n\n    /**\n     * 注释由编译器记录在类文件中\n     * 但不必在运行时由VM保留。 这是默认值\n     */\n    CLASS,\n\n    /**\n   \t *注释由编译器记录在类文件中，并且\n     *在运行时由VM保留，因此可以以反射方式读取它们。\n     */\n    RUNTIME\n}\n\n```\n\n## 写一个切面类\n\n因为用到了切面，所以我们要先导入`Spring AOP`这个依赖包。\n\n```xml\n<!--SpringBoot项目导入AOP-->\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-aop</artifactId>\n</dependency>\n```\n\n### 创建切面类\n\n```java\n@Aspect\n@Component\npublic class MyAnnAop {\n    private Logger logger= LoggerFactory.getLogger(MyAnnAop.class);\n    @Pointcut(\"@annotation(com.example.demo.annotation.MyAnn)\")\n    public void ann(){\n    }\n    @Before(\"ann()\")\n    public void before(JoinPoint joinPoint){\n        logger.info(\"打印：开始前\");\n    }\n    @AfterReturning(value = \"ann()\",returning = \"res\")\n    public Object dochange(JoinPoint joinPoint,Object res){\n        logger.info(\"AfterReturning通知开始-获取数据:{}\",res);\n        //获取数据\n        Map<String,String> map= (Map<String, String>) res;\n        //添加新值\n        map.put(\"s1\",\"我是在AOP中添加的新值\");\n        return map;\n    }\n}\n```\n\n### Spring AOP说明\n\n> 具体可以查阅Spring AOP相关资料\n\n| 注解              | 说明                                                         |\n| ----------------- | ------------------------------------------------------------ |\n| `@Before`         | 前置通知，在连接点方法前调用                                 |\n| `@Around`         | 环绕通知，它将覆盖原有方法，但是允许你通过反射调用原有方法   |\n| `@After`          | 后置通知，在连接点方法后调用                                 |\n| `@AfterReturning` | 返回通知，在连接点方法执行并正常返回后调用，要求连接点方法在执行过程中没有发生异常 |\n| `@AfterThrowing`  | 异常通知，当连接点方法异常时调用                             |\n\n## 使用自定义的注解\n\n这里使用普通的`SpringBoot`来使用注解，创建一个**Service**,在里面使用注解，然后才控制层调用\n\n```java\n//服务层\n@Service\npublic class TestService {\n    @MyAnn\n    public Map test(){\n        Map<String,String>  map=new HashMap<>();\n        map.put(\"t1\",\"我是在Service设置的值\");\n        return map;\n    }\n}\n\n//控制层\n@RestController\npublic class Test2 {\n    private Logger logger= LoggerFactory.getLogger(Test2.class);\n\n    @Autowired\n    private TestService testService;\n\n    @GetMapping(\"/test\")\n    public String test(String id){\n        Map<String,String> s=testService.test();\n        logger.info(\"控制层输出：{}\",s.get(\"s1\"));\n        return \"sccess\";\n    }\n}\n```\n\n#### 输出\n\n```shell\ncom.example.demo.aop.MyAnnAop : AfterReturning通知开始-获取数据:{t1=我是在Service设置的值}\ncom.example.demo.web.Test2    : 控制层输出：我是在AOP中添加的新值\n```\n\n## 注意事项\n\n上面那样使用注解是没问题的，但是如果是下面这样使用，`AOP`就会**失效**\n\n```java\n@RestController\npublic class Test2 {\n    private Logger logger= LoggerFactory.getLogger(Test2.class);\n\n    @Autowired\n    private TestService testService;\n\n    @GetMapping(\"/test\")\n    public String test(String id){\n        Map<String,String> s=this.test2();\n        logger.info(\"控制层输出：{}\",s.get(\"s1\"));\n        return \"sccess\";\n    }\n\n    @MyAnn\n    public Map test2(){\n        Map<String,String>  map=new HashMap<>();\n        map.put(\"t1\",\"我是在控制层设置的值\");\n        return map;\n    }\n}\n```\n\n#### 输出\n\n```shell\ncom.example.demo.web.Test2       : 控制层输出：null\n```\n\n这是应为内部方法调用，调用的是具体方法，并没有调用使用AOP后生成的代理方法\n\n具体参考资料：\n\n- https://blog.csdn.net/Daybreak1209/article/details/82982674\n- https://blog.csdn.net/u013151053/article/details/106124048?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase\n- https://zhewuzhou.github.io/2018/09/01/Spring_AOP_Trap/","source":"_posts/spring/apring-aop-ann.md","raw":"---\ntitle: 创建一个自定义注解\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-06-22 16:23:56\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Spring AOP\n- 注解\ncategories:\n- Spring\n---\n\n## 前言\n\n平时在用springBoot的使用，常常会用到`@Service`，`@Compent`等等注解，简化了我们的开发流程，提升了开发效率.那如何自己来写一个注解呢？下面就来介绍一下。\n\n\n\n## 写一个注解\n\n创建一个注解主要分两部分，一部分是创建**注解类**，一部分是创建一个**切面类**。\n\n### 创建注解类\n\n```java\n@Target({ElementType.METHOD})\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface MyAnn {\n    String value() default \"d\";\n}\n```\n\n创建注解类的关键字就是`@interface`，这个注解类设置了一个`value`变量，默认值为d；\n\n在注解类上面还有`@Target`和`@Retention`注解，下面来说说创建注解类时需要用到的几个注解：\n\n#### `@Target`\n\n用来标记这个注解可以用于哪些地方，与`ElementType`枚举类搭配使用，那这个枚举类里面有什么内容呢？\n\n```java\npublic enum ElementType {\n    /** 类，接口（包括注释类型）或枚举声明*/\n    TYPE,\n\n    /** 字段声明（包括枚举常量）*/\n    FIELD,\n\n    /** 方法声明*/\n    METHOD,\n\n    /** 形式参数（形参-调用方法时传入的参数）声明 */\n    PARAMETER,\n\n    /** 构造函数声明 */\n    CONSTRUCTOR,\n\n    /** 局部变量声明 */\n    LOCAL_VARIABLE,\n\n    /** 注释类型声明 */\n    ANNOTATION_TYPE,\n\n    /** 包声明 */\n    PACKAGE,\n\n    /**\n     * 类型参数声明\n     * java8新特性：\n     * @since 1.8\n     */\n    TYPE_PARAMETER,\n\n    /**\n     * 任何类型声明 \n     * java8新特性：\n     * @since 1.8\n     */\n    TYPE_USE\n}\n```\n\n#### `@Retention`\n\n该注解表示自定义注解的生命周期\n\n```java\npublic enum RetentionPolicy {\n    /**\n     * 注释将被编译器丢弃。\n     */\n    SOURCE,\n\n    /**\n     * 注释由编译器记录在类文件中\n     * 但不必在运行时由VM保留。 这是默认值\n     */\n    CLASS,\n\n    /**\n   \t *注释由编译器记录在类文件中，并且\n     *在运行时由VM保留，因此可以以反射方式读取它们。\n     */\n    RUNTIME\n}\n\n```\n\n## 写一个切面类\n\n因为用到了切面，所以我们要先导入`Spring AOP`这个依赖包。\n\n```xml\n<!--SpringBoot项目导入AOP-->\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-aop</artifactId>\n</dependency>\n```\n\n### 创建切面类\n\n```java\n@Aspect\n@Component\npublic class MyAnnAop {\n    private Logger logger= LoggerFactory.getLogger(MyAnnAop.class);\n    @Pointcut(\"@annotation(com.example.demo.annotation.MyAnn)\")\n    public void ann(){\n    }\n    @Before(\"ann()\")\n    public void before(JoinPoint joinPoint){\n        logger.info(\"打印：开始前\");\n    }\n    @AfterReturning(value = \"ann()\",returning = \"res\")\n    public Object dochange(JoinPoint joinPoint,Object res){\n        logger.info(\"AfterReturning通知开始-获取数据:{}\",res);\n        //获取数据\n        Map<String,String> map= (Map<String, String>) res;\n        //添加新值\n        map.put(\"s1\",\"我是在AOP中添加的新值\");\n        return map;\n    }\n}\n```\n\n### Spring AOP说明\n\n> 具体可以查阅Spring AOP相关资料\n\n| 注解              | 说明                                                         |\n| ----------------- | ------------------------------------------------------------ |\n| `@Before`         | 前置通知，在连接点方法前调用                                 |\n| `@Around`         | 环绕通知，它将覆盖原有方法，但是允许你通过反射调用原有方法   |\n| `@After`          | 后置通知，在连接点方法后调用                                 |\n| `@AfterReturning` | 返回通知，在连接点方法执行并正常返回后调用，要求连接点方法在执行过程中没有发生异常 |\n| `@AfterThrowing`  | 异常通知，当连接点方法异常时调用                             |\n\n## 使用自定义的注解\n\n这里使用普通的`SpringBoot`来使用注解，创建一个**Service**,在里面使用注解，然后才控制层调用\n\n```java\n//服务层\n@Service\npublic class TestService {\n    @MyAnn\n    public Map test(){\n        Map<String,String>  map=new HashMap<>();\n        map.put(\"t1\",\"我是在Service设置的值\");\n        return map;\n    }\n}\n\n//控制层\n@RestController\npublic class Test2 {\n    private Logger logger= LoggerFactory.getLogger(Test2.class);\n\n    @Autowired\n    private TestService testService;\n\n    @GetMapping(\"/test\")\n    public String test(String id){\n        Map<String,String> s=testService.test();\n        logger.info(\"控制层输出：{}\",s.get(\"s1\"));\n        return \"sccess\";\n    }\n}\n```\n\n#### 输出\n\n```shell\ncom.example.demo.aop.MyAnnAop : AfterReturning通知开始-获取数据:{t1=我是在Service设置的值}\ncom.example.demo.web.Test2    : 控制层输出：我是在AOP中添加的新值\n```\n\n## 注意事项\n\n上面那样使用注解是没问题的，但是如果是下面这样使用，`AOP`就会**失效**\n\n```java\n@RestController\npublic class Test2 {\n    private Logger logger= LoggerFactory.getLogger(Test2.class);\n\n    @Autowired\n    private TestService testService;\n\n    @GetMapping(\"/test\")\n    public String test(String id){\n        Map<String,String> s=this.test2();\n        logger.info(\"控制层输出：{}\",s.get(\"s1\"));\n        return \"sccess\";\n    }\n\n    @MyAnn\n    public Map test2(){\n        Map<String,String>  map=new HashMap<>();\n        map.put(\"t1\",\"我是在控制层设置的值\");\n        return map;\n    }\n}\n```\n\n#### 输出\n\n```shell\ncom.example.demo.web.Test2       : 控制层输出：null\n```\n\n这是应为内部方法调用，调用的是具体方法，并没有调用使用AOP后生成的代理方法\n\n具体参考资料：\n\n- https://blog.csdn.net/Daybreak1209/article/details/82982674\n- https://blog.csdn.net/u013151053/article/details/106124048?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase\n- https://zhewuzhou.github.io/2018/09/01/Spring_AOP_Trap/","slug":"spring/apring-aop-ann","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bkd003h2mg5zis69d00","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>平时在用springBoot的使用，常常会用到<code>@Service</code>，<code>@Compent</code>等等注解，简化了我们的开发流程，提升了开发效率.那如何自己来写一个注解呢？下面就来介绍一下。</p>\n<h2 id=\"写一个注解\"><a href=\"#写一个注解\" class=\"headerlink\" title=\"写一个注解\"></a>写一个注解</h2><p>创建一个注解主要分两部分，一部分是创建<strong>注解类</strong>，一部分是创建一个<strong>切面类</strong>。</p>\n<h3 id=\"创建注解类\"><a href=\"#创建注解类\" class=\"headerlink\" title=\"创建注解类\"></a>创建注解类</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.METHOD&#125;)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> MyAnn &#123;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> \"d\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>创建注解类的关键字就是<code>@interface</code>，这个注解类设置了一个<code>value</code>变量，默认值为d；</p>\n<p>在注解类上面还有<code>@Target</code>和<code>@Retention</code>注解，下面来说说创建注解类时需要用到的几个注解：</p>\n<h4 id=\"Target\"><a href=\"#Target\" class=\"headerlink\" title=\"@Target\"></a><code>@Target</code></h4><p>用来标记这个注解可以用于哪些地方，与<code>ElementType</code>枚举类搭配使用，那这个枚举类里面有什么内容呢？</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> ElementType &#123;</span><br><span class=\"line\">    <span class=\"comment\">/** 类，接口（包括注释类型）或枚举声明*/</span></span><br><span class=\"line\">    TYPE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 字段声明（包括枚举常量）*/</span></span><br><span class=\"line\">    FIELD,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 方法声明*/</span></span><br><span class=\"line\">    METHOD,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 形式参数（形参-调用方法时传入的参数）声明 */</span></span><br><span class=\"line\">    PARAMETER,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 构造函数声明 */</span></span><br><span class=\"line\">    CONSTRUCTOR,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 局部变量声明 */</span></span><br><span class=\"line\">    LOCAL_VARIABLE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 注释类型声明 */</span></span><br><span class=\"line\">    ANNOTATION_TYPE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 包声明 */</span></span><br><span class=\"line\">    PACKAGE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 类型参数声明</span></span><br><span class=\"line\"><span class=\"comment\">     * java8新特性：</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@since</span> 1.8</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    TYPE_PARAMETER,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 任何类型声明 </span></span><br><span class=\"line\"><span class=\"comment\">     * java8新特性：</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@since</span> 1.8</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    TYPE_USE</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Retention\"><a href=\"#Retention\" class=\"headerlink\" title=\"@Retention\"></a><code>@Retention</code></h4><p>该注解表示自定义注解的生命周期</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> RetentionPolicy &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 注释将被编译器丢弃。</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    SOURCE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 注释由编译器记录在类文件中</span></span><br><span class=\"line\"><span class=\"comment\">     * 但不必在运行时由VM保留。 这是默认值</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    CLASS,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   \t *注释由编译器记录在类文件中，并且</span></span><br><span class=\"line\"><span class=\"comment\">     *在运行时由VM保留，因此可以以反射方式读取它们。</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    RUNTIME</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"写一个切面类\"><a href=\"#写一个切面类\" class=\"headerlink\" title=\"写一个切面类\"></a>写一个切面类</h2><p>因为用到了切面，所以我们要先导入<code>Spring AOP</code>这个依赖包。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--SpringBoot项目导入AOP--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-aop<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建切面类\"><a href=\"#创建切面类\" class=\"headerlink\" title=\"创建切面类\"></a>创建切面类</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Aspect</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyAnnAop</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Logger logger= LoggerFactory.getLogger(MyAnnAop.class);</span><br><span class=\"line\">    <span class=\"meta\">@Pointcut</span>(<span class=\"string\">\"@annotation(com.example.demo.annotation.MyAnn)\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ann</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Before</span>(<span class=\"string\">\"ann()\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">before</span><span class=\"params\">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class=\"line\">        logger.info(<span class=\"string\">\"打印：开始前\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@AfterReturning</span>(value = <span class=\"string\">\"ann()\"</span>,returning = <span class=\"string\">\"res\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">dochange</span><span class=\"params\">(JoinPoint joinPoint,Object res)</span></span>&#123;</span><br><span class=\"line\">        logger.info(<span class=\"string\">\"AfterReturning通知开始-获取数据:&#123;&#125;\"</span>,res);</span><br><span class=\"line\">        <span class=\"comment\">//获取数据</span></span><br><span class=\"line\">        Map&lt;String,String&gt; map= (Map&lt;String, String&gt;) res;</span><br><span class=\"line\">        <span class=\"comment\">//添加新值</span></span><br><span class=\"line\">        map.put(<span class=\"string\">\"s1\"</span>,<span class=\"string\">\"我是在AOP中添加的新值\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Spring-AOP说明\"><a href=\"#Spring-AOP说明\" class=\"headerlink\" title=\"Spring AOP说明\"></a>Spring AOP说明</h3><blockquote>\n<p>具体可以查阅Spring AOP相关资料</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>注解</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>@Before</code></td>\n<td>前置通知，在连接点方法前调用</td>\n</tr>\n<tr>\n<td><code>@Around</code></td>\n<td>环绕通知，它将覆盖原有方法，但是允许你通过反射调用原有方法</td>\n</tr>\n<tr>\n<td><code>@After</code></td>\n<td>后置通知，在连接点方法后调用</td>\n</tr>\n<tr>\n<td><code>@AfterReturning</code></td>\n<td>返回通知，在连接点方法执行并正常返回后调用，要求连接点方法在执行过程中没有发生异常</td>\n</tr>\n<tr>\n<td><code>@AfterThrowing</code></td>\n<td>异常通知，当连接点方法异常时调用</td>\n</tr>\n</tbody></table>\n<h2 id=\"使用自定义的注解\"><a href=\"#使用自定义的注解\" class=\"headerlink\" title=\"使用自定义的注解\"></a>使用自定义的注解</h2><p>这里使用普通的<code>SpringBoot</code>来使用注解，创建一个<strong>Service</strong>,在里面使用注解，然后才控制层调用</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//服务层</span></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestService</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@MyAnn</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Map <span class=\"title\">test</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        Map&lt;String,String&gt;  map=<span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">        map.put(<span class=\"string\">\"t1\"</span>,<span class=\"string\">\"我是在Service设置的值\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//控制层</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test2</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Logger logger= LoggerFactory.getLogger(Test2.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> TestService testService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">(String id)</span></span>&#123;</span><br><span class=\"line\">        Map&lt;String,String&gt; s=testService.test();</span><br><span class=\"line\">        logger.info(<span class=\"string\">\"控制层输出：&#123;&#125;\"</span>,s.get(<span class=\"string\">\"s1\"</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"sccess\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"输出\"><a href=\"#输出\" class=\"headerlink\" title=\"输出\"></a>输出</h4><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">com.example.demo.aop.MyAnnAop : AfterReturning通知开始-获取数据:&#123;t1=我是在Service设置的值&#125;</span><br><span class=\"line\">com.example.demo.web.Test2    : 控制层输出：我是在AOP中添加的新值</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><p>上面那样使用注解是没问题的，但是如果是下面这样使用，<code>AOP</code>就会<strong>失效</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test2</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Logger logger= LoggerFactory.getLogger(Test2.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> TestService testService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">(String id)</span></span>&#123;</span><br><span class=\"line\">        Map&lt;String,String&gt; s=<span class=\"keyword\">this</span>.test2();</span><br><span class=\"line\">        logger.info(<span class=\"string\">\"控制层输出：&#123;&#125;\"</span>,s.get(<span class=\"string\">\"s1\"</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"sccess\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@MyAnn</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Map <span class=\"title\">test2</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        Map&lt;String,String&gt;  map=<span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">        map.put(<span class=\"string\">\"t1\"</span>,<span class=\"string\">\"我是在控制层设置的值\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"输出-1\"><a href=\"#输出-1\" class=\"headerlink\" title=\"输出\"></a>输出</h4><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">com.example.demo.web.Test2       : 控制层输出：null</span><br></pre></td></tr></table></figure>\n\n<p>这是应为内部方法调用，调用的是具体方法，并没有调用使用AOP后生成的代理方法</p>\n<p>具体参考资料：</p>\n<ul>\n<li><a href=\"https://blog.csdn.net/Daybreak1209/article/details/82982674\" rel=\"noopener\" target=\"_blank\">https://blog.csdn.net/Daybreak1209/article/details/82982674</a></li>\n<li><a href=\"https://blog.csdn.net/u013151053/article/details/106124048?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase\" rel=\"noopener\" target=\"_blank\">https://blog.csdn.net/u013151053/article/details/106124048?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase</a></li>\n<li><a href=\"https://zhewuzhou.github.io/2018/09/01/Spring_AOP_Trap/\" rel=\"noopener\" target=\"_blank\">https://zhewuzhou.github.io/2018/09/01/Spring_AOP_Trap/</a></li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>平时在用springBoot的使用，常常会用到<code>@Service</code>，<code>@Compent</code>等等注解，简化了我们的开发流程，提升了开发效率.那如何自己来写一个注解呢？下面就来介绍一下。</p>\n<h2 id=\"写一个注解\"><a href=\"#写一个注解\" class=\"headerlink\" title=\"写一个注解\"></a>写一个注解</h2><p>创建一个注解主要分两部分，一部分是创建<strong>注解类</strong>，一部分是创建一个<strong>切面类</strong>。</p>\n<h3 id=\"创建注解类\"><a href=\"#创建注解类\" class=\"headerlink\" title=\"创建注解类\"></a>创建注解类</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Target</span>(&#123;ElementType.METHOD&#125;)</span><br><span class=\"line\"><span class=\"meta\">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"meta\">@interface</span> MyAnn &#123;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">value</span><span class=\"params\">()</span> <span class=\"keyword\">default</span> \"d\"</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>创建注解类的关键字就是<code>@interface</code>，这个注解类设置了一个<code>value</code>变量，默认值为d；</p>\n<p>在注解类上面还有<code>@Target</code>和<code>@Retention</code>注解，下面来说说创建注解类时需要用到的几个注解：</p>\n<h4 id=\"Target\"><a href=\"#Target\" class=\"headerlink\" title=\"@Target\"></a><code>@Target</code></h4><p>用来标记这个注解可以用于哪些地方，与<code>ElementType</code>枚举类搭配使用，那这个枚举类里面有什么内容呢？</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> ElementType &#123;</span><br><span class=\"line\">    <span class=\"comment\">/** 类，接口（包括注释类型）或枚举声明*/</span></span><br><span class=\"line\">    TYPE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 字段声明（包括枚举常量）*/</span></span><br><span class=\"line\">    FIELD,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 方法声明*/</span></span><br><span class=\"line\">    METHOD,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 形式参数（形参-调用方法时传入的参数）声明 */</span></span><br><span class=\"line\">    PARAMETER,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 构造函数声明 */</span></span><br><span class=\"line\">    CONSTRUCTOR,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 局部变量声明 */</span></span><br><span class=\"line\">    LOCAL_VARIABLE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 注释类型声明 */</span></span><br><span class=\"line\">    ANNOTATION_TYPE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** 包声明 */</span></span><br><span class=\"line\">    PACKAGE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 类型参数声明</span></span><br><span class=\"line\"><span class=\"comment\">     * java8新特性：</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@since</span> 1.8</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    TYPE_PARAMETER,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 任何类型声明 </span></span><br><span class=\"line\"><span class=\"comment\">     * java8新特性：</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@since</span> 1.8</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    TYPE_USE</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Retention\"><a href=\"#Retention\" class=\"headerlink\" title=\"@Retention\"></a><code>@Retention</code></h4><p>该注解表示自定义注解的生命周期</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">enum</span> RetentionPolicy &#123;</span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 注释将被编译器丢弃。</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    SOURCE,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 注释由编译器记录在类文件中</span></span><br><span class=\"line\"><span class=\"comment\">     * 但不必在运行时由VM保留。 这是默认值</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    CLASS,</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   \t *注释由编译器记录在类文件中，并且</span></span><br><span class=\"line\"><span class=\"comment\">     *在运行时由VM保留，因此可以以反射方式读取它们。</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    RUNTIME</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"写一个切面类\"><a href=\"#写一个切面类\" class=\"headerlink\" title=\"写一个切面类\"></a>写一个切面类</h2><p>因为用到了切面，所以我们要先导入<code>Spring AOP</code>这个依赖包。</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--SpringBoot项目导入AOP--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-aop<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建切面类\"><a href=\"#创建切面类\" class=\"headerlink\" title=\"创建切面类\"></a>创建切面类</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Aspect</span></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyAnnAop</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Logger logger= LoggerFactory.getLogger(MyAnnAop.class);</span><br><span class=\"line\">    <span class=\"meta\">@Pointcut</span>(<span class=\"string\">\"@annotation(com.example.demo.annotation.MyAnn)\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">ann</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Before</span>(<span class=\"string\">\"ann()\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">before</span><span class=\"params\">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class=\"line\">        logger.info(<span class=\"string\">\"打印：开始前\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@AfterReturning</span>(value = <span class=\"string\">\"ann()\"</span>,returning = <span class=\"string\">\"res\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">dochange</span><span class=\"params\">(JoinPoint joinPoint,Object res)</span></span>&#123;</span><br><span class=\"line\">        logger.info(<span class=\"string\">\"AfterReturning通知开始-获取数据:&#123;&#125;\"</span>,res);</span><br><span class=\"line\">        <span class=\"comment\">//获取数据</span></span><br><span class=\"line\">        Map&lt;String,String&gt; map= (Map&lt;String, String&gt;) res;</span><br><span class=\"line\">        <span class=\"comment\">//添加新值</span></span><br><span class=\"line\">        map.put(<span class=\"string\">\"s1\"</span>,<span class=\"string\">\"我是在AOP中添加的新值\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Spring-AOP说明\"><a href=\"#Spring-AOP说明\" class=\"headerlink\" title=\"Spring AOP说明\"></a>Spring AOP说明</h3><blockquote>\n<p>具体可以查阅Spring AOP相关资料</p>\n</blockquote>\n<table>\n<thead>\n<tr>\n<th>注解</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>@Before</code></td>\n<td>前置通知，在连接点方法前调用</td>\n</tr>\n<tr>\n<td><code>@Around</code></td>\n<td>环绕通知，它将覆盖原有方法，但是允许你通过反射调用原有方法</td>\n</tr>\n<tr>\n<td><code>@After</code></td>\n<td>后置通知，在连接点方法后调用</td>\n</tr>\n<tr>\n<td><code>@AfterReturning</code></td>\n<td>返回通知，在连接点方法执行并正常返回后调用，要求连接点方法在执行过程中没有发生异常</td>\n</tr>\n<tr>\n<td><code>@AfterThrowing</code></td>\n<td>异常通知，当连接点方法异常时调用</td>\n</tr>\n</tbody></table>\n<h2 id=\"使用自定义的注解\"><a href=\"#使用自定义的注解\" class=\"headerlink\" title=\"使用自定义的注解\"></a>使用自定义的注解</h2><p>这里使用普通的<code>SpringBoot</code>来使用注解，创建一个<strong>Service</strong>,在里面使用注解，然后才控制层调用</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//服务层</span></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestService</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@MyAnn</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Map <span class=\"title\">test</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        Map&lt;String,String&gt;  map=<span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">        map.put(<span class=\"string\">\"t1\"</span>,<span class=\"string\">\"我是在Service设置的值\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//控制层</span></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test2</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Logger logger= LoggerFactory.getLogger(Test2.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> TestService testService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">(String id)</span></span>&#123;</span><br><span class=\"line\">        Map&lt;String,String&gt; s=testService.test();</span><br><span class=\"line\">        logger.info(<span class=\"string\">\"控制层输出：&#123;&#125;\"</span>,s.get(<span class=\"string\">\"s1\"</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"sccess\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"输出\"><a href=\"#输出\" class=\"headerlink\" title=\"输出\"></a>输出</h4><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">com.example.demo.aop.MyAnnAop : AfterReturning通知开始-获取数据:&#123;t1=我是在Service设置的值&#125;</span><br><span class=\"line\">com.example.demo.web.Test2    : 控制层输出：我是在AOP中添加的新值</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><p>上面那样使用注解是没问题的，但是如果是下面这样使用，<code>AOP</code>就会<strong>失效</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test2</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Logger logger= LoggerFactory.getLogger(Test2.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> TestService testService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">(String id)</span></span>&#123;</span><br><span class=\"line\">        Map&lt;String,String&gt; s=<span class=\"keyword\">this</span>.test2();</span><br><span class=\"line\">        logger.info(<span class=\"string\">\"控制层输出：&#123;&#125;\"</span>,s.get(<span class=\"string\">\"s1\"</span>));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"sccess\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@MyAnn</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Map <span class=\"title\">test2</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        Map&lt;String,String&gt;  map=<span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">        map.put(<span class=\"string\">\"t1\"</span>,<span class=\"string\">\"我是在控制层设置的值\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> map;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"输出-1\"><a href=\"#输出-1\" class=\"headerlink\" title=\"输出\"></a>输出</h4><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">com.example.demo.web.Test2       : 控制层输出：null</span><br></pre></td></tr></table></figure>\n\n<p>这是应为内部方法调用，调用的是具体方法，并没有调用使用AOP后生成的代理方法</p>\n<p>具体参考资料：</p>\n<ul>\n<li><a href=\"https://blog.csdn.net/Daybreak1209/article/details/82982674\" rel=\"noopener\" target=\"_blank\">https://blog.csdn.net/Daybreak1209/article/details/82982674</a></li>\n<li><a href=\"https://blog.csdn.net/u013151053/article/details/106124048?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase\" rel=\"noopener\" target=\"_blank\">https://blog.csdn.net/u013151053/article/details/106124048?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase</a></li>\n<li><a href=\"https://zhewuzhou.github.io/2018/09/01/Spring_AOP_Trap/\" rel=\"noopener\" target=\"_blank\">https://zhewuzhou.github.io/2018/09/01/Spring_AOP_Trap/</a></li>\n</ul>\n"},{"title":"RocketMQ集群搭建","top":true,"cover":false,"toc":true,"mathjax":true,"date":"2019-10-09T12:55:36.000Z","password":null,"summary":null,"_content":"\n  本文只讲RocketMQ集群的搭建(异步复制)，具体理论知识后续会在写新文章详细介绍;\n\n\n\n## 环境\n\n- JDK1.8\n- Centos7\n\n\n\n## 主机-两台\n\n- centos7_1 :172.16.54.130\n- centos7_2 :172.16.54.128\n\n\n\n## 软件资源\n\n- JDK1.8 :https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html\n- RocketMQ4.5.2 :http://mirrors.tuna.tsinghua.edu.cn/apache/rocketmq/4.5.2/rocketmq-all-4.5.2-bin-release.zip\n\n\n\n## 安装JDK\n\n  首先分别在两台主机上安装JDK1.8，具体安装方法这里就不说了，网上随便搜一搜都有；\n\n\n\n## 配置RocketMQ\n\n  把下载的RocketMQ包分别上传到两台服务器上，然后用命令解压:\n\n  ```shell\n# unzip rocketmq-all-4.5.2-bin-release.zip\n  ```\n\n### 编写配置文件\n\n  这一步很重要，集群的搭建关键在于配置文件的编写，首先看看RocketMq配置文件的解析:\n\n```properties\n#所属集群名字 \nbrokerClusterName=rocketmq-cluster\n\n#broker名字，每队master和slave保持一致\nbrokerName=broker-a\n\n#0 表示 Master，>0 表示 Slave\nbrokerId=0 \n\n#指定主机ip\nbrokerIP1 = 主机IP\n\n#nameServer地址，分号分割\nnamesrvAddr=主机IP:9876;主机IP:9876\n\n#在发送消息时，自动创建服务器不存在的topic，默认创建的队列数 \ndefaultTopicQueueNums=4\n\n#是否允许 Broker 自动创建Topic，建议线下开启，线上关闭 \nautoCreateTopicEnable=true\n\n#是否允许 Broker 自动创建订阅组，建议线下开启，线上关闭 \nautoCreateSubscriptionGroup=true\n\n#Broker 对外服务的监听端口 \nlistenPort=10911\n\n#删除文件时间点，默认凌晨 4点\n deleteWhen=04\n\n#文件保留时间，默认 48 小时 \nfileReservedTime=120\n\n#commitLog每个文件的大小默认1G \nmapedFileSizeCommitLog=1073741824\n\n#ConsumeQueue每个文件默认存30W条，根据业务情况调整\nmapedFileSizeConsumeQueue=300000\n\n#检测物理文件磁盘空间\ndiskMaxUsedSpaceRatio=88\n\n#存储路径\nstorePathRootDir=/usr/local/rocketmq/store\n#commitLog 存储路径 \nstorePathCommitLog=/usr/local/rocketmq/store/commitlog\n#消费队列存储路径存储路径\nstorePathConsumeQueue=/usr/local/rocketmq/store/consumequeue\n#消息索引存储路径\nstorePathIndex=/usr/local/rocketmq/store/index\n#checkpoint 文件存储路径\nstoreCheckpoint=/usr/local/rocketmq/store/checkpoint\n\n#Broker 的角色\n#- ASYNC_MASTER 异步复制Master\n#- SYNC_MASTER 同步双写Master\n#- SLAVE \nbrokerRole=ASYNC_MASTER\n\n#刷盘方式\n#- ASYNC_FLUSH 异步刷盘\n#- SYNC_FLUSH 同步刷盘 flushDiskType=ASYNC_FLUSH\n#checkTransactionMessageEnable=false\n\n#abort 文件存储路径\nabortFile=/usr/javawork/apache-rocketmq/store/abort\n\n#限制的消息大小 maxMessageSize=65536\n```\n\n以上配置可根据个人需求加入到自己的配置文件中；RocketMQ官方已经为我们创建好了简单的集群配置文件，进去解压后的文件夹，在进入到conf文件夹，可以看到里面有三个文件夹：\n\n- 2m-2s-async :2个master，2个slave，async异步复制\n- 2m-2s-sync :2个master，2个slave，sync同步双写\n- 2m-noslave :2个master,没有slave\n\n这里我们用async异步复制模式，进入文件夹，分别编辑：\n\n#### centos7_1主机编辑如下两个配置文件\n\n> 注意，master和slave的文件存储路径不能用同一个路径，所以必须要区分开。\n\n##### broker-a.properties\n\n```properties\nbrokerClusterName=DefaultCluster\nbrokerName=broker-a\nbrokerId=0\ndeleteWhen=04\nfileReservedTime=48\nbrokerRole=ASYNC_MASTER\nflushDiskType=ASYNC_FLUSH\nnamesrvAddr=172.16.54.128:9876;172.16.54.130:9876\nlistenPort=10911\n#存储路径\nstorePathRootDir=/usr/local/rocketmq/master/store\n#commitLog 存储路径 \nstorePathCommitLog=/usr/local/rocketmq/master/store/commitlog\n#消费队列存储路径存储路径\nstorePathConsumeQueue=/usr/local/rocketmq/master/store/consumequeue\n#消息索引存储路径\nstorePathIndex=/usr/local/rocketmq/master/store/index\n#checkpoint 文件存储路径\nstoreCheckpoint=/usr/local/rocketmq/master/store/checkpoint\n```\n\n*这个监听端口设置设置成10911后还会自动监听10909,10912这两个端口，所以要配置文件要避免设置到相应的端口。*\n\n##### broker-a-s.properties\n\n```properties\nbrokerClusterName=DefaultCluster\nbrokerName=broker-a\nbrokerId=1\ndeleteWhen=04\nfileReservedTime=48\nbrokerRole=SLAVE\nflushDiskType=ASYNC_FLUSH\nnamesrvAddr=172.16.54.128:9876;172.16.54.130:9876\nlistenPort=20911\n#存储路径\nstorePathRootDir=/usr/local/rocketmq/slave/store\n#commitLog 存储路径 \nstorePathCommitLog=/usr/local/rocketmq/slave/store/commitlog\n#消费队列存储路径存储路径\nstorePathConsumeQueue=/usr/local/rocketmq/slave/store/consumequeue\n#消息索引存储路径\nstorePathIndex=/usr/local/rocketmq/slave/store/index\n#checkpoint 文件存储路径\nstoreCheckpoint=/usr/local/rocketmq/slave/store/checkpoint\n```\n\n*这个监听端口设置设置成20911后还会自动监听20909,20912这两个端口，所以要配置文件要避免设置到相应的端口。*\n\n\n\n#### centos7_2主机编辑如下两个配置文件\n\n##### 和centos7_1主机配置一样，这边就不写了，不过brokerName要设置成不同的，我这边设置成broker-b。\n\n\n\n## 设置RocketMQ运行的JVM内存(非必须)\n\n> 此项设置非必须，如果你主机内存很大的话可以不设置，RocketMQ默认要8G。\n\n  进入rocketmq-all-4.5.2-bin-release/bin目录，两台主机分别设置runbroker.sh和runserver.sh这两个文件。\n\n- runbroker.sh：找到如下一行配置\n\n```properties\nJAVA_OPT=\"${JAVA_OPT} -server -Xms8g -Xmx8g -Xmn4g\"\n\n改成：\nJAVA_OPT=\"${JAVA_OPT} -server -Xms512m -Xmx512m -Xmn256m\"\n```\n\n- runserver.sh: 找到如下一行配置\n\n```properties\nJAVA_OPT=\"${JAVA_OPT} -server -Xms4g -Xmx4g -Xmn2g -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m\"\n\n改成：\nJAVA_OPT=\"${JAVA_OPT} -server -Xms512m -Xmx512m -Xmn256m -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m\"\n```\n\n\n\n## 启动RocketMQ\n\n> 启动RocketMQ前为了方便访问，先关闭两台主机的防火墙。执行如下命令：\n>\n> ```shell\n> # service firewalld stop\n> ```\n>\n> \n\n  进入rocketmq-all-4.5.2-bin-release/bin这个目录，两台主机分别执行以下命令：\n\n- 启动namesrv\n\n```shell\n# nohup sh mqnamesrv &\n```\n\n- 启动broker-master\n\n```shell\n# nohup sh mqbroker -c ../conf/2m-2s-async/broker-a.properties &\n```\n\n- 启动broker-slave\n\n```shell\n# nohup sh mqbroker -c ../conf/2m-2s-async/broker-a-s.properties &\n```\n\n*注意两台主机启动broker时后面的-c记得加载你配置好的配置文件路径，别加载错了*\n\n\n\n## 搭建Console可视化控制台\n\n  任意一台机器或者本地下载Console源码，地址：https://github.com/apache/rocketmq-externals，或者有git的话直接用命令拉取：\n\n```shell\n# git clone https://github.com/apache/rocketmq-externals.git\n```\n\n进去目录：\n\n```shell\n# cd rocketmq-externals-master/rocketmq-console\n```\n\n修改配置文件：\n\n```shell\n# vim src/main/resources/application.properties\n```\n\n添加两个namesvr的主机ip\n\n```properties\nrocketmq.config.namesrvAddr=172.16.54.128:9876;172.16.54.130:9876\n```\n\n然后进项目跟目录，运行项目\n\n```shell\n# mvn sprint-boot:run\n```\n\n浏览器访问：\n\n![可视化Console界面](http://cdn.mjava.top/blog/rocketmq_console.png)","source":"_posts/rocketmq/rocketmq-cluster-build.md","raw":"---\ntitle: RocketMQ集群搭建\ntop: true\ncover: false\ntoc: true\nmathjax: true\ntags:\n  - RocketMQ\n  - Linux\ncategories:\n  - RocketMq\ndate: 2019-10-09 20:55:36\npassword:\nsummary:\n---\n\n  本文只讲RocketMQ集群的搭建(异步复制)，具体理论知识后续会在写新文章详细介绍;\n\n\n\n## 环境\n\n- JDK1.8\n- Centos7\n\n\n\n## 主机-两台\n\n- centos7_1 :172.16.54.130\n- centos7_2 :172.16.54.128\n\n\n\n## 软件资源\n\n- JDK1.8 :https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html\n- RocketMQ4.5.2 :http://mirrors.tuna.tsinghua.edu.cn/apache/rocketmq/4.5.2/rocketmq-all-4.5.2-bin-release.zip\n\n\n\n## 安装JDK\n\n  首先分别在两台主机上安装JDK1.8，具体安装方法这里就不说了，网上随便搜一搜都有；\n\n\n\n## 配置RocketMQ\n\n  把下载的RocketMQ包分别上传到两台服务器上，然后用命令解压:\n\n  ```shell\n# unzip rocketmq-all-4.5.2-bin-release.zip\n  ```\n\n### 编写配置文件\n\n  这一步很重要，集群的搭建关键在于配置文件的编写，首先看看RocketMq配置文件的解析:\n\n```properties\n#所属集群名字 \nbrokerClusterName=rocketmq-cluster\n\n#broker名字，每队master和slave保持一致\nbrokerName=broker-a\n\n#0 表示 Master，>0 表示 Slave\nbrokerId=0 \n\n#指定主机ip\nbrokerIP1 = 主机IP\n\n#nameServer地址，分号分割\nnamesrvAddr=主机IP:9876;主机IP:9876\n\n#在发送消息时，自动创建服务器不存在的topic，默认创建的队列数 \ndefaultTopicQueueNums=4\n\n#是否允许 Broker 自动创建Topic，建议线下开启，线上关闭 \nautoCreateTopicEnable=true\n\n#是否允许 Broker 自动创建订阅组，建议线下开启，线上关闭 \nautoCreateSubscriptionGroup=true\n\n#Broker 对外服务的监听端口 \nlistenPort=10911\n\n#删除文件时间点，默认凌晨 4点\n deleteWhen=04\n\n#文件保留时间，默认 48 小时 \nfileReservedTime=120\n\n#commitLog每个文件的大小默认1G \nmapedFileSizeCommitLog=1073741824\n\n#ConsumeQueue每个文件默认存30W条，根据业务情况调整\nmapedFileSizeConsumeQueue=300000\n\n#检测物理文件磁盘空间\ndiskMaxUsedSpaceRatio=88\n\n#存储路径\nstorePathRootDir=/usr/local/rocketmq/store\n#commitLog 存储路径 \nstorePathCommitLog=/usr/local/rocketmq/store/commitlog\n#消费队列存储路径存储路径\nstorePathConsumeQueue=/usr/local/rocketmq/store/consumequeue\n#消息索引存储路径\nstorePathIndex=/usr/local/rocketmq/store/index\n#checkpoint 文件存储路径\nstoreCheckpoint=/usr/local/rocketmq/store/checkpoint\n\n#Broker 的角色\n#- ASYNC_MASTER 异步复制Master\n#- SYNC_MASTER 同步双写Master\n#- SLAVE \nbrokerRole=ASYNC_MASTER\n\n#刷盘方式\n#- ASYNC_FLUSH 异步刷盘\n#- SYNC_FLUSH 同步刷盘 flushDiskType=ASYNC_FLUSH\n#checkTransactionMessageEnable=false\n\n#abort 文件存储路径\nabortFile=/usr/javawork/apache-rocketmq/store/abort\n\n#限制的消息大小 maxMessageSize=65536\n```\n\n以上配置可根据个人需求加入到自己的配置文件中；RocketMQ官方已经为我们创建好了简单的集群配置文件，进去解压后的文件夹，在进入到conf文件夹，可以看到里面有三个文件夹：\n\n- 2m-2s-async :2个master，2个slave，async异步复制\n- 2m-2s-sync :2个master，2个slave，sync同步双写\n- 2m-noslave :2个master,没有slave\n\n这里我们用async异步复制模式，进入文件夹，分别编辑：\n\n#### centos7_1主机编辑如下两个配置文件\n\n> 注意，master和slave的文件存储路径不能用同一个路径，所以必须要区分开。\n\n##### broker-a.properties\n\n```properties\nbrokerClusterName=DefaultCluster\nbrokerName=broker-a\nbrokerId=0\ndeleteWhen=04\nfileReservedTime=48\nbrokerRole=ASYNC_MASTER\nflushDiskType=ASYNC_FLUSH\nnamesrvAddr=172.16.54.128:9876;172.16.54.130:9876\nlistenPort=10911\n#存储路径\nstorePathRootDir=/usr/local/rocketmq/master/store\n#commitLog 存储路径 \nstorePathCommitLog=/usr/local/rocketmq/master/store/commitlog\n#消费队列存储路径存储路径\nstorePathConsumeQueue=/usr/local/rocketmq/master/store/consumequeue\n#消息索引存储路径\nstorePathIndex=/usr/local/rocketmq/master/store/index\n#checkpoint 文件存储路径\nstoreCheckpoint=/usr/local/rocketmq/master/store/checkpoint\n```\n\n*这个监听端口设置设置成10911后还会自动监听10909,10912这两个端口，所以要配置文件要避免设置到相应的端口。*\n\n##### broker-a-s.properties\n\n```properties\nbrokerClusterName=DefaultCluster\nbrokerName=broker-a\nbrokerId=1\ndeleteWhen=04\nfileReservedTime=48\nbrokerRole=SLAVE\nflushDiskType=ASYNC_FLUSH\nnamesrvAddr=172.16.54.128:9876;172.16.54.130:9876\nlistenPort=20911\n#存储路径\nstorePathRootDir=/usr/local/rocketmq/slave/store\n#commitLog 存储路径 \nstorePathCommitLog=/usr/local/rocketmq/slave/store/commitlog\n#消费队列存储路径存储路径\nstorePathConsumeQueue=/usr/local/rocketmq/slave/store/consumequeue\n#消息索引存储路径\nstorePathIndex=/usr/local/rocketmq/slave/store/index\n#checkpoint 文件存储路径\nstoreCheckpoint=/usr/local/rocketmq/slave/store/checkpoint\n```\n\n*这个监听端口设置设置成20911后还会自动监听20909,20912这两个端口，所以要配置文件要避免设置到相应的端口。*\n\n\n\n#### centos7_2主机编辑如下两个配置文件\n\n##### 和centos7_1主机配置一样，这边就不写了，不过brokerName要设置成不同的，我这边设置成broker-b。\n\n\n\n## 设置RocketMQ运行的JVM内存(非必须)\n\n> 此项设置非必须，如果你主机内存很大的话可以不设置，RocketMQ默认要8G。\n\n  进入rocketmq-all-4.5.2-bin-release/bin目录，两台主机分别设置runbroker.sh和runserver.sh这两个文件。\n\n- runbroker.sh：找到如下一行配置\n\n```properties\nJAVA_OPT=\"${JAVA_OPT} -server -Xms8g -Xmx8g -Xmn4g\"\n\n改成：\nJAVA_OPT=\"${JAVA_OPT} -server -Xms512m -Xmx512m -Xmn256m\"\n```\n\n- runserver.sh: 找到如下一行配置\n\n```properties\nJAVA_OPT=\"${JAVA_OPT} -server -Xms4g -Xmx4g -Xmn2g -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m\"\n\n改成：\nJAVA_OPT=\"${JAVA_OPT} -server -Xms512m -Xmx512m -Xmn256m -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m\"\n```\n\n\n\n## 启动RocketMQ\n\n> 启动RocketMQ前为了方便访问，先关闭两台主机的防火墙。执行如下命令：\n>\n> ```shell\n> # service firewalld stop\n> ```\n>\n> \n\n  进入rocketmq-all-4.5.2-bin-release/bin这个目录，两台主机分别执行以下命令：\n\n- 启动namesrv\n\n```shell\n# nohup sh mqnamesrv &\n```\n\n- 启动broker-master\n\n```shell\n# nohup sh mqbroker -c ../conf/2m-2s-async/broker-a.properties &\n```\n\n- 启动broker-slave\n\n```shell\n# nohup sh mqbroker -c ../conf/2m-2s-async/broker-a-s.properties &\n```\n\n*注意两台主机启动broker时后面的-c记得加载你配置好的配置文件路径，别加载错了*\n\n\n\n## 搭建Console可视化控制台\n\n  任意一台机器或者本地下载Console源码，地址：https://github.com/apache/rocketmq-externals，或者有git的话直接用命令拉取：\n\n```shell\n# git clone https://github.com/apache/rocketmq-externals.git\n```\n\n进去目录：\n\n```shell\n# cd rocketmq-externals-master/rocketmq-console\n```\n\n修改配置文件：\n\n```shell\n# vim src/main/resources/application.properties\n```\n\n添加两个namesvr的主机ip\n\n```properties\nrocketmq.config.namesrvAddr=172.16.54.128:9876;172.16.54.130:9876\n```\n\n然后进项目跟目录，运行项目\n\n```shell\n# mvn sprint-boot:run\n```\n\n浏览器访问：\n\n![可视化Console界面](http://cdn.mjava.top/blog/rocketmq_console.png)","slug":"rocketmq/rocketmq-cluster-build","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bke003j2mg56pypg84j","content":"<p>  本文只讲RocketMQ集群的搭建(异步复制)，具体理论知识后续会在写新文章详细介绍;</p>\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><ul>\n<li>JDK1.8</li>\n<li>Centos7</li>\n</ul>\n<h2 id=\"主机-两台\"><a href=\"#主机-两台\" class=\"headerlink\" title=\"主机-两台\"></a>主机-两台</h2><ul>\n<li>centos7_1 :172.16.54.130</li>\n<li>centos7_2 :172.16.54.128</li>\n</ul>\n<h2 id=\"软件资源\"><a href=\"#软件资源\" class=\"headerlink\" title=\"软件资源\"></a>软件资源</h2><ul>\n<li>JDK1.8 :<a href=\"https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html\" rel=\"noopener\" target=\"_blank\">https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a></li>\n<li>RocketMQ4.5.2 :<a href=\"http://mirrors.tuna.tsinghua.edu.cn/apache/rocketmq/4.5.2/rocketmq-all-4.5.2-bin-release.zip\" rel=\"noopener\" target=\"_blank\">http://mirrors.tuna.tsinghua.edu.cn/apache/rocketmq/4.5.2/rocketmq-all-4.5.2-bin-release.zip</a></li>\n</ul>\n<h2 id=\"安装JDK\"><a href=\"#安装JDK\" class=\"headerlink\" title=\"安装JDK\"></a>安装JDK</h2><p>  首先分别在两台主机上安装JDK1.8，具体安装方法这里就不说了，网上随便搜一搜都有；</p>\n<h2 id=\"配置RocketMQ\"><a href=\"#配置RocketMQ\" class=\"headerlink\" title=\"配置RocketMQ\"></a>配置RocketMQ</h2><p>  把下载的RocketMQ包分别上传到两台服务器上，然后用命令解压:</p>\n  <figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> unzip rocketmq-all-4.5.2-bin-release.zip</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"编写配置文件\"><a href=\"#编写配置文件\" class=\"headerlink\" title=\"编写配置文件\"></a>编写配置文件</h3><p>  这一步很重要，集群的搭建关键在于配置文件的编写，首先看看RocketMq配置文件的解析:</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#所属集群名字 </span></span><br><span class=\"line\"><span class=\"attr\">brokerClusterName</span>=<span class=\"string\">rocketmq-cluster</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#broker名字，每队master和slave保持一致</span></span><br><span class=\"line\"><span class=\"attr\">brokerName</span>=<span class=\"string\">broker-a</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#0 表示 Master，&gt;0 表示 Slave</span></span><br><span class=\"line\"><span class=\"attr\">brokerId</span>=<span class=\"string\">0 </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#指定主机ip</span></span><br><span class=\"line\"><span class=\"attr\">brokerIP1</span> = <span class=\"string\">主机IP</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#nameServer地址，分号分割</span></span><br><span class=\"line\"><span class=\"attr\">namesrvAddr</span>=<span class=\"string\">主机IP:9876;主机IP:9876</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#在发送消息时，自动创建服务器不存在的topic，默认创建的队列数 </span></span><br><span class=\"line\"><span class=\"attr\">defaultTopicQueueNums</span>=<span class=\"string\">4</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#是否允许 Broker 自动创建Topic，建议线下开启，线上关闭 </span></span><br><span class=\"line\"><span class=\"attr\">autoCreateTopicEnable</span>=<span class=\"string\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#是否允许 Broker 自动创建订阅组，建议线下开启，线上关闭 </span></span><br><span class=\"line\"><span class=\"attr\">autoCreateSubscriptionGroup</span>=<span class=\"string\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Broker 对外服务的监听端口 </span></span><br><span class=\"line\"><span class=\"attr\">listenPort</span>=<span class=\"string\">10911</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#删除文件时间点，默认凌晨 4点</span></span><br><span class=\"line\"> <span class=\"attr\">deleteWhen</span>=<span class=\"string\">04</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#文件保留时间，默认 48 小时 </span></span><br><span class=\"line\"><span class=\"attr\">fileReservedTime</span>=<span class=\"string\">120</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#commitLog每个文件的大小默认1G </span></span><br><span class=\"line\"><span class=\"attr\">mapedFileSizeCommitLog</span>=<span class=\"string\">1073741824</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ConsumeQueue每个文件默认存30W条，根据业务情况调整</span></span><br><span class=\"line\"><span class=\"attr\">mapedFileSizeConsumeQueue</span>=<span class=\"string\">300000</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#检测物理文件磁盘空间</span></span><br><span class=\"line\"><span class=\"attr\">diskMaxUsedSpaceRatio</span>=<span class=\"string\">88</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathRootDir</span>=<span class=\"string\">/usr/local/rocketmq/store</span></span><br><span class=\"line\"><span class=\"comment\">#commitLog 存储路径 </span></span><br><span class=\"line\"><span class=\"attr\">storePathCommitLog</span>=<span class=\"string\">/usr/local/rocketmq/store/commitlog</span></span><br><span class=\"line\"><span class=\"comment\">#消费队列存储路径存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathConsumeQueue</span>=<span class=\"string\">/usr/local/rocketmq/store/consumequeue</span></span><br><span class=\"line\"><span class=\"comment\">#消息索引存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathIndex</span>=<span class=\"string\">/usr/local/rocketmq/store/index</span></span><br><span class=\"line\"><span class=\"comment\">#checkpoint 文件存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storeCheckpoint</span>=<span class=\"string\">/usr/local/rocketmq/store/checkpoint</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Broker 的角色</span></span><br><span class=\"line\"><span class=\"comment\">#- ASYNC_MASTER 异步复制Master</span></span><br><span class=\"line\"><span class=\"comment\">#- SYNC_MASTER 同步双写Master</span></span><br><span class=\"line\"><span class=\"comment\">#- SLAVE </span></span><br><span class=\"line\"><span class=\"attr\">brokerRole</span>=<span class=\"string\">ASYNC_MASTER</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#刷盘方式</span></span><br><span class=\"line\"><span class=\"comment\">#- ASYNC_FLUSH 异步刷盘</span></span><br><span class=\"line\"><span class=\"comment\">#- SYNC_FLUSH 同步刷盘 flushDiskType=ASYNC_FLUSH</span></span><br><span class=\"line\"><span class=\"comment\">#checkTransactionMessageEnable=false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#abort 文件存储路径</span></span><br><span class=\"line\"><span class=\"attr\">abortFile</span>=<span class=\"string\">/usr/javawork/apache-rocketmq/store/abort</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#限制的消息大小 maxMessageSize=65536</span></span><br></pre></td></tr></table></figure>\n\n<p>以上配置可根据个人需求加入到自己的配置文件中；RocketMQ官方已经为我们创建好了简单的集群配置文件，进去解压后的文件夹，在进入到conf文件夹，可以看到里面有三个文件夹：</p>\n<ul>\n<li>2m-2s-async :2个master，2个slave，async异步复制</li>\n<li>2m-2s-sync :2个master，2个slave，sync同步双写</li>\n<li>2m-noslave :2个master,没有slave</li>\n</ul>\n<p>这里我们用async异步复制模式，进入文件夹，分别编辑：</p>\n<h4 id=\"centos7-1主机编辑如下两个配置文件\"><a href=\"#centos7-1主机编辑如下两个配置文件\" class=\"headerlink\" title=\"centos7_1主机编辑如下两个配置文件\"></a>centos7_1主机编辑如下两个配置文件</h4><blockquote>\n<p>注意，master和slave的文件存储路径不能用同一个路径，所以必须要区分开。</p>\n</blockquote>\n<h5 id=\"broker-a-properties\"><a href=\"#broker-a-properties\" class=\"headerlink\" title=\"broker-a.properties\"></a>broker-a.properties</h5><figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">brokerClusterName</span>=<span class=\"string\">DefaultCluster</span></span><br><span class=\"line\"><span class=\"attr\">brokerName</span>=<span class=\"string\">broker-a</span></span><br><span class=\"line\"><span class=\"attr\">brokerId</span>=<span class=\"string\">0</span></span><br><span class=\"line\"><span class=\"attr\">deleteWhen</span>=<span class=\"string\">04</span></span><br><span class=\"line\"><span class=\"attr\">fileReservedTime</span>=<span class=\"string\">48</span></span><br><span class=\"line\"><span class=\"attr\">brokerRole</span>=<span class=\"string\">ASYNC_MASTER</span></span><br><span class=\"line\"><span class=\"attr\">flushDiskType</span>=<span class=\"string\">ASYNC_FLUSH</span></span><br><span class=\"line\"><span class=\"attr\">namesrvAddr</span>=<span class=\"string\">172.16.54.128:9876;172.16.54.130:9876</span></span><br><span class=\"line\"><span class=\"attr\">listenPort</span>=<span class=\"string\">10911</span></span><br><span class=\"line\"><span class=\"comment\">#存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathRootDir</span>=<span class=\"string\">/usr/local/rocketmq/master/store</span></span><br><span class=\"line\"><span class=\"comment\">#commitLog 存储路径 </span></span><br><span class=\"line\"><span class=\"attr\">storePathCommitLog</span>=<span class=\"string\">/usr/local/rocketmq/master/store/commitlog</span></span><br><span class=\"line\"><span class=\"comment\">#消费队列存储路径存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathConsumeQueue</span>=<span class=\"string\">/usr/local/rocketmq/master/store/consumequeue</span></span><br><span class=\"line\"><span class=\"comment\">#消息索引存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathIndex</span>=<span class=\"string\">/usr/local/rocketmq/master/store/index</span></span><br><span class=\"line\"><span class=\"comment\">#checkpoint 文件存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storeCheckpoint</span>=<span class=\"string\">/usr/local/rocketmq/master/store/checkpoint</span></span><br></pre></td></tr></table></figure>\n\n<p><em>这个监听端口设置设置成10911后还会自动监听10909,10912这两个端口，所以要配置文件要避免设置到相应的端口。</em></p>\n<h5 id=\"broker-a-s-properties\"><a href=\"#broker-a-s-properties\" class=\"headerlink\" title=\"broker-a-s.properties\"></a>broker-a-s.properties</h5><figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">brokerClusterName</span>=<span class=\"string\">DefaultCluster</span></span><br><span class=\"line\"><span class=\"attr\">brokerName</span>=<span class=\"string\">broker-a</span></span><br><span class=\"line\"><span class=\"attr\">brokerId</span>=<span class=\"string\">1</span></span><br><span class=\"line\"><span class=\"attr\">deleteWhen</span>=<span class=\"string\">04</span></span><br><span class=\"line\"><span class=\"attr\">fileReservedTime</span>=<span class=\"string\">48</span></span><br><span class=\"line\"><span class=\"attr\">brokerRole</span>=<span class=\"string\">SLAVE</span></span><br><span class=\"line\"><span class=\"attr\">flushDiskType</span>=<span class=\"string\">ASYNC_FLUSH</span></span><br><span class=\"line\"><span class=\"attr\">namesrvAddr</span>=<span class=\"string\">172.16.54.128:9876;172.16.54.130:9876</span></span><br><span class=\"line\"><span class=\"attr\">listenPort</span>=<span class=\"string\">20911</span></span><br><span class=\"line\"><span class=\"comment\">#存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathRootDir</span>=<span class=\"string\">/usr/local/rocketmq/slave/store</span></span><br><span class=\"line\"><span class=\"comment\">#commitLog 存储路径 </span></span><br><span class=\"line\"><span class=\"attr\">storePathCommitLog</span>=<span class=\"string\">/usr/local/rocketmq/slave/store/commitlog</span></span><br><span class=\"line\"><span class=\"comment\">#消费队列存储路径存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathConsumeQueue</span>=<span class=\"string\">/usr/local/rocketmq/slave/store/consumequeue</span></span><br><span class=\"line\"><span class=\"comment\">#消息索引存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathIndex</span>=<span class=\"string\">/usr/local/rocketmq/slave/store/index</span></span><br><span class=\"line\"><span class=\"comment\">#checkpoint 文件存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storeCheckpoint</span>=<span class=\"string\">/usr/local/rocketmq/slave/store/checkpoint</span></span><br></pre></td></tr></table></figure>\n\n<p><em>这个监听端口设置设置成20911后还会自动监听20909,20912这两个端口，所以要配置文件要避免设置到相应的端口。</em></p>\n<h4 id=\"centos7-2主机编辑如下两个配置文件\"><a href=\"#centos7-2主机编辑如下两个配置文件\" class=\"headerlink\" title=\"centos7_2主机编辑如下两个配置文件\"></a>centos7_2主机编辑如下两个配置文件</h4><h5 id=\"和centos7-1主机配置一样，这边就不写了，不过brokerName要设置成不同的，我这边设置成broker-b。\"><a href=\"#和centos7-1主机配置一样，这边就不写了，不过brokerName要设置成不同的，我这边设置成broker-b。\" class=\"headerlink\" title=\"和centos7_1主机配置一样，这边就不写了，不过brokerName要设置成不同的，我这边设置成broker-b。\"></a>和centos7_1主机配置一样，这边就不写了，不过brokerName要设置成不同的，我这边设置成broker-b。</h5><h2 id=\"设置RocketMQ运行的JVM内存-非必须\"><a href=\"#设置RocketMQ运行的JVM内存-非必须\" class=\"headerlink\" title=\"设置RocketMQ运行的JVM内存(非必须)\"></a>设置RocketMQ运行的JVM内存(非必须)</h2><blockquote>\n<p>此项设置非必须，如果你主机内存很大的话可以不设置，RocketMQ默认要8G。</p>\n</blockquote>\n<p>  进入rocketmq-all-4.5.2-bin-release/bin目录，两台主机分别设置runbroker.sh和runserver.sh这两个文件。</p>\n<ul>\n<li>runbroker.sh：找到如下一行配置</li>\n</ul>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">JAVA_OPT</span>=<span class=\"string\">\"$&#123;JAVA_OPT&#125; -server -Xms8g -Xmx8g -Xmn4g\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">改成：</span></span><br><span class=\"line\"><span class=\"attr\">JAVA_OPT</span>=<span class=\"string\">\"$&#123;JAVA_OPT&#125; -server -Xms512m -Xmx512m -Xmn256m\"</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>runserver.sh: 找到如下一行配置</li>\n</ul>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">JAVA_OPT</span>=<span class=\"string\">\"$&#123;JAVA_OPT&#125; -server -Xms4g -Xmx4g -Xmn2g -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">改成：</span></span><br><span class=\"line\"><span class=\"attr\">JAVA_OPT</span>=<span class=\"string\">\"$&#123;JAVA_OPT&#125; -server -Xms512m -Xmx512m -Xmn256m -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m\"</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"启动RocketMQ\"><a href=\"#启动RocketMQ\" class=\"headerlink\" title=\"启动RocketMQ\"></a>启动RocketMQ</h2><blockquote>\n<p>启动RocketMQ前为了方便访问，先关闭两台主机的防火墙。执行如下命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> <span class=\"comment\"># service firewalld stop</span></span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"></span></span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n</blockquote>\n<p>  进入rocketmq-all-4.5.2-bin-release/bin这个目录，两台主机分别执行以下命令：</p>\n<ul>\n<li>启动namesrv</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> nohup sh mqnamesrv &amp;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>启动broker-master</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> nohup sh mqbroker -c ../conf/2m-2s-async/broker-a.properties &amp;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>启动broker-slave</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> nohup sh mqbroker -c ../conf/2m-2s-async/broker<span class=\"_\">-a</span>-s.properties &amp;</span></span><br></pre></td></tr></table></figure>\n\n<p><em>注意两台主机启动broker时后面的-c记得加载你配置好的配置文件路径，别加载错了</em></p>\n<h2 id=\"搭建Console可视化控制台\"><a href=\"#搭建Console可视化控制台\" class=\"headerlink\" title=\"搭建Console可视化控制台\"></a>搭建Console可视化控制台</h2><p>  任意一台机器或者本地下载Console源码，地址：<a href=\"https://github.com/apache/rocketmq-externals，或者有git的话直接用命令拉取：\" rel=\"noopener\" target=\"_blank\">https://github.com/apache/rocketmq-externals，或者有git的话直接用命令拉取：</a></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> git <span class=\"built_in\">clone</span> https://github.com/apache/rocketmq-externals.git</span></span><br></pre></td></tr></table></figure>\n\n<p>进去目录：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> <span class=\"built_in\">cd</span> rocketmq-externals-master/rocketmq-console</span></span><br></pre></td></tr></table></figure>\n\n<p>修改配置文件：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> vim src/main/resources/application.properties</span></span><br></pre></td></tr></table></figure>\n\n<p>添加两个namesvr的主机ip</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">rocketmq.config.namesrvAddr</span>=<span class=\"string\">172.16.54.128:9876;172.16.54.130:9876</span></span><br></pre></td></tr></table></figure>\n\n<p>然后进项目跟目录，运行项目</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> mvn sprint-boot:run</span></span><br></pre></td></tr></table></figure>\n\n<p>浏览器访问：</p>\n<p><img src=\"http://cdn.mjava.top/blog/rocketmq_console.png\" alt=\"可视化Console界面\"></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p>  本文只讲RocketMQ集群的搭建(异步复制)，具体理论知识后续会在写新文章详细介绍;</p>\n<h2 id=\"环境\"><a href=\"#环境\" class=\"headerlink\" title=\"环境\"></a>环境</h2><ul>\n<li>JDK1.8</li>\n<li>Centos7</li>\n</ul>\n<h2 id=\"主机-两台\"><a href=\"#主机-两台\" class=\"headerlink\" title=\"主机-两台\"></a>主机-两台</h2><ul>\n<li>centos7_1 :172.16.54.130</li>\n<li>centos7_2 :172.16.54.128</li>\n</ul>\n<h2 id=\"软件资源\"><a href=\"#软件资源\" class=\"headerlink\" title=\"软件资源\"></a>软件资源</h2><ul>\n<li>JDK1.8 :<a href=\"https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html\" rel=\"noopener\" target=\"_blank\">https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</a></li>\n<li>RocketMQ4.5.2 :<a href=\"http://mirrors.tuna.tsinghua.edu.cn/apache/rocketmq/4.5.2/rocketmq-all-4.5.2-bin-release.zip\" rel=\"noopener\" target=\"_blank\">http://mirrors.tuna.tsinghua.edu.cn/apache/rocketmq/4.5.2/rocketmq-all-4.5.2-bin-release.zip</a></li>\n</ul>\n<h2 id=\"安装JDK\"><a href=\"#安装JDK\" class=\"headerlink\" title=\"安装JDK\"></a>安装JDK</h2><p>  首先分别在两台主机上安装JDK1.8，具体安装方法这里就不说了，网上随便搜一搜都有；</p>\n<h2 id=\"配置RocketMQ\"><a href=\"#配置RocketMQ\" class=\"headerlink\" title=\"配置RocketMQ\"></a>配置RocketMQ</h2><p>  把下载的RocketMQ包分别上传到两台服务器上，然后用命令解压:</p>\n  <figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> unzip rocketmq-all-4.5.2-bin-release.zip</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"编写配置文件\"><a href=\"#编写配置文件\" class=\"headerlink\" title=\"编写配置文件\"></a>编写配置文件</h3><p>  这一步很重要，集群的搭建关键在于配置文件的编写，首先看看RocketMq配置文件的解析:</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#所属集群名字 </span></span><br><span class=\"line\"><span class=\"attr\">brokerClusterName</span>=<span class=\"string\">rocketmq-cluster</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#broker名字，每队master和slave保持一致</span></span><br><span class=\"line\"><span class=\"attr\">brokerName</span>=<span class=\"string\">broker-a</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#0 表示 Master，&gt;0 表示 Slave</span></span><br><span class=\"line\"><span class=\"attr\">brokerId</span>=<span class=\"string\">0 </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#指定主机ip</span></span><br><span class=\"line\"><span class=\"attr\">brokerIP1</span> = <span class=\"string\">主机IP</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#nameServer地址，分号分割</span></span><br><span class=\"line\"><span class=\"attr\">namesrvAddr</span>=<span class=\"string\">主机IP:9876;主机IP:9876</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#在发送消息时，自动创建服务器不存在的topic，默认创建的队列数 </span></span><br><span class=\"line\"><span class=\"attr\">defaultTopicQueueNums</span>=<span class=\"string\">4</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#是否允许 Broker 自动创建Topic，建议线下开启，线上关闭 </span></span><br><span class=\"line\"><span class=\"attr\">autoCreateTopicEnable</span>=<span class=\"string\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#是否允许 Broker 自动创建订阅组，建议线下开启，线上关闭 </span></span><br><span class=\"line\"><span class=\"attr\">autoCreateSubscriptionGroup</span>=<span class=\"string\">true</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Broker 对外服务的监听端口 </span></span><br><span class=\"line\"><span class=\"attr\">listenPort</span>=<span class=\"string\">10911</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#删除文件时间点，默认凌晨 4点</span></span><br><span class=\"line\"> <span class=\"attr\">deleteWhen</span>=<span class=\"string\">04</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#文件保留时间，默认 48 小时 </span></span><br><span class=\"line\"><span class=\"attr\">fileReservedTime</span>=<span class=\"string\">120</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#commitLog每个文件的大小默认1G </span></span><br><span class=\"line\"><span class=\"attr\">mapedFileSizeCommitLog</span>=<span class=\"string\">1073741824</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#ConsumeQueue每个文件默认存30W条，根据业务情况调整</span></span><br><span class=\"line\"><span class=\"attr\">mapedFileSizeConsumeQueue</span>=<span class=\"string\">300000</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#检测物理文件磁盘空间</span></span><br><span class=\"line\"><span class=\"attr\">diskMaxUsedSpaceRatio</span>=<span class=\"string\">88</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathRootDir</span>=<span class=\"string\">/usr/local/rocketmq/store</span></span><br><span class=\"line\"><span class=\"comment\">#commitLog 存储路径 </span></span><br><span class=\"line\"><span class=\"attr\">storePathCommitLog</span>=<span class=\"string\">/usr/local/rocketmq/store/commitlog</span></span><br><span class=\"line\"><span class=\"comment\">#消费队列存储路径存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathConsumeQueue</span>=<span class=\"string\">/usr/local/rocketmq/store/consumequeue</span></span><br><span class=\"line\"><span class=\"comment\">#消息索引存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathIndex</span>=<span class=\"string\">/usr/local/rocketmq/store/index</span></span><br><span class=\"line\"><span class=\"comment\">#checkpoint 文件存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storeCheckpoint</span>=<span class=\"string\">/usr/local/rocketmq/store/checkpoint</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#Broker 的角色</span></span><br><span class=\"line\"><span class=\"comment\">#- ASYNC_MASTER 异步复制Master</span></span><br><span class=\"line\"><span class=\"comment\">#- SYNC_MASTER 同步双写Master</span></span><br><span class=\"line\"><span class=\"comment\">#- SLAVE </span></span><br><span class=\"line\"><span class=\"attr\">brokerRole</span>=<span class=\"string\">ASYNC_MASTER</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#刷盘方式</span></span><br><span class=\"line\"><span class=\"comment\">#- ASYNC_FLUSH 异步刷盘</span></span><br><span class=\"line\"><span class=\"comment\">#- SYNC_FLUSH 同步刷盘 flushDiskType=ASYNC_FLUSH</span></span><br><span class=\"line\"><span class=\"comment\">#checkTransactionMessageEnable=false</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#abort 文件存储路径</span></span><br><span class=\"line\"><span class=\"attr\">abortFile</span>=<span class=\"string\">/usr/javawork/apache-rocketmq/store/abort</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#限制的消息大小 maxMessageSize=65536</span></span><br></pre></td></tr></table></figure>\n\n<p>以上配置可根据个人需求加入到自己的配置文件中；RocketMQ官方已经为我们创建好了简单的集群配置文件，进去解压后的文件夹，在进入到conf文件夹，可以看到里面有三个文件夹：</p>\n<ul>\n<li>2m-2s-async :2个master，2个slave，async异步复制</li>\n<li>2m-2s-sync :2个master，2个slave，sync同步双写</li>\n<li>2m-noslave :2个master,没有slave</li>\n</ul>\n<p>这里我们用async异步复制模式，进入文件夹，分别编辑：</p>\n<h4 id=\"centos7-1主机编辑如下两个配置文件\"><a href=\"#centos7-1主机编辑如下两个配置文件\" class=\"headerlink\" title=\"centos7_1主机编辑如下两个配置文件\"></a>centos7_1主机编辑如下两个配置文件</h4><blockquote>\n<p>注意，master和slave的文件存储路径不能用同一个路径，所以必须要区分开。</p>\n</blockquote>\n<h5 id=\"broker-a-properties\"><a href=\"#broker-a-properties\" class=\"headerlink\" title=\"broker-a.properties\"></a>broker-a.properties</h5><figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">brokerClusterName</span>=<span class=\"string\">DefaultCluster</span></span><br><span class=\"line\"><span class=\"attr\">brokerName</span>=<span class=\"string\">broker-a</span></span><br><span class=\"line\"><span class=\"attr\">brokerId</span>=<span class=\"string\">0</span></span><br><span class=\"line\"><span class=\"attr\">deleteWhen</span>=<span class=\"string\">04</span></span><br><span class=\"line\"><span class=\"attr\">fileReservedTime</span>=<span class=\"string\">48</span></span><br><span class=\"line\"><span class=\"attr\">brokerRole</span>=<span class=\"string\">ASYNC_MASTER</span></span><br><span class=\"line\"><span class=\"attr\">flushDiskType</span>=<span class=\"string\">ASYNC_FLUSH</span></span><br><span class=\"line\"><span class=\"attr\">namesrvAddr</span>=<span class=\"string\">172.16.54.128:9876;172.16.54.130:9876</span></span><br><span class=\"line\"><span class=\"attr\">listenPort</span>=<span class=\"string\">10911</span></span><br><span class=\"line\"><span class=\"comment\">#存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathRootDir</span>=<span class=\"string\">/usr/local/rocketmq/master/store</span></span><br><span class=\"line\"><span class=\"comment\">#commitLog 存储路径 </span></span><br><span class=\"line\"><span class=\"attr\">storePathCommitLog</span>=<span class=\"string\">/usr/local/rocketmq/master/store/commitlog</span></span><br><span class=\"line\"><span class=\"comment\">#消费队列存储路径存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathConsumeQueue</span>=<span class=\"string\">/usr/local/rocketmq/master/store/consumequeue</span></span><br><span class=\"line\"><span class=\"comment\">#消息索引存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathIndex</span>=<span class=\"string\">/usr/local/rocketmq/master/store/index</span></span><br><span class=\"line\"><span class=\"comment\">#checkpoint 文件存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storeCheckpoint</span>=<span class=\"string\">/usr/local/rocketmq/master/store/checkpoint</span></span><br></pre></td></tr></table></figure>\n\n<p><em>这个监听端口设置设置成10911后还会自动监听10909,10912这两个端口，所以要配置文件要避免设置到相应的端口。</em></p>\n<h5 id=\"broker-a-s-properties\"><a href=\"#broker-a-s-properties\" class=\"headerlink\" title=\"broker-a-s.properties\"></a>broker-a-s.properties</h5><figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">brokerClusterName</span>=<span class=\"string\">DefaultCluster</span></span><br><span class=\"line\"><span class=\"attr\">brokerName</span>=<span class=\"string\">broker-a</span></span><br><span class=\"line\"><span class=\"attr\">brokerId</span>=<span class=\"string\">1</span></span><br><span class=\"line\"><span class=\"attr\">deleteWhen</span>=<span class=\"string\">04</span></span><br><span class=\"line\"><span class=\"attr\">fileReservedTime</span>=<span class=\"string\">48</span></span><br><span class=\"line\"><span class=\"attr\">brokerRole</span>=<span class=\"string\">SLAVE</span></span><br><span class=\"line\"><span class=\"attr\">flushDiskType</span>=<span class=\"string\">ASYNC_FLUSH</span></span><br><span class=\"line\"><span class=\"attr\">namesrvAddr</span>=<span class=\"string\">172.16.54.128:9876;172.16.54.130:9876</span></span><br><span class=\"line\"><span class=\"attr\">listenPort</span>=<span class=\"string\">20911</span></span><br><span class=\"line\"><span class=\"comment\">#存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathRootDir</span>=<span class=\"string\">/usr/local/rocketmq/slave/store</span></span><br><span class=\"line\"><span class=\"comment\">#commitLog 存储路径 </span></span><br><span class=\"line\"><span class=\"attr\">storePathCommitLog</span>=<span class=\"string\">/usr/local/rocketmq/slave/store/commitlog</span></span><br><span class=\"line\"><span class=\"comment\">#消费队列存储路径存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathConsumeQueue</span>=<span class=\"string\">/usr/local/rocketmq/slave/store/consumequeue</span></span><br><span class=\"line\"><span class=\"comment\">#消息索引存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storePathIndex</span>=<span class=\"string\">/usr/local/rocketmq/slave/store/index</span></span><br><span class=\"line\"><span class=\"comment\">#checkpoint 文件存储路径</span></span><br><span class=\"line\"><span class=\"attr\">storeCheckpoint</span>=<span class=\"string\">/usr/local/rocketmq/slave/store/checkpoint</span></span><br></pre></td></tr></table></figure>\n\n<p><em>这个监听端口设置设置成20911后还会自动监听20909,20912这两个端口，所以要配置文件要避免设置到相应的端口。</em></p>\n<h4 id=\"centos7-2主机编辑如下两个配置文件\"><a href=\"#centos7-2主机编辑如下两个配置文件\" class=\"headerlink\" title=\"centos7_2主机编辑如下两个配置文件\"></a>centos7_2主机编辑如下两个配置文件</h4><h5 id=\"和centos7-1主机配置一样，这边就不写了，不过brokerName要设置成不同的，我这边设置成broker-b。\"><a href=\"#和centos7-1主机配置一样，这边就不写了，不过brokerName要设置成不同的，我这边设置成broker-b。\" class=\"headerlink\" title=\"和centos7_1主机配置一样，这边就不写了，不过brokerName要设置成不同的，我这边设置成broker-b。\"></a>和centos7_1主机配置一样，这边就不写了，不过brokerName要设置成不同的，我这边设置成broker-b。</h5><h2 id=\"设置RocketMQ运行的JVM内存-非必须\"><a href=\"#设置RocketMQ运行的JVM内存-非必须\" class=\"headerlink\" title=\"设置RocketMQ运行的JVM内存(非必须)\"></a>设置RocketMQ运行的JVM内存(非必须)</h2><blockquote>\n<p>此项设置非必须，如果你主机内存很大的话可以不设置，RocketMQ默认要8G。</p>\n</blockquote>\n<p>  进入rocketmq-all-4.5.2-bin-release/bin目录，两台主机分别设置runbroker.sh和runserver.sh这两个文件。</p>\n<ul>\n<li>runbroker.sh：找到如下一行配置</li>\n</ul>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">JAVA_OPT</span>=<span class=\"string\">\"$&#123;JAVA_OPT&#125; -server -Xms8g -Xmx8g -Xmn4g\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">改成：</span></span><br><span class=\"line\"><span class=\"attr\">JAVA_OPT</span>=<span class=\"string\">\"$&#123;JAVA_OPT&#125; -server -Xms512m -Xmx512m -Xmn256m\"</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>runserver.sh: 找到如下一行配置</li>\n</ul>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">JAVA_OPT</span>=<span class=\"string\">\"$&#123;JAVA_OPT&#125; -server -Xms4g -Xmx4g -Xmn2g -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">改成：</span></span><br><span class=\"line\"><span class=\"attr\">JAVA_OPT</span>=<span class=\"string\">\"$&#123;JAVA_OPT&#125; -server -Xms512m -Xmx512m -Xmn256m -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m\"</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"启动RocketMQ\"><a href=\"#启动RocketMQ\" class=\"headerlink\" title=\"启动RocketMQ\"></a>启动RocketMQ</h2><blockquote>\n<p>启动RocketMQ前为了方便访问，先关闭两台主机的防火墙。执行如下命令：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> <span class=\"comment\"># service firewalld stop</span></span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"></span></span><br></pre></td></tr></table></figure>\n</blockquote>\n<blockquote>\n</blockquote>\n<p>  进入rocketmq-all-4.5.2-bin-release/bin这个目录，两台主机分别执行以下命令：</p>\n<ul>\n<li>启动namesrv</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> nohup sh mqnamesrv &amp;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>启动broker-master</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> nohup sh mqbroker -c ../conf/2m-2s-async/broker-a.properties &amp;</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>启动broker-slave</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> nohup sh mqbroker -c ../conf/2m-2s-async/broker<span class=\"_\">-a</span>-s.properties &amp;</span></span><br></pre></td></tr></table></figure>\n\n<p><em>注意两台主机启动broker时后面的-c记得加载你配置好的配置文件路径，别加载错了</em></p>\n<h2 id=\"搭建Console可视化控制台\"><a href=\"#搭建Console可视化控制台\" class=\"headerlink\" title=\"搭建Console可视化控制台\"></a>搭建Console可视化控制台</h2><p>  任意一台机器或者本地下载Console源码，地址：<a href=\"https://github.com/apache/rocketmq-externals，或者有git的话直接用命令拉取：\" rel=\"noopener\" target=\"_blank\">https://github.com/apache/rocketmq-externals，或者有git的话直接用命令拉取：</a></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> git <span class=\"built_in\">clone</span> https://github.com/apache/rocketmq-externals.git</span></span><br></pre></td></tr></table></figure>\n\n<p>进去目录：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> <span class=\"built_in\">cd</span> rocketmq-externals-master/rocketmq-console</span></span><br></pre></td></tr></table></figure>\n\n<p>修改配置文件：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> vim src/main/resources/application.properties</span></span><br></pre></td></tr></table></figure>\n\n<p>添加两个namesvr的主机ip</p>\n<figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">rocketmq.config.namesrvAddr</span>=<span class=\"string\">172.16.54.128:9876;172.16.54.130:9876</span></span><br></pre></td></tr></table></figure>\n\n<p>然后进项目跟目录，运行项目</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span><span class=\"bash\"> mvn sprint-boot:run</span></span><br></pre></td></tr></table></figure>\n\n<p>浏览器访问：</p>\n<p><img src=\"http://cdn.mjava.top/blog/rocketmq_console.png\" alt=\"可视化Console界面\"></p>\n"},{"title":"【转】免费可商用，最值得收藏的10个插画素材网站","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-01-16T01:24:52.000Z","password":null,"summary":null,"keywords":null,"description":"现在插画风格的界面越来越多，网上提供的免费插图也越来越丰富。这些插图优点是表达的内容更丰富，包括：人物、商业、运动、自然、工作、幽默等等。也更适合产品类的宣传网站或者落地页。另外，矢量图的不失真在不同尺寸的显示效果上更胜一筹。花时间整理了当前全网那些优秀的10个免费插图网站，给做产品的人们节省点查找的时间，建议收藏以备后用。这些站点的素材都是免费下载可用的，而且可以免费商用。","_content":"\n> 转自[凯凯刘](http://liujinkai.com/2019/10/18/10-best-free-illustration/)\n\n现在插画风格的界面越来越多，网上提供的免费插图也越来越丰富。这些插图优点是表达的内容更丰富，包括：人物、商业、运动、自然、工作、幽默等等。也更适合产品类的宣传网站或者落地页。另外，矢量图的不失真在不同尺寸的显示效果上更胜一筹。花时间整理了当前全网那些优秀的10个免费插图网站，给做产品的人们节省点查找的时间，建议收藏以备后用。这些站点的素材都是免费下载可用的，而且可以免费商用。\n\n## IRA Design\n网站：https://iradesign.io/\n介绍：可以将元素进行组合形成自己喜欢的图片，有png和svg格式\n\n![](http://cdn.mjava.top/blog/20200116092835.png)\n\n## Absurd Design\n网站：https://absurd.design/\n介绍：有些荒诞风格的矢量图，适用网站的落地页、APP等\n\n![](http://cdn.mjava.top/blog/20200116092907.png)\n\n## Ouch!\n网站：https://icons8.com/ouch\n介绍：很多的免费图，各种分类\n\n![](http://cdn.mjava.top/blog/20200116092945.png)\n\n## unDraw\n网站：https://undraw.co/\n内容：开源的矢量图库，各种你能想到的基本都有\n\n![](http://cdn.mjava.top/blog/20200116093011.png)\n\n## Pngtree\n网站：https://pngtree.com/\n介绍：上百万的素材资源可下载\n\n![](http://cdn.mjava.top/blog/20200116093038.png)\n\n## Drawkit\n网站：https://www.drawkit.io/\n介绍：有免费的下载资源集合\n\n![](http://cdn.mjava.top/blog/20200116093103.png)\n\n## Humaaans\n网站：[https://www.humaaans.com](https://www.humaaans.com/)\n内容：关于人物的插画图片站\n\n![](http://cdn.mjava.top/blog/20200116093137.png)\n\n## Manypixels\n网站：https://www.manypixels.co/gallery/\n介绍：建筑、人物、科技、天气、运动，商业等类型的插画\n\n![](http://cdn.mjava.top/blog/20200116093201.png)\n\n## Lukaszadam\n网站：https://lukaszadam.com/illustrations\n介绍：一些有趣的小图标的插画\n\n![](http://cdn.mjava.top/blog/20200116093226.png)\n\n## Pixabay\n网站：https://pixabay.com/illustrations/search/\n介绍：收集了很多免费的插图素材，根据关键字可任意搜索\n\n![](http://cdn.mjava.top/blog/20200116093253.png)","source":"_posts/recommend/recommend-tool-1.md","raw":"---\ntitle: 【转】免费可商用，最值得收藏的10个插画素材网站\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-01-16 09:24:52\npassword:\nsummary:\nkeywords:\ndescription: 现在插画风格的界面越来越多，网上提供的免费插图也越来越丰富。这些插图优点是表达的内容更丰富，包括：人物、商业、运动、自然、工作、幽默等等。也更适合产品类的宣传网站或者落地页。另外，矢量图的不失真在不同尺寸的显示效果上更胜一筹。花时间整理了当前全网那些优秀的10个免费插图网站，给做产品的人们节省点查找的时间，建议收藏以备后用。这些站点的素材都是免费下载可用的，而且可以免费商用。\ntags:\n- UI\n- 推荐\ncategories:\n- Recommend\n---\n\n> 转自[凯凯刘](http://liujinkai.com/2019/10/18/10-best-free-illustration/)\n\n现在插画风格的界面越来越多，网上提供的免费插图也越来越丰富。这些插图优点是表达的内容更丰富，包括：人物、商业、运动、自然、工作、幽默等等。也更适合产品类的宣传网站或者落地页。另外，矢量图的不失真在不同尺寸的显示效果上更胜一筹。花时间整理了当前全网那些优秀的10个免费插图网站，给做产品的人们节省点查找的时间，建议收藏以备后用。这些站点的素材都是免费下载可用的，而且可以免费商用。\n\n## IRA Design\n网站：https://iradesign.io/\n介绍：可以将元素进行组合形成自己喜欢的图片，有png和svg格式\n\n![](http://cdn.mjava.top/blog/20200116092835.png)\n\n## Absurd Design\n网站：https://absurd.design/\n介绍：有些荒诞风格的矢量图，适用网站的落地页、APP等\n\n![](http://cdn.mjava.top/blog/20200116092907.png)\n\n## Ouch!\n网站：https://icons8.com/ouch\n介绍：很多的免费图，各种分类\n\n![](http://cdn.mjava.top/blog/20200116092945.png)\n\n## unDraw\n网站：https://undraw.co/\n内容：开源的矢量图库，各种你能想到的基本都有\n\n![](http://cdn.mjava.top/blog/20200116093011.png)\n\n## Pngtree\n网站：https://pngtree.com/\n介绍：上百万的素材资源可下载\n\n![](http://cdn.mjava.top/blog/20200116093038.png)\n\n## Drawkit\n网站：https://www.drawkit.io/\n介绍：有免费的下载资源集合\n\n![](http://cdn.mjava.top/blog/20200116093103.png)\n\n## Humaaans\n网站：[https://www.humaaans.com](https://www.humaaans.com/)\n内容：关于人物的插画图片站\n\n![](http://cdn.mjava.top/blog/20200116093137.png)\n\n## Manypixels\n网站：https://www.manypixels.co/gallery/\n介绍：建筑、人物、科技、天气、运动，商业等类型的插画\n\n![](http://cdn.mjava.top/blog/20200116093201.png)\n\n## Lukaszadam\n网站：https://lukaszadam.com/illustrations\n介绍：一些有趣的小图标的插画\n\n![](http://cdn.mjava.top/blog/20200116093226.png)\n\n## Pixabay\n网站：https://pixabay.com/illustrations/search/\n介绍：收集了很多免费的插图素材，根据关键字可任意搜索\n\n![](http://cdn.mjava.top/blog/20200116093253.png)","slug":"recommend/recommend-tool-1","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bkf003o2mg534tjiqwv","content":"<blockquote>\n<p>转自<a href=\"http://liujinkai.com/2019/10/18/10-best-free-illustration/\" rel=\"noopener\" target=\"_blank\">凯凯刘</a></p>\n</blockquote>\n<p>现在插画风格的界面越来越多，网上提供的免费插图也越来越丰富。这些插图优点是表达的内容更丰富，包括：人物、商业、运动、自然、工作、幽默等等。也更适合产品类的宣传网站或者落地页。另外，矢量图的不失真在不同尺寸的显示效果上更胜一筹。花时间整理了当前全网那些优秀的10个免费插图网站，给做产品的人们节省点查找的时间，建议收藏以备后用。这些站点的素材都是免费下载可用的，而且可以免费商用。</p>\n<h2 id=\"IRA-Design\"><a href=\"#IRA-Design\" class=\"headerlink\" title=\"IRA Design\"></a>IRA Design</h2><p>网站：<a href=\"https://iradesign.io/\" rel=\"noopener\" target=\"_blank\">https://iradesign.io/</a><br>介绍：可以将元素进行组合形成自己喜欢的图片，有png和svg格式</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116092835.png\" alt></p>\n<h2 id=\"Absurd-Design\"><a href=\"#Absurd-Design\" class=\"headerlink\" title=\"Absurd Design\"></a>Absurd Design</h2><p>网站：<a href=\"https://absurd.design/\" rel=\"noopener\" target=\"_blank\">https://absurd.design/</a><br>介绍：有些荒诞风格的矢量图，适用网站的落地页、APP等</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116092907.png\" alt></p>\n<h2 id=\"Ouch\"><a href=\"#Ouch\" class=\"headerlink\" title=\"Ouch!\"></a>Ouch!</h2><p>网站：<a href=\"https://icons8.com/ouch\" rel=\"noopener\" target=\"_blank\">https://icons8.com/ouch</a><br>介绍：很多的免费图，各种分类</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116092945.png\" alt></p>\n<h2 id=\"unDraw\"><a href=\"#unDraw\" class=\"headerlink\" title=\"unDraw\"></a>unDraw</h2><p>网站：<a href=\"https://undraw.co/\" rel=\"noopener\" target=\"_blank\">https://undraw.co/</a><br>内容：开源的矢量图库，各种你能想到的基本都有</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093011.png\" alt></p>\n<h2 id=\"Pngtree\"><a href=\"#Pngtree\" class=\"headerlink\" title=\"Pngtree\"></a>Pngtree</h2><p>网站：<a href=\"https://pngtree.com/\" rel=\"noopener\" target=\"_blank\">https://pngtree.com/</a><br>介绍：上百万的素材资源可下载</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093038.png\" alt></p>\n<h2 id=\"Drawkit\"><a href=\"#Drawkit\" class=\"headerlink\" title=\"Drawkit\"></a>Drawkit</h2><p>网站：<a href=\"https://www.drawkit.io/\" rel=\"noopener\" target=\"_blank\">https://www.drawkit.io/</a><br>介绍：有免费的下载资源集合</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093103.png\" alt></p>\n<h2 id=\"Humaaans\"><a href=\"#Humaaans\" class=\"headerlink\" title=\"Humaaans\"></a>Humaaans</h2><p>网站：<a href=\"https://www.humaaans.com/\" rel=\"noopener\" target=\"_blank\">https://www.humaaans.com</a><br>内容：关于人物的插画图片站</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093137.png\" alt></p>\n<h2 id=\"Manypixels\"><a href=\"#Manypixels\" class=\"headerlink\" title=\"Manypixels\"></a>Manypixels</h2><p>网站：<a href=\"https://www.manypixels.co/gallery/\" rel=\"noopener\" target=\"_blank\">https://www.manypixels.co/gallery/</a><br>介绍：建筑、人物、科技、天气、运动，商业等类型的插画</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093201.png\" alt></p>\n<h2 id=\"Lukaszadam\"><a href=\"#Lukaszadam\" class=\"headerlink\" title=\"Lukaszadam\"></a>Lukaszadam</h2><p>网站：<a href=\"https://lukaszadam.com/illustrations\" rel=\"noopener\" target=\"_blank\">https://lukaszadam.com/illustrations</a><br>介绍：一些有趣的小图标的插画</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093226.png\" alt></p>\n<h2 id=\"Pixabay\"><a href=\"#Pixabay\" class=\"headerlink\" title=\"Pixabay\"></a>Pixabay</h2><p>网站：<a href=\"https://pixabay.com/illustrations/search/\" rel=\"noopener\" target=\"_blank\">https://pixabay.com/illustrations/search/</a><br>介绍：收集了很多免费的插图素材，根据关键字可任意搜索</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093253.png\" alt></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<blockquote>\n<p>转自<a href=\"http://liujinkai.com/2019/10/18/10-best-free-illustration/\" rel=\"noopener\" target=\"_blank\">凯凯刘</a></p>\n</blockquote>\n<p>现在插画风格的界面越来越多，网上提供的免费插图也越来越丰富。这些插图优点是表达的内容更丰富，包括：人物、商业、运动、自然、工作、幽默等等。也更适合产品类的宣传网站或者落地页。另外，矢量图的不失真在不同尺寸的显示效果上更胜一筹。花时间整理了当前全网那些优秀的10个免费插图网站，给做产品的人们节省点查找的时间，建议收藏以备后用。这些站点的素材都是免费下载可用的，而且可以免费商用。</p>\n<h2 id=\"IRA-Design\"><a href=\"#IRA-Design\" class=\"headerlink\" title=\"IRA Design\"></a>IRA Design</h2><p>网站：<a href=\"https://iradesign.io/\" rel=\"noopener\" target=\"_blank\">https://iradesign.io/</a><br>介绍：可以将元素进行组合形成自己喜欢的图片，有png和svg格式</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116092835.png\" alt></p>\n<h2 id=\"Absurd-Design\"><a href=\"#Absurd-Design\" class=\"headerlink\" title=\"Absurd Design\"></a>Absurd Design</h2><p>网站：<a href=\"https://absurd.design/\" rel=\"noopener\" target=\"_blank\">https://absurd.design/</a><br>介绍：有些荒诞风格的矢量图，适用网站的落地页、APP等</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116092907.png\" alt></p>\n<h2 id=\"Ouch\"><a href=\"#Ouch\" class=\"headerlink\" title=\"Ouch!\"></a>Ouch!</h2><p>网站：<a href=\"https://icons8.com/ouch\" rel=\"noopener\" target=\"_blank\">https://icons8.com/ouch</a><br>介绍：很多的免费图，各种分类</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116092945.png\" alt></p>\n<h2 id=\"unDraw\"><a href=\"#unDraw\" class=\"headerlink\" title=\"unDraw\"></a>unDraw</h2><p>网站：<a href=\"https://undraw.co/\" rel=\"noopener\" target=\"_blank\">https://undraw.co/</a><br>内容：开源的矢量图库，各种你能想到的基本都有</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093011.png\" alt></p>\n<h2 id=\"Pngtree\"><a href=\"#Pngtree\" class=\"headerlink\" title=\"Pngtree\"></a>Pngtree</h2><p>网站：<a href=\"https://pngtree.com/\" rel=\"noopener\" target=\"_blank\">https://pngtree.com/</a><br>介绍：上百万的素材资源可下载</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093038.png\" alt></p>\n<h2 id=\"Drawkit\"><a href=\"#Drawkit\" class=\"headerlink\" title=\"Drawkit\"></a>Drawkit</h2><p>网站：<a href=\"https://www.drawkit.io/\" rel=\"noopener\" target=\"_blank\">https://www.drawkit.io/</a><br>介绍：有免费的下载资源集合</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093103.png\" alt></p>\n<h2 id=\"Humaaans\"><a href=\"#Humaaans\" class=\"headerlink\" title=\"Humaaans\"></a>Humaaans</h2><p>网站：<a href=\"https://www.humaaans.com/\" rel=\"noopener\" target=\"_blank\">https://www.humaaans.com</a><br>内容：关于人物的插画图片站</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093137.png\" alt></p>\n<h2 id=\"Manypixels\"><a href=\"#Manypixels\" class=\"headerlink\" title=\"Manypixels\"></a>Manypixels</h2><p>网站：<a href=\"https://www.manypixels.co/gallery/\" rel=\"noopener\" target=\"_blank\">https://www.manypixels.co/gallery/</a><br>介绍：建筑、人物、科技、天气、运动，商业等类型的插画</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093201.png\" alt></p>\n<h2 id=\"Lukaszadam\"><a href=\"#Lukaszadam\" class=\"headerlink\" title=\"Lukaszadam\"></a>Lukaszadam</h2><p>网站：<a href=\"https://lukaszadam.com/illustrations\" rel=\"noopener\" target=\"_blank\">https://lukaszadam.com/illustrations</a><br>介绍：一些有趣的小图标的插画</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093226.png\" alt></p>\n<h2 id=\"Pixabay\"><a href=\"#Pixabay\" class=\"headerlink\" title=\"Pixabay\"></a>Pixabay</h2><p>网站：<a href=\"https://pixabay.com/illustrations/search/\" rel=\"noopener\" target=\"_blank\">https://pixabay.com/illustrations/search/</a><br>介绍：收集了很多免费的插图素材，根据关键字可任意搜索</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200116093253.png\" alt></p>\n"},{"title":"Fegin和RestTemplate添加全局请求头","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-09-16T07:14:43.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## Fegin添加全局请求头\n\n- 实现RequestInterceptor接口\n\n```java\n\n/**\n* 实现RequestInterceptor接口的apply方法\n*/\n@Configuration\npublic class FeignRequestInterceptor implements RequestInterceptor {\n    @Override\n    public void apply(RequestTemplate requestTemplate) {\n        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder\n                .getRequestAttributes();\n        HttpServletRequest request = attributes.getRequest();\n        Enumeration<String> headerNames = request.getHeaderNames();\n        if (headerNames != null) {\n            while (headerNames.hasMoreElements()) {\n                String name = headerNames.nextElement();\n                String values = request.getHeader(name);\n                requestTemplate.header(name, values);\n\n            }\n        }\n    }\n}\n\n```\n\n- 在`@FeginClient`注释里`configuration`所填入的类文件中添加上面的拦截器\n\n  > 比如 \n  >\n  > ```java\n  > // configuration指定的类为FeignConfig\n  > \n  > @FeignClient(name = \"${TinyConfigServiceName}\",path=\"/config\",configuration = FeignConfig.class)\n  > ```\n  - 在FeignConfig类中添加拦截器\n\n    ```java\n    @Configuration\n    public class FeignConfig {\n        @Bean\n        public RequestInterceptor requestInterceptor(){\n            return new FeignRequestInterceptor();\n        }\n    }\n    ```\n\n    \n\n## RestTemplate添加全局请求头\n\n- 编写拦截器,实现`ClientHttpRequestInterceptor`接口的`intercept`方法\n\n  ```java\n  public class MyInterceptor implements ClientHttpRequestInterceptor {\n      @Override\n      public ClientHttpResponse intercept(HttpRequest httpRequest, byte[] bytes, ClientHttpRequestExecution clientHttpRequestExecution) throws IOException {\n          HttpHeaders httpHeaders=httpRequest.getHeaders();\n          ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder\n                  .getRequestAttributes();\n          HttpServletRequest request = attributes.getRequest();\n          Enumeration<String> headerNames = request.getHeaderNames();\n          if (headerNames != null) {\n              while (headerNames.hasMoreElements()) {\n                  String name = headerNames.nextElement();\n                  String values = request.getHeader(name);\n                  httpHeaders.add(name, values);\n              }\n          }\n          return clientHttpRequestExecution.execute(httpRequest,bytes);\n      }\n  }\n  ```\n\n  \n\n- 在springboot的启动类里添加`RestTemplate`\n\n  ```java\n  @SpringBootApplication\n  public class DemoApplication {\n  \n      public static void main(String[] args) {\n          SpringApplication.run(DemoApplication.class, args);\n      }\n  \n      //ioc添加RestTemplate\n      @Bean\n      public RestTemplate restTemplate(){\n          MyInterceptor myInterceptor=new MyInterceptor();\n          RestTemplate restTemplate=new RestTemplate();\n          restTemplate.setInterceptors(Collections.singletonList(myInterceptor));\n          return restTemplate;\n      }\n  \n  }\n  ```\n\n  ","source":"_posts/spring/fegin-resttemplate-addheard.md","raw":"---\ntitle: Fegin和RestTemplate添加全局请求头\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-09-16 15:14:43\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Fegin\n- Resttemplate\ncategories:\n- Spring\n---\n\n## Fegin添加全局请求头\n\n- 实现RequestInterceptor接口\n\n```java\n\n/**\n* 实现RequestInterceptor接口的apply方法\n*/\n@Configuration\npublic class FeignRequestInterceptor implements RequestInterceptor {\n    @Override\n    public void apply(RequestTemplate requestTemplate) {\n        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder\n                .getRequestAttributes();\n        HttpServletRequest request = attributes.getRequest();\n        Enumeration<String> headerNames = request.getHeaderNames();\n        if (headerNames != null) {\n            while (headerNames.hasMoreElements()) {\n                String name = headerNames.nextElement();\n                String values = request.getHeader(name);\n                requestTemplate.header(name, values);\n\n            }\n        }\n    }\n}\n\n```\n\n- 在`@FeginClient`注释里`configuration`所填入的类文件中添加上面的拦截器\n\n  > 比如 \n  >\n  > ```java\n  > // configuration指定的类为FeignConfig\n  > \n  > @FeignClient(name = \"${TinyConfigServiceName}\",path=\"/config\",configuration = FeignConfig.class)\n  > ```\n  - 在FeignConfig类中添加拦截器\n\n    ```java\n    @Configuration\n    public class FeignConfig {\n        @Bean\n        public RequestInterceptor requestInterceptor(){\n            return new FeignRequestInterceptor();\n        }\n    }\n    ```\n\n    \n\n## RestTemplate添加全局请求头\n\n- 编写拦截器,实现`ClientHttpRequestInterceptor`接口的`intercept`方法\n\n  ```java\n  public class MyInterceptor implements ClientHttpRequestInterceptor {\n      @Override\n      public ClientHttpResponse intercept(HttpRequest httpRequest, byte[] bytes, ClientHttpRequestExecution clientHttpRequestExecution) throws IOException {\n          HttpHeaders httpHeaders=httpRequest.getHeaders();\n          ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder\n                  .getRequestAttributes();\n          HttpServletRequest request = attributes.getRequest();\n          Enumeration<String> headerNames = request.getHeaderNames();\n          if (headerNames != null) {\n              while (headerNames.hasMoreElements()) {\n                  String name = headerNames.nextElement();\n                  String values = request.getHeader(name);\n                  httpHeaders.add(name, values);\n              }\n          }\n          return clientHttpRequestExecution.execute(httpRequest,bytes);\n      }\n  }\n  ```\n\n  \n\n- 在springboot的启动类里添加`RestTemplate`\n\n  ```java\n  @SpringBootApplication\n  public class DemoApplication {\n  \n      public static void main(String[] args) {\n          SpringApplication.run(DemoApplication.class, args);\n      }\n  \n      //ioc添加RestTemplate\n      @Bean\n      public RestTemplate restTemplate(){\n          MyInterceptor myInterceptor=new MyInterceptor();\n          RestTemplate restTemplate=new RestTemplate();\n          restTemplate.setInterceptors(Collections.singletonList(myInterceptor));\n          return restTemplate;\n      }\n  \n  }\n  ```\n\n  ","slug":"spring/fegin-resttemplate-addheard","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bkg003q2mg5opittkez","content":"<h2 id=\"Fegin添加全局请求头\"><a href=\"#Fegin添加全局请求头\" class=\"headerlink\" title=\"Fegin添加全局请求头\"></a>Fegin添加全局请求头</h2><ul>\n<li>实现RequestInterceptor接口</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 实现RequestInterceptor接口的apply方法</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FeignRequestInterceptor</span> <span class=\"keyword\">implements</span> <span class=\"title\">RequestInterceptor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">apply</span><span class=\"params\">(RequestTemplate requestTemplate)</span> </span>&#123;</span><br><span class=\"line\">        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder</span><br><span class=\"line\">                .getRequestAttributes();</span><br><span class=\"line\">        HttpServletRequest request = attributes.getRequest();</span><br><span class=\"line\">        Enumeration&lt;String&gt; headerNames = request.getHeaderNames();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (headerNames != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (headerNames.hasMoreElements()) &#123;</span><br><span class=\"line\">                String name = headerNames.nextElement();</span><br><span class=\"line\">                String values = request.getHeader(name);</span><br><span class=\"line\">                requestTemplate.header(name, values);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>在<code>@FeginClient</code>注释里<code>configuration</code>所填入的类文件中添加上面的拦截器</p>\n<blockquote>\n<p>比如 </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"comment\">// configuration指定的类为FeignConfig</span></span><br><span class=\"line\">&gt; </span><br><span class=\"line\">&gt; <span class=\"meta\">@FeignClient</span>(name = <span class=\"string\">\"$&#123;TinyConfigServiceName&#125;\"</span>,path=<span class=\"string\">\"/config\"</span>,configuration = FeignConfig.class)</span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<ul>\n<li><p>在FeignConfig类中添加拦截器</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FeignConfig</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> RequestInterceptor <span class=\"title\">requestInterceptor</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> FeignRequestInterceptor();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"RestTemplate添加全局请求头\"><a href=\"#RestTemplate添加全局请求头\" class=\"headerlink\" title=\"RestTemplate添加全局请求头\"></a>RestTemplate添加全局请求头</h2><ul>\n<li><p>编写拦截器,实现<code>ClientHttpRequestInterceptor</code>接口的<code>intercept</code>方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyInterceptor</span> <span class=\"keyword\">implements</span> <span class=\"title\">ClientHttpRequestInterceptor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ClientHttpResponse <span class=\"title\">intercept</span><span class=\"params\">(HttpRequest httpRequest, <span class=\"keyword\">byte</span>[] bytes, ClientHttpRequestExecution clientHttpRequestExecution)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        HttpHeaders httpHeaders=httpRequest.getHeaders();</span><br><span class=\"line\">        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder</span><br><span class=\"line\">                .getRequestAttributes();</span><br><span class=\"line\">        HttpServletRequest request = attributes.getRequest();</span><br><span class=\"line\">        Enumeration&lt;String&gt; headerNames = request.getHeaderNames();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (headerNames != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (headerNames.hasMoreElements()) &#123;</span><br><span class=\"line\">                String name = headerNames.nextElement();</span><br><span class=\"line\">                String values = request.getHeader(name);</span><br><span class=\"line\">                httpHeaders.add(name, values);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> clientHttpRequestExecution.execute(httpRequest,bytes);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ul>\n<ul>\n<li><p>在springboot的启动类里添加<code>RestTemplate</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoApplication</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(DemoApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//ioc添加RestTemplate</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> RestTemplate <span class=\"title\">restTemplate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        MyInterceptor myInterceptor=<span class=\"keyword\">new</span> MyInterceptor();</span><br><span class=\"line\">        RestTemplate restTemplate=<span class=\"keyword\">new</span> RestTemplate();</span><br><span class=\"line\">        restTemplate.setInterceptors(Collections.singletonList(myInterceptor));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> restTemplate;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"Fegin添加全局请求头\"><a href=\"#Fegin添加全局请求头\" class=\"headerlink\" title=\"Fegin添加全局请求头\"></a>Fegin添加全局请求头</h2><ul>\n<li>实现RequestInterceptor接口</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* 实现RequestInterceptor接口的apply方法</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FeignRequestInterceptor</span> <span class=\"keyword\">implements</span> <span class=\"title\">RequestInterceptor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">apply</span><span class=\"params\">(RequestTemplate requestTemplate)</span> </span>&#123;</span><br><span class=\"line\">        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder</span><br><span class=\"line\">                .getRequestAttributes();</span><br><span class=\"line\">        HttpServletRequest request = attributes.getRequest();</span><br><span class=\"line\">        Enumeration&lt;String&gt; headerNames = request.getHeaderNames();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (headerNames != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (headerNames.hasMoreElements()) &#123;</span><br><span class=\"line\">                String name = headerNames.nextElement();</span><br><span class=\"line\">                String values = request.getHeader(name);</span><br><span class=\"line\">                requestTemplate.header(name, values);</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><p>在<code>@FeginClient</code>注释里<code>configuration</code>所填入的类文件中添加上面的拦截器</p>\n<blockquote>\n<p>比如 </p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"comment\">// configuration指定的类为FeignConfig</span></span><br><span class=\"line\">&gt; </span><br><span class=\"line\">&gt; <span class=\"meta\">@FeignClient</span>(name = <span class=\"string\">\"$&#123;TinyConfigServiceName&#125;\"</span>,path=<span class=\"string\">\"/config\"</span>,configuration = FeignConfig.class)</span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<ul>\n<li><p>在FeignConfig类中添加拦截器</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Configuration</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FeignConfig</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> RequestInterceptor <span class=\"title\">requestInterceptor</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> FeignRequestInterceptor();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"RestTemplate添加全局请求头\"><a href=\"#RestTemplate添加全局请求头\" class=\"headerlink\" title=\"RestTemplate添加全局请求头\"></a>RestTemplate添加全局请求头</h2><ul>\n<li><p>编写拦截器,实现<code>ClientHttpRequestInterceptor</code>接口的<code>intercept</code>方法</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyInterceptor</span> <span class=\"keyword\">implements</span> <span class=\"title\">ClientHttpRequestInterceptor</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> ClientHttpResponse <span class=\"title\">intercept</span><span class=\"params\">(HttpRequest httpRequest, <span class=\"keyword\">byte</span>[] bytes, ClientHttpRequestExecution clientHttpRequestExecution)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        HttpHeaders httpHeaders=httpRequest.getHeaders();</span><br><span class=\"line\">        ServletRequestAttributes attributes = (ServletRequestAttributes) RequestContextHolder</span><br><span class=\"line\">                .getRequestAttributes();</span><br><span class=\"line\">        HttpServletRequest request = attributes.getRequest();</span><br><span class=\"line\">        Enumeration&lt;String&gt; headerNames = request.getHeaderNames();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (headerNames != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (headerNames.hasMoreElements()) &#123;</span><br><span class=\"line\">                String name = headerNames.nextElement();</span><br><span class=\"line\">                String values = request.getHeader(name);</span><br><span class=\"line\">                httpHeaders.add(name, values);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> clientHttpRequestExecution.execute(httpRequest,bytes);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ul>\n<ul>\n<li><p>在springboot的启动类里添加<code>RestTemplate</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoApplication</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(DemoApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//ioc添加RestTemplate</span></span><br><span class=\"line\">    <span class=\"meta\">@Bean</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> RestTemplate <span class=\"title\">restTemplate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        MyInterceptor myInterceptor=<span class=\"keyword\">new</span> MyInterceptor();</span><br><span class=\"line\">        RestTemplate restTemplate=<span class=\"keyword\">new</span> RestTemplate();</span><br><span class=\"line\">        restTemplate.setInterceptors(Collections.singletonList(myInterceptor));</span><br><span class=\"line\">        <span class=\"keyword\">return</span> restTemplate;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n"},{"title":"438b5300-ffcf-443b-a1fa-2d2dbb6ea113","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-01-28T06:23:01.000Z","password":null,"summary":null,"keywords":null,"description":"测试测试测试测试12232","_content":"\n## 大声道\n\n阿诗丹顿多多多多多多多\n\n![1_3b6isFQ8iULtNYFoJF19mg](http://cdn.mjava.top/blog/1_3b6isFQ8iULtNYFoJF19mg.png)","source":"_posts/tool/438b5300-ffcf-443b-a1fa-2d2dbb6ea113.md","raw":"---\ntitle: 438b5300-ffcf-443b-a1fa-2d2dbb6ea113\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-01-28 14:23:01\npassword:\nsummary:\nkeywords:\ndescription: 测试测试测试测试12232\ntags:\ncategories:\n---\n\n## 大声道\n\n阿诗丹顿多多多多多多多\n\n![1_3b6isFQ8iULtNYFoJF19mg](http://cdn.mjava.top/blog/1_3b6isFQ8iULtNYFoJF19mg.png)","slug":"tool/438b5300-ffcf-443b-a1fa-2d2dbb6ea113","published":1,"updated":"2021-01-28T06:31:04.098Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bkh003u2mg5fw8w1uje","content":"<h2 id=\"大声道\"><a href=\"#大声道\" class=\"headerlink\" title=\"大声道\"></a>大声道</h2><p>阿诗丹顿多多多多多多多</p>\n<p><img src=\"http://cdn.mjava.top/blog/1_3b6isFQ8iULtNYFoJF19mg.png\" alt=\"1_3b6isFQ8iULtNYFoJF19mg\"></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"大声道\"><a href=\"#大声道\" class=\"headerlink\" title=\"大声道\"></a>大声道</h2><p>阿诗丹顿多多多多多多多</p>\n<p><img src=\"http://cdn.mjava.top/blog/1_3b6isFQ8iULtNYFoJF19mg.png\" alt=\"1_3b6isFQ8iULtNYFoJF19mg\"></p>\n"},{"title":"吐血整理Git常用命令","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-06-22T08:27:25.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## Git常用命令\n\n## Git简介\n\nGit 是用于 Linux[内核](https://baike.baidu.com/item/内核)开发的[版本控制](https://baike.baidu.com/item/版本控制)工具。与常用的版本控制工具 CVS, Subversion 等不同，它采用了分布式版本库的方式，不必服务器端软件支持（wingeddevil注：这得分是用什么样的服务端，使用http协议或者git协议等不太一样。并且在push和pull的时候和服务器端还是有交互的。），使[源代码](https://baike.baidu.com/item/源代码)的发布和交流极其方便。 Git 的速度很快，这对于诸如 Linux kernel 这样的大项目来说自然很重要。 Git 最为出色的是它的合并跟踪（merge tracing）能力。\n\ngit对于很多人来说,真的是又爱又恨,用的好可以提示开发效率;用不好,解决各种冲突就要累的你半死\n\n\n\n## git结构\n\n> 网上有 我就不画了\n\n![git结构图](http://cdn.mjava.top/blog/20200605001853.png)\n\n\n\n- workspace    相当于就是我们的本地电脑上的文件\n\n- Index    缓存区\n- Repository    本地仓库\n- Remote    远程仓库(github/gitlab/gitee)\n\n\n\n## git命令\n\ngit官方提供的命令多达几百个,可是我们日常却用不到这么多\n\n所以我就整理了一下日常使用的命令\n\n现在关注微信公招:`灰色Code`\n\n回复关键字:`git`\n\n就可以获取思维导图高清图片及导图源地址\n\n![](http://cdn.mjava.top/blog/20200605002904.jpg)","source":"_posts/tool/git-tool-command.md","raw":"---\ntitle: 吐血整理Git常用命令\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-06-22 16:27:25\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Git\ncategories:\n- Tool\n---\n\n## Git常用命令\n\n## Git简介\n\nGit 是用于 Linux[内核](https://baike.baidu.com/item/内核)开发的[版本控制](https://baike.baidu.com/item/版本控制)工具。与常用的版本控制工具 CVS, Subversion 等不同，它采用了分布式版本库的方式，不必服务器端软件支持（wingeddevil注：这得分是用什么样的服务端，使用http协议或者git协议等不太一样。并且在push和pull的时候和服务器端还是有交互的。），使[源代码](https://baike.baidu.com/item/源代码)的发布和交流极其方便。 Git 的速度很快，这对于诸如 Linux kernel 这样的大项目来说自然很重要。 Git 最为出色的是它的合并跟踪（merge tracing）能力。\n\ngit对于很多人来说,真的是又爱又恨,用的好可以提示开发效率;用不好,解决各种冲突就要累的你半死\n\n\n\n## git结构\n\n> 网上有 我就不画了\n\n![git结构图](http://cdn.mjava.top/blog/20200605001853.png)\n\n\n\n- workspace    相当于就是我们的本地电脑上的文件\n\n- Index    缓存区\n- Repository    本地仓库\n- Remote    远程仓库(github/gitlab/gitee)\n\n\n\n## git命令\n\ngit官方提供的命令多达几百个,可是我们日常却用不到这么多\n\n所以我就整理了一下日常使用的命令\n\n现在关注微信公招:`灰色Code`\n\n回复关键字:`git`\n\n就可以获取思维导图高清图片及导图源地址\n\n![](http://cdn.mjava.top/blog/20200605002904.jpg)","slug":"tool/git-tool-command","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bki003w2mg5qphyiy0y","content":"<h2 id=\"Git常用命令\"><a href=\"#Git常用命令\" class=\"headerlink\" title=\"Git常用命令\"></a>Git常用命令</h2><h2 id=\"Git简介\"><a href=\"#Git简介\" class=\"headerlink\" title=\"Git简介\"></a>Git简介</h2><p>Git 是用于 Linux<a href=\"https://baike.baidu.com/item/内核\" rel=\"noopener\" target=\"_blank\">内核</a>开发的<a href=\"https://baike.baidu.com/item/版本控制\" rel=\"noopener\" target=\"_blank\">版本控制</a>工具。与常用的版本控制工具 CVS, Subversion 等不同，它采用了分布式版本库的方式，不必服务器端软件支持（wingeddevil注：这得分是用什么样的服务端，使用http协议或者git协议等不太一样。并且在push和pull的时候和服务器端还是有交互的。），使<a href=\"https://baike.baidu.com/item/源代码\" rel=\"noopener\" target=\"_blank\">源代码</a>的发布和交流极其方便。 Git 的速度很快，这对于诸如 Linux kernel 这样的大项目来说自然很重要。 Git 最为出色的是它的合并跟踪（merge tracing）能力。</p>\n<p>git对于很多人来说,真的是又爱又恨,用的好可以提示开发效率;用不好,解决各种冲突就要累的你半死</p>\n<h2 id=\"git结构\"><a href=\"#git结构\" class=\"headerlink\" title=\"git结构\"></a>git结构</h2><blockquote>\n<p>网上有 我就不画了</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200605001853.png\" alt=\"git结构图\"></p>\n<ul>\n<li><p>workspace    相当于就是我们的本地电脑上的文件</p>\n</li>\n<li><p>Index    缓存区</p>\n</li>\n<li><p>Repository    本地仓库</p>\n</li>\n<li><p>Remote    远程仓库(github/gitlab/gitee)</p>\n</li>\n</ul>\n<h2 id=\"git命令\"><a href=\"#git命令\" class=\"headerlink\" title=\"git命令\"></a>git命令</h2><p>git官方提供的命令多达几百个,可是我们日常却用不到这么多</p>\n<p>所以我就整理了一下日常使用的命令</p>\n<p>现在关注微信公招:<code>灰色Code</code></p>\n<p>回复关键字:<code>git</code></p>\n<p>就可以获取思维导图高清图片及导图源地址</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200605002904.jpg\" alt></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"Git常用命令\"><a href=\"#Git常用命令\" class=\"headerlink\" title=\"Git常用命令\"></a>Git常用命令</h2><h2 id=\"Git简介\"><a href=\"#Git简介\" class=\"headerlink\" title=\"Git简介\"></a>Git简介</h2><p>Git 是用于 Linux<a href=\"https://baike.baidu.com/item/内核\" rel=\"noopener\" target=\"_blank\">内核</a>开发的<a href=\"https://baike.baidu.com/item/版本控制\" rel=\"noopener\" target=\"_blank\">版本控制</a>工具。与常用的版本控制工具 CVS, Subversion 等不同，它采用了分布式版本库的方式，不必服务器端软件支持（wingeddevil注：这得分是用什么样的服务端，使用http协议或者git协议等不太一样。并且在push和pull的时候和服务器端还是有交互的。），使<a href=\"https://baike.baidu.com/item/源代码\" rel=\"noopener\" target=\"_blank\">源代码</a>的发布和交流极其方便。 Git 的速度很快，这对于诸如 Linux kernel 这样的大项目来说自然很重要。 Git 最为出色的是它的合并跟踪（merge tracing）能力。</p>\n<p>git对于很多人来说,真的是又爱又恨,用的好可以提示开发效率;用不好,解决各种冲突就要累的你半死</p>\n<h2 id=\"git结构\"><a href=\"#git结构\" class=\"headerlink\" title=\"git结构\"></a>git结构</h2><blockquote>\n<p>网上有 我就不画了</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200605001853.png\" alt=\"git结构图\"></p>\n<ul>\n<li><p>workspace    相当于就是我们的本地电脑上的文件</p>\n</li>\n<li><p>Index    缓存区</p>\n</li>\n<li><p>Repository    本地仓库</p>\n</li>\n<li><p>Remote    远程仓库(github/gitlab/gitee)</p>\n</li>\n</ul>\n<h2 id=\"git命令\"><a href=\"#git命令\" class=\"headerlink\" title=\"git命令\"></a>git命令</h2><p>git官方提供的命令多达几百个,可是我们日常却用不到这么多</p>\n<p>所以我就整理了一下日常使用的命令</p>\n<p>现在关注微信公招:<code>灰色Code</code></p>\n<p>回复关键字:<code>git</code></p>\n<p>就可以获取思维导图高清图片及导图源地址</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200605002904.jpg\" alt></p>\n"},{"title":"Vue Cli3-11创建项目慢的问题","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-09-05T08:33:23.000Z","password":null,"summary":null,"_content":"## 前言\n\n  这几天刚学习vue，于是下载了最新的vue cli3.11来搭建项目，可是搭建的时候一直卡在下载插件见面，就是下面这张图。\n\n![vuecreate](/images/vuecreate.png)\n\n网上查了说不能用国内的镜像，WTF，不是说国内的更快吗？好吧，我换！！！\n\n## 下载nrm\n\n  看清楚哦，是nrm部署npm！！！nrm 是一个 `npm` 源管理器，允许你快速地在 `npm` 源间切换。执行以下命令安装。\n\n```shell\nsudo npm install -g nrm\n```\n\n### 测试nrm是否安装成功\n\n```shell\nnrm -V\n```\n\n如果输出版本号，则说明安装成功。\n\n## 切换npm源\n\n  ```shell\nnrm ls\n  ```\n\n此命令会列出npm的所有源\n\n![nrmls](/images/nrmls.png)\n\n可以看到我现在使用的是淘宝的源，现在把他切换到npm的源。\n\n```shell\nnrm use npm\n```\n\n![nrmuse](/images/nrmuse.png)\n\n## 再次创建vue项目\n\n```shell\nvue create rrr2\n```\n![vuecreate2](/images/vuecreate2.png)\n![vuecreate3](/images/vuecreate3.png)\n\n项目成功创建！！！\n","source":"_posts/vue/vue-cli3-11-problem.md","raw":"---\ntitle: Vue Cli3-11创建项目慢的问题\ntop: false\ncover: false\ntoc: true\nmathjax: true\ncategories:\n  - Vue\ntags:\n  - Vue\n  - Pit\ndate: 2019-09-05 16:33:23\npassword:\nsummary:\n---\n## 前言\n\n  这几天刚学习vue，于是下载了最新的vue cli3.11来搭建项目，可是搭建的时候一直卡在下载插件见面，就是下面这张图。\n\n![vuecreate](/images/vuecreate.png)\n\n网上查了说不能用国内的镜像，WTF，不是说国内的更快吗？好吧，我换！！！\n\n## 下载nrm\n\n  看清楚哦，是nrm部署npm！！！nrm 是一个 `npm` 源管理器，允许你快速地在 `npm` 源间切换。执行以下命令安装。\n\n```shell\nsudo npm install -g nrm\n```\n\n### 测试nrm是否安装成功\n\n```shell\nnrm -V\n```\n\n如果输出版本号，则说明安装成功。\n\n## 切换npm源\n\n  ```shell\nnrm ls\n  ```\n\n此命令会列出npm的所有源\n\n![nrmls](/images/nrmls.png)\n\n可以看到我现在使用的是淘宝的源，现在把他切换到npm的源。\n\n```shell\nnrm use npm\n```\n\n![nrmuse](/images/nrmuse.png)\n\n## 再次创建vue项目\n\n```shell\nvue create rrr2\n```\n![vuecreate2](/images/vuecreate2.png)\n![vuecreate3](/images/vuecreate3.png)\n\n项目成功创建！！！\n","slug":"vue/vue-cli3-11-problem","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bkj00412mg59accedz6","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>  这几天刚学习vue，于是下载了最新的vue cli3.11来搭建项目，可是搭建的时候一直卡在下载插件见面，就是下面这张图。</p>\n<p><img src=\"/images/vuecreate.png\" alt=\"vuecreate\"></p>\n<p>网上查了说不能用国内的镜像，WTF，不是说国内的更快吗？好吧，我换！！！</p>\n<h2 id=\"下载nrm\"><a href=\"#下载nrm\" class=\"headerlink\" title=\"下载nrm\"></a>下载nrm</h2><p>  看清楚哦，是nrm部署npm！！！nrm 是一个 <code>npm</code> 源管理器，允许你快速地在 <code>npm</code> 源间切换。执行以下命令安装。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo npm install -g nrm</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"测试nrm是否安装成功\"><a href=\"#测试nrm是否安装成功\" class=\"headerlink\" title=\"测试nrm是否安装成功\"></a>测试nrm是否安装成功</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">nrm -V</span><br></pre></td></tr></table></figure>\n\n<p>如果输出版本号，则说明安装成功。</p>\n<h2 id=\"切换npm源\"><a href=\"#切换npm源\" class=\"headerlink\" title=\"切换npm源\"></a>切换npm源</h2>  <figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">nrm ls</span><br></pre></td></tr></table></figure>\n\n<p>此命令会列出npm的所有源</p>\n<p><img src=\"/images/nrmls.png\" alt=\"nrmls\"></p>\n<p>可以看到我现在使用的是淘宝的源，现在把他切换到npm的源。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">nrm use npm</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/nrmuse.png\" alt=\"nrmuse\"></p>\n<h2 id=\"再次创建vue项目\"><a href=\"#再次创建vue项目\" class=\"headerlink\" title=\"再次创建vue项目\"></a>再次创建vue项目</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">vue create rrr2</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/vuecreate2.png\" alt=\"vuecreate2\"><br><img src=\"/images/vuecreate3.png\" alt=\"vuecreate3\"></p>\n<p>项目成功创建！！！</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>  这几天刚学习vue，于是下载了最新的vue cli3.11来搭建项目，可是搭建的时候一直卡在下载插件见面，就是下面这张图。</p>\n<p><img src=\"/images/vuecreate.png\" alt=\"vuecreate\"></p>\n<p>网上查了说不能用国内的镜像，WTF，不是说国内的更快吗？好吧，我换！！！</p>\n<h2 id=\"下载nrm\"><a href=\"#下载nrm\" class=\"headerlink\" title=\"下载nrm\"></a>下载nrm</h2><p>  看清楚哦，是nrm部署npm！！！nrm 是一个 <code>npm</code> 源管理器，允许你快速地在 <code>npm</code> 源间切换。执行以下命令安装。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">sudo npm install -g nrm</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"测试nrm是否安装成功\"><a href=\"#测试nrm是否安装成功\" class=\"headerlink\" title=\"测试nrm是否安装成功\"></a>测试nrm是否安装成功</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">nrm -V</span><br></pre></td></tr></table></figure>\n\n<p>如果输出版本号，则说明安装成功。</p>\n<h2 id=\"切换npm源\"><a href=\"#切换npm源\" class=\"headerlink\" title=\"切换npm源\"></a>切换npm源</h2>  <figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">nrm ls</span><br></pre></td></tr></table></figure>\n\n<p>此命令会列出npm的所有源</p>\n<p><img src=\"/images/nrmls.png\" alt=\"nrmls\"></p>\n<p>可以看到我现在使用的是淘宝的源，现在把他切换到npm的源。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">nrm use npm</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/nrmuse.png\" alt=\"nrmuse\"></p>\n<h2 id=\"再次创建vue项目\"><a href=\"#再次创建vue项目\" class=\"headerlink\" title=\"再次创建vue项目\"></a>再次创建vue项目</h2><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">vue create rrr2</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/images/vuecreate2.png\" alt=\"vuecreate2\"><br><img src=\"/images/vuecreate3.png\" alt=\"vuecreate3\"></p>\n<p>项目成功创建！！！</p>\n"},{"title":"RestTemplate简单使用","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2019-11-20T09:32:18.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n## 前言\n\n​\t本文只讲常用的**GET** 和**POST**请求,其他类型的请求(如**PUT**，**PATCH**)请求方式都差不多，有兴趣的可以查看RestTemplate源码。\n\n## GET\n\n> GET官方给了**getForEntity**和**getForObject**两种种方法，每个方法又有三个重载方法\n\n### 官方源码接口\n\n```java\n\t@Nullable\n\t<T> T getForObject(String url, Class<T> responseType, Object... uriVariables) throws RestClientException;\n\n\t@Nullable\n\t<T> T getForObject(String url, Class<T> responseType, Map<String, ?> uriVariables) throws RestClientException;\n\n\t@Nullable\n\t<T> T getForObject(URI url, Class<T> responseType) throws RestClientException;\n\n\t<T> ResponseEntity<T> getForEntity(String url, Class<T> responseType, Object... uriVariables)\n\t\t\tthrows RestClientException;\n\n\t<T> ResponseEntity<T> getForEntity(String url, Class<T> responseType, Map<String, ?> uriVariables)\n\t\t\tthrows RestClientException;\n\n\t<T> ResponseEntity<T> getForEntity(URI url, Class<T> responseType) throws RestClientException;\n```\n\n### 使用\n\n#### API接口\n\n>  首先我写了两个接口供RestTemplate调用\n\n```java\n@RestController\npublic class Test {\n\n    @GetMapping(\"/test\")\n    public JSONObject test(){\n        JSONObject jsonObject=new JSONObject();\n        jsonObject.put(\"name:\",\"Mr.Zheng\");\n        jsonObject.put(\"tag:\",\"Good\");\n        return jsonObject;\n    }\n\n    @GetMapping(\"/test/{name}\")\n    public JSONObject test2(@PathVariable String name){\n        JSONObject jsonObject=new JSONObject();\n        jsonObject.put(\"name:\",name);\n        jsonObject.put(\"tag:\",\"Good\");\n        return jsonObject;\n    }\n    \n}\n```\n\n#### getForObject\n\n##### 代码\n\n```java\n\t@Test\n    public void restTemplate(){\n        RestTemplate template=new RestTemplate();\n\n        //使用URI请求\n        URI uri=URI.create(\"http://localhost:8090/test\");\n        String response=template.getForObject(uri, String.class);\n        System.out.println(response);\n\n        //url带参数请求 \n        String response2=template.getForObject(\"http://localhost:8090/test/{name}\",String.class,\"hui1\");\n        System.out.println(response2);\n\n        //当url参数过多可以用map\n        Map<String,String> param=new HashMap<>();\n        param.put(\"name\",\"hui2\");\n        String reponse3=template.getForObject(\"http://localhost:8090/test/{name}\",String.class,param);\n        System.out.println(reponse3);\n    }\n```\n\n##### 结果:\n\n```java\n{\"name:\":\"Mr.Zheng\",\"tag:\":\"Good\"}\n{\"name:\":\"hui1\",\"tag:\":\"Good\"}\n{\"name:\":\"hui2\",\"tag:\":\"Good\"}\n```\n\n\n\n#### getForEntity\n\n##### 代码\n\n```java\n    @Test\n    public void restTemplate(){\n        RestTemplate template=new RestTemplate();\n\n        //使用URI请求\n        URI uri=URI.create(\"http://localhost:8090/test\");\n        ResponseEntity<String> response=template.getForEntity(uri, String.class);\n        System.out.println(response.getBody());\n\n        //url带参数请求\n        ResponseEntity<String> response2=template.getForEntity(\"http://localhost:8090/test/{name}\",String.class,\"hui1\");\n        System.out.println(response2.getBody());\n\n        //当url参数过多可以用map\n        Map<String,String> param=new HashMap<>();\n        param.put(\"name\",\"hui2\");\n        ResponseEntity<String> reponse3=template.getForEntity(\"http://localhost:8090/test/{name}\",String.class,param);\n        System.out.println(reponse3.getBody());\n    }\n```\n\n\n\n##### 结果\n\n```java\n{\"name:\":\"Mr.Zheng\",\"tag:\":\"Good\"}\n{\"name:\":\"hui1\",\"tag:\":\"Good\"}\n{\"name:\":\"hui2\",\"tag:\":\"Good\"}\n```\n\n\n\n### 小结\n\n可以看到**getForEntity**和**getForObject**的使用方法差不多，他们的区别就是\n\n- getForObject只返回结果，getForEntity包装了返回的信息，可以从中获取更多关于http请求的信息，比如请求头，请求状态等\n\n## POST\n\n> POST官方给了**postForLocation**,**postForObject**,**postForEntity**三种方法，每种又有三个重载方法\n\n### 官方源码接口\n\n```java\n\t@Nullable\n\tURI postForLocation(String url, @Nullable Object request, Object... uriVariables) throws RestClientException;\n\n\t@Nullable\n\tURI postForLocation(String url, @Nullable Object request, Map<String, ?> uriVariables)\n\t\t\tthrows RestClientException;\n\n\t@Nullable\n\tURI postForLocation(URI url, @Nullable Object request) throws RestClientException;\n\n\t@Nullable\n\t<T> T postForObject(String url, @Nullable Object request, Class<T> responseType,\n\t\t\tObject... uriVariables) throws RestClientException;\n\n\t@Nullable\n\t<T> T postForObject(String url, @Nullable Object request, Class<T> responseType,\n\t\t\tMap<String, ?> uriVariables) throws RestClientException;\n\n\t@Nullable\n\t<T> T postForObject(URI url, @Nullable Object request, Class<T> responseType) throws RestClientException;\n\n\t<T> ResponseEntity<T> postForEntity(String url, @Nullable Object request, Class<T> responseType,\n\t\t\tObject... uriVariables) throws RestClientException;\n\n\t<T> ResponseEntity<T> postForEntity(String url, @Nullable Object request, Class<T> responseType,\n\t\t\tMap<String, ?> uriVariables) throws RestClientException;\n\n\t<T> ResponseEntity<T> postForEntity(URI url, @Nullable Object request, Class<T> responseType)\n\t\t\tthrows RestClientException;\n```\n\n\n\n### API接口\n\n```java\n@RestController\npublic class Test {\n    private static final Logger LOG= LoggerFactory.getLogger(Test.class);\n\n    @PostMapping(\"/test\")\n    public JSONObject test(@RequestBody JSONObject param){\n        LOG.info(\"param:{}\",param.toJSONString());\n        return param;\n    }\n\n    @PostMapping(\"/test/{urlParam}\")\n    public JSONObject test(@RequestBody JSONObject param,@PathVariable String urlParam){\n        LOG.info(\"param:{}\",param);\n        param.put(\"urlParam\",urlParam);\n        return param;\n    }\n    \n}\n```\n\n### postForObject\n\n#### 代码\n\n```java\n    @Test\n    public void restTemplate(){\n        RestTemplate template=new RestTemplate();\n        String baseURL=\"http://localhost:8090\";\n        JSONObject param=new JSONObject();\n        param.put(\"tag\",\"this is post request!!\");\n\n        //使用URI请求\n        URI uri=URI.create(baseURL+\"/test\");\n        String response=template.postForObject(uri,param,String.class);\n        System.out.println(response);\n\n        //url带参数请求\n        String response2=template.postForObject(baseURL+\"/test/{urlParam}\",param,String.class,\"this is urlParam\");\n        System.out.println(response2);\n\n        //当url参数过多可以用map\n        Map<String,String> mapParam=new HashMap<>();\n        mapParam.put(\"urlParam\",\"this is map param!!\");\n        String reponse3=template.postForObject(baseURL+\"/test/{urlParam}\",param,String.class,mapParam);\n        System.out.println(reponse3);\n    }\n```\n\n#### 结果\n\n```java\n{\"tag\":\"this is post request!!\"}\n{\"tag\":\"this is post request!!\",\"urlParam\":\"this is urlParam\"}\n{\"tag\":\"this is post request!!\",\"urlParam\":\"this is map param!!\"}\n```\n\n\n\n### postForEntity\n\n> postForEntity和postForObject用法类似，具体这里就写了。\n\n\n\n### postForLocation\n\n> 这个请求和其他请求不一样，可以看到他返回的是URI，这里具体讲一下\n\n#### 新写个API接口\n\n```java\n@RestController\npublic class UriTest {\n    private static final Logger LOG= LoggerFactory.getLogger(UriTest.class);\n\n    @PostMapping(\"/uri\")\n    public void uriTest(@RequestBody JSONObject param, HttpServletResponse response) throws IOException {\n        try {\n            //打印上传的参数\n            LOG.info(\"requestParam:{}\",param);\n            //跳转百度\n            response.sendRedirect(\"https://www.baidu.com\");\n        }catch (Exception e){\n            LOG.info(e.getMessage(),e);\n        }\n    }\n}\n```\n\n#### 代码\n\n```java\n    @Test\n    public void restTemplate(){\n        RestTemplate template=new RestTemplate();\n        String baseURL=\"http://localhost:8090\";\n        JSONObject param=new JSONObject();\n        param.put(\"info\",\"this is postForLocation test!!\");\n\n        URI response2=template.postForLocation(baseURL+\"/uri\",param);\n        System.out.println(response2);\n    }\n```\n\n#### 结果\n\n![代码运行结果](http://cdn.mjava.top/blog/20191120165138.png)\n\n\n\n#### 服务端日志\n\n![服务端日志](http://cdn.mjava.top/blog/20191120165302.png)\n\n### 小结\n\n**postForObject**和**postForEntity**两个方法和GET请求的用法差不多，只是POST请求比GET请求多了个request请求体。而**postForLocation**方法一般用的比较少,一般只有后端发生301或302等跳转时用来获取跳转后的URL，方法的形参中不用定义返回的数据类型，默认是URI；","source":"_posts/spring/spring-boot-resttemplate-example.md","raw":"---\ntitle: RestTemplate简单使用\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2019-11-20 17:32:18\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n - SpringBoot\ncategories:\n - Spring\n---\n\n\n\n## 前言\n\n​\t本文只讲常用的**GET** 和**POST**请求,其他类型的请求(如**PUT**，**PATCH**)请求方式都差不多，有兴趣的可以查看RestTemplate源码。\n\n## GET\n\n> GET官方给了**getForEntity**和**getForObject**两种种方法，每个方法又有三个重载方法\n\n### 官方源码接口\n\n```java\n\t@Nullable\n\t<T> T getForObject(String url, Class<T> responseType, Object... uriVariables) throws RestClientException;\n\n\t@Nullable\n\t<T> T getForObject(String url, Class<T> responseType, Map<String, ?> uriVariables) throws RestClientException;\n\n\t@Nullable\n\t<T> T getForObject(URI url, Class<T> responseType) throws RestClientException;\n\n\t<T> ResponseEntity<T> getForEntity(String url, Class<T> responseType, Object... uriVariables)\n\t\t\tthrows RestClientException;\n\n\t<T> ResponseEntity<T> getForEntity(String url, Class<T> responseType, Map<String, ?> uriVariables)\n\t\t\tthrows RestClientException;\n\n\t<T> ResponseEntity<T> getForEntity(URI url, Class<T> responseType) throws RestClientException;\n```\n\n### 使用\n\n#### API接口\n\n>  首先我写了两个接口供RestTemplate调用\n\n```java\n@RestController\npublic class Test {\n\n    @GetMapping(\"/test\")\n    public JSONObject test(){\n        JSONObject jsonObject=new JSONObject();\n        jsonObject.put(\"name:\",\"Mr.Zheng\");\n        jsonObject.put(\"tag:\",\"Good\");\n        return jsonObject;\n    }\n\n    @GetMapping(\"/test/{name}\")\n    public JSONObject test2(@PathVariable String name){\n        JSONObject jsonObject=new JSONObject();\n        jsonObject.put(\"name:\",name);\n        jsonObject.put(\"tag:\",\"Good\");\n        return jsonObject;\n    }\n    \n}\n```\n\n#### getForObject\n\n##### 代码\n\n```java\n\t@Test\n    public void restTemplate(){\n        RestTemplate template=new RestTemplate();\n\n        //使用URI请求\n        URI uri=URI.create(\"http://localhost:8090/test\");\n        String response=template.getForObject(uri, String.class);\n        System.out.println(response);\n\n        //url带参数请求 \n        String response2=template.getForObject(\"http://localhost:8090/test/{name}\",String.class,\"hui1\");\n        System.out.println(response2);\n\n        //当url参数过多可以用map\n        Map<String,String> param=new HashMap<>();\n        param.put(\"name\",\"hui2\");\n        String reponse3=template.getForObject(\"http://localhost:8090/test/{name}\",String.class,param);\n        System.out.println(reponse3);\n    }\n```\n\n##### 结果:\n\n```java\n{\"name:\":\"Mr.Zheng\",\"tag:\":\"Good\"}\n{\"name:\":\"hui1\",\"tag:\":\"Good\"}\n{\"name:\":\"hui2\",\"tag:\":\"Good\"}\n```\n\n\n\n#### getForEntity\n\n##### 代码\n\n```java\n    @Test\n    public void restTemplate(){\n        RestTemplate template=new RestTemplate();\n\n        //使用URI请求\n        URI uri=URI.create(\"http://localhost:8090/test\");\n        ResponseEntity<String> response=template.getForEntity(uri, String.class);\n        System.out.println(response.getBody());\n\n        //url带参数请求\n        ResponseEntity<String> response2=template.getForEntity(\"http://localhost:8090/test/{name}\",String.class,\"hui1\");\n        System.out.println(response2.getBody());\n\n        //当url参数过多可以用map\n        Map<String,String> param=new HashMap<>();\n        param.put(\"name\",\"hui2\");\n        ResponseEntity<String> reponse3=template.getForEntity(\"http://localhost:8090/test/{name}\",String.class,param);\n        System.out.println(reponse3.getBody());\n    }\n```\n\n\n\n##### 结果\n\n```java\n{\"name:\":\"Mr.Zheng\",\"tag:\":\"Good\"}\n{\"name:\":\"hui1\",\"tag:\":\"Good\"}\n{\"name:\":\"hui2\",\"tag:\":\"Good\"}\n```\n\n\n\n### 小结\n\n可以看到**getForEntity**和**getForObject**的使用方法差不多，他们的区别就是\n\n- getForObject只返回结果，getForEntity包装了返回的信息，可以从中获取更多关于http请求的信息，比如请求头，请求状态等\n\n## POST\n\n> POST官方给了**postForLocation**,**postForObject**,**postForEntity**三种方法，每种又有三个重载方法\n\n### 官方源码接口\n\n```java\n\t@Nullable\n\tURI postForLocation(String url, @Nullable Object request, Object... uriVariables) throws RestClientException;\n\n\t@Nullable\n\tURI postForLocation(String url, @Nullable Object request, Map<String, ?> uriVariables)\n\t\t\tthrows RestClientException;\n\n\t@Nullable\n\tURI postForLocation(URI url, @Nullable Object request) throws RestClientException;\n\n\t@Nullable\n\t<T> T postForObject(String url, @Nullable Object request, Class<T> responseType,\n\t\t\tObject... uriVariables) throws RestClientException;\n\n\t@Nullable\n\t<T> T postForObject(String url, @Nullable Object request, Class<T> responseType,\n\t\t\tMap<String, ?> uriVariables) throws RestClientException;\n\n\t@Nullable\n\t<T> T postForObject(URI url, @Nullable Object request, Class<T> responseType) throws RestClientException;\n\n\t<T> ResponseEntity<T> postForEntity(String url, @Nullable Object request, Class<T> responseType,\n\t\t\tObject... uriVariables) throws RestClientException;\n\n\t<T> ResponseEntity<T> postForEntity(String url, @Nullable Object request, Class<T> responseType,\n\t\t\tMap<String, ?> uriVariables) throws RestClientException;\n\n\t<T> ResponseEntity<T> postForEntity(URI url, @Nullable Object request, Class<T> responseType)\n\t\t\tthrows RestClientException;\n```\n\n\n\n### API接口\n\n```java\n@RestController\npublic class Test {\n    private static final Logger LOG= LoggerFactory.getLogger(Test.class);\n\n    @PostMapping(\"/test\")\n    public JSONObject test(@RequestBody JSONObject param){\n        LOG.info(\"param:{}\",param.toJSONString());\n        return param;\n    }\n\n    @PostMapping(\"/test/{urlParam}\")\n    public JSONObject test(@RequestBody JSONObject param,@PathVariable String urlParam){\n        LOG.info(\"param:{}\",param);\n        param.put(\"urlParam\",urlParam);\n        return param;\n    }\n    \n}\n```\n\n### postForObject\n\n#### 代码\n\n```java\n    @Test\n    public void restTemplate(){\n        RestTemplate template=new RestTemplate();\n        String baseURL=\"http://localhost:8090\";\n        JSONObject param=new JSONObject();\n        param.put(\"tag\",\"this is post request!!\");\n\n        //使用URI请求\n        URI uri=URI.create(baseURL+\"/test\");\n        String response=template.postForObject(uri,param,String.class);\n        System.out.println(response);\n\n        //url带参数请求\n        String response2=template.postForObject(baseURL+\"/test/{urlParam}\",param,String.class,\"this is urlParam\");\n        System.out.println(response2);\n\n        //当url参数过多可以用map\n        Map<String,String> mapParam=new HashMap<>();\n        mapParam.put(\"urlParam\",\"this is map param!!\");\n        String reponse3=template.postForObject(baseURL+\"/test/{urlParam}\",param,String.class,mapParam);\n        System.out.println(reponse3);\n    }\n```\n\n#### 结果\n\n```java\n{\"tag\":\"this is post request!!\"}\n{\"tag\":\"this is post request!!\",\"urlParam\":\"this is urlParam\"}\n{\"tag\":\"this is post request!!\",\"urlParam\":\"this is map param!!\"}\n```\n\n\n\n### postForEntity\n\n> postForEntity和postForObject用法类似，具体这里就写了。\n\n\n\n### postForLocation\n\n> 这个请求和其他请求不一样，可以看到他返回的是URI，这里具体讲一下\n\n#### 新写个API接口\n\n```java\n@RestController\npublic class UriTest {\n    private static final Logger LOG= LoggerFactory.getLogger(UriTest.class);\n\n    @PostMapping(\"/uri\")\n    public void uriTest(@RequestBody JSONObject param, HttpServletResponse response) throws IOException {\n        try {\n            //打印上传的参数\n            LOG.info(\"requestParam:{}\",param);\n            //跳转百度\n            response.sendRedirect(\"https://www.baidu.com\");\n        }catch (Exception e){\n            LOG.info(e.getMessage(),e);\n        }\n    }\n}\n```\n\n#### 代码\n\n```java\n    @Test\n    public void restTemplate(){\n        RestTemplate template=new RestTemplate();\n        String baseURL=\"http://localhost:8090\";\n        JSONObject param=new JSONObject();\n        param.put(\"info\",\"this is postForLocation test!!\");\n\n        URI response2=template.postForLocation(baseURL+\"/uri\",param);\n        System.out.println(response2);\n    }\n```\n\n#### 结果\n\n![代码运行结果](http://cdn.mjava.top/blog/20191120165138.png)\n\n\n\n#### 服务端日志\n\n![服务端日志](http://cdn.mjava.top/blog/20191120165302.png)\n\n### 小结\n\n**postForObject**和**postForEntity**两个方法和GET请求的用法差不多，只是POST请求比GET请求多了个request请求体。而**postForLocation**方法一般用的比较少,一般只有后端发生301或302等跳转时用来获取跳转后的URL，方法的形参中不用定义返回的数据类型，默认是URI；","slug":"spring/spring-boot-resttemplate-example","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bkk00422mg58tj5npoz","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>​    本文只讲常用的<strong>GET</strong> 和<strong>POST</strong>请求,其他类型的请求(如<strong>PUT</strong>，<strong>PATCH</strong>)请求方式都差不多，有兴趣的可以查看RestTemplate源码。</p>\n<h2 id=\"GET\"><a href=\"#GET\" class=\"headerlink\" title=\"GET\"></a>GET</h2><blockquote>\n<p>GET官方给了<strong>getForEntity</strong>和<strong>getForObject</strong>两种种方法，每个方法又有三个重载方法</p>\n</blockquote>\n<h3 id=\"官方源码接口\"><a href=\"#官方源码接口\" class=\"headerlink\" title=\"官方源码接口\"></a>官方源码接口</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">getForObject</span><span class=\"params\">(String url, Class&lt;T&gt; responseType, Object... uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">getForObject</span><span class=\"params\">(String url, Class&lt;T&gt; responseType, Map&lt;String, ?&gt; uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">getForObject</span><span class=\"params\">(URI url, Class&lt;T&gt; responseType)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">getForEntity</span><span class=\"params\">(String url, Class&lt;T&gt; responseType, Object... uriVariables)</span></span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">getForEntity</span><span class=\"params\">(String url, Class&lt;T&gt; responseType, Map&lt;String, ?&gt; uriVariables)</span></span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">getForEntity</span><span class=\"params\">(URI url, Class&lt;T&gt; responseType)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h3><h4 id=\"API接口\"><a href=\"#API接口\" class=\"headerlink\" title=\"API接口\"></a>API接口</h4><blockquote>\n<p> 首先我写了两个接口供RestTemplate调用</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JSONObject <span class=\"title\">test</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        JSONObject jsonObject=<span class=\"keyword\">new</span> JSONObject();</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">\"name:\"</span>,<span class=\"string\">\"Mr.Zheng\"</span>);</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">\"tag:\"</span>,<span class=\"string\">\"Good\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jsonObject;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/test/&#123;name&#125;\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JSONObject <span class=\"title\">test2</span><span class=\"params\">(@PathVariable String name)</span></span>&#123;</span><br><span class=\"line\">        JSONObject jsonObject=<span class=\"keyword\">new</span> JSONObject();</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">\"name:\"</span>,name);</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">\"tag:\"</span>,<span class=\"string\">\"Good\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jsonObject;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"getForObject\"><a href=\"#getForObject\" class=\"headerlink\" title=\"getForObject\"></a>getForObject</h4><h5 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">restTemplate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">       RestTemplate template=<span class=\"keyword\">new</span> RestTemplate();</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\">//使用URI请求</span></span><br><span class=\"line\">       URI uri=URI.create(<span class=\"string\">\"http://localhost:8090/test\"</span>);</span><br><span class=\"line\">       String response=template.getForObject(uri, String.class);</span><br><span class=\"line\">       System.out.println(response);</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\">//url带参数请求 </span></span><br><span class=\"line\">       String response2=template.getForObject(<span class=\"string\">\"http://localhost:8090/test/&#123;name&#125;\"</span>,String.class,<span class=\"string\">\"hui1\"</span>);</span><br><span class=\"line\">       System.out.println(response2);</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\">//当url参数过多可以用map</span></span><br><span class=\"line\">       Map&lt;String,String&gt; param=<span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">       param.put(<span class=\"string\">\"name\"</span>,<span class=\"string\">\"hui2\"</span>);</span><br><span class=\"line\">       String reponse3=template.getForObject(<span class=\"string\">\"http://localhost:8090/test/&#123;name&#125;\"</span>,String.class,param);</span><br><span class=\"line\">       System.out.println(reponse3);</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"结果\"><a href=\"#结果\" class=\"headerlink\" title=\"结果:\"></a>结果:</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"Mr.Zheng\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"hui1\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"hui2\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"getForEntity\"><a href=\"#getForEntity\" class=\"headerlink\" title=\"getForEntity\"></a>getForEntity</h4><h5 id=\"代码-1\"><a href=\"#代码-1\" class=\"headerlink\" title=\"代码\"></a>代码</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">restTemplate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    RestTemplate template=<span class=\"keyword\">new</span> RestTemplate();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//使用URI请求</span></span><br><span class=\"line\">    URI uri=URI.create(<span class=\"string\">\"http://localhost:8090/test\"</span>);</span><br><span class=\"line\">    ResponseEntity&lt;String&gt; response=template.getForEntity(uri, String.class);</span><br><span class=\"line\">    System.out.println(response.getBody());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//url带参数请求</span></span><br><span class=\"line\">    ResponseEntity&lt;String&gt; response2=template.getForEntity(<span class=\"string\">\"http://localhost:8090/test/&#123;name&#125;\"</span>,String.class,<span class=\"string\">\"hui1\"</span>);</span><br><span class=\"line\">    System.out.println(response2.getBody());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//当url参数过多可以用map</span></span><br><span class=\"line\">    Map&lt;String,String&gt; param=<span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    param.put(<span class=\"string\">\"name\"</span>,<span class=\"string\">\"hui2\"</span>);</span><br><span class=\"line\">    ResponseEntity&lt;String&gt; reponse3=template.getForEntity(<span class=\"string\">\"http://localhost:8090/test/&#123;name&#125;\"</span>,String.class,param);</span><br><span class=\"line\">    System.out.println(reponse3.getBody());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"结果-1\"><a href=\"#结果-1\" class=\"headerlink\" title=\"结果\"></a>结果</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"Mr.Zheng\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"hui1\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"hui2\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h3><p>可以看到<strong>getForEntity</strong>和<strong>getForObject</strong>的使用方法差不多，他们的区别就是</p>\n<ul>\n<li>getForObject只返回结果，getForEntity包装了返回的信息，可以从中获取更多关于http请求的信息，比如请求头，请求状态等</li>\n</ul>\n<h2 id=\"POST\"><a href=\"#POST\" class=\"headerlink\" title=\"POST\"></a>POST</h2><blockquote>\n<p>POST官方给了<strong>postForLocation</strong>,<strong>postForObject</strong>,<strong>postForEntity</strong>三种方法，每种又有三个重载方法</p>\n</blockquote>\n<h3 id=\"官方源码接口-1\"><a href=\"#官方源码接口-1\" class=\"headerlink\" title=\"官方源码接口\"></a>官方源码接口</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\"><span class=\"function\">URI <span class=\"title\">postForLocation</span><span class=\"params\">(String url, @Nullable Object request, Object... uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\"><span class=\"function\">URI <span class=\"title\">postForLocation</span><span class=\"params\">(String url, @Nullable Object request, Map&lt;String, ?&gt; uriVariables)</span></span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\"><span class=\"function\">URI <span class=\"title\">postForLocation</span><span class=\"params\">(URI url, @Nullable Object request)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">postForObject</span><span class=\"params\">(String url, @Nullable Object request, Class&lt;T&gt; responseType,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\tObject... uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">postForObject</span><span class=\"params\">(String url, @Nullable Object request, Class&lt;T&gt; responseType,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\tMap&lt;String, ?&gt; uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">postForObject</span><span class=\"params\">(URI url, @Nullable Object request, Class&lt;T&gt; responseType)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">postForEntity</span><span class=\"params\">(String url, @Nullable Object request, Class&lt;T&gt; responseType,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\tObject... uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">postForEntity</span><span class=\"params\">(String url, @Nullable Object request, Class&lt;T&gt; responseType,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\tMap&lt;String, ?&gt; uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">postForEntity</span><span class=\"params\">(URI url, @Nullable Object request, Class&lt;T&gt; responseType)</span></span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"keyword\">throws</span> RestClientException</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"API接口-1\"><a href=\"#API接口-1\" class=\"headerlink\" title=\"API接口\"></a>API接口</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Logger LOG= LoggerFactory.getLogger(Test.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping</span>(<span class=\"string\">\"/test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JSONObject <span class=\"title\">test</span><span class=\"params\">(@RequestBody JSONObject param)</span></span>&#123;</span><br><span class=\"line\">        LOG.info(<span class=\"string\">\"param:&#123;&#125;\"</span>,param.toJSONString());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> param;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping</span>(<span class=\"string\">\"/test/&#123;urlParam&#125;\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JSONObject <span class=\"title\">test</span><span class=\"params\">(@RequestBody JSONObject param,@PathVariable String urlParam)</span></span>&#123;</span><br><span class=\"line\">        LOG.info(<span class=\"string\">\"param:&#123;&#125;\"</span>,param);</span><br><span class=\"line\">        param.put(<span class=\"string\">\"urlParam\"</span>,urlParam);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> param;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"postForObject\"><a href=\"#postForObject\" class=\"headerlink\" title=\"postForObject\"></a>postForObject</h3><h4 id=\"代码-2\"><a href=\"#代码-2\" class=\"headerlink\" title=\"代码\"></a>代码</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">restTemplate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    RestTemplate template=<span class=\"keyword\">new</span> RestTemplate();</span><br><span class=\"line\">    String baseURL=<span class=\"string\">\"http://localhost:8090\"</span>;</span><br><span class=\"line\">    JSONObject param=<span class=\"keyword\">new</span> JSONObject();</span><br><span class=\"line\">    param.put(<span class=\"string\">\"tag\"</span>,<span class=\"string\">\"this is post request!!\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//使用URI请求</span></span><br><span class=\"line\">    URI uri=URI.create(baseURL+<span class=\"string\">\"/test\"</span>);</span><br><span class=\"line\">    String response=template.postForObject(uri,param,String.class);</span><br><span class=\"line\">    System.out.println(response);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//url带参数请求</span></span><br><span class=\"line\">    String response2=template.postForObject(baseURL+<span class=\"string\">\"/test/&#123;urlParam&#125;\"</span>,param,String.class,<span class=\"string\">\"this is urlParam\"</span>);</span><br><span class=\"line\">    System.out.println(response2);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//当url参数过多可以用map</span></span><br><span class=\"line\">    Map&lt;String,String&gt; mapParam=<span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    mapParam.put(<span class=\"string\">\"urlParam\"</span>,<span class=\"string\">\"this is map param!!\"</span>);</span><br><span class=\"line\">    String reponse3=template.postForObject(baseURL+<span class=\"string\">\"/test/&#123;urlParam&#125;\"</span>,param,String.class,mapParam);</span><br><span class=\"line\">    System.out.println(reponse3);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"结果-2\"><a href=\"#结果-2\" class=\"headerlink\" title=\"结果\"></a>结果</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"string\">\"tag\"</span>:<span class=\"string\">\"this is post request!!\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"tag\"</span>:<span class=\"string\">\"this is post request!!\"</span>,<span class=\"string\">\"urlParam\"</span>:<span class=\"string\">\"this is urlParam\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"tag\"</span>:<span class=\"string\">\"this is post request!!\"</span>,<span class=\"string\">\"urlParam\"</span>:<span class=\"string\">\"this is map param!!\"</span>&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"postForEntity\"><a href=\"#postForEntity\" class=\"headerlink\" title=\"postForEntity\"></a>postForEntity</h3><blockquote>\n<p>postForEntity和postForObject用法类似，具体这里就写了。</p>\n</blockquote>\n<h3 id=\"postForLocation\"><a href=\"#postForLocation\" class=\"headerlink\" title=\"postForLocation\"></a>postForLocation</h3><blockquote>\n<p>这个请求和其他请求不一样，可以看到他返回的是URI，这里具体讲一下</p>\n</blockquote>\n<h4 id=\"新写个API接口\"><a href=\"#新写个API接口\" class=\"headerlink\" title=\"新写个API接口\"></a>新写个API接口</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UriTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Logger LOG= LoggerFactory.getLogger(UriTest.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping</span>(<span class=\"string\">\"/uri\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">uriTest</span><span class=\"params\">(@RequestBody JSONObject param, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//打印上传的参数</span></span><br><span class=\"line\">            LOG.info(<span class=\"string\">\"requestParam:&#123;&#125;\"</span>,param);</span><br><span class=\"line\">            <span class=\"comment\">//跳转百度</span></span><br><span class=\"line\">            response.sendRedirect(<span class=\"string\">\"https://www.baidu.com\"</span>);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</span><br><span class=\"line\">            LOG.info(e.getMessage(),e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"代码-3\"><a href=\"#代码-3\" class=\"headerlink\" title=\"代码\"></a>代码</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">restTemplate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    RestTemplate template=<span class=\"keyword\">new</span> RestTemplate();</span><br><span class=\"line\">    String baseURL=<span class=\"string\">\"http://localhost:8090\"</span>;</span><br><span class=\"line\">    JSONObject param=<span class=\"keyword\">new</span> JSONObject();</span><br><span class=\"line\">    param.put(<span class=\"string\">\"info\"</span>,<span class=\"string\">\"this is postForLocation test!!\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    URI response2=template.postForLocation(baseURL+<span class=\"string\">\"/uri\"</span>,param);</span><br><span class=\"line\">    System.out.println(response2);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"结果-3\"><a href=\"#结果-3\" class=\"headerlink\" title=\"结果\"></a>结果</h4><p><img src=\"http://cdn.mjava.top/blog/20191120165138.png\" alt=\"代码运行结果\"></p>\n<h4 id=\"服务端日志\"><a href=\"#服务端日志\" class=\"headerlink\" title=\"服务端日志\"></a>服务端日志</h4><p><img src=\"http://cdn.mjava.top/blog/20191120165302.png\" alt=\"服务端日志\"></p>\n<h3 id=\"小结-1\"><a href=\"#小结-1\" class=\"headerlink\" title=\"小结\"></a>小结</h3><p><strong>postForObject</strong>和<strong>postForEntity</strong>两个方法和GET请求的用法差不多，只是POST请求比GET请求多了个request请求体。而<strong>postForLocation</strong>方法一般用的比较少,一般只有后端发生301或302等跳转时用来获取跳转后的URL，方法的形参中不用定义返回的数据类型，默认是URI；</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>​    本文只讲常用的<strong>GET</strong> 和<strong>POST</strong>请求,其他类型的请求(如<strong>PUT</strong>，<strong>PATCH</strong>)请求方式都差不多，有兴趣的可以查看RestTemplate源码。</p>\n<h2 id=\"GET\"><a href=\"#GET\" class=\"headerlink\" title=\"GET\"></a>GET</h2><blockquote>\n<p>GET官方给了<strong>getForEntity</strong>和<strong>getForObject</strong>两种种方法，每个方法又有三个重载方法</p>\n</blockquote>\n<h3 id=\"官方源码接口\"><a href=\"#官方源码接口\" class=\"headerlink\" title=\"官方源码接口\"></a>官方源码接口</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">getForObject</span><span class=\"params\">(String url, Class&lt;T&gt; responseType, Object... uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">getForObject</span><span class=\"params\">(String url, Class&lt;T&gt; responseType, Map&lt;String, ?&gt; uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">getForObject</span><span class=\"params\">(URI url, Class&lt;T&gt; responseType)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">getForEntity</span><span class=\"params\">(String url, Class&lt;T&gt; responseType, Object... uriVariables)</span></span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">getForEntity</span><span class=\"params\">(String url, Class&lt;T&gt; responseType, Map&lt;String, ?&gt; uriVariables)</span></span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">getForEntity</span><span class=\"params\">(URI url, Class&lt;T&gt; responseType)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h3><h4 id=\"API接口\"><a href=\"#API接口\" class=\"headerlink\" title=\"API接口\"></a>API接口</h4><blockquote>\n<p> 首先我写了两个接口供RestTemplate调用</p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JSONObject <span class=\"title\">test</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">        JSONObject jsonObject=<span class=\"keyword\">new</span> JSONObject();</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">\"name:\"</span>,<span class=\"string\">\"Mr.Zheng\"</span>);</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">\"tag:\"</span>,<span class=\"string\">\"Good\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jsonObject;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@GetMapping</span>(<span class=\"string\">\"/test/&#123;name&#125;\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JSONObject <span class=\"title\">test2</span><span class=\"params\">(@PathVariable String name)</span></span>&#123;</span><br><span class=\"line\">        JSONObject jsonObject=<span class=\"keyword\">new</span> JSONObject();</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">\"name:\"</span>,name);</span><br><span class=\"line\">        jsonObject.put(<span class=\"string\">\"tag:\"</span>,<span class=\"string\">\"Good\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> jsonObject;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"getForObject\"><a href=\"#getForObject\" class=\"headerlink\" title=\"getForObject\"></a>getForObject</h4><h5 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\">   <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">restTemplate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">       RestTemplate template=<span class=\"keyword\">new</span> RestTemplate();</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\">//使用URI请求</span></span><br><span class=\"line\">       URI uri=URI.create(<span class=\"string\">\"http://localhost:8090/test\"</span>);</span><br><span class=\"line\">       String response=template.getForObject(uri, String.class);</span><br><span class=\"line\">       System.out.println(response);</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\">//url带参数请求 </span></span><br><span class=\"line\">       String response2=template.getForObject(<span class=\"string\">\"http://localhost:8090/test/&#123;name&#125;\"</span>,String.class,<span class=\"string\">\"hui1\"</span>);</span><br><span class=\"line\">       System.out.println(response2);</span><br><span class=\"line\"></span><br><span class=\"line\">       <span class=\"comment\">//当url参数过多可以用map</span></span><br><span class=\"line\">       Map&lt;String,String&gt; param=<span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">       param.put(<span class=\"string\">\"name\"</span>,<span class=\"string\">\"hui2\"</span>);</span><br><span class=\"line\">       String reponse3=template.getForObject(<span class=\"string\">\"http://localhost:8090/test/&#123;name&#125;\"</span>,String.class,param);</span><br><span class=\"line\">       System.out.println(reponse3);</span><br><span class=\"line\">   &#125;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"结果\"><a href=\"#结果\" class=\"headerlink\" title=\"结果:\"></a>结果:</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"Mr.Zheng\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"hui1\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"hui2\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"getForEntity\"><a href=\"#getForEntity\" class=\"headerlink\" title=\"getForEntity\"></a>getForEntity</h4><h5 id=\"代码-1\"><a href=\"#代码-1\" class=\"headerlink\" title=\"代码\"></a>代码</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">restTemplate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    RestTemplate template=<span class=\"keyword\">new</span> RestTemplate();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//使用URI请求</span></span><br><span class=\"line\">    URI uri=URI.create(<span class=\"string\">\"http://localhost:8090/test\"</span>);</span><br><span class=\"line\">    ResponseEntity&lt;String&gt; response=template.getForEntity(uri, String.class);</span><br><span class=\"line\">    System.out.println(response.getBody());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//url带参数请求</span></span><br><span class=\"line\">    ResponseEntity&lt;String&gt; response2=template.getForEntity(<span class=\"string\">\"http://localhost:8090/test/&#123;name&#125;\"</span>,String.class,<span class=\"string\">\"hui1\"</span>);</span><br><span class=\"line\">    System.out.println(response2.getBody());</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//当url参数过多可以用map</span></span><br><span class=\"line\">    Map&lt;String,String&gt; param=<span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    param.put(<span class=\"string\">\"name\"</span>,<span class=\"string\">\"hui2\"</span>);</span><br><span class=\"line\">    ResponseEntity&lt;String&gt; reponse3=template.getForEntity(<span class=\"string\">\"http://localhost:8090/test/&#123;name&#125;\"</span>,String.class,param);</span><br><span class=\"line\">    System.out.println(reponse3.getBody());</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h5 id=\"结果-1\"><a href=\"#结果-1\" class=\"headerlink\" title=\"结果\"></a>结果</h5><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"Mr.Zheng\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"hui1\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"name:\"</span>:<span class=\"string\">\"hui2\"</span>,<span class=\"string\">\"tag:\"</span>:<span class=\"string\">\"Good\"</span>&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"小结\"><a href=\"#小结\" class=\"headerlink\" title=\"小结\"></a>小结</h3><p>可以看到<strong>getForEntity</strong>和<strong>getForObject</strong>的使用方法差不多，他们的区别就是</p>\n<ul>\n<li>getForObject只返回结果，getForEntity包装了返回的信息，可以从中获取更多关于http请求的信息，比如请求头，请求状态等</li>\n</ul>\n<h2 id=\"POST\"><a href=\"#POST\" class=\"headerlink\" title=\"POST\"></a>POST</h2><blockquote>\n<p>POST官方给了<strong>postForLocation</strong>,<strong>postForObject</strong>,<strong>postForEntity</strong>三种方法，每种又有三个重载方法</p>\n</blockquote>\n<h3 id=\"官方源码接口-1\"><a href=\"#官方源码接口-1\" class=\"headerlink\" title=\"官方源码接口\"></a>官方源码接口</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\"><span class=\"function\">URI <span class=\"title\">postForLocation</span><span class=\"params\">(String url, @Nullable Object request, Object... uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\"><span class=\"function\">URI <span class=\"title\">postForLocation</span><span class=\"params\">(String url, @Nullable Object request, Map&lt;String, ?&gt; uriVariables)</span></span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\"><span class=\"function\">URI <span class=\"title\">postForLocation</span><span class=\"params\">(URI url, @Nullable Object request)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">postForObject</span><span class=\"params\">(String url, @Nullable Object request, Class&lt;T&gt; responseType,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\tObject... uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">postForObject</span><span class=\"params\">(String url, @Nullable Object request, Class&lt;T&gt; responseType,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\tMap&lt;String, ?&gt; uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Nullable</span></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">T <span class=\"title\">postForObject</span><span class=\"params\">(URI url, @Nullable Object request, Class&lt;T&gt; responseType)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">postForEntity</span><span class=\"params\">(String url, @Nullable Object request, Class&lt;T&gt; responseType,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\tObject... uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">postForEntity</span><span class=\"params\">(String url, @Nullable Object request, Class&lt;T&gt; responseType,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\tMap&lt;String, ?&gt; uriVariables)</span> <span class=\"keyword\">throws</span> RestClientException</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;T&gt; <span class=\"function\">ResponseEntity&lt;T&gt; <span class=\"title\">postForEntity</span><span class=\"params\">(URI url, @Nullable Object request, Class&lt;T&gt; responseType)</span></span></span><br><span class=\"line\"><span class=\"function\">\t\t<span class=\"keyword\">throws</span> RestClientException</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"API接口-1\"><a href=\"#API接口-1\" class=\"headerlink\" title=\"API接口\"></a>API接口</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Logger LOG= LoggerFactory.getLogger(Test.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping</span>(<span class=\"string\">\"/test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JSONObject <span class=\"title\">test</span><span class=\"params\">(@RequestBody JSONObject param)</span></span>&#123;</span><br><span class=\"line\">        LOG.info(<span class=\"string\">\"param:&#123;&#125;\"</span>,param.toJSONString());</span><br><span class=\"line\">        <span class=\"keyword\">return</span> param;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping</span>(<span class=\"string\">\"/test/&#123;urlParam&#125;\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> JSONObject <span class=\"title\">test</span><span class=\"params\">(@RequestBody JSONObject param,@PathVariable String urlParam)</span></span>&#123;</span><br><span class=\"line\">        LOG.info(<span class=\"string\">\"param:&#123;&#125;\"</span>,param);</span><br><span class=\"line\">        param.put(<span class=\"string\">\"urlParam\"</span>,urlParam);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> param;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"postForObject\"><a href=\"#postForObject\" class=\"headerlink\" title=\"postForObject\"></a>postForObject</h3><h4 id=\"代码-2\"><a href=\"#代码-2\" class=\"headerlink\" title=\"代码\"></a>代码</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">restTemplate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    RestTemplate template=<span class=\"keyword\">new</span> RestTemplate();</span><br><span class=\"line\">    String baseURL=<span class=\"string\">\"http://localhost:8090\"</span>;</span><br><span class=\"line\">    JSONObject param=<span class=\"keyword\">new</span> JSONObject();</span><br><span class=\"line\">    param.put(<span class=\"string\">\"tag\"</span>,<span class=\"string\">\"this is post request!!\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//使用URI请求</span></span><br><span class=\"line\">    URI uri=URI.create(baseURL+<span class=\"string\">\"/test\"</span>);</span><br><span class=\"line\">    String response=template.postForObject(uri,param,String.class);</span><br><span class=\"line\">    System.out.println(response);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//url带参数请求</span></span><br><span class=\"line\">    String response2=template.postForObject(baseURL+<span class=\"string\">\"/test/&#123;urlParam&#125;\"</span>,param,String.class,<span class=\"string\">\"this is urlParam\"</span>);</span><br><span class=\"line\">    System.out.println(response2);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//当url参数过多可以用map</span></span><br><span class=\"line\">    Map&lt;String,String&gt; mapParam=<span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">    mapParam.put(<span class=\"string\">\"urlParam\"</span>,<span class=\"string\">\"this is map param!!\"</span>);</span><br><span class=\"line\">    String reponse3=template.postForObject(baseURL+<span class=\"string\">\"/test/&#123;urlParam&#125;\"</span>,param,String.class,mapParam);</span><br><span class=\"line\">    System.out.println(reponse3);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"结果-2\"><a href=\"#结果-2\" class=\"headerlink\" title=\"结果\"></a>结果</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;<span class=\"string\">\"tag\"</span>:<span class=\"string\">\"this is post request!!\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"tag\"</span>:<span class=\"string\">\"this is post request!!\"</span>,<span class=\"string\">\"urlParam\"</span>:<span class=\"string\">\"this is urlParam\"</span>&#125;</span><br><span class=\"line\">&#123;<span class=\"string\">\"tag\"</span>:<span class=\"string\">\"this is post request!!\"</span>,<span class=\"string\">\"urlParam\"</span>:<span class=\"string\">\"this is map param!!\"</span>&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"postForEntity\"><a href=\"#postForEntity\" class=\"headerlink\" title=\"postForEntity\"></a>postForEntity</h3><blockquote>\n<p>postForEntity和postForObject用法类似，具体这里就写了。</p>\n</blockquote>\n<h3 id=\"postForLocation\"><a href=\"#postForLocation\" class=\"headerlink\" title=\"postForLocation\"></a>postForLocation</h3><blockquote>\n<p>这个请求和其他请求不一样，可以看到他返回的是URI，这里具体讲一下</p>\n</blockquote>\n<h4 id=\"新写个API接口\"><a href=\"#新写个API接口\" class=\"headerlink\" title=\"新写个API接口\"></a>新写个API接口</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">UriTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Logger LOG= LoggerFactory.getLogger(UriTest.class);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@PostMapping</span>(<span class=\"string\">\"/uri\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">uriTest</span><span class=\"params\">(@RequestBody JSONObject param, HttpServletResponse response)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//打印上传的参数</span></span><br><span class=\"line\">            LOG.info(<span class=\"string\">\"requestParam:&#123;&#125;\"</span>,param);</span><br><span class=\"line\">            <span class=\"comment\">//跳转百度</span></span><br><span class=\"line\">            response.sendRedirect(<span class=\"string\">\"https://www.baidu.com\"</span>);</span><br><span class=\"line\">        &#125;<span class=\"keyword\">catch</span> (Exception e)&#123;</span><br><span class=\"line\">            LOG.info(e.getMessage(),e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"代码-3\"><a href=\"#代码-3\" class=\"headerlink\" title=\"代码\"></a>代码</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@Test</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">restTemplate</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    RestTemplate template=<span class=\"keyword\">new</span> RestTemplate();</span><br><span class=\"line\">    String baseURL=<span class=\"string\">\"http://localhost:8090\"</span>;</span><br><span class=\"line\">    JSONObject param=<span class=\"keyword\">new</span> JSONObject();</span><br><span class=\"line\">    param.put(<span class=\"string\">\"info\"</span>,<span class=\"string\">\"this is postForLocation test!!\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    URI response2=template.postForLocation(baseURL+<span class=\"string\">\"/uri\"</span>,param);</span><br><span class=\"line\">    System.out.println(response2);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"结果-3\"><a href=\"#结果-3\" class=\"headerlink\" title=\"结果\"></a>结果</h4><p><img src=\"http://cdn.mjava.top/blog/20191120165138.png\" alt=\"代码运行结果\"></p>\n<h4 id=\"服务端日志\"><a href=\"#服务端日志\" class=\"headerlink\" title=\"服务端日志\"></a>服务端日志</h4><p><img src=\"http://cdn.mjava.top/blog/20191120165302.png\" alt=\"服务端日志\"></p>\n<h3 id=\"小结-1\"><a href=\"#小结-1\" class=\"headerlink\" title=\"小结\"></a>小结</h3><p><strong>postForObject</strong>和<strong>postForEntity</strong>两个方法和GET请求的用法差不多，只是POST请求比GET请求多了个request请求体。而<strong>postForLocation</strong>方法一般用的比较少,一般只有后端发生301或302等跳转时用来获取跳转后的URL，方法的形参中不用定义返回的数据类型，默认是URI；</p>\n"},{"title":"【源码解析】你真的了解ArrayDeque嘛？","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-01-08T06:00:51.000Z","password":null,"summary":null,"keywords":null,"description":"LinkedList和ArrayDeque都是通过实现了Deque这个接口来获得队列和栈的功能。而Deque这个接口通过继承Queue这个接口来取得队列功能，然后在这个基础进行扩展，实现了双端队列，由此可以获得栈的功能。为了空间能得到充分利用，ArrayDeque使用了循环队列；还有LinkedList可以插入null值，而ArrayDeque是不能插入null的。","_content":"\n<div class=\"output_wrapper\" id=\"output_wrapper_id\" style=\"font-size: 15px; color: rgb(62, 62, 62); line-height: 1.8; word-spacing: 2px; letter-spacing: 2px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%); background-size: 20px 20px; background-position: center center;\"><blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"h\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">前言</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上篇文章说<a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>也可以实现<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能，但是我们一般要用队列功能的话推荐使用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>,因为他层是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">数组</strong>，而队列和栈都是只要<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">操作头部或尾部</strong>，所以这样的话数组的性能就比链表快一点。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>都是通过实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口来获得<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能。而<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口通过继承<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Queue</code>这个接口来取得队列功能，然后在这个基础进行扩展，实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">双端队列</code>，由此可以获得<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能。为了空间能得到充分利用，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>使用了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">循环队列</code>；还有<a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>可以插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值，而<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>是不能插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>的。</p>\n<h2 id=\"h-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">什么是双端队列？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">简单来说，就是两端都可以操作的队列（🌚说了和没说一样…）。哈哈，还是看图吧</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">一般队列是这样的：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104246.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">双端队列是这样的</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104215.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">总的来说，普通队列只可在头部删除元素和尾部添加元素，而双端队列头部和尾部都可以添加和删除元素</strong></p>\n<h2 id=\"h-2\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">什么是循环队列？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">不如说你定了个5容量大小的数组，你第一次插入的位置是下标为2，当你添加第4个元素的时候，他不会进行扩容，而是通过<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头尾指针</strong>进行对比，然后把数据插入到下标为0的位置上。当<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头尾指针相等时</strong>，表示这个队列数组已经满了，这时才会扩容。</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104300.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这里的数组从上向下的顺序，有人会问为什么头尾指针都指向第三个方格呢？因为这边演示的是第一个元素插入到下标为2的位置嘛。。当然，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>是从0开始的，所以初始化时头尾指针都是指向下标为0的位置上。</p>\n</blockquote>\n<h2 id=\"hdeque\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">Deque有什么？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">话不多说，看图：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107134323.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>具体实现的方法主要在蓝色的方框里，其他两个颜色的方框都是通过调用蓝色方框里的这些方法来实现相关功能的，可以再看一张我画的脑图：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107232905.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这边队列的每种功能都有两个方法，其中<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">remove()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">element()</code>如果操作失败会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">报异常</strong>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">offer()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">poll()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">peek()</code>操作失败会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">返回null或者false</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">其实真正用到的就<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">深红色方框</strong>里写的这些方法，所以本文我就说这四个方法，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addLast()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">pollFirst</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">getFirst()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addFirst()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">peekFirst</code>；</p>\n<h2 id=\"h-3\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">内部变量</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">ArrayDeque内部就只有4个变量，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">对象数组element[]</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头指针head</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">尾指针tail</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">MIN_INITIAL_CAPACITY表示最小初始化容量为8</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107235523.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-4\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">构造方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">构造方法和其他集合一样，有<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">有参构造</strong>和<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">无参构造</strong></p>\n<h3 id=\"h-5\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">无参构造</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">很简单，直接初始化一个<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">容量为16</strong>的对象数组</p>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;=&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;Object[<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">16</span>];<br>}<br></code></pre>\n<h3 id=\"h-6\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">有参构造</span></h3>\n<h4 id=\"hint\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">传入参数为int数</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;numElements)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;allocateElements(numElements);<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">allocateElements(int numElements)</strong>分配空数组以容纳给定数量的元素。</li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">private</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">void</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">allocateElements</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;numElements)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;=&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;Object[calculateSize(numElements)];<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">calculateSize(int numElements)</strong>调整传入的值大小</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108003104.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">上面的算法中用到了位运算，如果不了解位运算的话，可以看<a href=\"https://mjava.top/java/java-base-wei/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">位运算</a>这篇文章。这里把数值设置成2的n次方(是整数次)，是为了满足下面要说的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">循环队列</code>这个算法</strong></p>\n<h4 id=\"h-7\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">传入的参数为集合对象</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(Collection&lt;?&nbsp;extends&nbsp;E&gt;&nbsp;c)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;allocateElements(c.size());<br>&nbsp;&nbsp;&nbsp;&nbsp;addAll(c);<br>}<br></code></pre>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">第一步调用了和上面一样的方法，这里多了个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addAll()</code>方法</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">addAll(Collection<!--? extends E--> c)</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108003710.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这边复制时并没有用和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>一样的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">System.arraycopy()</code>方法，而是采用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">for循环</code>来调用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>方法进行一个一个添加的；为什么这么做呢？因为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>和其他集合不一样，它里面是不能有<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值的，而其他集合里面有的是可以传<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>的，所以这边采用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>一个一个的加，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>方法如果传入的值为空的话，就会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">报异常</strong>；（add()实际调用的是addLast()，下面再讲）</p>\n</blockquote>\n<h2 id=\"haddlast\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">addLast()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-8\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这个方法的意思是添加数据到尾部，下面图片方框中的位与算法是实现循环队列这个功能的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">核心算法</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">还记得上面初始化时候，不管传入的是什么数值，最后出来的都是<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>(整数次)方。这个算法就是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>右边为<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span>时，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为正整数时，不管有多大，最后的结果永远&lt;=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为0时，结果为0；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为负数时，-1=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span></strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">举一些例子：当<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span><span class=\"mrel\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">=</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">8</span></span></span></span>，<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span><span class=\"mrel\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">=</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">7</span></span></span></span></p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">4&amp;7=4    9&amp;7=1    22&amp;7=6</span></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">0&amp;7=0</span></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">-1&amp;7=7    -2&amp;7=6    -8&amp;7=0</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108095155.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">doubleCapacity()</strong>扩容为原来的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">2倍</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108103710.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"h-9\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">方便理解，我画下上扩容的流程图，比如head在中间：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108112208.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hpollfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">pollFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">移除头部数据</p>\n<h3 id=\"h-10\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108114243.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">删除的时候并没有像<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>一样移动数据，而只是移动了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的位置</p>\n</blockquote>\n<h3 id=\"h-11\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108114844.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hgetfirstpeekfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">getFirst()和peekFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这两个方法都是一样的，都是直接返回<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的数据，区别就是一个会抛异常，一个不会</p>\n<h3 id=\"h-12\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码分析</span></h3>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">getFirst()</strong></li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;E&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">getFirst</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-meta\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(230, 4, 21); word-wrap: inherit !important; word-break: inherit !important;\">@SuppressWarnings</span>(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"unchecked\"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;result&nbsp;=&nbsp;(E)&nbsp;elements[head];<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">if</span>&nbsp;(result&nbsp;==&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">null</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">throw</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;NoSuchElementException();<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;result;<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">peekFirst()</strong></li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;E&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">peekFirst</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(230, 4, 21); word-wrap: inherit !important; word-break: inherit !important;\">//&nbsp;elements[head]&nbsp;is&nbsp;null&nbsp;if&nbsp;deque&nbsp;empty</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;(E)&nbsp;elements[head];<br>}<br></code></pre>\n<h2 id=\"haddfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">addFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-13\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108131919.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这里还是用了上面讲了位与算法，算出<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>的值，然后插入数据</p>\n<h3 id=\"h-14\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108133154.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hclear\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-15\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">清空这个操作是从<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的元素开始删除，直到<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>=<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">tail</code>，清空完成；</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108134034.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hsize\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">size()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个获取队列的大小也是用了上面讲的位与算法，用尾部减去了头部，然后位与数组的长度-1。为什么要这么弄呢？直接向<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>一样定义个size不好嘛？<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">你不觉得这样更方便吗？少了一个变量，就少维护了一个变量，就少了一个安全隐患啊</strong></p>\n</blockquote>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">size</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;(tail&nbsp;-&nbsp;head)&nbsp;&amp;&nbsp;(elements.length&nbsp;-&nbsp;<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>);<br>}<br></code></pre>\n<h2 id=\"h-16\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">总结</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上面的方法基本上有<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">位与</code>这个算法的身影，可见这个是核心了；如果不了解位运算的话，可以看<a href=\"https://mjava.top/java/java-base-wei/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">位运算</a>这篇文章；</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">核心算法：</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>右边为<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span>时，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为正整数时，不管有多大，最后的结果永远&lt;=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为0时，结果为0；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为负数时，-1=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span></strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>无参构造方法是直接初始化一个容量为16的空数组，而上篇<a href=\"https://mjava.top/java/java-arraylist-source-1\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">ArrayList</a>文章里，它无参构造方法是初始化了一个<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">空数组</strong>，在第一次添加数据的时候才进行扩容到10；</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>每次扩容为原来数组长度的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">2倍</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>不能插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值</p></div>","source":"_posts/java/java-arraydeque-source-1.md","raw":"---\ntitle: 【源码解析】你真的了解ArrayDeque嘛？\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-01-08 14:00:51\npassword:\nsummary:\nkeywords:\ndescription: LinkedList和ArrayDeque都是通过实现了Deque这个接口来获得队列和栈的功能。而Deque这个接口通过继承Queue这个接口来取得队列功能，然后在这个基础进行扩展，实现了双端队列，由此可以获得栈的功能。为了空间能得到充分利用，ArrayDeque使用了循环队列；还有LinkedList可以插入null值，而ArrayDeque是不能插入null的。\ntags:\n- Java\n- 源码解析\n- ArrayDeque\ncategories:\n- Java\n---\n\n<div class=\"output_wrapper\" id=\"output_wrapper_id\" style=\"font-size: 15px; color: rgb(62, 62, 62); line-height: 1.8; word-spacing: 2px; letter-spacing: 2px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%); background-size: 20px 20px; background-position: center center;\"><blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"h\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">前言</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上篇文章说<a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>也可以实现<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能，但是我们一般要用队列功能的话推荐使用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>,因为他层是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">数组</strong>，而队列和栈都是只要<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">操作头部或尾部</strong>，所以这样的话数组的性能就比链表快一点。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>都是通过实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口来获得<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能。而<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口通过继承<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Queue</code>这个接口来取得队列功能，然后在这个基础进行扩展，实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">双端队列</code>，由此可以获得<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能。为了空间能得到充分利用，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>使用了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">循环队列</code>；还有<a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>可以插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值，而<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>是不能插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>的。</p>\n<h2 id=\"h-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">什么是双端队列？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">简单来说，就是两端都可以操作的队列（🌚说了和没说一样…）。哈哈，还是看图吧</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">一般队列是这样的：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104246.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">双端队列是这样的</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104215.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">总的来说，普通队列只可在头部删除元素和尾部添加元素，而双端队列头部和尾部都可以添加和删除元素</strong></p>\n<h2 id=\"h-2\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">什么是循环队列？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">不如说你定了个5容量大小的数组，你第一次插入的位置是下标为2，当你添加第4个元素的时候，他不会进行扩容，而是通过<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头尾指针</strong>进行对比，然后把数据插入到下标为0的位置上。当<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头尾指针相等时</strong>，表示这个队列数组已经满了，这时才会扩容。</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104300.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这里的数组从上向下的顺序，有人会问为什么头尾指针都指向第三个方格呢？因为这边演示的是第一个元素插入到下标为2的位置嘛。。当然，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>是从0开始的，所以初始化时头尾指针都是指向下标为0的位置上。</p>\n</blockquote>\n<h2 id=\"hdeque\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">Deque有什么？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">话不多说，看图：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107134323.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>具体实现的方法主要在蓝色的方框里，其他两个颜色的方框都是通过调用蓝色方框里的这些方法来实现相关功能的，可以再看一张我画的脑图：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107232905.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这边队列的每种功能都有两个方法，其中<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">remove()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">element()</code>如果操作失败会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">报异常</strong>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">offer()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">poll()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">peek()</code>操作失败会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">返回null或者false</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">其实真正用到的就<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">深红色方框</strong>里写的这些方法，所以本文我就说这四个方法，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addLast()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">pollFirst</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">getFirst()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addFirst()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">peekFirst</code>；</p>\n<h2 id=\"h-3\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">内部变量</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">ArrayDeque内部就只有4个变量，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">对象数组element[]</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头指针head</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">尾指针tail</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">MIN_INITIAL_CAPACITY表示最小初始化容量为8</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107235523.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-4\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">构造方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">构造方法和其他集合一样，有<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">有参构造</strong>和<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">无参构造</strong></p>\n<h3 id=\"h-5\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">无参构造</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">很简单，直接初始化一个<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">容量为16</strong>的对象数组</p>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;=&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;Object[<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">16</span>];<br>}<br></code></pre>\n<h3 id=\"h-6\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">有参构造</span></h3>\n<h4 id=\"hint\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">传入参数为int数</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;numElements)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;allocateElements(numElements);<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">allocateElements(int numElements)</strong>分配空数组以容纳给定数量的元素。</li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">private</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">void</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">allocateElements</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;numElements)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;=&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;Object[calculateSize(numElements)];<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">calculateSize(int numElements)</strong>调整传入的值大小</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108003104.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">上面的算法中用到了位运算，如果不了解位运算的话，可以看<a href=\"https://mjava.top/java/java-base-wei/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">位运算</a>这篇文章。这里把数值设置成2的n次方(是整数次)，是为了满足下面要说的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">循环队列</code>这个算法</strong></p>\n<h4 id=\"h-7\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">传入的参数为集合对象</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(Collection&lt;?&nbsp;extends&nbsp;E&gt;&nbsp;c)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;allocateElements(c.size());<br>&nbsp;&nbsp;&nbsp;&nbsp;addAll(c);<br>}<br></code></pre>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">第一步调用了和上面一样的方法，这里多了个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addAll()</code>方法</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">addAll(Collection<!--? extends E--> c)</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108003710.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这边复制时并没有用和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>一样的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">System.arraycopy()</code>方法，而是采用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">for循环</code>来调用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>方法进行一个一个添加的；为什么这么做呢？因为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>和其他集合不一样，它里面是不能有<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值的，而其他集合里面有的是可以传<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>的，所以这边采用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>一个一个的加，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>方法如果传入的值为空的话，就会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">报异常</strong>；（add()实际调用的是addLast()，下面再讲）</p>\n</blockquote>\n<h2 id=\"haddlast\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">addLast()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-8\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这个方法的意思是添加数据到尾部，下面图片方框中的位与算法是实现循环队列这个功能的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">核心算法</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">还记得上面初始化时候，不管传入的是什么数值，最后出来的都是<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>(整数次)方。这个算法就是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>右边为<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span>时，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为正整数时，不管有多大，最后的结果永远&lt;=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为0时，结果为0；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为负数时，-1=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span></strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">举一些例子：当<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span><span class=\"mrel\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">=</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">8</span></span></span></span>，<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span><span class=\"mrel\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">=</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">7</span></span></span></span></p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">4&amp;7=4    9&amp;7=1    22&amp;7=6</span></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">0&amp;7=0</span></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">-1&amp;7=7    -2&amp;7=6    -8&amp;7=0</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108095155.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">doubleCapacity()</strong>扩容为原来的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">2倍</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108103710.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"h-9\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">方便理解，我画下上扩容的流程图，比如head在中间：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108112208.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hpollfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">pollFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">移除头部数据</p>\n<h3 id=\"h-10\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108114243.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">删除的时候并没有像<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>一样移动数据，而只是移动了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的位置</p>\n</blockquote>\n<h3 id=\"h-11\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108114844.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hgetfirstpeekfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">getFirst()和peekFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这两个方法都是一样的，都是直接返回<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的数据，区别就是一个会抛异常，一个不会</p>\n<h3 id=\"h-12\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码分析</span></h3>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">getFirst()</strong></li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;E&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">getFirst</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-meta\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(230, 4, 21); word-wrap: inherit !important; word-break: inherit !important;\">@SuppressWarnings</span>(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"unchecked\"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;result&nbsp;=&nbsp;(E)&nbsp;elements[head];<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">if</span>&nbsp;(result&nbsp;==&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">null</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">throw</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;NoSuchElementException();<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;result;<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">peekFirst()</strong></li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;E&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">peekFirst</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(230, 4, 21); word-wrap: inherit !important; word-break: inherit !important;\">//&nbsp;elements[head]&nbsp;is&nbsp;null&nbsp;if&nbsp;deque&nbsp;empty</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;(E)&nbsp;elements[head];<br>}<br></code></pre>\n<h2 id=\"haddfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">addFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-13\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108131919.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这里还是用了上面讲了位与算法，算出<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>的值，然后插入数据</p>\n<h3 id=\"h-14\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108133154.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hclear\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-15\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">清空这个操作是从<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的元素开始删除，直到<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>=<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">tail</code>，清空完成；</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108134034.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hsize\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">size()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个获取队列的大小也是用了上面讲的位与算法，用尾部减去了头部，然后位与数组的长度-1。为什么要这么弄呢？直接向<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>一样定义个size不好嘛？<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">你不觉得这样更方便吗？少了一个变量，就少维护了一个变量，就少了一个安全隐患啊</strong></p>\n</blockquote>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">size</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;(tail&nbsp;-&nbsp;head)&nbsp;&amp;&nbsp;(elements.length&nbsp;-&nbsp;<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>);<br>}<br></code></pre>\n<h2 id=\"h-16\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">总结</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上面的方法基本上有<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">位与</code>这个算法的身影，可见这个是核心了；如果不了解位运算的话，可以看<a href=\"https://mjava.top/java/java-base-wei/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">位运算</a>这篇文章；</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">核心算法：</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>右边为<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span>时，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为正整数时，不管有多大，最后的结果永远&lt;=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为0时，结果为0；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为负数时，-1=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span></strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>无参构造方法是直接初始化一个容量为16的空数组，而上篇<a href=\"https://mjava.top/java/java-arraylist-source-1\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">ArrayList</a>文章里，它无参构造方法是初始化了一个<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">空数组</strong>，在第一次添加数据的时候才进行扩容到10；</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>每次扩容为原来数组长度的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">2倍</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>不能插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值</p></div>","slug":"java/java-arraydeque-source-1","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5blo007w2mg5tjo6cjqf","content":"<div class=\"output_wrapper\" id=\"output_wrapper_id\" style=\"font-size: 15px; color: rgb(62, 62, 62); line-height: 1.8; word-spacing: 2px; letter-spacing: 2px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%); background-size: 20px 20px; background-position: center center;\"><blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"h\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">前言</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上篇文章说<a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>也可以实现<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能，但是我们一般要用队列功能的话推荐使用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>,因为他层是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">数组</strong>，而队列和栈都是只要<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">操作头部或尾部</strong>，所以这样的话数组的性能就比链表快一点。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>都是通过实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口来获得<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能。而<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口通过继承<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Queue</code>这个接口来取得队列功能，然后在这个基础进行扩展，实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">双端队列</code>，由此可以获得<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能。为了空间能得到充分利用，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>使用了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">循环队列</code>；还有<a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>可以插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值，而<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>是不能插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>的。</p>\n<h2 id=\"h-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">什么是双端队列？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">简单来说，就是两端都可以操作的队列（🌚说了和没说一样…）。哈哈，还是看图吧</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">一般队列是这样的：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104246.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">双端队列是这样的</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104215.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">总的来说，普通队列只可在头部删除元素和尾部添加元素，而双端队列头部和尾部都可以添加和删除元素</strong></p>\n<h2 id=\"h-2\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">什么是循环队列？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">不如说你定了个5容量大小的数组，你第一次插入的位置是下标为2，当你添加第4个元素的时候，他不会进行扩容，而是通过<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头尾指针</strong>进行对比，然后把数据插入到下标为0的位置上。当<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头尾指针相等时</strong>，表示这个队列数组已经满了，这时才会扩容。</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104300.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这里的数组从上向下的顺序，有人会问为什么头尾指针都指向第三个方格呢？因为这边演示的是第一个元素插入到下标为2的位置嘛。。当然，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>是从0开始的，所以初始化时头尾指针都是指向下标为0的位置上。</p>\n</blockquote>\n<h2 id=\"hdeque\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">Deque有什么？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">话不多说，看图：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107134323.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>具体实现的方法主要在蓝色的方框里，其他两个颜色的方框都是通过调用蓝色方框里的这些方法来实现相关功能的，可以再看一张我画的脑图：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107232905.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这边队列的每种功能都有两个方法，其中<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">remove()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">element()</code>如果操作失败会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">报异常</strong>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">offer()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">poll()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">peek()</code>操作失败会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">返回null或者false</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">其实真正用到的就<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">深红色方框</strong>里写的这些方法，所以本文我就说这四个方法，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addLast()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">pollFirst</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">getFirst()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addFirst()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">peekFirst</code>；</p>\n<h2 id=\"h-3\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">内部变量</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">ArrayDeque内部就只有4个变量，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">对象数组element[]</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头指针head</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">尾指针tail</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">MIN_INITIAL_CAPACITY表示最小初始化容量为8</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107235523.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-4\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">构造方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">构造方法和其他集合一样，有<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">有参构造</strong>和<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">无参构造</strong></p>\n<h3 id=\"h-5\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">无参构造</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">很简单，直接初始化一个<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">容量为16</strong>的对象数组</p>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;=&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;Object[<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">16</span>];<br>}<br></code></pre>\n<h3 id=\"h-6\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">有参构造</span></h3>\n<h4 id=\"hint\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">传入参数为int数</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;numElements)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;allocateElements(numElements);<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">allocateElements(int numElements)</strong>分配空数组以容纳给定数量的元素。</li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">private</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">void</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">allocateElements</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;numElements)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;=&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;Object[calculateSize(numElements)];<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">calculateSize(int numElements)</strong>调整传入的值大小</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108003104.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">上面的算法中用到了位运算，如果不了解位运算的话，可以看<a href=\"https://mjava.top/java/java-base-wei/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">位运算</a>这篇文章。这里把数值设置成2的n次方(是整数次)，是为了满足下面要说的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">循环队列</code>这个算法</strong></p>\n<h4 id=\"h-7\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">传入的参数为集合对象</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(Collection&lt;?&nbsp;extends&nbsp;E&gt;&nbsp;c)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;allocateElements(c.size());<br>&nbsp;&nbsp;&nbsp;&nbsp;addAll(c);<br>}<br></code></pre>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">第一步调用了和上面一样的方法，这里多了个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addAll()</code>方法</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">addAll(Collection<!--? extends E--> c)</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108003710.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这边复制时并没有用和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>一样的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">System.arraycopy()</code>方法，而是采用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">for循环</code>来调用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>方法进行一个一个添加的；为什么这么做呢？因为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>和其他集合不一样，它里面是不能有<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值的，而其他集合里面有的是可以传<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>的，所以这边采用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>一个一个的加，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>方法如果传入的值为空的话，就会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">报异常</strong>；（add()实际调用的是addLast()，下面再讲）</p>\n</blockquote>\n<h2 id=\"haddlast\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">addLast()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-8\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这个方法的意思是添加数据到尾部，下面图片方框中的位与算法是实现循环队列这个功能的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">核心算法</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">还记得上面初始化时候，不管传入的是什么数值，最后出来的都是<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>(整数次)方。这个算法就是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>右边为<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span>时，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为正整数时，不管有多大，最后的结果永远&lt;=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为0时，结果为0；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为负数时，-1=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span></strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">举一些例子：当<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span><span class=\"mrel\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">=</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">8</span></span></span></span>，<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span><span class=\"mrel\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">=</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">7</span></span></span></span></p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">4&amp;7=4    9&amp;7=1    22&amp;7=6</span></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">0&amp;7=0</span></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">-1&amp;7=7    -2&amp;7=6    -8&amp;7=0</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108095155.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">doubleCapacity()</strong>扩容为原来的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">2倍</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108103710.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"h-9\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">方便理解，我画下上扩容的流程图，比如head在中间：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108112208.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hpollfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">pollFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">移除头部数据</p>\n<h3 id=\"h-10\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108114243.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">删除的时候并没有像<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>一样移动数据，而只是移动了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的位置</p>\n</blockquote>\n<h3 id=\"h-11\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108114844.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hgetfirstpeekfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">getFirst()和peekFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这两个方法都是一样的，都是直接返回<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的数据，区别就是一个会抛异常，一个不会</p>\n<h3 id=\"h-12\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码分析</span></h3>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">getFirst()</strong></li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;E&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">getFirst</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-meta\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(230, 4, 21); word-wrap: inherit !important; word-break: inherit !important;\">@SuppressWarnings</span>(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"unchecked\"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;result&nbsp;=&nbsp;(E)&nbsp;elements[head];<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">if</span>&nbsp;(result&nbsp;==&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">null</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">throw</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;NoSuchElementException();<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;result;<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">peekFirst()</strong></li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;E&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">peekFirst</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(230, 4, 21); word-wrap: inherit !important; word-break: inherit !important;\">//&nbsp;elements[head]&nbsp;is&nbsp;null&nbsp;if&nbsp;deque&nbsp;empty</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;(E)&nbsp;elements[head];<br>}<br></code></pre>\n<h2 id=\"haddfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">addFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-13\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108131919.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这里还是用了上面讲了位与算法，算出<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>的值，然后插入数据</p>\n<h3 id=\"h-14\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108133154.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hclear\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-15\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">清空这个操作是从<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的元素开始删除，直到<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>=<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">tail</code>，清空完成；</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108134034.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hsize\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">size()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个获取队列的大小也是用了上面讲的位与算法，用尾部减去了头部，然后位与数组的长度-1。为什么要这么弄呢？直接向<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>一样定义个size不好嘛？<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">你不觉得这样更方便吗？少了一个变量，就少维护了一个变量，就少了一个安全隐患啊</strong></p>\n</blockquote>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">size</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;(tail&nbsp;-&nbsp;head)&nbsp;&amp;&nbsp;(elements.length&nbsp;-&nbsp;<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>);<br>}<br></code></pre>\n<h2 id=\"h-16\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">总结</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上面的方法基本上有<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">位与</code>这个算法的身影，可见这个是核心了；如果不了解位运算的话，可以看<a href=\"https://mjava.top/java/java-base-wei/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">位运算</a>这篇文章；</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">核心算法：</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>右边为<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span>时，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为正整数时，不管有多大，最后的结果永远&lt;=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为0时，结果为0；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为负数时，-1=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span></strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>无参构造方法是直接初始化一个容量为16的空数组，而上篇<a href=\"https://mjava.top/java/java-arraylist-source-1\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">ArrayList</a>文章里，它无参构造方法是初始化了一个<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">空数组</strong>，在第一次添加数据的时候才进行扩容到10；</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>每次扩容为原来数组长度的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">2倍</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>不能插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值</p></div>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<div class=\"output_wrapper\" id=\"output_wrapper_id\" style=\"font-size: 15px; color: rgb(62, 62, 62); line-height: 1.8; word-spacing: 2px; letter-spacing: 2px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%); background-size: 20px 20px; background-position: center center;\"><blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬</p>\n</blockquote>\n<h2 id=\"h\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">前言</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上篇文章说<a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>也可以实现<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能，但是我们一般要用队列功能的话推荐使用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>,因为他层是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">数组</strong>，而队列和栈都是只要<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">操作头部或尾部</strong>，所以这样的话数组的性能就比链表快一点。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>都是通过实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口来获得<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能。而<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口通过继承<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Queue</code>这个接口来取得队列功能，然后在这个基础进行扩展，实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">双端队列</code>，由此可以获得<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>的功能。为了空间能得到充分利用，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>使用了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">循环队列</code>；还有<a href=\"https://mjava.top/java/java-linkedlist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">LinkedList</a>可以插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值，而<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>是不能插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>的。</p>\n<h2 id=\"h-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">什么是双端队列？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">简单来说，就是两端都可以操作的队列（🌚说了和没说一样…）。哈哈，还是看图吧</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">一般队列是这样的：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104246.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">双端队列是这样的</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104215.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">总的来说，普通队列只可在头部删除元素和尾部添加元素，而双端队列头部和尾部都可以添加和删除元素</strong></p>\n<h2 id=\"h-2\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">什么是循环队列？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">不如说你定了个5容量大小的数组，你第一次插入的位置是下标为2，当你添加第4个元素的时候，他不会进行扩容，而是通过<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头尾指针</strong>进行对比，然后把数据插入到下标为0的位置上。当<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头尾指针相等时</strong>，表示这个队列数组已经满了，这时才会扩容。</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108104300.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这里的数组从上向下的顺序，有人会问为什么头尾指针都指向第三个方格呢？因为这边演示的是第一个元素插入到下标为2的位置嘛。。当然，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>是从0开始的，所以初始化时头尾指针都是指向下标为0的位置上。</p>\n</blockquote>\n<h2 id=\"hdeque\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">Deque有什么？</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">话不多说，看图：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107134323.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>具体实现的方法主要在蓝色的方框里，其他两个颜色的方框都是通过调用蓝色方框里的这些方法来实现相关功能的，可以再看一张我画的脑图：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107232905.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这边队列的每种功能都有两个方法，其中<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">remove()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">element()</code>如果操作失败会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">报异常</strong>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">offer()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">poll()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">peek()</code>操作失败会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">返回null或者false</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">其实真正用到的就<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">深红色方框</strong>里写的这些方法，所以本文我就说这四个方法，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addLast()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">pollFirst</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">getFirst()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addFirst()</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">peekFirst</code>；</p>\n<h2 id=\"h-3\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">内部变量</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">ArrayDeque内部就只有4个变量，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">对象数组element[]</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">头指针head</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">尾指针tail</strong>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">MIN_INITIAL_CAPACITY表示最小初始化容量为8</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200107235523.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-4\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">构造方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">构造方法和其他集合一样，有<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">有参构造</strong>和<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">无参构造</strong></p>\n<h3 id=\"h-5\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">无参构造</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">很简单，直接初始化一个<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">容量为16</strong>的对象数组</p>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;=&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;Object[<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">16</span>];<br>}<br></code></pre>\n<h3 id=\"h-6\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">有参构造</span></h3>\n<h4 id=\"hint\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">传入参数为int数</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;numElements)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;allocateElements(numElements);<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">allocateElements(int numElements)</strong>分配空数组以容纳给定数量的元素。</li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">private</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">void</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">allocateElements</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;numElements)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;elements&nbsp;=&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;Object[calculateSize(numElements)];<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">calculateSize(int numElements)</strong>调整传入的值大小</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108003104.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">上面的算法中用到了位运算，如果不了解位运算的话，可以看<a href=\"https://mjava.top/java/java-base-wei/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">位运算</a>这篇文章。这里把数值设置成2的n次方(是整数次)，是为了满足下面要说的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">循环队列</code>这个算法</strong></p>\n<h4 id=\"h-7\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">传入的参数为集合对象</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">ArrayDeque</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">(Collection&lt;?&nbsp;extends&nbsp;E&gt;&nbsp;c)</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;allocateElements(c.size());<br>&nbsp;&nbsp;&nbsp;&nbsp;addAll(c);<br>}<br></code></pre>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">第一步调用了和上面一样的方法，这里多了个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">addAll()</code>方法</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">addAll(Collection<!--? extends E--> c)</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108003710.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这边复制时并没有用和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>一样的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">System.arraycopy()</code>方法，而是采用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">for循环</code>来调用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>方法进行一个一个添加的；为什么这么做呢？因为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>和其他集合不一样，它里面是不能有<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值的，而其他集合里面有的是可以传<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>的，所以这边采用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>一个一个的加，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">add()</code>方法如果传入的值为空的话，就会<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">报异常</strong>；（add()实际调用的是addLast()，下面再讲）</p>\n</blockquote>\n<h2 id=\"haddlast\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">addLast()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-8\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这个方法的意思是添加数据到尾部，下面图片方框中的位与算法是实现循环队列这个功能的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">核心算法</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">还记得上面初始化时候，不管传入的是什么数值，最后出来的都是<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>(整数次)方。这个算法就是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>右边为<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span>时，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为正整数时，不管有多大，最后的结果永远&lt;=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为0时，结果为0；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为负数时，-1=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span></strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">举一些例子：当<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span><span class=\"mrel\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">=</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">8</span></span></span></span>，<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span><span class=\"mrel\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">=</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2777777777777778em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">7</span></span></span></span></p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">4&amp;7=4    9&amp;7=1    22&amp;7=6</span></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">0&amp;7=0</span></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">-1&amp;7=7    -2&amp;7=6    -8&amp;7=0</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108095155.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">doubleCapacity()</strong>扩容为原来的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">2倍</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108103710.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"h-9\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">方便理解，我画下上扩容的流程图，比如head在中间：</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108112208.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hpollfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">pollFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">移除头部数据</p>\n<h3 id=\"h-10\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108114243.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">删除的时候并没有像<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>一样移动数据，而只是移动了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的位置</p>\n</blockquote>\n<h3 id=\"h-11\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108114844.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hgetfirstpeekfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">getFirst()和peekFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这两个方法都是一样的，都是直接返回<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的数据，区别就是一个会抛异常，一个不会</p>\n<h3 id=\"h-12\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码分析</span></h3>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">getFirst()</strong></li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;E&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">getFirst</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-meta\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(230, 4, 21); word-wrap: inherit !important; word-break: inherit !important;\">@SuppressWarnings</span>(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"unchecked\"</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;result&nbsp;=&nbsp;(E)&nbsp;elements[head];<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">if</span>&nbsp;(result&nbsp;==&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">null</span>)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">throw</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;NoSuchElementException();<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;result;<br>}<br></code></pre>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">peekFirst()</strong></li>\n</ul>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;E&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">peekFirst</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-comment\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(230, 4, 21); word-wrap: inherit !important; word-break: inherit !important;\">//&nbsp;elements[head]&nbsp;is&nbsp;null&nbsp;if&nbsp;deque&nbsp;empty</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;(E)&nbsp;elements[head];<br>}<br></code></pre>\n<h2 id=\"haddfirst\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">addFirst()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-13\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108131919.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这里还是用了上面讲了位与算法，算出<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>的值，然后插入数据</p>\n<h3 id=\"h-14\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">流程图</span></h3>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108133154.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hclear\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-15\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">源码解析</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">清空这个操作是从<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>指向的元素开始删除，直到<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">head</code>=<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">tail</code>，清空完成；</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200108134034.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hsize\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">size()</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个获取队列的大小也是用了上面讲的位与算法，用尾部减去了头部，然后位与数组的长度-1。为什么要这么弄呢？直接向<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayList</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>一样定义个size不好嘛？<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">你不觉得这样更方便吗？少了一个变量，就少维护了一个变量，就少了一个安全隐患啊</strong></p>\n</blockquote>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-function\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">public</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">int</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">size</span><span class=\"hljs-params\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">()</span>&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">return</span>&nbsp;(tail&nbsp;-&nbsp;head)&nbsp;&amp;&nbsp;(elements.length&nbsp;-&nbsp;<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>);<br>}<br></code></pre>\n<h2 id=\"h-16\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">总结</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上面的方法基本上有<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">位与</code>这个算法的身影，可见这个是核心了；如果不了解位运算的话，可以看<a href=\"https://mjava.top/java/java-base-wei/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">位运算</a>这篇文章；</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">核心算法：</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>右边为<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span>时，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为正整数时，不管有多大，最后的结果永远&lt;=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.664392em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span></span></span></span>；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为0时，结果为0；当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">&amp;</code>左边的数为负数时，-1=<span class=\"katex\" style=\"font: 1.21em / 1.2 KaTeX_Main, 'Times New Roman', serif; text-indent: 0px; text-rendering: auto; font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 8px 3px;\"><span class=\"katex-mathml\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; position: absolute; clip: rect(1px, 1px, 1px, 1px); padding: 0px; border: 0px; height: 1px; width: 1px; overflow: hidden;\"></span><span class=\"katex-html\" aria-hidden=\"true\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.747722em; vertical-align: -0.08333em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">2</span><span class=\"msupsub\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; text-align: left;\"><span class=\"vlist-t\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-table; table-layout: fixed;\"><span class=\"vlist-r\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-row;\"><span class=\"vlist\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: table-cell; vertical-align: bottom; position: relative; height: 0.664392em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block; height: 0px; position: relative; top: -3.063em; margin-right: 0.05em;\"><span class=\"pstrut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; overflow: hidden; width: 0px; height: 2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\" style=\"color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; font-size: 0.7em;\"><span class=\"mord mathit mtight\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-family: KaTeX_Math; font-style: italic;\">n</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span><span class=\"mbin\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">−</span><span class=\"mspace\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; margin-right: 0.2222222222222222em;\"></span></span><span class=\"base\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; position: relative; display: inline-block; white-space: nowrap; width: min-content;\"><span class=\"strut\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: inline-block; height: 0.64444em; vertical-align: 0em;\"></span><span class=\"mord\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">1</span></span></span></span></strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>无参构造方法是直接初始化一个容量为16的空数组，而上篇<a href=\"https://mjava.top/java/java-arraylist-source-1\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">ArrayList</a>文章里，它无参构造方法是初始化了一个<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">空数组</strong>，在第一次添加数据的时候才进行扩容到10；</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>每次扩容为原来数组长度的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">2倍</strong></p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>不能插入<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>值</p></div>"},{"title":"【源码解析】想了解LinkedList？看这篇文章就对了","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-01-04T16:21:43.000Z","password":null,"summary":null,"keywords":null,"description":"LinkedList由于实现了Deque这个接口，所以可以当栈和队列使用。不过一般要用栈或队列的时候推荐使用ArrayDeque,所以这里就不讲LinkedList的栈和队列功能了🌚。还是和上篇ArrayList一样，讲些常用的方法...","_content":"<div class=\"output_wrapper\" id=\"output_wrapper_id\" style=\"font-size: 15px; color: rgb(62, 62, 62); line-height: 1.8; word-spacing: 2px; letter-spacing: 2px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%); background-size: 20px 20px; background-position: center center;\"><blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬。</p>\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">本文基于JDK1.8</p>\n</blockquote>\n<h2 id=\"h\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">前言</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>由于实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口，所以可以当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>使用。不过一般要用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>或<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>的时候推荐使用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>,所以这里就不讲<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>的栈和队列功能了🌚。还是和上篇<a href=\"https://mjava.top/java/java-arraylist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">ArrayList</a>一样，讲些常用的方法。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>内部是由<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">双链表</strong>组成的，里面存放着一个个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>，每个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>又包含三个元素(<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">prev</code>,<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">item</code>,<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">next</code>):</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">prev:</strong>指向前一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">item:</strong>存放存入的数据</li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">next:</strong>指向下一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">链表的第一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">prev</code>为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>，最后个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">next</code>为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code></p>\n</blockquote>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">我简单的画了一张图，可以看下</p>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个prev和next并不是指向null，因为内存中没有为null分配空间，这边是表示是prev和next为null；</p>\n</blockquote>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213058.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">本文内容</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104164627.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-2\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">内部变量</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">相比于<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Arraylist</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>内部变量就少得多，就只有三个，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">size</code>存这当前元素的个数，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">first</code>指向链表的第一个，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">last</code>指向列表的最后一个</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104170249.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-3\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">构造方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-4\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">无参构造方法</span></h3>\n<h4 id=\"h-5\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br></code></pre>\n<h4 id=\"h-6\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">无参构造只是初始化了数据，并未做任何操作<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">(初始化  size=0  first=null   last=null)</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104172851.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"h-7\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">有参构造方法</span></h3>\n<h4 id=\"h-8\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;oldList=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>List&lt;String&gt;&nbsp;newList=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;(oldList);<br></code></pre>\n<h4 id=\"h-9\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">由于篇幅有限，addAll()方法这边就不讲了，后面另写文章再讲，里面的操作就相当于把集合里的元素复制到新集合里面。</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104174143.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hget\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">get方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hgetintindex\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">get(int index)</span></h3>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这里先讲get()方法，然后再讲add()方法，原因是插入方法里用到的调用的方法个get()方法里是一样的</p>\n</blockquote>\n<h4 id=\"h-10\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰2\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰3\"</span>);<br>list.get(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">2</span>);<br></code></pre>\n<h4 id=\"h-11\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183636.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">checkElementIndex(int index)</strong>检查越界</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183853.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183939.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">node(int index)</strong>查找Node</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200109160648.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hadd\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"haddee\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add(E e)</span></h3>\n<h4 id=\"h-12\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br></code></pre>\n<h4 id=\"h-13\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104175255.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">linkLast(E e)</strong>连接最后一个元素</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104175907.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">Node&lt;E&gt;</strong>内部类</li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">就像开头说的，每个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>里有三个，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">prev:</strong>指向前一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">item:</strong>存放存入的数据，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">next:</strong>指向下一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></p>\n</blockquote>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">private</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">static</span>&nbsp;<span class=\"hljs-class\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">class</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">Node</span>&lt;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">E</span>&gt;&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;item;<br>&nbsp;&nbsp;&nbsp;&nbsp;Node&lt;E&gt;&nbsp;next;<br>&nbsp;&nbsp;&nbsp;&nbsp;Node&lt;E&gt;&nbsp;prev;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Node(Node&lt;E&gt;&nbsp;prev,&nbsp;E&nbsp;element,&nbsp;Node&lt;E&gt;&nbsp;next)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.item&nbsp;=&nbsp;element;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.next&nbsp;=&nbsp;next;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.prev&nbsp;=&nbsp;prev;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></code></pre>\n<h4 id=\"h-14\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">第一次添加时的流程示意图</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104224556.jpg\" alt=\"第一次添加时的流程示意图\" title=\"第一次添加时的流程示意图\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">第一次添加时的流程示意图</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">不是第一次添加</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213234.jpg\" alt=\"不是第一次添加\" title=\"不是第一次添加\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">不是第一次添加</figcaption></figure>\n<h3 id=\"haddintindexeelement\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add(int index, E element)</span></h3>\n<h4 id=\"h-15\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.add(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>,<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hk\"</span>);<br></code></pre>\n<h4 id=\"h-16\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">这边插入元素时，先判断插入的位置是不是尾部，如果不尾部的话，先调用和get()那个一样的方法，来查找要插入位置的当前元素，然后进行插入操作</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104185743.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">checkPositionIndex(int index)</strong>检查是否越界</li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个检查越界的方法个get()检查越界的方法有点不同，它是可以等于<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">size</code>的，因为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">linkedList</code>的索引设计也是从<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">0</code>开始的，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">所以size永远比索引大1</strong></p>\n</blockquote>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104190000.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104190144.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">linkBefore(E e, Node&lt;E&gt; succ)</strong>插入元素操作</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104191607.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h4 id=\"h-17\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上面说的可能有点绕，看看流程图就明白了，哈哈</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">添加的位置为第一个</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213757.jpg\" alt=\"添加的位置为第一个\" title=\"添加的位置为第一个\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">添加的位置为第一个</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">添加的位置为中间</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213437.jpg\" alt=\"添加的位置为中间\" title=\"添加的位置为中间\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">添加的位置为中间</figcaption></figure>\n<h2 id=\"hset\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">set方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hsetintindexeelement\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">set(int index, E element)</span></h3>\n<h4 id=\"h-18\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.set(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">0</span>,<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br></code></pre>\n<h4 id=\"h-19\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这里大多调用的是和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">get()</code>里一样的方法</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104194247.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hremove\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hremoveintindex\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove(int index)</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">按索引删除，先找到被删除的Node，然后解除相关链接，设置Node里三大元素为null，删除后返回被删除Node里的item</p>\n<h4 id=\"h-20\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.remove(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>);<br></code></pre>\n<h4 id=\"h-21\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104205658.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">unlink(Node&lt;E&gt; x)</strong>解除Node的连接，然后返回被解除链接的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">item</code></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104222250.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h4 id=\"h-22\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">第一个元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104215754.jpg\" alt=\"删除的是链表里的第一个元素\" title=\"删除的是链表里的第一个元素\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">删除的是链表里的第一个元素</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">中间元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104215947.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">最后一个元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104220851.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"hremoveobjecto\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove(Object o)</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这个删除就比较<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">慢</code>了，它是从头开始一一对比，时间复杂度为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">O(n)</code>，这个删除也是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">只删除最早添加的数据</strong></p>\n<h4 id=\"h-23\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.remove(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br></code></pre>\n<h4 id=\"h-24\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">unlink()</code>方法就是上面讲的那个</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104223708.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hclear\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hclear-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear()</span></h3>\n<h4 id=\"h-25\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.clear();<br></code></pre>\n<h4 id=\"h-26\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104224213.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-27\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">总结</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>里删除，添加操作一般就两个步骤，变换前后Node指向的地址，删除操作把对应Node里的三个变量都设置为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>，方便<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">GC</code>回收。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">如果要删除元素时，最好选择传入索引删除，他比直接传入要删除的对象的方法要快很多</p></div>","source":"_posts/java/java-linkedlist-source-1.md","raw":"---\ntitle: 【源码解析】想了解LinkedList？看这篇文章就对了\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-01-05 00:21:43\npassword:\nsummary:\nkeywords:\ndescription: LinkedList由于实现了Deque这个接口，所以可以当栈和队列使用。不过一般要用栈或队列的时候推荐使用ArrayDeque,所以这里就不讲LinkedList的栈和队列功能了🌚。还是和上篇ArrayList一样，讲些常用的方法...\ntags:\n- Java\n- 源码分析\n- LinkedList\ncategories:\n- Java\n---\n<div class=\"output_wrapper\" id=\"output_wrapper_id\" style=\"font-size: 15px; color: rgb(62, 62, 62); line-height: 1.8; word-spacing: 2px; letter-spacing: 2px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%); background-size: 20px 20px; background-position: center center;\"><blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬。</p>\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">本文基于JDK1.8</p>\n</blockquote>\n<h2 id=\"h\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">前言</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>由于实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口，所以可以当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>使用。不过一般要用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>或<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>的时候推荐使用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>,所以这里就不讲<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>的栈和队列功能了🌚。还是和上篇<a href=\"https://mjava.top/java/java-arraylist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">ArrayList</a>一样，讲些常用的方法。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>内部是由<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">双链表</strong>组成的，里面存放着一个个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>，每个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>又包含三个元素(<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">prev</code>,<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">item</code>,<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">next</code>):</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">prev:</strong>指向前一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">item:</strong>存放存入的数据</li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">next:</strong>指向下一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">链表的第一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">prev</code>为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>，最后个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">next</code>为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code></p>\n</blockquote>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">我简单的画了一张图，可以看下</p>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个prev和next并不是指向null，因为内存中没有为null分配空间，这边是表示是prev和next为null；</p>\n</blockquote>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213058.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">本文内容</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104164627.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-2\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">内部变量</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">相比于<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Arraylist</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>内部变量就少得多，就只有三个，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">size</code>存这当前元素的个数，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">first</code>指向链表的第一个，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">last</code>指向列表的最后一个</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104170249.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-3\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">构造方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-4\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">无参构造方法</span></h3>\n<h4 id=\"h-5\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br></code></pre>\n<h4 id=\"h-6\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">无参构造只是初始化了数据，并未做任何操作<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">(初始化  size=0  first=null   last=null)</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104172851.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"h-7\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">有参构造方法</span></h3>\n<h4 id=\"h-8\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;oldList=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>List&lt;String&gt;&nbsp;newList=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;(oldList);<br></code></pre>\n<h4 id=\"h-9\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">由于篇幅有限，addAll()方法这边就不讲了，后面另写文章再讲，里面的操作就相当于把集合里的元素复制到新集合里面。</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104174143.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hget\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">get方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hgetintindex\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">get(int index)</span></h3>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这里先讲get()方法，然后再讲add()方法，原因是插入方法里用到的调用的方法个get()方法里是一样的</p>\n</blockquote>\n<h4 id=\"h-10\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰2\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰3\"</span>);<br>list.get(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">2</span>);<br></code></pre>\n<h4 id=\"h-11\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183636.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">checkElementIndex(int index)</strong>检查越界</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183853.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183939.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">node(int index)</strong>查找Node</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200109160648.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hadd\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"haddee\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add(E e)</span></h3>\n<h4 id=\"h-12\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br></code></pre>\n<h4 id=\"h-13\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104175255.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">linkLast(E e)</strong>连接最后一个元素</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104175907.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">Node&lt;E&gt;</strong>内部类</li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">就像开头说的，每个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>里有三个，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">prev:</strong>指向前一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">item:</strong>存放存入的数据，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">next:</strong>指向下一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></p>\n</blockquote>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">private</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">static</span>&nbsp;<span class=\"hljs-class\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">class</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">Node</span>&lt;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">E</span>&gt;&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;item;<br>&nbsp;&nbsp;&nbsp;&nbsp;Node&lt;E&gt;&nbsp;next;<br>&nbsp;&nbsp;&nbsp;&nbsp;Node&lt;E&gt;&nbsp;prev;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Node(Node&lt;E&gt;&nbsp;prev,&nbsp;E&nbsp;element,&nbsp;Node&lt;E&gt;&nbsp;next)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.item&nbsp;=&nbsp;element;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.next&nbsp;=&nbsp;next;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.prev&nbsp;=&nbsp;prev;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></code></pre>\n<h4 id=\"h-14\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">第一次添加时的流程示意图</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104224556.jpg\" alt=\"第一次添加时的流程示意图\" title=\"第一次添加时的流程示意图\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">第一次添加时的流程示意图</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">不是第一次添加</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213234.jpg\" alt=\"不是第一次添加\" title=\"不是第一次添加\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">不是第一次添加</figcaption></figure>\n<h3 id=\"haddintindexeelement\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add(int index, E element)</span></h3>\n<h4 id=\"h-15\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.add(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>,<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hk\"</span>);<br></code></pre>\n<h4 id=\"h-16\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">这边插入元素时，先判断插入的位置是不是尾部，如果不尾部的话，先调用和get()那个一样的方法，来查找要插入位置的当前元素，然后进行插入操作</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104185743.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">checkPositionIndex(int index)</strong>检查是否越界</li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个检查越界的方法个get()检查越界的方法有点不同，它是可以等于<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">size</code>的，因为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">linkedList</code>的索引设计也是从<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">0</code>开始的，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">所以size永远比索引大1</strong></p>\n</blockquote>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104190000.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104190144.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">linkBefore(E e, Node&lt;E&gt; succ)</strong>插入元素操作</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104191607.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h4 id=\"h-17\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上面说的可能有点绕，看看流程图就明白了，哈哈</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">添加的位置为第一个</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213757.jpg\" alt=\"添加的位置为第一个\" title=\"添加的位置为第一个\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">添加的位置为第一个</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">添加的位置为中间</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213437.jpg\" alt=\"添加的位置为中间\" title=\"添加的位置为中间\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">添加的位置为中间</figcaption></figure>\n<h2 id=\"hset\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">set方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hsetintindexeelement\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">set(int index, E element)</span></h3>\n<h4 id=\"h-18\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.set(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">0</span>,<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br></code></pre>\n<h4 id=\"h-19\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这里大多调用的是和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">get()</code>里一样的方法</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104194247.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hremove\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hremoveintindex\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove(int index)</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">按索引删除，先找到被删除的Node，然后解除相关链接，设置Node里三大元素为null，删除后返回被删除Node里的item</p>\n<h4 id=\"h-20\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.remove(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>);<br></code></pre>\n<h4 id=\"h-21\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104205658.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">unlink(Node&lt;E&gt; x)</strong>解除Node的连接，然后返回被解除链接的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">item</code></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104222250.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h4 id=\"h-22\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">第一个元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104215754.jpg\" alt=\"删除的是链表里的第一个元素\" title=\"删除的是链表里的第一个元素\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">删除的是链表里的第一个元素</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">中间元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104215947.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">最后一个元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104220851.jpg\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"hremoveobjecto\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove(Object o)</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这个删除就比较<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">慢</code>了，它是从头开始一一对比，时间复杂度为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">O(n)</code>，这个删除也是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">只删除最早添加的数据</strong></p>\n<h4 id=\"h-23\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.remove(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br></code></pre>\n<h4 id=\"h-24\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">unlink()</code>方法就是上面讲的那个</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104223708.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hclear\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hclear-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear()</span></h3>\n<h4 id=\"h-25\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.clear();<br></code></pre>\n<h4 id=\"h-26\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104224213.png\" alt=\"\" title=\"\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-27\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">总结</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>里删除，添加操作一般就两个步骤，变换前后Node指向的地址，删除操作把对应Node里的三个变量都设置为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>，方便<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">GC</code>回收。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">如果要删除元素时，最好选择传入索引删除，他比直接传入要删除的对象的方法要快很多</p></div>","slug":"java/java-linkedlist-source-1","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5blp007x2mg5bm77cnhl","content":"<div class=\"output_wrapper\" id=\"output_wrapper_id\" style=\"font-size: 15px; color: rgb(62, 62, 62); line-height: 1.8; word-spacing: 2px; letter-spacing: 2px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%); background-size: 20px 20px; background-position: center center;\"><blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬。</p>\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">本文基于JDK1.8</p>\n</blockquote>\n<h2 id=\"h\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">前言</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>由于实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口，所以可以当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>使用。不过一般要用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>或<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>的时候推荐使用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>,所以这里就不讲<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>的栈和队列功能了🌚。还是和上篇<a href=\"https://mjava.top/java/java-arraylist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">ArrayList</a>一样，讲些常用的方法。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>内部是由<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">双链表</strong>组成的，里面存放着一个个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>，每个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>又包含三个元素(<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">prev</code>,<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">item</code>,<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">next</code>):</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">prev:</strong>指向前一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">item:</strong>存放存入的数据</li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">next:</strong>指向下一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">链表的第一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">prev</code>为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>，最后个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">next</code>为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code></p>\n</blockquote>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">我简单的画了一张图，可以看下</p>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个prev和next并不是指向null，因为内存中没有为null分配空间，这边是表示是prev和next为null；</p>\n</blockquote>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213058.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">本文内容</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104164627.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-2\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">内部变量</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">相比于<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Arraylist</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>内部变量就少得多，就只有三个，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">size</code>存这当前元素的个数，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">first</code>指向链表的第一个，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">last</code>指向列表的最后一个</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104170249.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-3\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">构造方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-4\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">无参构造方法</span></h3>\n<h4 id=\"h-5\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br></code></pre>\n<h4 id=\"h-6\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">无参构造只是初始化了数据，并未做任何操作<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">(初始化  size=0  first=null   last=null)</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104172851.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"h-7\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">有参构造方法</span></h3>\n<h4 id=\"h-8\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;oldList=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>List&lt;String&gt;&nbsp;newList=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;(oldList);<br></code></pre>\n<h4 id=\"h-9\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">由于篇幅有限，addAll()方法这边就不讲了，后面另写文章再讲，里面的操作就相当于把集合里的元素复制到新集合里面。</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104174143.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hget\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">get方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hgetintindex\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">get(int index)</span></h3>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这里先讲get()方法，然后再讲add()方法，原因是插入方法里用到的调用的方法个get()方法里是一样的</p>\n</blockquote>\n<h4 id=\"h-10\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰2\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰3\"</span>);<br>list.get(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">2</span>);<br></code></pre>\n<h4 id=\"h-11\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183636.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">checkElementIndex(int index)</strong>检查越界</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183853.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183939.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">node(int index)</strong>查找Node</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200109160648.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hadd\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"haddee\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add(E e)</span></h3>\n<h4 id=\"h-12\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br></code></pre>\n<h4 id=\"h-13\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104175255.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">linkLast(E e)</strong>连接最后一个元素</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104175907.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">Node&lt;E&gt;</strong>内部类</li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">就像开头说的，每个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>里有三个，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">prev:</strong>指向前一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">item:</strong>存放存入的数据，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">next:</strong>指向下一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></p>\n</blockquote>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">private</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">static</span>&nbsp;<span class=\"hljs-class\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">class</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">Node</span>&lt;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">E</span>&gt;&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;item;<br>&nbsp;&nbsp;&nbsp;&nbsp;Node&lt;E&gt;&nbsp;next;<br>&nbsp;&nbsp;&nbsp;&nbsp;Node&lt;E&gt;&nbsp;prev;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Node(Node&lt;E&gt;&nbsp;prev,&nbsp;E&nbsp;element,&nbsp;Node&lt;E&gt;&nbsp;next)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.item&nbsp;=&nbsp;element;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.next&nbsp;=&nbsp;next;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.prev&nbsp;=&nbsp;prev;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></code></pre>\n<h4 id=\"h-14\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">第一次添加时的流程示意图</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104224556.jpg\" alt=\"第一次添加时的流程示意图\" title=\"第一次添加时的流程示意图\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">第一次添加时的流程示意图</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">不是第一次添加</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213234.jpg\" alt=\"不是第一次添加\" title=\"不是第一次添加\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">不是第一次添加</figcaption></figure>\n<h3 id=\"haddintindexeelement\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add(int index, E element)</span></h3>\n<h4 id=\"h-15\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.add(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>,<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hk\"</span>);<br></code></pre>\n<h4 id=\"h-16\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">这边插入元素时，先判断插入的位置是不是尾部，如果不尾部的话，先调用和get()那个一样的方法，来查找要插入位置的当前元素，然后进行插入操作</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104185743.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">checkPositionIndex(int index)</strong>检查是否越界</li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个检查越界的方法个get()检查越界的方法有点不同，它是可以等于<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">size</code>的，因为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">linkedList</code>的索引设计也是从<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">0</code>开始的，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">所以size永远比索引大1</strong></p>\n</blockquote>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104190000.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104190144.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">linkBefore(E e, Node&lt;E&gt; succ)</strong>插入元素操作</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104191607.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h4 id=\"h-17\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上面说的可能有点绕，看看流程图就明白了，哈哈</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">添加的位置为第一个</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213757.jpg\" alt=\"添加的位置为第一个\" title=\"添加的位置为第一个\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">添加的位置为第一个</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">添加的位置为中间</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213437.jpg\" alt=\"添加的位置为中间\" title=\"添加的位置为中间\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">添加的位置为中间</figcaption></figure>\n<h2 id=\"hset\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">set方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hsetintindexeelement\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">set(int index, E element)</span></h3>\n<h4 id=\"h-18\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.set(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">0</span>,<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br></code></pre>\n<h4 id=\"h-19\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这里大多调用的是和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">get()</code>里一样的方法</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104194247.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hremove\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hremoveintindex\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove(int index)</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">按索引删除，先找到被删除的Node，然后解除相关链接，设置Node里三大元素为null，删除后返回被删除Node里的item</p>\n<h4 id=\"h-20\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.remove(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>);<br></code></pre>\n<h4 id=\"h-21\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104205658.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">unlink(Node&lt;E&gt; x)</strong>解除Node的连接，然后返回被解除链接的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">item</code></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104222250.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h4 id=\"h-22\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">第一个元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104215754.jpg\" alt=\"删除的是链表里的第一个元素\" title=\"删除的是链表里的第一个元素\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">删除的是链表里的第一个元素</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">中间元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104215947.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">最后一个元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104220851.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"hremoveobjecto\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove(Object o)</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这个删除就比较<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">慢</code>了，它是从头开始一一对比，时间复杂度为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">O(n)</code>，这个删除也是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">只删除最早添加的数据</strong></p>\n<h4 id=\"h-23\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.remove(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br></code></pre>\n<h4 id=\"h-24\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">unlink()</code>方法就是上面讲的那个</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104223708.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hclear\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hclear-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear()</span></h3>\n<h4 id=\"h-25\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.clear();<br></code></pre>\n<h4 id=\"h-26\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104224213.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-27\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">总结</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>里删除，添加操作一般就两个步骤，变换前后Node指向的地址，删除操作把对应Node里的三个变量都设置为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>，方便<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">GC</code>回收。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">如果要删除元素时，最好选择传入索引删除，他比直接传入要删除的对象的方法要快很多</p></div>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<div class=\"output_wrapper\" id=\"output_wrapper_id\" style=\"font-size: 15px; color: rgb(62, 62, 62); line-height: 1.8; word-spacing: 2px; letter-spacing: 2px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif; background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%); background-size: 20px 20px; background-position: center center;\"><blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">积千里跬步，汇万里江河；每天进步一点点，终有一天将成大佬。</p>\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">本文基于JDK1.8</p>\n</blockquote>\n<h2 id=\"h\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">前言</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>由于实现了<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Deque</code>这个接口，所以可以当<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>使用。不过一般要用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">栈</code>或<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">队列</code>的时候推荐使用<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">ArrayDeque</code>,所以这里就不讲<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>的栈和队列功能了🌚。还是和上篇<a href=\"https://mjava.top/java/java-arraylist-source-1/\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: rgb(30, 107, 184); overflow-wrap: break-word;\">ArrayList</a>一样，讲些常用的方法。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>内部是由<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">双链表</strong>组成的，里面存放着一个个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>，每个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>又包含三个元素(<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">prev</code>,<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">item</code>,<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">next</code>):</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">prev:</strong>指向前一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">item:</strong>存放存入的数据</li>\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">next:</strong>指向下一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">链表的第一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">prev</code>为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>，最后个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">next</code>为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code></p>\n</blockquote>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">我简单的画了一张图，可以看下</p>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个prev和next并不是指向null，因为内存中没有为null分配空间，这边是表示是prev和next为null；</p>\n</blockquote>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213058.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">本文内容</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104164627.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-2\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">内部变量</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">相比于<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Arraylist</code>，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>内部变量就少得多，就只有三个，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">size</code>存这当前元素的个数，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">first</code>指向链表的第一个，<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">last</code>指向列表的最后一个</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104170249.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-3\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">构造方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"h-4\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">无参构造方法</span></h3>\n<h4 id=\"h-5\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br></code></pre>\n<h4 id=\"h-6\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">无参构造只是初始化了数据，并未做任何操作<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">(初始化  size=0  first=null   last=null)</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104172851.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"h-7\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">有参构造方法</span></h3>\n<h4 id=\"h-8\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;oldList=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>List&lt;String&gt;&nbsp;newList=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;(oldList);<br></code></pre>\n<h4 id=\"h-9\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">由于篇幅有限，addAll()方法这边就不讲了，后面另写文章再讲，里面的操作就相当于把集合里的元素复制到新集合里面。</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104174143.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hget\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">get方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hgetintindex\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">get(int index)</span></h3>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这里先讲get()方法，然后再讲add()方法，原因是插入方法里用到的调用的方法个get()方法里是一样的</p>\n</blockquote>\n<h4 id=\"h-10\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰2\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰3\"</span>);<br>list.get(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">2</span>);<br></code></pre>\n<h4 id=\"h-11\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183636.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">checkElementIndex(int index)</strong>检查越界</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183853.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104183939.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">node(int index)</strong>查找Node</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200109160648.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hadd\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"haddee\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add(E e)</span></h3>\n<h4 id=\"h-12\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br></code></pre>\n<h4 id=\"h-13\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104175255.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">linkLast(E e)</strong>连接最后一个元素</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104175907.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">Node&lt;E&gt;</strong>内部类</li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">就像开头说的，每个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>里有三个，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">prev:</strong>指向前一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code>，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">item:</strong>存放存入的数据，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">next:</strong>指向下一个<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">Node</code></p>\n</blockquote>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">private</span>&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">static</span>&nbsp;<span class=\"hljs-class\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\"><span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">class</span>&nbsp;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">Node</span>&lt;<span class=\"hljs-title\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">E</span>&gt;&nbsp;</span>{<br>&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;item;<br>&nbsp;&nbsp;&nbsp;&nbsp;Node&lt;E&gt;&nbsp;next;<br>&nbsp;&nbsp;&nbsp;&nbsp;Node&lt;E&gt;&nbsp;prev;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;Node(Node&lt;E&gt;&nbsp;prev,&nbsp;E&nbsp;element,&nbsp;Node&lt;E&gt;&nbsp;next)&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.item&nbsp;=&nbsp;element;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.next&nbsp;=&nbsp;next;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">this</span>.prev&nbsp;=&nbsp;prev;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br></code></pre>\n<h4 id=\"h-14\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">第一次添加时的流程示意图</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104224556.jpg\" alt=\"第一次添加时的流程示意图\" title=\"第一次添加时的流程示意图\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">第一次添加时的流程示意图</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">不是第一次添加</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213234.jpg\" alt=\"不是第一次添加\" title=\"不是第一次添加\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">不是第一次添加</figcaption></figure>\n<h3 id=\"haddintindexeelement\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">add(int index, E element)</span></h3>\n<h4 id=\"h-15\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.add(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>,<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hk\"</span>);<br></code></pre>\n<h4 id=\"h-16\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码分析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">这边插入元素时，先判断插入的位置是不是尾部，如果不尾部的话，先调用和get()那个一样的方法，来查找要插入位置的当前元素，然后进行插入操作</strong></p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104185743.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">checkPositionIndex(int index)</strong>检查是否越界</li>\n</ul>\n<blockquote style=\"line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: rgb(0, 0, 0); border-left: 5px solid rgb(202, 200, 96); background: rgb(239, 235, 233); overflow: auto; overflow-wrap: normal; word-break: normal;\">\n  <p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;\">这个检查越界的方法个get()检查越界的方法有点不同，它是可以等于<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">size</code>的，因为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">linkedList</code>的索引设计也是从<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">0</code>开始的，<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">所以size永远比索引大1</strong></p>\n</blockquote>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104190000.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104190144.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">linkBefore(E e, Node&lt;E&gt; succ)</strong>插入元素操作</li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104191607.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h4 id=\"h-17\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">上面说的可能有点绕，看看流程图就明白了，哈哈</p>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">添加的位置为第一个</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213757.jpg\" alt=\"添加的位置为第一个\" title=\"添加的位置为第一个\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">添加的位置为第一个</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">添加的位置为中间</span></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104213437.jpg\" alt=\"添加的位置为中间\" title=\"添加的位置为中间\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">添加的位置为中间</figcaption></figure>\n<h2 id=\"hset\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">set方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hsetintindexeelement\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">set(int index, E element)</span></h3>\n<h4 id=\"h-18\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.set(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">0</span>,<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br></code></pre>\n<h4 id=\"h-19\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这里大多调用的是和<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">get()</code>里一样的方法</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104194247.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hremove\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hremoveintindex\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove(int index)</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">按索引删除，先找到被删除的Node，然后解除相关链接，设置Node里三大元素为null，删除后返回被删除Node里的item</p>\n<h4 id=\"h-20\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"灰\"</span>);<br>list.remove(<span class=\"hljs-number\" style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;\">1</span>);<br></code></pre>\n<h4 id=\"h-21\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104205658.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\"><strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">unlink(Node&lt;E&gt; x)</strong>解除Node的连接，然后返回被解除链接的<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">item</code></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104222250.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h4 id=\"h-22\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">流程图</span></h4>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">第一个元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104215754.jpg\" alt=\"删除的是链表里的第一个元素\" title=\"删除的是链表里的第一个元素\" style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\">删除的是链表里的第一个元素</figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">中间元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104215947.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<ul style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; padding-left: 32px; list-style-type: disc;\">\n<li style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-bottom: 0.5em;\">删除的是链表里的<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">最后一个元素</strong></li>\n</ul>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104220851.jpg\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h3 id=\"hremoveobjecto\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">remove(Object o)</span></h3>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">这个删除就比较<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">慢</code>了，它是从头开始一一对比，时间复杂度为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">O(n)</code>，这个删除也是<strong style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold; color: rgb(233, 105, 0);\">只删除最早添加的数据</strong></p>\n<h4 id=\"h-23\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.remove(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br></code></pre>\n<h4 id=\"h-24\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">unlink()</code>方法就是上面讲的那个</p>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104223708.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"hclear\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear方法</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<h3 id=\"hclear-1\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(150, 100, 50); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">clear()</span></h3>\n<h4 id=\"h-25\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">代码实现</span></h4>\n<pre style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; background: url('./school-book.png') rgb(246, 246, 174); border-top: 2px solid rgb(210, 232, 185); border-bottom: 1px solid rgb(210, 232, 185);\"><code class=\"java language-java hljs\" style=\"overflow-wrap: break-word; margin: 0px 2px; background: rgb(248, 248, 248); font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; padding: 15px 0.5em 0.5em 30px; font-size: 11px; line-height: 16px; color: rgb(62, 89, 21); white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;\">List&lt;String&gt;&nbsp;list=<span class=\"hljs-keyword\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(0, 85, 153); font-weight: bold; word-wrap: inherit !important; word-break: inherit !important;\">new</span>&nbsp;LinkedList&lt;&gt;();<br>list.add(<span class=\"hljs-string\" style=\"font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: rgb(44, 0, 159); word-wrap: inherit !important; word-break: inherit !important;\">\"hui\"</span>);<br>list.clear();<br></code></pre>\n<h4 id=\"h-26\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; font-size: 1.2em;\"><span style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\">源码解析</span></h4>\n<figure style=\"font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;\"><img src=\"http://cdn.mjava.top/blog/20200104224213.png\" alt title style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; display: block; margin: 0px auto; max-width: 100%;\"><figcaption style=\"line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;\"></figcaption></figure>\n<h2 id=\"h-27\" style=\"color: inherit; line-height: inherit; padding: 0px; margin: 1.6em 0px; font-weight: bold; border-bottom: 2px solid rgb(233, 90, 96); font-size: 1.3em;\"><span style=\"font-size: inherit; line-height: inherit; margin: 0px; display: inline-block; font-weight: normal; background: rgb(233, 90, 96); color: rgb(255, 255, 255); padding: 3px 10px 1px; border-top-right-radius: 3px; border-top-left-radius: 3px; margin-right: 3px;\">总结</span><span style=\"display: inline-block; vertical-align: bottom; border-bottom: 36px solid rgb(239, 235, 233); border-right: 20px solid transparent;\"> </span></h2>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\"><code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">LinkedList</code>里删除，添加操作一般就两个步骤，变换前后Node指向的地址，删除操作把对应Node里的三个变量都设置为<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">null</code>，方便<code style=\"font-size: inherit; line-height: inherit; overflow-wrap: break-word; padding: 2px 4px; border-radius: 4px; margin: 0px 2px; color: rgb(248, 35, 117); background: rgb(248, 248, 248);\">GC</code>回收。</p>\n<p style=\"font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1.7em 0px;\">如果要删除元素时，最好选择传入索引删除，他比直接传入要删除的对象的方法要快很多</p></div>"},{"title":"OAuth2.0与JWT","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-05-12T06:59:43.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n\n\n\n\n## OAuth2.0\n\nOAuth2.0是一个授权协议，它允许软件应用代表资源拥有者去访问资源拥有者的资源。应用向资源拥有者请求`令牌`，并用这个令牌来访问资源拥有者的资源。\n\n### 角色\n\n- 客户端：相当于访问受保护资源的软件\n- 授权服务器：授予客户端令牌的服务\n- 资源拥有者：受保护的资源拥有者，有权决定将不将令牌授权给客户端\n- 受保护的资源：除资源拥有者外，要访问此资源必须要有授权服务器颁发的有效的令牌\n\n### 授权类型\n\n\n\n#### 授权码许可类型![授权码许可类型](http://cdn.mjava.top/blog/20200512090246.jpg)\n\n---\n\n#### 隐式许可类型![隐式许可类型](http://cdn.mjava.top/blog/20200512135621.jpg)\n\n---\n\n#### 客户端凭证许可类型![客户端凭证许可类型](http://cdn.mjava.top/blog/20200512135605.jpg)\n\n---\n\n#### 资源拥有者凭证许可类型(账号密码模式)![资源拥有者凭证许可类型(账号密码模式)](http://cdn.mjava.top/blog/20200512135635.jpg)\n\n---\n\n#### 断言许可类型![断言许可类型](http://cdn.mjava.top/blog/20200512135531.jpg)\n\n\n\n## JWT\n\nJWT全称：JSON Web Token，是一种令牌格式。其格式类似为`xxxxx.yyyyy.zzzzz`,分为三部分，每个部分都用`Base64`进行编码，之间用`.`分隔。\n\n第一部分：为Header部分，标头通常由两部分组成：令牌的类型（即JWT）和所使用的签名算法，例如HMAC SHA256或RSA。\n\n```json\n{\n  \"alg\": \"HS256\",\n  \"typ\": \"JWT\"\n}\n```\n\n\n\n第二部分：令牌的第二部分是有效负载，其中包含声明。 声明是有关实体（通常是用户）和其他数据的声明。 共有三种类型的声明：注册的，公共的和私有的三种声明。当然里面可以存放任何有效的字段信息（私有声明）。但是为了避免不同实现之间不兼容，可以准守JWT官方提供的声明字段。\n\n- 注册声明：JWT官方提供的声明，参考资料:https://tools.ietf.org/html/rfc7519#section-4.1\n- 公共声明：用户发邮件给JWT官方进行注册的声明字段，参考资料：https://tools.ietf.org/html/rfc7519#section-4.2\n- 私有声明：完全用户自定义，参考资料https://tools.ietf.org/html/rfc7519#section-4.3\n\n第三部分：为令牌签名部分，使用这个字段后，资源服务器只会接受签名正确的令牌。","source":"_posts/archive/web-security/oauth-and-jwt.md","raw":"---\ntitle: OAuth2.0与JWT\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-05-12 14:59:43\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- OAuth2.0\n- JWT\ncategories:\n- WebSecurity\n---\n\n\n\n\n\n\n\n## OAuth2.0\n\nOAuth2.0是一个授权协议，它允许软件应用代表资源拥有者去访问资源拥有者的资源。应用向资源拥有者请求`令牌`，并用这个令牌来访问资源拥有者的资源。\n\n### 角色\n\n- 客户端：相当于访问受保护资源的软件\n- 授权服务器：授予客户端令牌的服务\n- 资源拥有者：受保护的资源拥有者，有权决定将不将令牌授权给客户端\n- 受保护的资源：除资源拥有者外，要访问此资源必须要有授权服务器颁发的有效的令牌\n\n### 授权类型\n\n\n\n#### 授权码许可类型![授权码许可类型](http://cdn.mjava.top/blog/20200512090246.jpg)\n\n---\n\n#### 隐式许可类型![隐式许可类型](http://cdn.mjava.top/blog/20200512135621.jpg)\n\n---\n\n#### 客户端凭证许可类型![客户端凭证许可类型](http://cdn.mjava.top/blog/20200512135605.jpg)\n\n---\n\n#### 资源拥有者凭证许可类型(账号密码模式)![资源拥有者凭证许可类型(账号密码模式)](http://cdn.mjava.top/blog/20200512135635.jpg)\n\n---\n\n#### 断言许可类型![断言许可类型](http://cdn.mjava.top/blog/20200512135531.jpg)\n\n\n\n## JWT\n\nJWT全称：JSON Web Token，是一种令牌格式。其格式类似为`xxxxx.yyyyy.zzzzz`,分为三部分，每个部分都用`Base64`进行编码，之间用`.`分隔。\n\n第一部分：为Header部分，标头通常由两部分组成：令牌的类型（即JWT）和所使用的签名算法，例如HMAC SHA256或RSA。\n\n```json\n{\n  \"alg\": \"HS256\",\n  \"typ\": \"JWT\"\n}\n```\n\n\n\n第二部分：令牌的第二部分是有效负载，其中包含声明。 声明是有关实体（通常是用户）和其他数据的声明。 共有三种类型的声明：注册的，公共的和私有的三种声明。当然里面可以存放任何有效的字段信息（私有声明）。但是为了避免不同实现之间不兼容，可以准守JWT官方提供的声明字段。\n\n- 注册声明：JWT官方提供的声明，参考资料:https://tools.ietf.org/html/rfc7519#section-4.1\n- 公共声明：用户发邮件给JWT官方进行注册的声明字段，参考资料：https://tools.ietf.org/html/rfc7519#section-4.2\n- 私有声明：完全用户自定义，参考资料https://tools.ietf.org/html/rfc7519#section-4.3\n\n第三部分：为令牌签名部分，使用这个字段后，资源服务器只会接受签名正确的令牌。","slug":"archive/web-security/oauth-and-jwt","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5blv00892mg5tgytwzpm","content":"<h2 id=\"OAuth2-0\"><a href=\"#OAuth2-0\" class=\"headerlink\" title=\"OAuth2.0\"></a>OAuth2.0</h2><p>OAuth2.0是一个授权协议，它允许软件应用代表资源拥有者去访问资源拥有者的资源。应用向资源拥有者请求<code>令牌</code>，并用这个令牌来访问资源拥有者的资源。</p>\n<h3 id=\"角色\"><a href=\"#角色\" class=\"headerlink\" title=\"角色\"></a>角色</h3><ul>\n<li>客户端：相当于访问受保护资源的软件</li>\n<li>授权服务器：授予客户端令牌的服务</li>\n<li>资源拥有者：受保护的资源拥有者，有权决定将不将令牌授权给客户端</li>\n<li>受保护的资源：除资源拥有者外，要访问此资源必须要有授权服务器颁发的有效的令牌</li>\n</ul>\n<h3 id=\"授权类型\"><a href=\"#授权类型\" class=\"headerlink\" title=\"授权类型\"></a>授权类型</h3><h4 id=\"授权码许可类型\"><a href=\"#授权码许可类型\" class=\"headerlink\" title=\"授权码许可类型\"></a>授权码许可类型<img src=\"http://cdn.mjava.top/blog/20200512090246.jpg\" alt=\"授权码许可类型\"></h4><hr>\n<h4 id=\"隐式许可类型\"><a href=\"#隐式许可类型\" class=\"headerlink\" title=\"隐式许可类型\"></a>隐式许可类型<img src=\"http://cdn.mjava.top/blog/20200512135621.jpg\" alt=\"隐式许可类型\"></h4><hr>\n<h4 id=\"客户端凭证许可类型\"><a href=\"#客户端凭证许可类型\" class=\"headerlink\" title=\"客户端凭证许可类型\"></a>客户端凭证许可类型<img src=\"http://cdn.mjava.top/blog/20200512135605.jpg\" alt=\"客户端凭证许可类型\"></h4><hr>\n<h4 id=\"资源拥有者凭证许可类型-账号密码模式\"><a href=\"#资源拥有者凭证许可类型-账号密码模式\" class=\"headerlink\" title=\"资源拥有者凭证许可类型(账号密码模式)\"></a>资源拥有者凭证许可类型(账号密码模式)<img src=\"http://cdn.mjava.top/blog/20200512135635.jpg\" alt=\"资源拥有者凭证许可类型(账号密码模式)\"></h4><hr>\n<h4 id=\"断言许可类型\"><a href=\"#断言许可类型\" class=\"headerlink\" title=\"断言许可类型\"></a>断言许可类型<img src=\"http://cdn.mjava.top/blog/20200512135531.jpg\" alt=\"断言许可类型\"></h4><h2 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h2><p>JWT全称：JSON Web Token，是一种令牌格式。其格式类似为<code>xxxxx.yyyyy.zzzzz</code>,分为三部分，每个部分都用<code>Base64</code>进行编码，之间用<code>.</code>分隔。</p>\n<p>第一部分：为Header部分，标头通常由两部分组成：令牌的类型（即JWT）和所使用的签名算法，例如HMAC SHA256或RSA。</p>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"alg\"</span>: <span class=\"string\">\"HS256\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"typ\"</span>: <span class=\"string\">\"JWT\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>第二部分：令牌的第二部分是有效负载，其中包含声明。 声明是有关实体（通常是用户）和其他数据的声明。 共有三种类型的声明：注册的，公共的和私有的三种声明。当然里面可以存放任何有效的字段信息（私有声明）。但是为了避免不同实现之间不兼容，可以准守JWT官方提供的声明字段。</p>\n<ul>\n<li>注册声明：JWT官方提供的声明，参考资料:<a href=\"https://tools.ietf.org/html/rfc7519#section-4.1\" rel=\"noopener\" target=\"_blank\">https://tools.ietf.org/html/rfc7519#section-4.1</a></li>\n<li>公共声明：用户发邮件给JWT官方进行注册的声明字段，参考资料：<a href=\"https://tools.ietf.org/html/rfc7519#section-4.2\" rel=\"noopener\" target=\"_blank\">https://tools.ietf.org/html/rfc7519#section-4.2</a></li>\n<li>私有声明：完全用户自定义，参考资料<a href=\"https://tools.ietf.org/html/rfc7519#section-4.3\" rel=\"noopener\" target=\"_blank\">https://tools.ietf.org/html/rfc7519#section-4.3</a></li>\n</ul>\n<p>第三部分：为令牌签名部分，使用这个字段后，资源服务器只会接受签名正确的令牌。</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"OAuth2-0\"><a href=\"#OAuth2-0\" class=\"headerlink\" title=\"OAuth2.0\"></a>OAuth2.0</h2><p>OAuth2.0是一个授权协议，它允许软件应用代表资源拥有者去访问资源拥有者的资源。应用向资源拥有者请求<code>令牌</code>，并用这个令牌来访问资源拥有者的资源。</p>\n<h3 id=\"角色\"><a href=\"#角色\" class=\"headerlink\" title=\"角色\"></a>角色</h3><ul>\n<li>客户端：相当于访问受保护资源的软件</li>\n<li>授权服务器：授予客户端令牌的服务</li>\n<li>资源拥有者：受保护的资源拥有者，有权决定将不将令牌授权给客户端</li>\n<li>受保护的资源：除资源拥有者外，要访问此资源必须要有授权服务器颁发的有效的令牌</li>\n</ul>\n<h3 id=\"授权类型\"><a href=\"#授权类型\" class=\"headerlink\" title=\"授权类型\"></a>授权类型</h3><h4 id=\"授权码许可类型\"><a href=\"#授权码许可类型\" class=\"headerlink\" title=\"授权码许可类型\"></a>授权码许可类型<img src=\"http://cdn.mjava.top/blog/20200512090246.jpg\" alt=\"授权码许可类型\"></h4><hr>\n<h4 id=\"隐式许可类型\"><a href=\"#隐式许可类型\" class=\"headerlink\" title=\"隐式许可类型\"></a>隐式许可类型<img src=\"http://cdn.mjava.top/blog/20200512135621.jpg\" alt=\"隐式许可类型\"></h4><hr>\n<h4 id=\"客户端凭证许可类型\"><a href=\"#客户端凭证许可类型\" class=\"headerlink\" title=\"客户端凭证许可类型\"></a>客户端凭证许可类型<img src=\"http://cdn.mjava.top/blog/20200512135605.jpg\" alt=\"客户端凭证许可类型\"></h4><hr>\n<h4 id=\"资源拥有者凭证许可类型-账号密码模式\"><a href=\"#资源拥有者凭证许可类型-账号密码模式\" class=\"headerlink\" title=\"资源拥有者凭证许可类型(账号密码模式)\"></a>资源拥有者凭证许可类型(账号密码模式)<img src=\"http://cdn.mjava.top/blog/20200512135635.jpg\" alt=\"资源拥有者凭证许可类型(账号密码模式)\"></h4><hr>\n<h4 id=\"断言许可类型\"><a href=\"#断言许可类型\" class=\"headerlink\" title=\"断言许可类型\"></a>断言许可类型<img src=\"http://cdn.mjava.top/blog/20200512135531.jpg\" alt=\"断言许可类型\"></h4><h2 id=\"JWT\"><a href=\"#JWT\" class=\"headerlink\" title=\"JWT\"></a>JWT</h2><p>JWT全称：JSON Web Token，是一种令牌格式。其格式类似为<code>xxxxx.yyyyy.zzzzz</code>,分为三部分，每个部分都用<code>Base64</code>进行编码，之间用<code>.</code>分隔。</p>\n<p>第一部分：为Header部分，标头通常由两部分组成：令牌的类型（即JWT）和所使用的签名算法，例如HMAC SHA256或RSA。</p>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"alg\"</span>: <span class=\"string\">\"HS256\"</span>,</span><br><span class=\"line\">  <span class=\"attr\">\"typ\"</span>: <span class=\"string\">\"JWT\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>第二部分：令牌的第二部分是有效负载，其中包含声明。 声明是有关实体（通常是用户）和其他数据的声明。 共有三种类型的声明：注册的，公共的和私有的三种声明。当然里面可以存放任何有效的字段信息（私有声明）。但是为了避免不同实现之间不兼容，可以准守JWT官方提供的声明字段。</p>\n<ul>\n<li>注册声明：JWT官方提供的声明，参考资料:<a href=\"https://tools.ietf.org/html/rfc7519#section-4.1\" rel=\"noopener\" target=\"_blank\">https://tools.ietf.org/html/rfc7519#section-4.1</a></li>\n<li>公共声明：用户发邮件给JWT官方进行注册的声明字段，参考资料：<a href=\"https://tools.ietf.org/html/rfc7519#section-4.2\" rel=\"noopener\" target=\"_blank\">https://tools.ietf.org/html/rfc7519#section-4.2</a></li>\n<li>私有声明：完全用户自定义，参考资料<a href=\"https://tools.ietf.org/html/rfc7519#section-4.3\" rel=\"noopener\" target=\"_blank\">https://tools.ietf.org/html/rfc7519#section-4.3</a></li>\n</ul>\n<p>第三部分：为令牌签名部分，使用这个字段后，资源服务器只会接受签名正确的令牌。</p>\n"},{"title":"基于SpringCloud搭建Spring-security-oauth认证服务器","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-05-19T12:25:06.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n\n\n## 准备阶段\n\n这里搭建一个用OAuth2.0密码模式认证的服务器，token存入redis，client存入Mysql；\n\n所以事先要准备好：\n\n- Redis\n- Mysql\n\n并且Mysql执行[Spring-security-oauth初始化Sql](https://github.com/spring-projects/spring-security-oauth/blob/master/spring-security-oauth2/src/test/resources/schema.sql)这个SQL，初始化Spring-security-oauth所需要的表。然后执行\n\n```sql\n-- 插入client_id和client_secret都为sunline的客户端\ninsert into \n\toauth_client_details (client_id, client_secret, authorized_grant_types , autoapprove)\nvalues \n\t(\"sunline\",\"\t{bcrypt}$2a$10$G1CFd535SiyOtvi6ckbZWexQy.hW5x/I/fLBPiW/E4UmctCfKYbgG\",\"password\",\"true\");\n```\n\n> client_secret为`new BCryptPasswordEncoder().encode(\"sunline\")`方法加密后，然后在加上`{bcrypt}`\n\n\n\n## 开始搭建\n\n\n\n### 导入pom依赖\n\n```java\n<!--security-oauth-->\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-oauth2</artifactId>\n</dependency>\n    \n<!--redis-->\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-redis</artifactId>\n</dependency>\n    \n<!--mysql-->\n<dependency>\n    <groupId>mysql</groupId>\n    <artifactId>mysql-connector-java</artifactId>\n    <version>8.0.17</version>\n    <scope>compile</scope>\n</dependency>\n```\n\n\n\n### 配置application.properties\n\n```properties\n#datasource\nspring.datasource.url=jdbc:mysql://localhost:3307/grey_code?useUnicode=true&characterEncoding=UTF-8&autoReconnect=true&serverTimezone=Asia/Shanghai\nspring.datasource.username=zmh\nspring.datasource.password=zmh\n\n#redis\nspring.redis.host=127.0.0.1\nspring.redis.port=6379\n\n\nserver.port=9991\nserver.servlet.context-path=/oauthServer\n```\n\n\n\n### 创建用户详情服务类\n\n![](http://cdn.mjava.top/blog/20200519194059.png)\n\n#### 创建权限控制类\n\n![](http://cdn.mjava.top/blog/20200519194128.png)\n\n### 创建认证授权类\n\n![](http://cdn.mjava.top/blog/20200519194207.png)\n\n## 获取令牌\n\n访问:`/oauth/token`就可以获取到令牌\n\n![](http://cdn.mjava.top/blog/20200519194446.png)\n\n```json\n{\n    \"accessToken\": \"e28f9a99-e60d-4693-b6c3-73e06a1d14f5ZMH10086\",\n    \"expiration\": \"2020-05-19T21:11:39.883+0000\",\n    \"scope\": [\n        \"all\"\n    ],\n    \"tokenType\": \"bearer\"\n}\n```\n\n\n\n### 访问资源\n\n带上获取到的令牌\n\n![](http://cdn.mjava.top/blog/20200519194803.png)","source":"_posts/archive/web-security/spring-security-oauth-server-demo.md","raw":"---\ntitle: 基于SpringCloud搭建Spring-security-oauth认证服务器\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-05-19 20:25:06\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- OAuth\n- spring-security\ncategories:\n- WebSecurity\n---\n\n\n\n\n\n## 准备阶段\n\n这里搭建一个用OAuth2.0密码模式认证的服务器，token存入redis，client存入Mysql；\n\n所以事先要准备好：\n\n- Redis\n- Mysql\n\n并且Mysql执行[Spring-security-oauth初始化Sql](https://github.com/spring-projects/spring-security-oauth/blob/master/spring-security-oauth2/src/test/resources/schema.sql)这个SQL，初始化Spring-security-oauth所需要的表。然后执行\n\n```sql\n-- 插入client_id和client_secret都为sunline的客户端\ninsert into \n\toauth_client_details (client_id, client_secret, authorized_grant_types , autoapprove)\nvalues \n\t(\"sunline\",\"\t{bcrypt}$2a$10$G1CFd535SiyOtvi6ckbZWexQy.hW5x/I/fLBPiW/E4UmctCfKYbgG\",\"password\",\"true\");\n```\n\n> client_secret为`new BCryptPasswordEncoder().encode(\"sunline\")`方法加密后，然后在加上`{bcrypt}`\n\n\n\n## 开始搭建\n\n\n\n### 导入pom依赖\n\n```java\n<!--security-oauth-->\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-oauth2</artifactId>\n</dependency>\n    \n<!--redis-->\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-redis</artifactId>\n</dependency>\n    \n<!--mysql-->\n<dependency>\n    <groupId>mysql</groupId>\n    <artifactId>mysql-connector-java</artifactId>\n    <version>8.0.17</version>\n    <scope>compile</scope>\n</dependency>\n```\n\n\n\n### 配置application.properties\n\n```properties\n#datasource\nspring.datasource.url=jdbc:mysql://localhost:3307/grey_code?useUnicode=true&characterEncoding=UTF-8&autoReconnect=true&serverTimezone=Asia/Shanghai\nspring.datasource.username=zmh\nspring.datasource.password=zmh\n\n#redis\nspring.redis.host=127.0.0.1\nspring.redis.port=6379\n\n\nserver.port=9991\nserver.servlet.context-path=/oauthServer\n```\n\n\n\n### 创建用户详情服务类\n\n![](http://cdn.mjava.top/blog/20200519194059.png)\n\n#### 创建权限控制类\n\n![](http://cdn.mjava.top/blog/20200519194128.png)\n\n### 创建认证授权类\n\n![](http://cdn.mjava.top/blog/20200519194207.png)\n\n## 获取令牌\n\n访问:`/oauth/token`就可以获取到令牌\n\n![](http://cdn.mjava.top/blog/20200519194446.png)\n\n```json\n{\n    \"accessToken\": \"e28f9a99-e60d-4693-b6c3-73e06a1d14f5ZMH10086\",\n    \"expiration\": \"2020-05-19T21:11:39.883+0000\",\n    \"scope\": [\n        \"all\"\n    ],\n    \"tokenType\": \"bearer\"\n}\n```\n\n\n\n### 访问资源\n\n带上获取到的令牌\n\n![](http://cdn.mjava.top/blog/20200519194803.png)","slug":"archive/web-security/spring-security-oauth-server-demo","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5blw008a2mg5f1ueyd6n","content":"<h2 id=\"准备阶段\"><a href=\"#准备阶段\" class=\"headerlink\" title=\"准备阶段\"></a>准备阶段</h2><p>这里搭建一个用OAuth2.0密码模式认证的服务器，token存入redis，client存入Mysql；</p>\n<p>所以事先要准备好：</p>\n<ul>\n<li>Redis</li>\n<li>Mysql</li>\n</ul>\n<p>并且Mysql执行<a href=\"https://github.com/spring-projects/spring-security-oauth/blob/master/spring-security-oauth2/src/test/resources/schema.sql\" rel=\"noopener\" target=\"_blank\">Spring-security-oauth初始化Sql</a>这个SQL，初始化Spring-security-oauth所需要的表。然后执行</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 插入client_id和client_secret都为sunline的客户端</span></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> </span><br><span class=\"line\">\toauth_client_details (client_id, client_secret, authorized_grant_types , autoapprove)</span><br><span class=\"line\"><span class=\"keyword\">values</span> </span><br><span class=\"line\">\t(<span class=\"string\">\"sunline\"</span>,<span class=\"string\">\"\t&#123;bcrypt&#125;$2a$10$G1CFd535SiyOtvi6ckbZWexQy.hW5x/I/fLBPiW/E4UmctCfKYbgG\"</span>,<span class=\"string\">\"password\"</span>,<span class=\"string\">\"true\"</span>);</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>client_secret为<code>new BCryptPasswordEncoder().encode(&quot;sunline&quot;)</code>方法加密后，然后在加上<code>{bcrypt}</code></p>\n</blockquote>\n<h2 id=\"开始搭建\"><a href=\"#开始搭建\" class=\"headerlink\" title=\"开始搭建\"></a>开始搭建</h2><h3 id=\"导入pom依赖\"><a href=\"#导入pom依赖\" class=\"headerlink\" title=\"导入pom依赖\"></a>导入pom依赖</h3><figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;!--security-oauth--&gt;</span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br><span class=\"line\">    </span><br><span class=\"line\">&lt;!--redis--&gt;</span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br><span class=\"line\">    </span><br><span class=\"line\">&lt;!--mysql--&gt;</span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;8.0.17&lt;/version&gt;</span><br><span class=\"line\">    &lt;scope&gt;compile&lt;/scope&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"配置application-properties\"><a href=\"#配置application-properties\" class=\"headerlink\" title=\"配置application.properties\"></a>配置application.properties</h3><figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#datasource</span></span><br><span class=\"line\"><span class=\"meta\">spring.datasource.url</span>=<span class=\"string\">jdbc:mysql://localhost:3307/grey_code?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;serverTimezone=Asia/Shanghai</span></span><br><span class=\"line\"><span class=\"meta\">spring.datasource.username</span>=<span class=\"string\">zmh</span></span><br><span class=\"line\"><span class=\"meta\">spring.datasource.password</span>=<span class=\"string\">zmh</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#redis</span></span><br><span class=\"line\"><span class=\"meta\">spring.redis.host</span>=<span class=\"string\">127.0.0.1</span></span><br><span class=\"line\"><span class=\"meta\">spring.redis.port</span>=<span class=\"string\">6379</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">server.port</span>=<span class=\"string\">9991</span></span><br><span class=\"line\"><span class=\"meta\">server.servlet.context-path</span>=<span class=\"string\">/oauthServer</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建用户详情服务类\"><a href=\"#创建用户详情服务类\" class=\"headerlink\" title=\"创建用户详情服务类\"></a>创建用户详情服务类</h3><p><img src=\"http://cdn.mjava.top/blog/20200519194059.png\" alt></p>\n<h4 id=\"创建权限控制类\"><a href=\"#创建权限控制类\" class=\"headerlink\" title=\"创建权限控制类\"></a>创建权限控制类</h4><p><img src=\"http://cdn.mjava.top/blog/20200519194128.png\" alt></p>\n<h3 id=\"创建认证授权类\"><a href=\"#创建认证授权类\" class=\"headerlink\" title=\"创建认证授权类\"></a>创建认证授权类</h3><p><img src=\"http://cdn.mjava.top/blog/20200519194207.png\" alt></p>\n<h2 id=\"获取令牌\"><a href=\"#获取令牌\" class=\"headerlink\" title=\"获取令牌\"></a>获取令牌</h2><p>访问:<code>/oauth/token</code>就可以获取到令牌</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200519194446.png\" alt></p>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"accessToken\"</span>: <span class=\"string\">\"e28f9a99-e60d-4693-b6c3-73e06a1d14f5ZMH10086\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"expiration\"</span>: <span class=\"string\">\"2020-05-19T21:11:39.883+0000\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"scope\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"all\"</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"attr\">\"tokenType\"</span>: <span class=\"string\">\"bearer\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"访问资源\"><a href=\"#访问资源\" class=\"headerlink\" title=\"访问资源\"></a>访问资源</h3><p>带上获取到的令牌</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200519194803.png\" alt></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"准备阶段\"><a href=\"#准备阶段\" class=\"headerlink\" title=\"准备阶段\"></a>准备阶段</h2><p>这里搭建一个用OAuth2.0密码模式认证的服务器，token存入redis，client存入Mysql；</p>\n<p>所以事先要准备好：</p>\n<ul>\n<li>Redis</li>\n<li>Mysql</li>\n</ul>\n<p>并且Mysql执行<a href=\"https://github.com/spring-projects/spring-security-oauth/blob/master/spring-security-oauth2/src/test/resources/schema.sql\" rel=\"noopener\" target=\"_blank\">Spring-security-oauth初始化Sql</a>这个SQL，初始化Spring-security-oauth所需要的表。然后执行</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 插入client_id和client_secret都为sunline的客户端</span></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> </span><br><span class=\"line\">\toauth_client_details (client_id, client_secret, authorized_grant_types , autoapprove)</span><br><span class=\"line\"><span class=\"keyword\">values</span> </span><br><span class=\"line\">\t(<span class=\"string\">\"sunline\"</span>,<span class=\"string\">\"\t&#123;bcrypt&#125;$2a$10$G1CFd535SiyOtvi6ckbZWexQy.hW5x/I/fLBPiW/E4UmctCfKYbgG\"</span>,<span class=\"string\">\"password\"</span>,<span class=\"string\">\"true\"</span>);</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>client_secret为<code>new BCryptPasswordEncoder().encode(&quot;sunline&quot;)</code>方法加密后，然后在加上<code>{bcrypt}</code></p>\n</blockquote>\n<h2 id=\"开始搭建\"><a href=\"#开始搭建\" class=\"headerlink\" title=\"开始搭建\"></a>开始搭建</h2><h3 id=\"导入pom依赖\"><a href=\"#导入pom依赖\" class=\"headerlink\" title=\"导入pom依赖\"></a>导入pom依赖</h3><figure class=\"highlight\"><table><tr><td class=\"code\"><pre><span class=\"line\">&lt;!--security-oauth--&gt;</span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br><span class=\"line\">    </span><br><span class=\"line\">&lt;!--redis--&gt;</span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br><span class=\"line\">    </span><br><span class=\"line\">&lt;!--mysql--&gt;</span><br><span class=\"line\">&lt;dependency&gt;</span><br><span class=\"line\">    &lt;groupId&gt;mysql&lt;/groupId&gt;</span><br><span class=\"line\">    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</span><br><span class=\"line\">    &lt;version&gt;8.0.17&lt;/version&gt;</span><br><span class=\"line\">    &lt;scope&gt;compile&lt;/scope&gt;</span><br><span class=\"line\">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"配置application-properties\"><a href=\"#配置application-properties\" class=\"headerlink\" title=\"配置application.properties\"></a>配置application.properties</h3><figure class=\"highlight properties\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#datasource</span></span><br><span class=\"line\"><span class=\"meta\">spring.datasource.url</span>=<span class=\"string\">jdbc:mysql://localhost:3307/grey_code?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;serverTimezone=Asia/Shanghai</span></span><br><span class=\"line\"><span class=\"meta\">spring.datasource.username</span>=<span class=\"string\">zmh</span></span><br><span class=\"line\"><span class=\"meta\">spring.datasource.password</span>=<span class=\"string\">zmh</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#redis</span></span><br><span class=\"line\"><span class=\"meta\">spring.redis.host</span>=<span class=\"string\">127.0.0.1</span></span><br><span class=\"line\"><span class=\"meta\">spring.redis.port</span>=<span class=\"string\">6379</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">server.port</span>=<span class=\"string\">9991</span></span><br><span class=\"line\"><span class=\"meta\">server.servlet.context-path</span>=<span class=\"string\">/oauthServer</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"创建用户详情服务类\"><a href=\"#创建用户详情服务类\" class=\"headerlink\" title=\"创建用户详情服务类\"></a>创建用户详情服务类</h3><p><img src=\"http://cdn.mjava.top/blog/20200519194059.png\" alt></p>\n<h4 id=\"创建权限控制类\"><a href=\"#创建权限控制类\" class=\"headerlink\" title=\"创建权限控制类\"></a>创建权限控制类</h4><p><img src=\"http://cdn.mjava.top/blog/20200519194128.png\" alt></p>\n<h3 id=\"创建认证授权类\"><a href=\"#创建认证授权类\" class=\"headerlink\" title=\"创建认证授权类\"></a>创建认证授权类</h3><p><img src=\"http://cdn.mjava.top/blog/20200519194207.png\" alt></p>\n<h2 id=\"获取令牌\"><a href=\"#获取令牌\" class=\"headerlink\" title=\"获取令牌\"></a>获取令牌</h2><p>访问:<code>/oauth/token</code>就可以获取到令牌</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200519194446.png\" alt></p>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">\"accessToken\"</span>: <span class=\"string\">\"e28f9a99-e60d-4693-b6c3-73e06a1d14f5ZMH10086\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"expiration\"</span>: <span class=\"string\">\"2020-05-19T21:11:39.883+0000\"</span>,</span><br><span class=\"line\">    <span class=\"attr\">\"scope\"</span>: [</span><br><span class=\"line\">        <span class=\"string\">\"all\"</span></span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"attr\">\"tokenType\"</span>: <span class=\"string\">\"bearer\"</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"访问资源\"><a href=\"#访问资源\" class=\"headerlink\" title=\"访问资源\"></a>访问资源</h3><p>带上获取到的令牌</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200519194803.png\" alt></p>\n"},{"title":"SSO单点登录和CAS框架","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-05-14T11:27:14.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## SSO单点登录\n\n**单点登录**（英语：Single sign-on，缩写为 SSO），又译为**单一签入**，一种对于许多相互关连，但是又是各自独立的软件系统，提供[访问控制](https://zh.wikipedia.org/wiki/存取控制)的属性。当拥有这项属性时，当用户[登录](https://zh.wikipedia.org/wiki/登入)时，就可以获取所有系统的访问权限，不用对每个单一系统都逐一登录。这项功能通常是以[轻型目录访问协议](https://zh.wikipedia.org/wiki/轻型目录访问协议)（LDAP）来实现，在服务器上会将用户信息存储到LDAP数据库中。相同的，**单一退出**（single sign-off）就是指，只需要单一的退出动作，就可以结束对于多个系统的访问权限。\n\n### 优点\n\n使用单点登录的好处包括：\n\n- 降低访问第三方网站的风险（不存储用户密码，或在外部管理）。\n- 减少因不同的用户名和密码组合而带来的[密码疲劳](https://zh.wikipedia.org/w/index.php?title=密碼疲勞&action=edit&redlink=1)。\n- 减少为相同的身份重新输入密码所花费的时间。\n- 因减少与密码相关的调用IT[服务台](https://zh.wikipedia.org/wiki/服务台)的次数而降低IT成本。[[1\\]](https://zh.wikipedia.org/wiki/單一登入#cite_note-1)\n\nSSO为所有其它应用程序和系统，以集中的[验证服务器](https://zh.wikipedia.org/w/index.php?title=验证服务器&action=edit&redlink=1)提供身份验证，并结合技术以确保用户不必频繁输入密码。\n\n\n\n## CAS框架\n\nCAS 协议基于在**客户端**Web浏览器、Web**应用**和**CAS服务器**之间的票据验证。当客户端访问访问应用程序，请求身份验证时，应用程序重定向到CAS。CAS验证客户端是否被授权，通常通过在数据库对用户名和密码进行检查。如果身份验证成功，CAS一次性在客户端以Cookie形式发放TGT票据，在其有效期CAS将一直信任用户，同时将客户端自动返回到应用程序，并向应用传递身份验证票（Service ticket）。然后，应用程序通过安全连接连接CAS，并提供自己的服务标识和验证票。之后CAS给出了关于特定用户是否已成功通过身份验证的应用程序授信信息。\n\n### 历史\n\n- CAS是由[耶鲁大学](https://zh.wikipedia.org/wiki/耶鲁大学)[[1\\]](https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-1)的Shawn Bayern创始的，后来由耶鲁大学的Drew Mazurek维护。CAS1.0实现了单点登录。 CAS2.0引入了多级代理认证（Multi-tier proxy authentication）。CAS其他几个版本已经有了新的功能。\n\n- 2004年12月，CAS成为[Jasig](https://zh.wikipedia.org/w/index.php?title=Jasig&action=edit&redlink=1)[[2\\]](https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-2)的一个项目，2008年该组织负责CAS的维护和发展。CAS原名“耶鲁大学CAS”，此后被称为“Jasig CAS”。\n\n- 2005年5月，CAS协议版本2发布，引入代理和服务验证。\n\n- 2006年12月，[安德鲁·W·梅隆基金会](https://zh.wikipedia.org/w/index.php?title=安德鲁·W·梅隆基金会&action=edit&redlink=1)授予耶鲁大学第一届梅隆技术协作奖，颁发50000美元的奖金对耶鲁大学开发CAS进行奖励。[[3\\]](https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-3)颁奖之时，CAS在“数以百计的大学校园”中使用。\n\n- 2012年12月，JASIG与Sakai基金合并，CAS改名为Apereo CAS。\n\n- 2016年11月，基于Spring Boot的CAS软件版本5发布。","source":"_posts/archive/web-security/sso-and-cas.md","raw":"---\ntitle: SSO单点登录和CAS框架\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-05-14 19:27:14\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- SSO\n- CAS框架\ncategories:\n- WebSecurity\n---\n\n## SSO单点登录\n\n**单点登录**（英语：Single sign-on，缩写为 SSO），又译为**单一签入**，一种对于许多相互关连，但是又是各自独立的软件系统，提供[访问控制](https://zh.wikipedia.org/wiki/存取控制)的属性。当拥有这项属性时，当用户[登录](https://zh.wikipedia.org/wiki/登入)时，就可以获取所有系统的访问权限，不用对每个单一系统都逐一登录。这项功能通常是以[轻型目录访问协议](https://zh.wikipedia.org/wiki/轻型目录访问协议)（LDAP）来实现，在服务器上会将用户信息存储到LDAP数据库中。相同的，**单一退出**（single sign-off）就是指，只需要单一的退出动作，就可以结束对于多个系统的访问权限。\n\n### 优点\n\n使用单点登录的好处包括：\n\n- 降低访问第三方网站的风险（不存储用户密码，或在外部管理）。\n- 减少因不同的用户名和密码组合而带来的[密码疲劳](https://zh.wikipedia.org/w/index.php?title=密碼疲勞&action=edit&redlink=1)。\n- 减少为相同的身份重新输入密码所花费的时间。\n- 因减少与密码相关的调用IT[服务台](https://zh.wikipedia.org/wiki/服务台)的次数而降低IT成本。[[1\\]](https://zh.wikipedia.org/wiki/單一登入#cite_note-1)\n\nSSO为所有其它应用程序和系统，以集中的[验证服务器](https://zh.wikipedia.org/w/index.php?title=验证服务器&action=edit&redlink=1)提供身份验证，并结合技术以确保用户不必频繁输入密码。\n\n\n\n## CAS框架\n\nCAS 协议基于在**客户端**Web浏览器、Web**应用**和**CAS服务器**之间的票据验证。当客户端访问访问应用程序，请求身份验证时，应用程序重定向到CAS。CAS验证客户端是否被授权，通常通过在数据库对用户名和密码进行检查。如果身份验证成功，CAS一次性在客户端以Cookie形式发放TGT票据，在其有效期CAS将一直信任用户，同时将客户端自动返回到应用程序，并向应用传递身份验证票（Service ticket）。然后，应用程序通过安全连接连接CAS，并提供自己的服务标识和验证票。之后CAS给出了关于特定用户是否已成功通过身份验证的应用程序授信信息。\n\n### 历史\n\n- CAS是由[耶鲁大学](https://zh.wikipedia.org/wiki/耶鲁大学)[[1\\]](https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-1)的Shawn Bayern创始的，后来由耶鲁大学的Drew Mazurek维护。CAS1.0实现了单点登录。 CAS2.0引入了多级代理认证（Multi-tier proxy authentication）。CAS其他几个版本已经有了新的功能。\n\n- 2004年12月，CAS成为[Jasig](https://zh.wikipedia.org/w/index.php?title=Jasig&action=edit&redlink=1)[[2\\]](https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-2)的一个项目，2008年该组织负责CAS的维护和发展。CAS原名“耶鲁大学CAS”，此后被称为“Jasig CAS”。\n\n- 2005年5月，CAS协议版本2发布，引入代理和服务验证。\n\n- 2006年12月，[安德鲁·W·梅隆基金会](https://zh.wikipedia.org/w/index.php?title=安德鲁·W·梅隆基金会&action=edit&redlink=1)授予耶鲁大学第一届梅隆技术协作奖，颁发50000美元的奖金对耶鲁大学开发CAS进行奖励。[[3\\]](https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-3)颁奖之时，CAS在“数以百计的大学校园”中使用。\n\n- 2012年12月，JASIG与Sakai基金合并，CAS改名为Apereo CAS。\n\n- 2016年11月，基于Spring Boot的CAS软件版本5发布。","slug":"archive/web-security/sso-and-cas","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5blx008d2mg5x2nsi6p0","content":"<h2 id=\"SSO单点登录\"><a href=\"#SSO单点登录\" class=\"headerlink\" title=\"SSO单点登录\"></a>SSO单点登录</h2><p><strong>单点登录</strong>（英语：Single sign-on，缩写为 SSO），又译为<strong>单一签入</strong>，一种对于许多相互关连，但是又是各自独立的软件系统，提供<a href=\"https://zh.wikipedia.org/wiki/存取控制\" rel=\"noopener\" target=\"_blank\">访问控制</a>的属性。当拥有这项属性时，当用户<a href=\"https://zh.wikipedia.org/wiki/登入\" rel=\"noopener\" target=\"_blank\">登录</a>时，就可以获取所有系统的访问权限，不用对每个单一系统都逐一登录。这项功能通常是以<a href=\"https://zh.wikipedia.org/wiki/轻型目录访问协议\" rel=\"noopener\" target=\"_blank\">轻型目录访问协议</a>（LDAP）来实现，在服务器上会将用户信息存储到LDAP数据库中。相同的，<strong>单一退出</strong>（single sign-off）就是指，只需要单一的退出动作，就可以结束对于多个系统的访问权限。</p>\n<h3 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h3><p>使用单点登录的好处包括：</p>\n<ul>\n<li>降低访问第三方网站的风险（不存储用户密码，或在外部管理）。</li>\n<li>减少因不同的用户名和密码组合而带来的<a href=\"https://zh.wikipedia.org/w/index.php?title=密碼疲勞&action=edit&redlink=1\" rel=\"noopener\" target=\"_blank\">密码疲劳</a>。</li>\n<li>减少为相同的身份重新输入密码所花费的时间。</li>\n<li>因减少与密码相关的调用IT<a href=\"https://zh.wikipedia.org/wiki/服务台\" rel=\"noopener\" target=\"_blank\">服务台</a>的次数而降低IT成本。<a href=\"https://zh.wikipedia.org/wiki/單一登入#cite_note-1\" rel=\"noopener\" target=\"_blank\">[1]</a></li>\n</ul>\n<p>SSO为所有其它应用程序和系统，以集中的<a href=\"https://zh.wikipedia.org/w/index.php?title=验证服务器&action=edit&redlink=1\" rel=\"noopener\" target=\"_blank\">验证服务器</a>提供身份验证，并结合技术以确保用户不必频繁输入密码。</p>\n<h2 id=\"CAS框架\"><a href=\"#CAS框架\" class=\"headerlink\" title=\"CAS框架\"></a>CAS框架</h2><p>CAS 协议基于在<strong>客户端</strong>Web浏览器、Web<strong>应用</strong>和<strong>CAS服务器</strong>之间的票据验证。当客户端访问访问应用程序，请求身份验证时，应用程序重定向到CAS。CAS验证客户端是否被授权，通常通过在数据库对用户名和密码进行检查。如果身份验证成功，CAS一次性在客户端以Cookie形式发放TGT票据，在其有效期CAS将一直信任用户，同时将客户端自动返回到应用程序，并向应用传递身份验证票（Service ticket）。然后，应用程序通过安全连接连接CAS，并提供自己的服务标识和验证票。之后CAS给出了关于特定用户是否已成功通过身份验证的应用程序授信信息。</p>\n<h3 id=\"历史\"><a href=\"#历史\" class=\"headerlink\" title=\"历史\"></a>历史</h3><ul>\n<li><p>CAS是由<a href=\"https://zh.wikipedia.org/wiki/耶鲁大学\" rel=\"noopener\" target=\"_blank\">耶鲁大学</a><a href=\"https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-1\" rel=\"noopener\" target=\"_blank\">[1]</a>的Shawn Bayern创始的，后来由耶鲁大学的Drew Mazurek维护。CAS1.0实现了单点登录。 CAS2.0引入了多级代理认证（Multi-tier proxy authentication）。CAS其他几个版本已经有了新的功能。</p>\n</li>\n<li><p>2004年12月，CAS成为<a href=\"https://zh.wikipedia.org/w/index.php?title=Jasig&action=edit&redlink=1\" rel=\"noopener\" target=\"_blank\">Jasig</a><a href=\"https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-2\" rel=\"noopener\" target=\"_blank\">[2]</a>的一个项目，2008年该组织负责CAS的维护和发展。CAS原名“耶鲁大学CAS”，此后被称为“Jasig CAS”。</p>\n</li>\n<li><p>2005年5月，CAS协议版本2发布，引入代理和服务验证。</p>\n</li>\n<li><p>2006年12月，<a href=\"https://zh.wikipedia.org/w/index.php?title=安德鲁·W·梅隆基金会&action=edit&redlink=1\" rel=\"noopener\" target=\"_blank\">安德鲁·W·梅隆基金会</a>授予耶鲁大学第一届梅隆技术协作奖，颁发50000美元的奖金对耶鲁大学开发CAS进行奖励。<a href=\"https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-3\" rel=\"noopener\" target=\"_blank\">[3]</a>颁奖之时，CAS在“数以百计的大学校园”中使用。</p>\n</li>\n<li><p>2012年12月，JASIG与Sakai基金合并，CAS改名为Apereo CAS。</p>\n</li>\n<li><p>2016年11月，基于Spring Boot的CAS软件版本5发布。</p>\n</li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"SSO单点登录\"><a href=\"#SSO单点登录\" class=\"headerlink\" title=\"SSO单点登录\"></a>SSO单点登录</h2><p><strong>单点登录</strong>（英语：Single sign-on，缩写为 SSO），又译为<strong>单一签入</strong>，一种对于许多相互关连，但是又是各自独立的软件系统，提供<a href=\"https://zh.wikipedia.org/wiki/存取控制\" rel=\"noopener\" target=\"_blank\">访问控制</a>的属性。当拥有这项属性时，当用户<a href=\"https://zh.wikipedia.org/wiki/登入\" rel=\"noopener\" target=\"_blank\">登录</a>时，就可以获取所有系统的访问权限，不用对每个单一系统都逐一登录。这项功能通常是以<a href=\"https://zh.wikipedia.org/wiki/轻型目录访问协议\" rel=\"noopener\" target=\"_blank\">轻型目录访问协议</a>（LDAP）来实现，在服务器上会将用户信息存储到LDAP数据库中。相同的，<strong>单一退出</strong>（single sign-off）就是指，只需要单一的退出动作，就可以结束对于多个系统的访问权限。</p>\n<h3 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h3><p>使用单点登录的好处包括：</p>\n<ul>\n<li>降低访问第三方网站的风险（不存储用户密码，或在外部管理）。</li>\n<li>减少因不同的用户名和密码组合而带来的<a href=\"https://zh.wikipedia.org/w/index.php?title=密碼疲勞&action=edit&redlink=1\" rel=\"noopener\" target=\"_blank\">密码疲劳</a>。</li>\n<li>减少为相同的身份重新输入密码所花费的时间。</li>\n<li>因减少与密码相关的调用IT<a href=\"https://zh.wikipedia.org/wiki/服务台\" rel=\"noopener\" target=\"_blank\">服务台</a>的次数而降低IT成本。<a href=\"https://zh.wikipedia.org/wiki/單一登入#cite_note-1\" rel=\"noopener\" target=\"_blank\">[1]</a></li>\n</ul>\n<p>SSO为所有其它应用程序和系统，以集中的<a href=\"https://zh.wikipedia.org/w/index.php?title=验证服务器&action=edit&redlink=1\" rel=\"noopener\" target=\"_blank\">验证服务器</a>提供身份验证，并结合技术以确保用户不必频繁输入密码。</p>\n<h2 id=\"CAS框架\"><a href=\"#CAS框架\" class=\"headerlink\" title=\"CAS框架\"></a>CAS框架</h2><p>CAS 协议基于在<strong>客户端</strong>Web浏览器、Web<strong>应用</strong>和<strong>CAS服务器</strong>之间的票据验证。当客户端访问访问应用程序，请求身份验证时，应用程序重定向到CAS。CAS验证客户端是否被授权，通常通过在数据库对用户名和密码进行检查。如果身份验证成功，CAS一次性在客户端以Cookie形式发放TGT票据，在其有效期CAS将一直信任用户，同时将客户端自动返回到应用程序，并向应用传递身份验证票（Service ticket）。然后，应用程序通过安全连接连接CAS，并提供自己的服务标识和验证票。之后CAS给出了关于特定用户是否已成功通过身份验证的应用程序授信信息。</p>\n<h3 id=\"历史\"><a href=\"#历史\" class=\"headerlink\" title=\"历史\"></a>历史</h3><ul>\n<li><p>CAS是由<a href=\"https://zh.wikipedia.org/wiki/耶鲁大学\" rel=\"noopener\" target=\"_blank\">耶鲁大学</a><a href=\"https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-1\" rel=\"noopener\" target=\"_blank\">[1]</a>的Shawn Bayern创始的，后来由耶鲁大学的Drew Mazurek维护。CAS1.0实现了单点登录。 CAS2.0引入了多级代理认证（Multi-tier proxy authentication）。CAS其他几个版本已经有了新的功能。</p>\n</li>\n<li><p>2004年12月，CAS成为<a href=\"https://zh.wikipedia.org/w/index.php?title=Jasig&action=edit&redlink=1\" rel=\"noopener\" target=\"_blank\">Jasig</a><a href=\"https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-2\" rel=\"noopener\" target=\"_blank\">[2]</a>的一个项目，2008年该组织负责CAS的维护和发展。CAS原名“耶鲁大学CAS”，此后被称为“Jasig CAS”。</p>\n</li>\n<li><p>2005年5月，CAS协议版本2发布，引入代理和服务验证。</p>\n</li>\n<li><p>2006年12月，<a href=\"https://zh.wikipedia.org/w/index.php?title=安德鲁·W·梅隆基金会&action=edit&redlink=1\" rel=\"noopener\" target=\"_blank\">安德鲁·W·梅隆基金会</a>授予耶鲁大学第一届梅隆技术协作奖，颁发50000美元的奖金对耶鲁大学开发CAS进行奖励。<a href=\"https://zh.wikipedia.org/wiki/集中式认证服务#cite_note-3\" rel=\"noopener\" target=\"_blank\">[3]</a>颁奖之时，CAS在“数以百计的大学校园”中使用。</p>\n</li>\n<li><p>2012年12月，JASIG与Sakai基金合并，CAS改名为Apereo CAS。</p>\n</li>\n<li><p>2016年11月，基于Spring Boot的CAS软件版本5发布。</p>\n</li>\n</ul>\n"},{"title":"Disruptor-生产者发布方式","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-03-01T01:57:58.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 旧版本API发布方式\n\n```java\nimport com.lmax.disruptor.RingBuffer;\n\npublic class LongEventProducer{\n    \n    private final RingBuffer<LongEvent> ringBuffer;\n    \n    public LongEventProducer(RingBuffer<LongEvent> ringBuffer){\n        this.ringBuffer = ringBuffer;\n    }\n    \n    public void onData(ByteBuffer bb){\n        long sequence = ringBuffer.next();  // Grab the next sequence\n        try{\n            LongEvent event = ringBuffer.get(sequence); // Get the entry in the Disruptor\n                                                        // for the sequence\n            event.set(bb.getLong(0));  // Fill with data\n        }\n        finally{\n            ringBuffer.publish(sequence);\n        }\n    }\n}\n\n\n```\n\n### 使用\n\n```java\nRingBuffer<LongEvent> ringBuffer = disruptor.start();\n\nLongEventProducer producer = new LongEventProducer(ringBuffer);\n\nByteBuffer bb = ByteBuffer.allocate(8);\nfor (long l = 0; l<5; l++) {\n    bb.putLong(0, l);\n    producer.onData(bb)\n}\nSystem.out.println(\"发布完成\");\n```\n\n\n\n## 使用Translators发布\n\n```java\nimport com.lmax.disruptor.RingBuffer;\nimport com.lmax.disruptor.EventTranslatorOneArg;\n\npublic class LongEventProducerWithTranslator{\n    \n    private final RingBuffer<LongEvent> ringBuffer;\n    \n    public LongEventProducerWithTranslator(RingBuffer<LongEvent> ringBuffer){\n        this.ringBuffer = ringBuffer;\n    }\n    \n    private static final EventTranslatorOneArg<LongEvent, ByteBuffer> TRANSLATOR =\n        new EventTranslatorOneArg<LongEvent, ByteBuffer>(){\n            public void translateTo(LongEvent event, long sequence, ByteBuffer bb){\n                event.set(bb.getLong(0));\n            }\n        };\n    \n    public void onData(ByteBuffer bb){\n        ringBuffer.publishEvent(TRANSLATOR, bb);\n    }\n}\n```\n\n### 使用\n\n```diff\nRingBuffer<LongEvent> ringBuffer = disruptor.start();\n\n- LongEventProducer producer = new LongEventProducer(ringBuffer);\n+ LongEventProducerWithTranslator producer = new LongEventProducerWithTranslator(ringBuffer);\n\nByteBuffer bb = ByteBuffer.allocate(8);\nfor (long l = 0; l<5; l++) {\n    bb.putLong(0, l);\n    producer.onData(bb)\n}\nSystem.out.println(\"发布完成\");\n```\n\n\n\n## 使用Java8的Lambda表达式发布\n\n```diff\nRingBuffer<LongEvent> ringBuffer = disruptor.start();\n- LongEventProducerWithTranslator producer = new LongEventProducerWithTranslator(ringBuffer);\nByteBuffer bb = ByteBuffer.allocate(8);\nfor (long l = 0; true; l++){\n    bb.putLong(0, l);\n-   producer.onData(bb);\n+   ringBuffer.publishEvent((event, sequence, buffer) ->event.set(buffer.getLong(0)),bb);\n}\n```","source":"_posts/java/disruptor/926f33f0-651d-471a-ad0c-b632fcce8c0f.md","raw":"---\ntitle: Disruptor-生产者发布方式\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-03-01 09:57:58\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Disruptor\n- Java\ncategories:\n- Java\n---\n\n## 旧版本API发布方式\n\n```java\nimport com.lmax.disruptor.RingBuffer;\n\npublic class LongEventProducer{\n    \n    private final RingBuffer<LongEvent> ringBuffer;\n    \n    public LongEventProducer(RingBuffer<LongEvent> ringBuffer){\n        this.ringBuffer = ringBuffer;\n    }\n    \n    public void onData(ByteBuffer bb){\n        long sequence = ringBuffer.next();  // Grab the next sequence\n        try{\n            LongEvent event = ringBuffer.get(sequence); // Get the entry in the Disruptor\n                                                        // for the sequence\n            event.set(bb.getLong(0));  // Fill with data\n        }\n        finally{\n            ringBuffer.publish(sequence);\n        }\n    }\n}\n\n\n```\n\n### 使用\n\n```java\nRingBuffer<LongEvent> ringBuffer = disruptor.start();\n\nLongEventProducer producer = new LongEventProducer(ringBuffer);\n\nByteBuffer bb = ByteBuffer.allocate(8);\nfor (long l = 0; l<5; l++) {\n    bb.putLong(0, l);\n    producer.onData(bb)\n}\nSystem.out.println(\"发布完成\");\n```\n\n\n\n## 使用Translators发布\n\n```java\nimport com.lmax.disruptor.RingBuffer;\nimport com.lmax.disruptor.EventTranslatorOneArg;\n\npublic class LongEventProducerWithTranslator{\n    \n    private final RingBuffer<LongEvent> ringBuffer;\n    \n    public LongEventProducerWithTranslator(RingBuffer<LongEvent> ringBuffer){\n        this.ringBuffer = ringBuffer;\n    }\n    \n    private static final EventTranslatorOneArg<LongEvent, ByteBuffer> TRANSLATOR =\n        new EventTranslatorOneArg<LongEvent, ByteBuffer>(){\n            public void translateTo(LongEvent event, long sequence, ByteBuffer bb){\n                event.set(bb.getLong(0));\n            }\n        };\n    \n    public void onData(ByteBuffer bb){\n        ringBuffer.publishEvent(TRANSLATOR, bb);\n    }\n}\n```\n\n### 使用\n\n```diff\nRingBuffer<LongEvent> ringBuffer = disruptor.start();\n\n- LongEventProducer producer = new LongEventProducer(ringBuffer);\n+ LongEventProducerWithTranslator producer = new LongEventProducerWithTranslator(ringBuffer);\n\nByteBuffer bb = ByteBuffer.allocate(8);\nfor (long l = 0; l<5; l++) {\n    bb.putLong(0, l);\n    producer.onData(bb)\n}\nSystem.out.println(\"发布完成\");\n```\n\n\n\n## 使用Java8的Lambda表达式发布\n\n```diff\nRingBuffer<LongEvent> ringBuffer = disruptor.start();\n- LongEventProducerWithTranslator producer = new LongEventProducerWithTranslator(ringBuffer);\nByteBuffer bb = ByteBuffer.allocate(8);\nfor (long l = 0; true; l++){\n    bb.putLong(0, l);\n-   producer.onData(bb);\n+   ringBuffer.publishEvent((event, sequence, buffer) ->event.set(buffer.getLong(0)),bb);\n}\n```","slug":"java/disruptor/926f33f0-651d-471a-ad0c-b632fcce8c0f","published":1,"updated":"2021-03-01T02:00:51.507Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bly008e2mg5boz5r6rg","content":"<h2 id=\"旧版本API发布方式\"><a href=\"#旧版本API发布方式\" class=\"headerlink\" title=\"旧版本API发布方式\"></a>旧版本API发布方式</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.lmax.disruptor.RingBuffer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEventProducer</span></span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> RingBuffer&lt;LongEvent&gt; ringBuffer;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">LongEventProducer</span><span class=\"params\">(RingBuffer&lt;LongEvent&gt; ringBuffer)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.ringBuffer = ringBuffer;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onData</span><span class=\"params\">(ByteBuffer bb)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> sequence = ringBuffer.next();  <span class=\"comment\">// Grab the next sequence</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">            LongEvent event = ringBuffer.get(sequence); <span class=\"comment\">// Get the entry in the Disruptor</span></span><br><span class=\"line\">                                                        <span class=\"comment\">// for the sequence</span></span><br><span class=\"line\">            event.set(bb.getLong(<span class=\"number\">0</span>));  <span class=\"comment\">// Fill with data</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">            ringBuffer.publish(sequence);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br><span class=\"line\"></span><br><span class=\"line\">LongEventProducer producer = <span class=\"keyword\">new</span> LongEventProducer(ringBuffer);</span><br><span class=\"line\"></span><br><span class=\"line\">ByteBuffer bb = ByteBuffer.allocate(<span class=\"number\">8</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">long</span> l = <span class=\"number\">0</span>; l&lt;<span class=\"number\">5</span>; l++) &#123;</span><br><span class=\"line\">    bb.putLong(<span class=\"number\">0</span>, l);</span><br><span class=\"line\">    producer.onData(bb)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(<span class=\"string\">\"发布完成\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"使用Translators发布\"><a href=\"#使用Translators发布\" class=\"headerlink\" title=\"使用Translators发布\"></a>使用Translators发布</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.lmax.disruptor.RingBuffer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.lmax.disruptor.EventTranslatorOneArg;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEventProducerWithTranslator</span></span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> RingBuffer&lt;LongEvent&gt; ringBuffer;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">LongEventProducerWithTranslator</span><span class=\"params\">(RingBuffer&lt;LongEvent&gt; ringBuffer)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.ringBuffer = ringBuffer;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> EventTranslatorOneArg&lt;LongEvent, ByteBuffer&gt; TRANSLATOR =</span><br><span class=\"line\">        <span class=\"keyword\">new</span> EventTranslatorOneArg&lt;LongEvent, ByteBuffer&gt;()&#123;</span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">translateTo</span><span class=\"params\">(LongEvent event, <span class=\"keyword\">long</span> sequence, ByteBuffer bb)</span></span>&#123;</span><br><span class=\"line\">                event.set(bb.getLong(<span class=\"number\">0</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onData</span><span class=\"params\">(ByteBuffer bb)</span></span>&#123;</span><br><span class=\"line\">        ringBuffer.publishEvent(TRANSLATOR, bb);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用-1\"><a href=\"#使用-1\" class=\"headerlink\" title=\"使用\"></a>使用</h3><figure class=\"highlight diff\"><table><tr><td class=\"code\"><pre><span class=\"line\">RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"deletion\">- LongEventProducer producer = new LongEventProducer(ringBuffer);</span></span><br><span class=\"line\"><span class=\"addition\">+ LongEventProducerWithTranslator producer = new LongEventProducerWithTranslator(ringBuffer);</span></span><br><span class=\"line\"></span><br><span class=\"line\">ByteBuffer bb = ByteBuffer.allocate(8);</span><br><span class=\"line\">for (long l = 0; l&lt;5; l++) &#123;</span><br><span class=\"line\">    bb.putLong(0, l);</span><br><span class=\"line\">    producer.onData(bb)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(\"发布完成\");</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"使用Java8的Lambda表达式发布\"><a href=\"#使用Java8的Lambda表达式发布\" class=\"headerlink\" title=\"使用Java8的Lambda表达式发布\"></a>使用Java8的Lambda表达式发布</h2><figure class=\"highlight diff\"><table><tr><td class=\"code\"><pre><span class=\"line\">RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br><span class=\"line\"><span class=\"deletion\">- LongEventProducerWithTranslator producer = new LongEventProducerWithTranslator(ringBuffer);</span></span><br><span class=\"line\">ByteBuffer bb = ByteBuffer.allocate(8);</span><br><span class=\"line\">for (long l = 0; true; l++)&#123;</span><br><span class=\"line\">    bb.putLong(0, l);</span><br><span class=\"line\"><span class=\"deletion\">-   producer.onData(bb);</span></span><br><span class=\"line\"><span class=\"addition\">+   ringBuffer.publishEvent((event, sequence, buffer) -&gt;event.set(buffer.getLong(0)),bb);</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"旧版本API发布方式\"><a href=\"#旧版本API发布方式\" class=\"headerlink\" title=\"旧版本API发布方式\"></a>旧版本API发布方式</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.lmax.disruptor.RingBuffer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEventProducer</span></span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> RingBuffer&lt;LongEvent&gt; ringBuffer;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">LongEventProducer</span><span class=\"params\">(RingBuffer&lt;LongEvent&gt; ringBuffer)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.ringBuffer = ringBuffer;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onData</span><span class=\"params\">(ByteBuffer bb)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> sequence = ringBuffer.next();  <span class=\"comment\">// Grab the next sequence</span></span><br><span class=\"line\">        <span class=\"keyword\">try</span>&#123;</span><br><span class=\"line\">            LongEvent event = ringBuffer.get(sequence); <span class=\"comment\">// Get the entry in the Disruptor</span></span><br><span class=\"line\">                                                        <span class=\"comment\">// for the sequence</span></span><br><span class=\"line\">            event.set(bb.getLong(<span class=\"number\">0</span>));  <span class=\"comment\">// Fill with data</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">finally</span>&#123;</span><br><span class=\"line\">            ringBuffer.publish(sequence);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br><span class=\"line\"></span><br><span class=\"line\">LongEventProducer producer = <span class=\"keyword\">new</span> LongEventProducer(ringBuffer);</span><br><span class=\"line\"></span><br><span class=\"line\">ByteBuffer bb = ByteBuffer.allocate(<span class=\"number\">8</span>);</span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">long</span> l = <span class=\"number\">0</span>; l&lt;<span class=\"number\">5</span>; l++) &#123;</span><br><span class=\"line\">    bb.putLong(<span class=\"number\">0</span>, l);</span><br><span class=\"line\">    producer.onData(bb)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(<span class=\"string\">\"发布完成\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"使用Translators发布\"><a href=\"#使用Translators发布\" class=\"headerlink\" title=\"使用Translators发布\"></a>使用Translators发布</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.lmax.disruptor.RingBuffer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.lmax.disruptor.EventTranslatorOneArg;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEventProducerWithTranslator</span></span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">final</span> RingBuffer&lt;LongEvent&gt; ringBuffer;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">LongEventProducerWithTranslator</span><span class=\"params\">(RingBuffer&lt;LongEvent&gt; ringBuffer)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.ringBuffer = ringBuffer;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> EventTranslatorOneArg&lt;LongEvent, ByteBuffer&gt; TRANSLATOR =</span><br><span class=\"line\">        <span class=\"keyword\">new</span> EventTranslatorOneArg&lt;LongEvent, ByteBuffer&gt;()&#123;</span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">translateTo</span><span class=\"params\">(LongEvent event, <span class=\"keyword\">long</span> sequence, ByteBuffer bb)</span></span>&#123;</span><br><span class=\"line\">                event.set(bb.getLong(<span class=\"number\">0</span>));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onData</span><span class=\"params\">(ByteBuffer bb)</span></span>&#123;</span><br><span class=\"line\">        ringBuffer.publishEvent(TRANSLATOR, bb);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"使用-1\"><a href=\"#使用-1\" class=\"headerlink\" title=\"使用\"></a>使用</h3><figure class=\"highlight diff\"><table><tr><td class=\"code\"><pre><span class=\"line\">RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"deletion\">- LongEventProducer producer = new LongEventProducer(ringBuffer);</span></span><br><span class=\"line\"><span class=\"addition\">+ LongEventProducerWithTranslator producer = new LongEventProducerWithTranslator(ringBuffer);</span></span><br><span class=\"line\"></span><br><span class=\"line\">ByteBuffer bb = ByteBuffer.allocate(8);</span><br><span class=\"line\">for (long l = 0; l&lt;5; l++) &#123;</span><br><span class=\"line\">    bb.putLong(0, l);</span><br><span class=\"line\">    producer.onData(bb)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(\"发布完成\");</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"使用Java8的Lambda表达式发布\"><a href=\"#使用Java8的Lambda表达式发布\" class=\"headerlink\" title=\"使用Java8的Lambda表达式发布\"></a>使用Java8的Lambda表达式发布</h2><figure class=\"highlight diff\"><table><tr><td class=\"code\"><pre><span class=\"line\">RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br><span class=\"line\"><span class=\"deletion\">- LongEventProducerWithTranslator producer = new LongEventProducerWithTranslator(ringBuffer);</span></span><br><span class=\"line\">ByteBuffer bb = ByteBuffer.allocate(8);</span><br><span class=\"line\">for (long l = 0; true; l++)&#123;</span><br><span class=\"line\">    bb.putLong(0, l);</span><br><span class=\"line\"><span class=\"deletion\">-   producer.onData(bb);</span></span><br><span class=\"line\"><span class=\"addition\">+   ringBuffer.publishEvent((event, sequence, buffer) -&gt;event.set(buffer.getLong(0)),bb);</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"Disruptor-缓存行填充","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-03-01T02:02:08.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 伪共享概念\n\n### CPU架构\n\n常见的CPU架构如下图：\n\n![](http://cdn.mjava.top/blog/20201116145239.jpg)\n\n在某个CPU核心上运行一个线程时，他获取数据是先从**L1缓存**上面找，没有命中数据时，再从**L2缓存**上面找、还是没有命中时再从**L3缓存**上找，如果还没有的话就再从主内存里面找。**找到后再一层一层的传递数据**。\n\n所以查找数据的顺序为：\n\n` L1 》L2 》 L3 》主内存`\n\n刷新缓存的顺序为：\n\n`主内存 》L3 》L2 》L1`\n\n### 缓存存储结构\n\n![](http://cdn.mjava.top/blog/20201116150451.jpg)\n\n在计算机缓存中，**存储数据是以缓存行为单位的**，不同的系统缓存行的大小也不一样，现在常见的64位操作系统，他每行可以存储64字节数据。比如Java中`Long`类型的数据占8个字节，所以**一行可以存8个Long数据类型的数据**。\n\n**所以当加载缓存行中任意一个数据时，其他在当前缓存行里的数据也会一起加载**\n\n### 线程数据共享\n\n当线程共享一个变量时，每个线程的更改都会把最新数据刷新回主内存，如果处理器发现自己缓存行对应的内存地址呗修改，就会将当前处理器的缓存行设置无效状态，当处理器对这个数据进行修改操作的时候，会重新从系统内存中把数据库读到处理器缓存中（**嗅探机制**）。\n\n![](http://cdn.mjava.top/blog/20201116153352.jpg)\n\n### 伪共享\n\n上面说的是**共享一个缓存行的一个数据，这样是完全没问题的**。可是**当不同线程要使用一个缓存行里的不同数据时**，这样就会出现一种**伪共享**的情况:\n\n![](http://cdn.mjava.top/blog/20201116155013.jpg)\n\n尽管`变量a`没有被其他线程更改，可以由于他和`变量d`在同一缓存行里，所以每次都会**受变量d的影响**,缓存都会被设置为无效状态，所以每次使用时都会从主内存里重新拉取。这样速度就会大大的打折扣。\n\n### RingBuffer的解决方法\n\n在`RingBuffer`解决伪共享的方法就是**缓存行填充**\n\n```java\nabstract class RingBufferPad\n{\n    protected long p1, p2, p3, p4, p5, p6, p7;\n}\n```","source":"_posts/java/disruptor/18e3fbd6-ff4b-4a0a-b82f-a547dbef8d0c.md","raw":"---\ntitle: Disruptor-缓存行填充\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-03-01 10:02:08\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Disruptor\n- Java\ncategories:\n- Java\n---\n\n## 伪共享概念\n\n### CPU架构\n\n常见的CPU架构如下图：\n\n![](http://cdn.mjava.top/blog/20201116145239.jpg)\n\n在某个CPU核心上运行一个线程时，他获取数据是先从**L1缓存**上面找，没有命中数据时，再从**L2缓存**上面找、还是没有命中时再从**L3缓存**上找，如果还没有的话就再从主内存里面找。**找到后再一层一层的传递数据**。\n\n所以查找数据的顺序为：\n\n` L1 》L2 》 L3 》主内存`\n\n刷新缓存的顺序为：\n\n`主内存 》L3 》L2 》L1`\n\n### 缓存存储结构\n\n![](http://cdn.mjava.top/blog/20201116150451.jpg)\n\n在计算机缓存中，**存储数据是以缓存行为单位的**，不同的系统缓存行的大小也不一样，现在常见的64位操作系统，他每行可以存储64字节数据。比如Java中`Long`类型的数据占8个字节，所以**一行可以存8个Long数据类型的数据**。\n\n**所以当加载缓存行中任意一个数据时，其他在当前缓存行里的数据也会一起加载**\n\n### 线程数据共享\n\n当线程共享一个变量时，每个线程的更改都会把最新数据刷新回主内存，如果处理器发现自己缓存行对应的内存地址呗修改，就会将当前处理器的缓存行设置无效状态，当处理器对这个数据进行修改操作的时候，会重新从系统内存中把数据库读到处理器缓存中（**嗅探机制**）。\n\n![](http://cdn.mjava.top/blog/20201116153352.jpg)\n\n### 伪共享\n\n上面说的是**共享一个缓存行的一个数据，这样是完全没问题的**。可是**当不同线程要使用一个缓存行里的不同数据时**，这样就会出现一种**伪共享**的情况:\n\n![](http://cdn.mjava.top/blog/20201116155013.jpg)\n\n尽管`变量a`没有被其他线程更改，可以由于他和`变量d`在同一缓存行里，所以每次都会**受变量d的影响**,缓存都会被设置为无效状态，所以每次使用时都会从主内存里重新拉取。这样速度就会大大的打折扣。\n\n### RingBuffer的解决方法\n\n在`RingBuffer`解决伪共享的方法就是**缓存行填充**\n\n```java\nabstract class RingBufferPad\n{\n    protected long p1, p2, p3, p4, p5, p6, p7;\n}\n```","slug":"java/disruptor/18e3fbd6-ff4b-4a0a-b82f-a547dbef8d0c","published":1,"updated":"2021-03-01T02:04:35.707Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5blz008f2mg5qfbn3ptm","content":"<h2 id=\"伪共享概念\"><a href=\"#伪共享概念\" class=\"headerlink\" title=\"伪共享概念\"></a>伪共享概念</h2><h3 id=\"CPU架构\"><a href=\"#CPU架构\" class=\"headerlink\" title=\"CPU架构\"></a>CPU架构</h3><p>常见的CPU架构如下图：</p>\n<p><img src=\"http://cdn.mjava.top/blog/20201116145239.jpg\" alt></p>\n<p>在某个CPU核心上运行一个线程时，他获取数据是先从<strong>L1缓存</strong>上面找，没有命中数据时，再从<strong>L2缓存</strong>上面找、还是没有命中时再从<strong>L3缓存</strong>上找，如果还没有的话就再从主内存里面找。<strong>找到后再一层一层的传递数据</strong>。</p>\n<p>所以查找数据的顺序为：</p>\n<p><code>L1 》L2 》 L3 》主内存</code></p>\n<p>刷新缓存的顺序为：</p>\n<p><code>主内存 》L3 》L2 》L1</code></p>\n<h3 id=\"缓存存储结构\"><a href=\"#缓存存储结构\" class=\"headerlink\" title=\"缓存存储结构\"></a>缓存存储结构</h3><p><img src=\"http://cdn.mjava.top/blog/20201116150451.jpg\" alt></p>\n<p>在计算机缓存中，<strong>存储数据是以缓存行为单位的</strong>，不同的系统缓存行的大小也不一样，现在常见的64位操作系统，他每行可以存储64字节数据。比如Java中<code>Long</code>类型的数据占8个字节，所以<strong>一行可以存8个Long数据类型的数据</strong>。</p>\n<p><strong>所以当加载缓存行中任意一个数据时，其他在当前缓存行里的数据也会一起加载</strong></p>\n<h3 id=\"线程数据共享\"><a href=\"#线程数据共享\" class=\"headerlink\" title=\"线程数据共享\"></a>线程数据共享</h3><p>当线程共享一个变量时，每个线程的更改都会把最新数据刷新回主内存，如果处理器发现自己缓存行对应的内存地址呗修改，就会将当前处理器的缓存行设置无效状态，当处理器对这个数据进行修改操作的时候，会重新从系统内存中把数据库读到处理器缓存中（<strong>嗅探机制</strong>）。</p>\n<p><img src=\"http://cdn.mjava.top/blog/20201116153352.jpg\" alt></p>\n<h3 id=\"伪共享\"><a href=\"#伪共享\" class=\"headerlink\" title=\"伪共享\"></a>伪共享</h3><p>上面说的是<strong>共享一个缓存行的一个数据，这样是完全没问题的</strong>。可是<strong>当不同线程要使用一个缓存行里的不同数据时</strong>，这样就会出现一种<strong>伪共享</strong>的情况:</p>\n<p><img src=\"http://cdn.mjava.top/blog/20201116155013.jpg\" alt></p>\n<p>尽管<code>变量a</code>没有被其他线程更改，可以由于他和<code>变量d</code>在同一缓存行里，所以每次都会<strong>受变量d的影响</strong>,缓存都会被设置为无效状态，所以每次使用时都会从主内存里重新拉取。这样速度就会大大的打折扣。</p>\n<h3 id=\"RingBuffer的解决方法\"><a href=\"#RingBuffer的解决方法\" class=\"headerlink\" title=\"RingBuffer的解决方法\"></a>RingBuffer的解决方法</h3><p>在<code>RingBuffer</code>解决伪共享的方法就是<strong>缓存行填充</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RingBufferPad</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"keyword\">long</span> p1, p2, p3, p4, p5, p6, p7;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"伪共享概念\"><a href=\"#伪共享概念\" class=\"headerlink\" title=\"伪共享概念\"></a>伪共享概念</h2><h3 id=\"CPU架构\"><a href=\"#CPU架构\" class=\"headerlink\" title=\"CPU架构\"></a>CPU架构</h3><p>常见的CPU架构如下图：</p>\n<p><img src=\"http://cdn.mjava.top/blog/20201116145239.jpg\" alt></p>\n<p>在某个CPU核心上运行一个线程时，他获取数据是先从<strong>L1缓存</strong>上面找，没有命中数据时，再从<strong>L2缓存</strong>上面找、还是没有命中时再从<strong>L3缓存</strong>上找，如果还没有的话就再从主内存里面找。<strong>找到后再一层一层的传递数据</strong>。</p>\n<p>所以查找数据的顺序为：</p>\n<p><code>L1 》L2 》 L3 》主内存</code></p>\n<p>刷新缓存的顺序为：</p>\n<p><code>主内存 》L3 》L2 》L1</code></p>\n<h3 id=\"缓存存储结构\"><a href=\"#缓存存储结构\" class=\"headerlink\" title=\"缓存存储结构\"></a>缓存存储结构</h3><p><img src=\"http://cdn.mjava.top/blog/20201116150451.jpg\" alt></p>\n<p>在计算机缓存中，<strong>存储数据是以缓存行为单位的</strong>，不同的系统缓存行的大小也不一样，现在常见的64位操作系统，他每行可以存储64字节数据。比如Java中<code>Long</code>类型的数据占8个字节，所以<strong>一行可以存8个Long数据类型的数据</strong>。</p>\n<p><strong>所以当加载缓存行中任意一个数据时，其他在当前缓存行里的数据也会一起加载</strong></p>\n<h3 id=\"线程数据共享\"><a href=\"#线程数据共享\" class=\"headerlink\" title=\"线程数据共享\"></a>线程数据共享</h3><p>当线程共享一个变量时，每个线程的更改都会把最新数据刷新回主内存，如果处理器发现自己缓存行对应的内存地址呗修改，就会将当前处理器的缓存行设置无效状态，当处理器对这个数据进行修改操作的时候，会重新从系统内存中把数据库读到处理器缓存中（<strong>嗅探机制</strong>）。</p>\n<p><img src=\"http://cdn.mjava.top/blog/20201116153352.jpg\" alt></p>\n<h3 id=\"伪共享\"><a href=\"#伪共享\" class=\"headerlink\" title=\"伪共享\"></a>伪共享</h3><p>上面说的是<strong>共享一个缓存行的一个数据，这样是完全没问题的</strong>。可是<strong>当不同线程要使用一个缓存行里的不同数据时</strong>，这样就会出现一种<strong>伪共享</strong>的情况:</p>\n<p><img src=\"http://cdn.mjava.top/blog/20201116155013.jpg\" alt></p>\n<p>尽管<code>变量a</code>没有被其他线程更改，可以由于他和<code>变量d</code>在同一缓存行里，所以每次都会<strong>受变量d的影响</strong>,缓存都会被设置为无效状态，所以每次使用时都会从主内存里重新拉取。这样速度就会大大的打折扣。</p>\n<h3 id=\"RingBuffer的解决方法\"><a href=\"#RingBuffer的解决方法\" class=\"headerlink\" title=\"RingBuffer的解决方法\"></a>RingBuffer的解决方法</h3><p>在<code>RingBuffer</code>解决伪共享的方法就是<strong>缓存行填充</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RingBufferPad</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">protected</span> <span class=\"keyword\">long</span> p1, p2, p3, p4, p5, p6, p7;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"Disruptor-消费模式简介(单个实例)","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-03-01T02:01:00.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 并行模式\n\n并行模式下两个Handler同时执行，互不影响\n\n```java\ndisruptor.handleEventsWith(new A1Handler(),new B1Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111164411.jpg)\n\n### 结果示例\n\n```shell\n++++++++++\n1605084168915+B1Handler:5\n1605084168915+A1Handler:1\n++++++++++\n1605084169915+B1Handler:6\n1605084169915+A1Handler:2\n```\n\n## 串行模式\n\n串行模式下，`Handler`执行必须是从前往后，按顺序执行。\n\n```java\ndisruptor.handleEventsWith(new A1Handler()).then(new B1Handler());\n// or\ndisruptor.handleEventsWith(new B1Handler()).then(new A1Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111164910.jpg)\n\n### 结果示例\n\n结果和`handler`放置的顺序有关，后面的handler要等前面的执行完才会执行\n\n```shell\n++++++++++\n1605084411462+A1Handler:1\n1605084411467+B1Handler:5\n++++++++++\n1605084412463+A1Handler:2\n1605084412463+B1Handler:6\n\n// or\n\n++++++++++\n1605084638285+B1Handler:5\n1605084638289+A1Handler:1\n++++++++++\n1605084639286+B1Handler:6\n1605084639286+A1Handler:2\n```\n\n\n\n## 菱形模式\n\n菱形模式其实就是并行和串行的结合体，先并行执行，再串行执行\n\n```java\ndisruptor.handleEventsWith(new A1Handler(), new A2Handler()).then(new B1Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111165759.jpg)\n\n### 结果示例\n\n`B1Handler`要等`A1Handler`和`A2Handler`全部执行完，它才会执行。\n\n```shell\n++++++++++\n1605085280283+A1Handler:1\n1605085280283+A2Handler:3\n1605085280287+B1Handler:5\n++++++++++\n1605085281283+A1Handler:2\n1605085281283+A2Handler:4\n1605085281283+B1Handler:6\n```\n\n## 链式模式\n\n链式模式也是并行和串行的结合，并行模式执行串行模式\n\n```java\ndisruptor.handleEventsWith(new A1Handler()).then(new A2Handler());\ndisruptor.handleEventsWith(new B1Handler()).then(new B2Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111171009.jpg)\n\n### 结果示例\n\n```shell\n++++++++++\n1605085843558+B1Handler:5\n1605085843558+A1Handler:1\n1605085843563+A2Handler:3\n1605085843563+B2Handler:7\n++++++++++\n1605085844558+B1Handler:6\n1605085844558+A1Handler:2\n1605085844558+B2Handler:8\n1605085844559+A2Handler:4\n```\n\n## 总结\n\n所有的模式都可以根据**并行**和**串行**来衍生出各种模式，玩法多种多样。","source":"_posts/java/disruptor/9a1bdb74-8ed3-4905-88bc-7b3b4e0a4af2.md","raw":"---\ntitle: Disruptor-消费模式简介(单个实例)\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-03-01 10:01:00\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Disruptor\n- Java\ncategories:\n- Java\n---\n\n## 并行模式\n\n并行模式下两个Handler同时执行，互不影响\n\n```java\ndisruptor.handleEventsWith(new A1Handler(),new B1Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111164411.jpg)\n\n### 结果示例\n\n```shell\n++++++++++\n1605084168915+B1Handler:5\n1605084168915+A1Handler:1\n++++++++++\n1605084169915+B1Handler:6\n1605084169915+A1Handler:2\n```\n\n## 串行模式\n\n串行模式下，`Handler`执行必须是从前往后，按顺序执行。\n\n```java\ndisruptor.handleEventsWith(new A1Handler()).then(new B1Handler());\n// or\ndisruptor.handleEventsWith(new B1Handler()).then(new A1Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111164910.jpg)\n\n### 结果示例\n\n结果和`handler`放置的顺序有关，后面的handler要等前面的执行完才会执行\n\n```shell\n++++++++++\n1605084411462+A1Handler:1\n1605084411467+B1Handler:5\n++++++++++\n1605084412463+A1Handler:2\n1605084412463+B1Handler:6\n\n// or\n\n++++++++++\n1605084638285+B1Handler:5\n1605084638289+A1Handler:1\n++++++++++\n1605084639286+B1Handler:6\n1605084639286+A1Handler:2\n```\n\n\n\n## 菱形模式\n\n菱形模式其实就是并行和串行的结合体，先并行执行，再串行执行\n\n```java\ndisruptor.handleEventsWith(new A1Handler(), new A2Handler()).then(new B1Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111165759.jpg)\n\n### 结果示例\n\n`B1Handler`要等`A1Handler`和`A2Handler`全部执行完，它才会执行。\n\n```shell\n++++++++++\n1605085280283+A1Handler:1\n1605085280283+A2Handler:3\n1605085280287+B1Handler:5\n++++++++++\n1605085281283+A1Handler:2\n1605085281283+A2Handler:4\n1605085281283+B1Handler:6\n```\n\n## 链式模式\n\n链式模式也是并行和串行的结合，并行模式执行串行模式\n\n```java\ndisruptor.handleEventsWith(new A1Handler()).then(new A2Handler());\ndisruptor.handleEventsWith(new B1Handler()).then(new B2Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111171009.jpg)\n\n### 结果示例\n\n```shell\n++++++++++\n1605085843558+B1Handler:5\n1605085843558+A1Handler:1\n1605085843563+A2Handler:3\n1605085843563+B2Handler:7\n++++++++++\n1605085844558+B1Handler:6\n1605085844558+A1Handler:2\n1605085844558+B2Handler:8\n1605085844559+A2Handler:4\n```\n\n## 总结\n\n所有的模式都可以根据**并行**和**串行**来衍生出各种模式，玩法多种多样。","slug":"java/disruptor/9a1bdb74-8ed3-4905-88bc-7b3b4e0a4af2","published":1,"updated":"2021-03-01T02:01:56.778Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bm0008i2mg5e21c4c36","content":"<h2 id=\"并行模式\"><a href=\"#并行模式\" class=\"headerlink\" title=\"并行模式\"></a>并行模式</h2><p>并行模式下两个Handler同时执行，互不影响</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> B1Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111164411.jpg\" alt></p>\n<h3 id=\"结果示例\"><a href=\"#结果示例\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084168915+B1Handler:5</span><br><span class=\"line\">1605084168915+A1Handler:1</span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084169915+B1Handler:6</span><br><span class=\"line\">1605084169915+A1Handler:2</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"串行模式\"><a href=\"#串行模式\" class=\"headerlink\" title=\"串行模式\"></a>串行模式</h2><p>串行模式下，<code>Handler</code>执行必须是从前往后，按顺序执行。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler()).then(<span class=\"keyword\">new</span> B1Handler());</span><br><span class=\"line\"><span class=\"comment\">// or</span></span><br><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> B1Handler()).then(<span class=\"keyword\">new</span> A1Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111164910.jpg\" alt></p>\n<h3 id=\"结果示例-1\"><a href=\"#结果示例-1\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><p>结果和<code>handler</code>放置的顺序有关，后面的handler要等前面的执行完才会执行</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084411462+A1Handler:1</span><br><span class=\"line\">1605084411467+B1Handler:5</span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084412463+A1Handler:2</span><br><span class=\"line\">1605084412463+B1Handler:6</span><br><span class=\"line\"></span><br><span class=\"line\">// or</span><br><span class=\"line\"></span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084638285+B1Handler:5</span><br><span class=\"line\">1605084638289+A1Handler:1</span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084639286+B1Handler:6</span><br><span class=\"line\">1605084639286+A1Handler:2</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"菱形模式\"><a href=\"#菱形模式\" class=\"headerlink\" title=\"菱形模式\"></a>菱形模式</h2><p>菱形模式其实就是并行和串行的结合体，先并行执行，再串行执行</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(), <span class=\"keyword\">new</span> A2Handler()).then(<span class=\"keyword\">new</span> B1Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111165759.jpg\" alt></p>\n<h3 id=\"结果示例-2\"><a href=\"#结果示例-2\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><p><code>B1Handler</code>要等<code>A1Handler</code>和<code>A2Handler</code>全部执行完，它才会执行。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++</span><br><span class=\"line\">1605085280283+A1Handler:1</span><br><span class=\"line\">1605085280283+A2Handler:3</span><br><span class=\"line\">1605085280287+B1Handler:5</span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605085281283+A1Handler:2</span><br><span class=\"line\">1605085281283+A2Handler:4</span><br><span class=\"line\">1605085281283+B1Handler:6</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"链式模式\"><a href=\"#链式模式\" class=\"headerlink\" title=\"链式模式\"></a>链式模式</h2><p>链式模式也是并行和串行的结合，并行模式执行串行模式</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler()).then(<span class=\"keyword\">new</span> A2Handler());</span><br><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> B1Handler()).then(<span class=\"keyword\">new</span> B2Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111171009.jpg\" alt></p>\n<h3 id=\"结果示例-3\"><a href=\"#结果示例-3\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++</span><br><span class=\"line\">1605085843558+B1Handler:5</span><br><span class=\"line\">1605085843558+A1Handler:1</span><br><span class=\"line\">1605085843563+A2Handler:3</span><br><span class=\"line\">1605085843563+B2Handler:7</span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605085844558+B1Handler:6</span><br><span class=\"line\">1605085844558+A1Handler:2</span><br><span class=\"line\">1605085844558+B2Handler:8</span><br><span class=\"line\">1605085844559+A2Handler:4</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>所有的模式都可以根据<strong>并行</strong>和<strong>串行</strong>来衍生出各种模式，玩法多种多样。</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"并行模式\"><a href=\"#并行模式\" class=\"headerlink\" title=\"并行模式\"></a>并行模式</h2><p>并行模式下两个Handler同时执行，互不影响</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> B1Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111164411.jpg\" alt></p>\n<h3 id=\"结果示例\"><a href=\"#结果示例\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084168915+B1Handler:5</span><br><span class=\"line\">1605084168915+A1Handler:1</span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084169915+B1Handler:6</span><br><span class=\"line\">1605084169915+A1Handler:2</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"串行模式\"><a href=\"#串行模式\" class=\"headerlink\" title=\"串行模式\"></a>串行模式</h2><p>串行模式下，<code>Handler</code>执行必须是从前往后，按顺序执行。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler()).then(<span class=\"keyword\">new</span> B1Handler());</span><br><span class=\"line\"><span class=\"comment\">// or</span></span><br><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> B1Handler()).then(<span class=\"keyword\">new</span> A1Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111164910.jpg\" alt></p>\n<h3 id=\"结果示例-1\"><a href=\"#结果示例-1\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><p>结果和<code>handler</code>放置的顺序有关，后面的handler要等前面的执行完才会执行</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084411462+A1Handler:1</span><br><span class=\"line\">1605084411467+B1Handler:5</span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084412463+A1Handler:2</span><br><span class=\"line\">1605084412463+B1Handler:6</span><br><span class=\"line\"></span><br><span class=\"line\">// or</span><br><span class=\"line\"></span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084638285+B1Handler:5</span><br><span class=\"line\">1605084638289+A1Handler:1</span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605084639286+B1Handler:6</span><br><span class=\"line\">1605084639286+A1Handler:2</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"菱形模式\"><a href=\"#菱形模式\" class=\"headerlink\" title=\"菱形模式\"></a>菱形模式</h2><p>菱形模式其实就是并行和串行的结合体，先并行执行，再串行执行</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(), <span class=\"keyword\">new</span> A2Handler()).then(<span class=\"keyword\">new</span> B1Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111165759.jpg\" alt></p>\n<h3 id=\"结果示例-2\"><a href=\"#结果示例-2\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><p><code>B1Handler</code>要等<code>A1Handler</code>和<code>A2Handler</code>全部执行完，它才会执行。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++</span><br><span class=\"line\">1605085280283+A1Handler:1</span><br><span class=\"line\">1605085280283+A2Handler:3</span><br><span class=\"line\">1605085280287+B1Handler:5</span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605085281283+A1Handler:2</span><br><span class=\"line\">1605085281283+A2Handler:4</span><br><span class=\"line\">1605085281283+B1Handler:6</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"链式模式\"><a href=\"#链式模式\" class=\"headerlink\" title=\"链式模式\"></a>链式模式</h2><p>链式模式也是并行和串行的结合，并行模式执行串行模式</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler()).then(<span class=\"keyword\">new</span> A2Handler());</span><br><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> B1Handler()).then(<span class=\"keyword\">new</span> B2Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111171009.jpg\" alt></p>\n<h3 id=\"结果示例-3\"><a href=\"#结果示例-3\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++</span><br><span class=\"line\">1605085843558+B1Handler:5</span><br><span class=\"line\">1605085843558+A1Handler:1</span><br><span class=\"line\">1605085843563+A2Handler:3</span><br><span class=\"line\">1605085843563+B2Handler:7</span><br><span class=\"line\">++++++++++</span><br><span class=\"line\">1605085844558+B1Handler:6</span><br><span class=\"line\">1605085844558+A1Handler:2</span><br><span class=\"line\">1605085844558+B2Handler:8</span><br><span class=\"line\">1605085844559+A2Handler:4</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>所有的模式都可以根据<strong>并行</strong>和<strong>串行</strong>来衍生出各种模式，玩法多种多样。</p>\n"},{"title":"Disruptor-消费模式简介(池化)","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-03-01T02:02:15.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 并行模式(池化)\n\n每个消费端有两个线程实例\n\n```java\ndisruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler());\ndisruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111210802.jpg)\n\n### 结果示例\n\n可以看到每次执行的线程是不一样的\n\n```shell\n++++++++++++++++++++++++++++++++++++++++++++++++\n**************************\nDisruptorWorker-0\n**************************\n1605100167571+A1Handler:10\n**************************\nDisruptorWorker-2\n1605100167572+A2Handler:30\n**************************\n++++++++++++++++++++++++++++++++++++++++++++++++\n**************************\nDisruptorWorker-1\n1605100168572+A1Handler:11\n**************************\n**************************\nDisruptorWorker-3\n1605100168573+A2Handler:31\n**************************\n```\n\n## 串行模式（池化）\n\n每个消费端有两个线程实例\n\n```java\ndisruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler())\n                .then(new A2Handler(),new A2Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111211136.jpg)\n\n### 结果示例\n\n```shell\n++++++++++++++++++++++++++++++++++++++++++++++++\n**************************\nDisruptorWorker-0\n1605100492248+A1Handler:10\n**************************\n**************************\nDisruptorWorker-2\n1605100492249+A2Handler:30\n**************************\n++++++++++++++++++++++++++++++++++++++++++++++++\n**************************\nDisruptorWorker-1\n1605100493249+A1Handler:11\n**************************\n**************************\nDisruptorWorker-3\n1605100493249+A2Handler:31\n**************************\n```","source":"_posts/java/disruptor/c16646bf-1474-42a7-a5cd-84b99669062c.md","raw":"---\ntitle: Disruptor-消费模式简介(池化)\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-03-01 10:02:15\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Disruptor\n- Java\ncategories:\n- Java\n---\n\n## 并行模式(池化)\n\n每个消费端有两个线程实例\n\n```java\ndisruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler());\ndisruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111210802.jpg)\n\n### 结果示例\n\n可以看到每次执行的线程是不一样的\n\n```shell\n++++++++++++++++++++++++++++++++++++++++++++++++\n**************************\nDisruptorWorker-0\n**************************\n1605100167571+A1Handler:10\n**************************\nDisruptorWorker-2\n1605100167572+A2Handler:30\n**************************\n++++++++++++++++++++++++++++++++++++++++++++++++\n**************************\nDisruptorWorker-1\n1605100168572+A1Handler:11\n**************************\n**************************\nDisruptorWorker-3\n1605100168573+A2Handler:31\n**************************\n```\n\n## 串行模式（池化）\n\n每个消费端有两个线程实例\n\n```java\ndisruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler())\n                .then(new A2Handler(),new A2Handler());\n```\n\n![](http://cdn.mjava.top/blog/20201111211136.jpg)\n\n### 结果示例\n\n```shell\n++++++++++++++++++++++++++++++++++++++++++++++++\n**************************\nDisruptorWorker-0\n1605100492248+A1Handler:10\n**************************\n**************************\nDisruptorWorker-2\n1605100492249+A2Handler:30\n**************************\n++++++++++++++++++++++++++++++++++++++++++++++++\n**************************\nDisruptorWorker-1\n1605100493249+A1Handler:11\n**************************\n**************************\nDisruptorWorker-3\n1605100493249+A2Handler:31\n**************************\n```","slug":"java/disruptor/c16646bf-1474-42a7-a5cd-84b99669062c","published":1,"updated":"2021-03-01T02:03:08.433Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bm1008j2mg524nu1zv5","content":"<h2 id=\"并行模式-池化\"><a href=\"#并行模式-池化\" class=\"headerlink\" title=\"并行模式(池化)\"></a>并行模式(池化)</h2><p>每个消费端有两个线程实例</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A1Handler());</span><br><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A2Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111210802.jpg\" alt></p>\n<h3 id=\"结果示例\"><a href=\"#结果示例\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><p>可以看到每次执行的线程是不一样的</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-0</span><br><span class=\"line\">**************************</span><br><span class=\"line\">1605100167571+A1Handler:10</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-2</span><br><span class=\"line\">1605100167572+A2Handler:30</span><br><span class=\"line\">**************************</span><br><span class=\"line\">++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-1</span><br><span class=\"line\">1605100168572+A1Handler:11</span><br><span class=\"line\">**************************</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-3</span><br><span class=\"line\">1605100168573+A2Handler:31</span><br><span class=\"line\">**************************</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"串行模式（池化）\"><a href=\"#串行模式（池化）\" class=\"headerlink\" title=\"串行模式（池化）\"></a>串行模式（池化）</h2><p>每个消费端有两个线程实例</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A1Handler())</span><br><span class=\"line\">                .then(<span class=\"keyword\">new</span> A2Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111211136.jpg\" alt></p>\n<h3 id=\"结果示例-1\"><a href=\"#结果示例-1\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-0</span><br><span class=\"line\">1605100492248+A1Handler:10</span><br><span class=\"line\">**************************</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-2</span><br><span class=\"line\">1605100492249+A2Handler:30</span><br><span class=\"line\">**************************</span><br><span class=\"line\">++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-1</span><br><span class=\"line\">1605100493249+A1Handler:11</span><br><span class=\"line\">**************************</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-3</span><br><span class=\"line\">1605100493249+A2Handler:31</span><br><span class=\"line\">**************************</span><br></pre></td></tr></table></figure>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"并行模式-池化\"><a href=\"#并行模式-池化\" class=\"headerlink\" title=\"并行模式(池化)\"></a>并行模式(池化)</h2><p>每个消费端有两个线程实例</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A1Handler());</span><br><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A2Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111210802.jpg\" alt></p>\n<h3 id=\"结果示例\"><a href=\"#结果示例\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><p>可以看到每次执行的线程是不一样的</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-0</span><br><span class=\"line\">**************************</span><br><span class=\"line\">1605100167571+A1Handler:10</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-2</span><br><span class=\"line\">1605100167572+A2Handler:30</span><br><span class=\"line\">**************************</span><br><span class=\"line\">++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-1</span><br><span class=\"line\">1605100168572+A1Handler:11</span><br><span class=\"line\">**************************</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-3</span><br><span class=\"line\">1605100168573+A2Handler:31</span><br><span class=\"line\">**************************</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"串行模式（池化）\"><a href=\"#串行模式（池化）\" class=\"headerlink\" title=\"串行模式（池化）\"></a>串行模式（池化）</h2><p>每个消费端有两个线程实例</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A1Handler())</span><br><span class=\"line\">                .then(<span class=\"keyword\">new</span> A2Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20201111211136.jpg\" alt></p>\n<h3 id=\"结果示例-1\"><a href=\"#结果示例-1\" class=\"headerlink\" title=\"结果示例\"></a>结果示例</h3><figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-0</span><br><span class=\"line\">1605100492248+A1Handler:10</span><br><span class=\"line\">**************************</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-2</span><br><span class=\"line\">1605100492249+A2Handler:30</span><br><span class=\"line\">**************************</span><br><span class=\"line\">++++++++++++++++++++++++++++++++++++++++++++++++</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-1</span><br><span class=\"line\">1605100493249+A1Handler:11</span><br><span class=\"line\">**************************</span><br><span class=\"line\">**************************</span><br><span class=\"line\">DisruptorWorker-3</span><br><span class=\"line\">1605100493249+A2Handler:31</span><br><span class=\"line\">**************************</span><br></pre></td></tr></table></figure>"},{"title":"Disruptor-实例化方法","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-03-01T01:58:05.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 创建一个事件实体\n\n```java\npublic class LongEvent{\n    private Long id;\n    \n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n}\n```\n\n\n\n## 创建一个事件实体工厂\n\n```java\npublic class LongEventFactory implements EventFactory<LongEvent> {\n\n    public LongEvent newInstance() {\n        return new LongEvent();\n    }\n}\n```\n\n\n\n## 创建两个事件处理类\n\n```java\n\n/**\n* EventHandler<LongEvent> 是没有池化的实现方式,每个消费者中只有一个示例\n* WorkHandler<LongEvent> 是池化的实现方式，每个消费者中可以以类似线程池的方式去执行这个事件\n* 实际根据业务场景 实现其中一个接口就可以\n*/\npublic class A1Handler implements EventHandler<LongEvent> , WorkHandler<LongEvent> {\n\n    public void onEvent(LongEvent longEvent, long l, boolean b) throws Exception {\n        long id = longEvent.getId();\n        id+=1;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A1Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n\n    /**\n     * 池化执行\n     * */\n    @Override\n    public void onEvent(LongEvent longEvent) throws Exception {\n        long id = longEvent.getId();\n        id+=10;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A1Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n}\n```\n\n```java\npublic class A2Handler implements EventHandler<LongEvent> , WorkHandler<LongEvent> {\n    public void onEvent(LongEvent longEvent, long l, boolean b) throws Exception {\n        long id = longEvent.getId();\n        id+=3;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A2Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n\n    /**\n     * 池化执行\n     * */\n    @Override\n    public void onEvent(LongEvent longEvent) throws Exception {\n        long id = longEvent.getId();\n        id+=30;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A2Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n}\n```\n\n\n\n\n\n## 实例化Disruptor\n\n```java\n// 事件工厂\nLongEventFactory factory = new LongEventFactory();\n\n// 定义RingBuff大小  注意：数值一定是2的幂次方\nint bufferSize = 1024;\n\n// 创建ThreadFactory\nThreadFactory threadFactory = new ThreadFactory() {\n    private int counter = 0;\n    private String prefix = \"DisruptorWorker\";\n    @Override\n    public Thread newThread(Runnable r) {\n        return new Thread(r, prefix + \"-\" + counter++);\n    }\n};\n\n/* 实例化Disruptor （官方有4个实例化方法）\n * factory 是事件工厂\n * bufferSize 是上面定义的RingBuffer的大小\n * ProducerType.MULTI 是生产者模式 有SINGL和MULTI两种\n * new BlockingWaitStrategy() 是等待阻塞策略\n */\nDisruptor<LongEvent> disruptor = new Disruptor<LongEvent>(\n    factory, \n    bufferSize, \n    threadFactory,\n    ProducerType.MULTI,\n    new BlockingWaitStrategy());\n```\n\n\n\n## 创建消费者\n\n### 单个模式\n\ndisruptor会创建2和线程，一个线程用来执行`A1Handler`，一个线程用来执行`A2Handler`.每个线程互不影响。\n\n```java\ndisruptor.handleEventsWith(new A1Handler(),new A2Handler());\n```\n\n### 池化模式\n\ndisruptor会创建4个线程，其中两个线程组成**线程池**来执行`A1Handler`，另外两个线程也组成**线程池**用来执行`A2Handler`\n\n```java\ndisruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler())\ndisruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler())\n```\n\n## 获取RingBuffer\n\n```java\nRingBuffer<LongEvent> ringBuffer = disruptor.start();\n```\n\n## 生产者发布消息\n\n这边直接使用Java8的发布方式来发布消息\n\n```java\n// 创建ByteBuffer缓冲区 \nByteBuffer bb = ByteBuffer.allocate(8);\n// 生产者发布5条消息\nfor (long l = 0; l<5; l++) {\n    // 写入消息到Bufer缓冲区\n    bb.putLong(0, l);\n    // Java8 lambda发布方式\n    ringBuffer.publishEvent((event,sequece,buffer) -> event.setId(buffer.getLong(0)),bb);\n}\nSystem.out.println(\"发布完成\");\n```\n\n\n\n## 完整的Main方法\n\n```java\npublic class DisruptorMain {\n    public static void main(String[] args) {\n        // 实例化事件工厂\n        LongEventFactory factory = new LongEventFactory();\n        // 定义RingBuffer大小\n        int bufferSize = 1024;\n        // 创建线程工厂\n        ThreadFactory threadFactory = new ThreadFactory() {\n            private int counter = 0;\n            private String prefix = \"DisruptorWorker\";\n            @Override\n            public Thread newThread(Runnable r) {\n                return new Thread(r, prefix + \"-\" + counter++);\n            }\n        };\n        // 实例化Disruptor\n        Disruptor<LongEvent> disruptor = new Disruptor<LongEvent>(\n                factory,\n                bufferSize,\n                threadFactory,\n                ProducerType.MULTI,\n                new BlockingWaitStrategy());\n\n        // 并行模式 两个Handler互不影响\n        disruptor.handleEventsWith(new A1Handler(),new A2Handler());\n\n        // 并行 每个消费端有两个线程实例 (池化模式)\n//        disruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler());\n//        disruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler());\n\n        // 获取RingBuffer\n        RingBuffer<LongEvent> ringBuffer = disruptor.start();\n        \n        // 创建ByteBuffer缓冲区\n        ByteBuffer bb = ByteBuffer.allocate(8);\n        for (long l = 0; l<5; l++) {\n            // 写入数据到缓冲区\n            bb.putLong(0, l);\n            // Java8的发布方式\n            ringBuffer.publishEvent((event,sequece,buffer) -> event.setId(buffer.getLong(0)),bb);\n        }\n        System.out.println(\"发布完成\");\n    }\n}\n\n```","source":"_posts/java/disruptor/b3025291-ae52-4d26-a70c-66a79bda07d7.md","raw":"---\ntitle: Disruptor-实例化方法\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-03-01 09:58:05\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Disruptor\n- Java\ncategories:\n- Java\n---\n\n## 创建一个事件实体\n\n```java\npublic class LongEvent{\n    private Long id;\n    \n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n}\n```\n\n\n\n## 创建一个事件实体工厂\n\n```java\npublic class LongEventFactory implements EventFactory<LongEvent> {\n\n    public LongEvent newInstance() {\n        return new LongEvent();\n    }\n}\n```\n\n\n\n## 创建两个事件处理类\n\n```java\n\n/**\n* EventHandler<LongEvent> 是没有池化的实现方式,每个消费者中只有一个示例\n* WorkHandler<LongEvent> 是池化的实现方式，每个消费者中可以以类似线程池的方式去执行这个事件\n* 实际根据业务场景 实现其中一个接口就可以\n*/\npublic class A1Handler implements EventHandler<LongEvent> , WorkHandler<LongEvent> {\n\n    public void onEvent(LongEvent longEvent, long l, boolean b) throws Exception {\n        long id = longEvent.getId();\n        id+=1;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A1Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n\n    /**\n     * 池化执行\n     * */\n    @Override\n    public void onEvent(LongEvent longEvent) throws Exception {\n        long id = longEvent.getId();\n        id+=10;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A1Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n}\n```\n\n```java\npublic class A2Handler implements EventHandler<LongEvent> , WorkHandler<LongEvent> {\n    public void onEvent(LongEvent longEvent, long l, boolean b) throws Exception {\n        long id = longEvent.getId();\n        id+=3;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A2Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n\n    /**\n     * 池化执行\n     * */\n    @Override\n    public void onEvent(LongEvent longEvent) throws Exception {\n        long id = longEvent.getId();\n        id+=30;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A2Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n}\n```\n\n\n\n\n\n## 实例化Disruptor\n\n```java\n// 事件工厂\nLongEventFactory factory = new LongEventFactory();\n\n// 定义RingBuff大小  注意：数值一定是2的幂次方\nint bufferSize = 1024;\n\n// 创建ThreadFactory\nThreadFactory threadFactory = new ThreadFactory() {\n    private int counter = 0;\n    private String prefix = \"DisruptorWorker\";\n    @Override\n    public Thread newThread(Runnable r) {\n        return new Thread(r, prefix + \"-\" + counter++);\n    }\n};\n\n/* 实例化Disruptor （官方有4个实例化方法）\n * factory 是事件工厂\n * bufferSize 是上面定义的RingBuffer的大小\n * ProducerType.MULTI 是生产者模式 有SINGL和MULTI两种\n * new BlockingWaitStrategy() 是等待阻塞策略\n */\nDisruptor<LongEvent> disruptor = new Disruptor<LongEvent>(\n    factory, \n    bufferSize, \n    threadFactory,\n    ProducerType.MULTI,\n    new BlockingWaitStrategy());\n```\n\n\n\n## 创建消费者\n\n### 单个模式\n\ndisruptor会创建2和线程，一个线程用来执行`A1Handler`，一个线程用来执行`A2Handler`.每个线程互不影响。\n\n```java\ndisruptor.handleEventsWith(new A1Handler(),new A2Handler());\n```\n\n### 池化模式\n\ndisruptor会创建4个线程，其中两个线程组成**线程池**来执行`A1Handler`，另外两个线程也组成**线程池**用来执行`A2Handler`\n\n```java\ndisruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler())\ndisruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler())\n```\n\n## 获取RingBuffer\n\n```java\nRingBuffer<LongEvent> ringBuffer = disruptor.start();\n```\n\n## 生产者发布消息\n\n这边直接使用Java8的发布方式来发布消息\n\n```java\n// 创建ByteBuffer缓冲区 \nByteBuffer bb = ByteBuffer.allocate(8);\n// 生产者发布5条消息\nfor (long l = 0; l<5; l++) {\n    // 写入消息到Bufer缓冲区\n    bb.putLong(0, l);\n    // Java8 lambda发布方式\n    ringBuffer.publishEvent((event,sequece,buffer) -> event.setId(buffer.getLong(0)),bb);\n}\nSystem.out.println(\"发布完成\");\n```\n\n\n\n## 完整的Main方法\n\n```java\npublic class DisruptorMain {\n    public static void main(String[] args) {\n        // 实例化事件工厂\n        LongEventFactory factory = new LongEventFactory();\n        // 定义RingBuffer大小\n        int bufferSize = 1024;\n        // 创建线程工厂\n        ThreadFactory threadFactory = new ThreadFactory() {\n            private int counter = 0;\n            private String prefix = \"DisruptorWorker\";\n            @Override\n            public Thread newThread(Runnable r) {\n                return new Thread(r, prefix + \"-\" + counter++);\n            }\n        };\n        // 实例化Disruptor\n        Disruptor<LongEvent> disruptor = new Disruptor<LongEvent>(\n                factory,\n                bufferSize,\n                threadFactory,\n                ProducerType.MULTI,\n                new BlockingWaitStrategy());\n\n        // 并行模式 两个Handler互不影响\n        disruptor.handleEventsWith(new A1Handler(),new A2Handler());\n\n        // 并行 每个消费端有两个线程实例 (池化模式)\n//        disruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler());\n//        disruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler());\n\n        // 获取RingBuffer\n        RingBuffer<LongEvent> ringBuffer = disruptor.start();\n        \n        // 创建ByteBuffer缓冲区\n        ByteBuffer bb = ByteBuffer.allocate(8);\n        for (long l = 0; l<5; l++) {\n            // 写入数据到缓冲区\n            bb.putLong(0, l);\n            // Java8的发布方式\n            ringBuffer.publishEvent((event,sequece,buffer) -> event.setId(buffer.getLong(0)),bb);\n        }\n        System.out.println(\"发布完成\");\n    }\n}\n\n```","slug":"java/disruptor/b3025291-ae52-4d26-a70c-66a79bda07d7","published":1,"updated":"2021-03-01T02:00:06.429Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bm2008n2mg5xz47npc8","content":"<h2 id=\"创建一个事件实体\"><a href=\"#创建一个事件实体\" class=\"headerlink\" title=\"创建一个事件实体\"></a>创建一个事件实体</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEvent</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Long <span class=\"title\">getId</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setId</span><span class=\"params\">(Long id)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建一个事件实体工厂\"><a href=\"#创建一个事件实体工厂\" class=\"headerlink\" title=\"创建一个事件实体工厂\"></a>创建一个事件实体工厂</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEventFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventFactory</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> LongEvent <span class=\"title\">newInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> LongEvent();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建两个事件处理类\"><a href=\"#创建两个事件处理类\" class=\"headerlink\" title=\"创建两个事件处理类\"></a>创建两个事件处理类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* EventHandler&lt;LongEvent&gt; 是没有池化的实现方式,每个消费者中只有一个示例</span></span><br><span class=\"line\"><span class=\"comment\">* WorkHandler&lt;LongEvent&gt; 是池化的实现方式，每个消费者中可以以类似线程池的方式去执行这个事件</span></span><br><span class=\"line\"><span class=\"comment\">* 实际根据业务场景 实现其中一个接口就可以</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A1Handler</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; , <span class=\"title\">WorkHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent, <span class=\"keyword\">long</span> l, <span class=\"keyword\">boolean</span> b)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">1</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A1Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 池化执行</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">10</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A1Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A2Handler</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; , <span class=\"title\">WorkHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent, <span class=\"keyword\">long</span> l, <span class=\"keyword\">boolean</span> b)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">3</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A2Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 池化执行</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">30</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A2Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"实例化Disruptor\"><a href=\"#实例化Disruptor\" class=\"headerlink\" title=\"实例化Disruptor\"></a>实例化Disruptor</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 事件工厂</span></span><br><span class=\"line\">LongEventFactory factory = <span class=\"keyword\">new</span> LongEventFactory();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义RingBuff大小  注意：数值一定是2的幂次方</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> bufferSize = <span class=\"number\">1024</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建ThreadFactory</span></span><br><span class=\"line\">ThreadFactory threadFactory = <span class=\"keyword\">new</span> ThreadFactory() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String prefix = <span class=\"string\">\"DisruptorWorker\"</span>;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Thread <span class=\"title\">newThread</span><span class=\"params\">(Runnable r)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Thread(r, prefix + <span class=\"string\">\"-\"</span> + counter++);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 实例化Disruptor （官方有4个实例化方法）</span></span><br><span class=\"line\"><span class=\"comment\"> * factory 是事件工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * bufferSize 是上面定义的RingBuffer的大小</span></span><br><span class=\"line\"><span class=\"comment\"> * ProducerType.MULTI 是生产者模式 有SINGL和MULTI两种</span></span><br><span class=\"line\"><span class=\"comment\"> * new BlockingWaitStrategy() 是等待阻塞策略</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">Disruptor&lt;LongEvent&gt; disruptor = <span class=\"keyword\">new</span> Disruptor&lt;LongEvent&gt;(</span><br><span class=\"line\">    factory, </span><br><span class=\"line\">    bufferSize, </span><br><span class=\"line\">    threadFactory,</span><br><span class=\"line\">    ProducerType.MULTI,</span><br><span class=\"line\">    <span class=\"keyword\">new</span> BlockingWaitStrategy());</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建消费者\"><a href=\"#创建消费者\" class=\"headerlink\" title=\"创建消费者\"></a>创建消费者</h2><h3 id=\"单个模式\"><a href=\"#单个模式\" class=\"headerlink\" title=\"单个模式\"></a>单个模式</h3><p>disruptor会创建2和线程，一个线程用来执行<code>A1Handler</code>，一个线程用来执行<code>A2Handler</code>.每个线程互不影响。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"池化模式\"><a href=\"#池化模式\" class=\"headerlink\" title=\"池化模式\"></a>池化模式</h3><p>disruptor会创建4个线程，其中两个线程组成<strong>线程池</strong>来执行<code>A1Handler</code>，另外两个线程也组成<strong>线程池</strong>用来执行<code>A2Handler</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A1Handler())</span><br><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A2Handler(),<span class=\"keyword\">new</span> A2Handler())</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"获取RingBuffer\"><a href=\"#获取RingBuffer\" class=\"headerlink\" title=\"获取RingBuffer\"></a>获取RingBuffer</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"生产者发布消息\"><a href=\"#生产者发布消息\" class=\"headerlink\" title=\"生产者发布消息\"></a>生产者发布消息</h2><p>这边直接使用Java8的发布方式来发布消息</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 创建ByteBuffer缓冲区 </span></span><br><span class=\"line\">ByteBuffer bb = ByteBuffer.allocate(<span class=\"number\">8</span>);</span><br><span class=\"line\"><span class=\"comment\">// 生产者发布5条消息</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">long</span> l = <span class=\"number\">0</span>; l&lt;<span class=\"number\">5</span>; l++) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 写入消息到Bufer缓冲区</span></span><br><span class=\"line\">    bb.putLong(<span class=\"number\">0</span>, l);</span><br><span class=\"line\">    <span class=\"comment\">// Java8 lambda发布方式</span></span><br><span class=\"line\">    ringBuffer.publishEvent((event,sequece,buffer) -&gt; event.setId(buffer.getLong(<span class=\"number\">0</span>)),bb);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(<span class=\"string\">\"发布完成\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"完整的Main方法\"><a href=\"#完整的Main方法\" class=\"headerlink\" title=\"完整的Main方法\"></a>完整的Main方法</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DisruptorMain</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 实例化事件工厂</span></span><br><span class=\"line\">        LongEventFactory factory = <span class=\"keyword\">new</span> LongEventFactory();</span><br><span class=\"line\">        <span class=\"comment\">// 定义RingBuffer大小</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> bufferSize = <span class=\"number\">1024</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 创建线程工厂</span></span><br><span class=\"line\">        ThreadFactory threadFactory = <span class=\"keyword\">new</span> ThreadFactory() &#123;</span><br><span class=\"line\">            <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">private</span> String prefix = <span class=\"string\">\"DisruptorWorker\"</span>;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Thread <span class=\"title\">newThread</span><span class=\"params\">(Runnable r)</span> </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Thread(r, prefix + <span class=\"string\">\"-\"</span> + counter++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">// 实例化Disruptor</span></span><br><span class=\"line\">        Disruptor&lt;LongEvent&gt; disruptor = <span class=\"keyword\">new</span> Disruptor&lt;LongEvent&gt;(</span><br><span class=\"line\">                factory,</span><br><span class=\"line\">                bufferSize,</span><br><span class=\"line\">                threadFactory,</span><br><span class=\"line\">                ProducerType.MULTI,</span><br><span class=\"line\">                <span class=\"keyword\">new</span> BlockingWaitStrategy());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 并行模式 两个Handler互不影响</span></span><br><span class=\"line\">        disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 并行 每个消费端有两个线程实例 (池化模式)</span></span><br><span class=\"line\"><span class=\"comment\">//        disruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler());</span></span><br><span class=\"line\"><span class=\"comment\">//        disruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler());</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取RingBuffer</span></span><br><span class=\"line\">        RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 创建ByteBuffer缓冲区</span></span><br><span class=\"line\">        ByteBuffer bb = ByteBuffer.allocate(<span class=\"number\">8</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">long</span> l = <span class=\"number\">0</span>; l&lt;<span class=\"number\">5</span>; l++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 写入数据到缓冲区</span></span><br><span class=\"line\">            bb.putLong(<span class=\"number\">0</span>, l);</span><br><span class=\"line\">            <span class=\"comment\">// Java8的发布方式</span></span><br><span class=\"line\">            ringBuffer.publishEvent((event,sequece,buffer) -&gt; event.setId(buffer.getLong(<span class=\"number\">0</span>)),bb);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"发布完成\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"创建一个事件实体\"><a href=\"#创建一个事件实体\" class=\"headerlink\" title=\"创建一个事件实体\"></a>创建一个事件实体</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEvent</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Long <span class=\"title\">getId</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setId</span><span class=\"params\">(Long id)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建一个事件实体工厂\"><a href=\"#创建一个事件实体工厂\" class=\"headerlink\" title=\"创建一个事件实体工厂\"></a>创建一个事件实体工厂</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEventFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventFactory</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> LongEvent <span class=\"title\">newInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> LongEvent();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建两个事件处理类\"><a href=\"#创建两个事件处理类\" class=\"headerlink\" title=\"创建两个事件处理类\"></a>创建两个事件处理类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* EventHandler&lt;LongEvent&gt; 是没有池化的实现方式,每个消费者中只有一个示例</span></span><br><span class=\"line\"><span class=\"comment\">* WorkHandler&lt;LongEvent&gt; 是池化的实现方式，每个消费者中可以以类似线程池的方式去执行这个事件</span></span><br><span class=\"line\"><span class=\"comment\">* 实际根据业务场景 实现其中一个接口就可以</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A1Handler</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; , <span class=\"title\">WorkHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent, <span class=\"keyword\">long</span> l, <span class=\"keyword\">boolean</span> b)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">1</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A1Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 池化执行</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">10</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A1Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A2Handler</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; , <span class=\"title\">WorkHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent, <span class=\"keyword\">long</span> l, <span class=\"keyword\">boolean</span> b)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">3</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A2Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 池化执行</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">30</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A2Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"实例化Disruptor\"><a href=\"#实例化Disruptor\" class=\"headerlink\" title=\"实例化Disruptor\"></a>实例化Disruptor</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 事件工厂</span></span><br><span class=\"line\">LongEventFactory factory = <span class=\"keyword\">new</span> LongEventFactory();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义RingBuff大小  注意：数值一定是2的幂次方</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> bufferSize = <span class=\"number\">1024</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建ThreadFactory</span></span><br><span class=\"line\">ThreadFactory threadFactory = <span class=\"keyword\">new</span> ThreadFactory() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String prefix = <span class=\"string\">\"DisruptorWorker\"</span>;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Thread <span class=\"title\">newThread</span><span class=\"params\">(Runnable r)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Thread(r, prefix + <span class=\"string\">\"-\"</span> + counter++);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 实例化Disruptor （官方有4个实例化方法）</span></span><br><span class=\"line\"><span class=\"comment\"> * factory 是事件工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * bufferSize 是上面定义的RingBuffer的大小</span></span><br><span class=\"line\"><span class=\"comment\"> * ProducerType.MULTI 是生产者模式 有SINGL和MULTI两种</span></span><br><span class=\"line\"><span class=\"comment\"> * new BlockingWaitStrategy() 是等待阻塞策略</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">Disruptor&lt;LongEvent&gt; disruptor = <span class=\"keyword\">new</span> Disruptor&lt;LongEvent&gt;(</span><br><span class=\"line\">    factory, </span><br><span class=\"line\">    bufferSize, </span><br><span class=\"line\">    threadFactory,</span><br><span class=\"line\">    ProducerType.MULTI,</span><br><span class=\"line\">    <span class=\"keyword\">new</span> BlockingWaitStrategy());</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建消费者\"><a href=\"#创建消费者\" class=\"headerlink\" title=\"创建消费者\"></a>创建消费者</h2><h3 id=\"单个模式\"><a href=\"#单个模式\" class=\"headerlink\" title=\"单个模式\"></a>单个模式</h3><p>disruptor会创建2和线程，一个线程用来执行<code>A1Handler</code>，一个线程用来执行<code>A2Handler</code>.每个线程互不影响。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"池化模式\"><a href=\"#池化模式\" class=\"headerlink\" title=\"池化模式\"></a>池化模式</h3><p>disruptor会创建4个线程，其中两个线程组成<strong>线程池</strong>来执行<code>A1Handler</code>，另外两个线程也组成<strong>线程池</strong>用来执行<code>A2Handler</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A1Handler())</span><br><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A2Handler(),<span class=\"keyword\">new</span> A2Handler())</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"获取RingBuffer\"><a href=\"#获取RingBuffer\" class=\"headerlink\" title=\"获取RingBuffer\"></a>获取RingBuffer</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"生产者发布消息\"><a href=\"#生产者发布消息\" class=\"headerlink\" title=\"生产者发布消息\"></a>生产者发布消息</h2><p>这边直接使用Java8的发布方式来发布消息</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 创建ByteBuffer缓冲区 </span></span><br><span class=\"line\">ByteBuffer bb = ByteBuffer.allocate(<span class=\"number\">8</span>);</span><br><span class=\"line\"><span class=\"comment\">// 生产者发布5条消息</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">long</span> l = <span class=\"number\">0</span>; l&lt;<span class=\"number\">5</span>; l++) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 写入消息到Bufer缓冲区</span></span><br><span class=\"line\">    bb.putLong(<span class=\"number\">0</span>, l);</span><br><span class=\"line\">    <span class=\"comment\">// Java8 lambda发布方式</span></span><br><span class=\"line\">    ringBuffer.publishEvent((event,sequece,buffer) -&gt; event.setId(buffer.getLong(<span class=\"number\">0</span>)),bb);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(<span class=\"string\">\"发布完成\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"完整的Main方法\"><a href=\"#完整的Main方法\" class=\"headerlink\" title=\"完整的Main方法\"></a>完整的Main方法</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DisruptorMain</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 实例化事件工厂</span></span><br><span class=\"line\">        LongEventFactory factory = <span class=\"keyword\">new</span> LongEventFactory();</span><br><span class=\"line\">        <span class=\"comment\">// 定义RingBuffer大小</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> bufferSize = <span class=\"number\">1024</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 创建线程工厂</span></span><br><span class=\"line\">        ThreadFactory threadFactory = <span class=\"keyword\">new</span> ThreadFactory() &#123;</span><br><span class=\"line\">            <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">private</span> String prefix = <span class=\"string\">\"DisruptorWorker\"</span>;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Thread <span class=\"title\">newThread</span><span class=\"params\">(Runnable r)</span> </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Thread(r, prefix + <span class=\"string\">\"-\"</span> + counter++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">// 实例化Disruptor</span></span><br><span class=\"line\">        Disruptor&lt;LongEvent&gt; disruptor = <span class=\"keyword\">new</span> Disruptor&lt;LongEvent&gt;(</span><br><span class=\"line\">                factory,</span><br><span class=\"line\">                bufferSize,</span><br><span class=\"line\">                threadFactory,</span><br><span class=\"line\">                ProducerType.MULTI,</span><br><span class=\"line\">                <span class=\"keyword\">new</span> BlockingWaitStrategy());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 并行模式 两个Handler互不影响</span></span><br><span class=\"line\">        disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 并行 每个消费端有两个线程实例 (池化模式)</span></span><br><span class=\"line\"><span class=\"comment\">//        disruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler());</span></span><br><span class=\"line\"><span class=\"comment\">//        disruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler());</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取RingBuffer</span></span><br><span class=\"line\">        RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 创建ByteBuffer缓冲区</span></span><br><span class=\"line\">        ByteBuffer bb = ByteBuffer.allocate(<span class=\"number\">8</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">long</span> l = <span class=\"number\">0</span>; l&lt;<span class=\"number\">5</span>; l++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 写入数据到缓冲区</span></span><br><span class=\"line\">            bb.putLong(<span class=\"number\">0</span>, l);</span><br><span class=\"line\">            <span class=\"comment\">// Java8的发布方式</span></span><br><span class=\"line\">            ringBuffer.publishEvent((event,sequece,buffer) -&gt; event.setId(buffer.getLong(<span class=\"number\">0</span>)),bb);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"发布完成\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"Disruptor-等待策略","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-03-01T02:02:06.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## BlockingWaitStrategy\n\nDisruptor默认策略\n\n对`EventProcessor`使用等待条件的锁和条件变量的阻塞策略。\n\n**当吞吐量和低延迟不如CPU资源那么重要时，可以使用此策略。**\n\n## LiteBlockingWaitStrategy\n\n**BlockingWaitStrategy的变体**，在无竞争的情况下尝试消除条件唤醒。 显示微基准测试的性能改进。\n\n 但是，由于我尚未完全证明锁省略码的正确性，因此应将这种等待策略视为实验性的。\n\n## BusySpinWaitStrategy\n\n繁忙旋转策略，该繁忙旋转策略对`EventProcessor`的障碍使用繁忙的旋转循环。\n\n**此策略将使用CPU资源来避免可能导致延迟抖动的系统调用。 最好当线程可以绑定到特定的CPU内核时使用。**\n\n## TimeoutBlockingWaitStrategy\n\n\n\n## LiteTimeoutBlockingWaitStrategy\n\n**TimeoutBlockingWaitStrategy的变体**，在无竞争的情况下尝试消除条件唤醒。\n\n## PhasedBackoffWaitStrategy\n\n在屏障上等待EventProcessor的分阶段等待策略。\n\n当吞吐量和低延迟不如CPU资源那么重要时，可以使用此策略。\n旋转，然后屈服，然后使用配置的后备WaitStrategy等待。\n\n## SleepingWaitStrategy\n\n最初启动的休眠策略，然后使用Thread.yield（），最后在EventProcessor等待屏障时，休眠操作系统和JVM将允许的最小数量的nanos。\n\n此策略是性能和CPU资源之间的良好折衷。\n安静时段后可能会出现延迟峰值。 这也将减少对生产线程的影响，因为它不需要发出信号通知任何条件变量来唤醒事件处理线程。\n\n## YieldingWaitStrategy\n\n在初始旋转后，使用Thread.yield（）的EventProcessor在屏障上等待。\n\n如果其他线程需要CPU资源，则此策略将使用100％CPU，但比忙碌的自旋策略更容易放弃CPU。","source":"_posts/java/disruptor/ff51336d-70d4-449c-9214-fff2542bef1f.md","raw":"---\ntitle: Disruptor-等待策略\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-03-01 10:02:06\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Disruptor\n- Java\ncategories:\n- Java\n---\n\n## BlockingWaitStrategy\n\nDisruptor默认策略\n\n对`EventProcessor`使用等待条件的锁和条件变量的阻塞策略。\n\n**当吞吐量和低延迟不如CPU资源那么重要时，可以使用此策略。**\n\n## LiteBlockingWaitStrategy\n\n**BlockingWaitStrategy的变体**，在无竞争的情况下尝试消除条件唤醒。 显示微基准测试的性能改进。\n\n 但是，由于我尚未完全证明锁省略码的正确性，因此应将这种等待策略视为实验性的。\n\n## BusySpinWaitStrategy\n\n繁忙旋转策略，该繁忙旋转策略对`EventProcessor`的障碍使用繁忙的旋转循环。\n\n**此策略将使用CPU资源来避免可能导致延迟抖动的系统调用。 最好当线程可以绑定到特定的CPU内核时使用。**\n\n## TimeoutBlockingWaitStrategy\n\n\n\n## LiteTimeoutBlockingWaitStrategy\n\n**TimeoutBlockingWaitStrategy的变体**，在无竞争的情况下尝试消除条件唤醒。\n\n## PhasedBackoffWaitStrategy\n\n在屏障上等待EventProcessor的分阶段等待策略。\n\n当吞吐量和低延迟不如CPU资源那么重要时，可以使用此策略。\n旋转，然后屈服，然后使用配置的后备WaitStrategy等待。\n\n## SleepingWaitStrategy\n\n最初启动的休眠策略，然后使用Thread.yield（），最后在EventProcessor等待屏障时，休眠操作系统和JVM将允许的最小数量的nanos。\n\n此策略是性能和CPU资源之间的良好折衷。\n安静时段后可能会出现延迟峰值。 这也将减少对生产线程的影响，因为它不需要发出信号通知任何条件变量来唤醒事件处理线程。\n\n## YieldingWaitStrategy\n\n在初始旋转后，使用Thread.yield（）的EventProcessor在屏障上等待。\n\n如果其他线程需要CPU资源，则此策略将使用100％CPU，但比忙碌的自旋策略更容易放弃CPU。","slug":"java/disruptor/ff51336d-70d4-449c-9214-fff2542bef1f","published":1,"updated":"2021-03-01T02:03:48.723Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bm3008q2mg5nark2swm","content":"<h2 id=\"BlockingWaitStrategy\"><a href=\"#BlockingWaitStrategy\" class=\"headerlink\" title=\"BlockingWaitStrategy\"></a>BlockingWaitStrategy</h2><p>Disruptor默认策略</p>\n<p>对<code>EventProcessor</code>使用等待条件的锁和条件变量的阻塞策略。</p>\n<p><strong>当吞吐量和低延迟不如CPU资源那么重要时，可以使用此策略。</strong></p>\n<h2 id=\"LiteBlockingWaitStrategy\"><a href=\"#LiteBlockingWaitStrategy\" class=\"headerlink\" title=\"LiteBlockingWaitStrategy\"></a>LiteBlockingWaitStrategy</h2><p><strong>BlockingWaitStrategy的变体</strong>，在无竞争的情况下尝试消除条件唤醒。 显示微基准测试的性能改进。</p>\n<p> 但是，由于我尚未完全证明锁省略码的正确性，因此应将这种等待策略视为实验性的。</p>\n<h2 id=\"BusySpinWaitStrategy\"><a href=\"#BusySpinWaitStrategy\" class=\"headerlink\" title=\"BusySpinWaitStrategy\"></a>BusySpinWaitStrategy</h2><p>繁忙旋转策略，该繁忙旋转策略对<code>EventProcessor</code>的障碍使用繁忙的旋转循环。</p>\n<p><strong>此策略将使用CPU资源来避免可能导致延迟抖动的系统调用。 最好当线程可以绑定到特定的CPU内核时使用。</strong></p>\n<h2 id=\"TimeoutBlockingWaitStrategy\"><a href=\"#TimeoutBlockingWaitStrategy\" class=\"headerlink\" title=\"TimeoutBlockingWaitStrategy\"></a>TimeoutBlockingWaitStrategy</h2><h2 id=\"LiteTimeoutBlockingWaitStrategy\"><a href=\"#LiteTimeoutBlockingWaitStrategy\" class=\"headerlink\" title=\"LiteTimeoutBlockingWaitStrategy\"></a>LiteTimeoutBlockingWaitStrategy</h2><p><strong>TimeoutBlockingWaitStrategy的变体</strong>，在无竞争的情况下尝试消除条件唤醒。</p>\n<h2 id=\"PhasedBackoffWaitStrategy\"><a href=\"#PhasedBackoffWaitStrategy\" class=\"headerlink\" title=\"PhasedBackoffWaitStrategy\"></a>PhasedBackoffWaitStrategy</h2><p>在屏障上等待EventProcessor的分阶段等待策略。</p>\n<p>当吞吐量和低延迟不如CPU资源那么重要时，可以使用此策略。<br>旋转，然后屈服，然后使用配置的后备WaitStrategy等待。</p>\n<h2 id=\"SleepingWaitStrategy\"><a href=\"#SleepingWaitStrategy\" class=\"headerlink\" title=\"SleepingWaitStrategy\"></a>SleepingWaitStrategy</h2><p>最初启动的休眠策略，然后使用Thread.yield（），最后在EventProcessor等待屏障时，休眠操作系统和JVM将允许的最小数量的nanos。</p>\n<p>此策略是性能和CPU资源之间的良好折衷。<br>安静时段后可能会出现延迟峰值。 这也将减少对生产线程的影响，因为它不需要发出信号通知任何条件变量来唤醒事件处理线程。</p>\n<h2 id=\"YieldingWaitStrategy\"><a href=\"#YieldingWaitStrategy\" class=\"headerlink\" title=\"YieldingWaitStrategy\"></a>YieldingWaitStrategy</h2><p>在初始旋转后，使用Thread.yield（）的EventProcessor在屏障上等待。</p>\n<p>如果其他线程需要CPU资源，则此策略将使用100％CPU，但比忙碌的自旋策略更容易放弃CPU。</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"BlockingWaitStrategy\"><a href=\"#BlockingWaitStrategy\" class=\"headerlink\" title=\"BlockingWaitStrategy\"></a>BlockingWaitStrategy</h2><p>Disruptor默认策略</p>\n<p>对<code>EventProcessor</code>使用等待条件的锁和条件变量的阻塞策略。</p>\n<p><strong>当吞吐量和低延迟不如CPU资源那么重要时，可以使用此策略。</strong></p>\n<h2 id=\"LiteBlockingWaitStrategy\"><a href=\"#LiteBlockingWaitStrategy\" class=\"headerlink\" title=\"LiteBlockingWaitStrategy\"></a>LiteBlockingWaitStrategy</h2><p><strong>BlockingWaitStrategy的变体</strong>，在无竞争的情况下尝试消除条件唤醒。 显示微基准测试的性能改进。</p>\n<p> 但是，由于我尚未完全证明锁省略码的正确性，因此应将这种等待策略视为实验性的。</p>\n<h2 id=\"BusySpinWaitStrategy\"><a href=\"#BusySpinWaitStrategy\" class=\"headerlink\" title=\"BusySpinWaitStrategy\"></a>BusySpinWaitStrategy</h2><p>繁忙旋转策略，该繁忙旋转策略对<code>EventProcessor</code>的障碍使用繁忙的旋转循环。</p>\n<p><strong>此策略将使用CPU资源来避免可能导致延迟抖动的系统调用。 最好当线程可以绑定到特定的CPU内核时使用。</strong></p>\n<h2 id=\"TimeoutBlockingWaitStrategy\"><a href=\"#TimeoutBlockingWaitStrategy\" class=\"headerlink\" title=\"TimeoutBlockingWaitStrategy\"></a>TimeoutBlockingWaitStrategy</h2><h2 id=\"LiteTimeoutBlockingWaitStrategy\"><a href=\"#LiteTimeoutBlockingWaitStrategy\" class=\"headerlink\" title=\"LiteTimeoutBlockingWaitStrategy\"></a>LiteTimeoutBlockingWaitStrategy</h2><p><strong>TimeoutBlockingWaitStrategy的变体</strong>，在无竞争的情况下尝试消除条件唤醒。</p>\n<h2 id=\"PhasedBackoffWaitStrategy\"><a href=\"#PhasedBackoffWaitStrategy\" class=\"headerlink\" title=\"PhasedBackoffWaitStrategy\"></a>PhasedBackoffWaitStrategy</h2><p>在屏障上等待EventProcessor的分阶段等待策略。</p>\n<p>当吞吐量和低延迟不如CPU资源那么重要时，可以使用此策略。<br>旋转，然后屈服，然后使用配置的后备WaitStrategy等待。</p>\n<h2 id=\"SleepingWaitStrategy\"><a href=\"#SleepingWaitStrategy\" class=\"headerlink\" title=\"SleepingWaitStrategy\"></a>SleepingWaitStrategy</h2><p>最初启动的休眠策略，然后使用Thread.yield（），最后在EventProcessor等待屏障时，休眠操作系统和JVM将允许的最小数量的nanos。</p>\n<p>此策略是性能和CPU资源之间的良好折衷。<br>安静时段后可能会出现延迟峰值。 这也将减少对生产线程的影响，因为它不需要发出信号通知任何条件变量来唤醒事件处理线程。</p>\n<h2 id=\"YieldingWaitStrategy\"><a href=\"#YieldingWaitStrategy\" class=\"headerlink\" title=\"YieldingWaitStrategy\"></a>YieldingWaitStrategy</h2><p>在初始旋转后，使用Thread.yield（）的EventProcessor在屏障上等待。</p>\n<p>如果其他线程需要CPU资源，则此策略将使用100％CPU，但比忙碌的自旋策略更容易放弃CPU。</p>\n"},{"title":"Disruptor-快速开始","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-03-01T01:58:03.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 创建一个事件实体\n\n```java\npublic class LongEvent{\n    private Long id;\n    \n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n}\n```\n\n\n\n## 创建一个事件实体工厂\n\n```java\npublic class LongEventFactory implements EventFactory<LongEvent> {\n\n    public LongEvent newInstance() {\n        return new LongEvent();\n    }\n}\n```\n\n\n\n## 创建两个事件处理类\n\n```java\n\n/**\n* EventHandler<LongEvent> 是没有池化的实现方式,每个消费者中只有一个示例\n* WorkHandler<LongEvent> 是池化的实现方式，每个消费者中可以以类似线程池的方式去执行这个事件\n* 实际根据业务场景 实现其中一个接口就可以\n*/\npublic class A1Handler implements EventHandler<LongEvent> , WorkHandler<LongEvent> {\n\n    public void onEvent(LongEvent longEvent, long l, boolean b) throws Exception {\n        long id = longEvent.getId();\n        id+=1;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A1Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n\n    /**\n     * 池化执行\n     * */\n    @Override\n    public void onEvent(LongEvent longEvent) throws Exception {\n        long id = longEvent.getId();\n        id+=10;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A1Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n}\n```\n\n```java\npublic class A2Handler implements EventHandler<LongEvent> , WorkHandler<LongEvent> {\n    public void onEvent(LongEvent longEvent, long l, boolean b) throws Exception {\n        long id = longEvent.getId();\n        id+=3;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A2Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n\n    /**\n     * 池化执行\n     * */\n    @Override\n    public void onEvent(LongEvent longEvent) throws Exception {\n        long id = longEvent.getId();\n        id+=30;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A2Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n}\n```\n\n\n\n\n\n## 实例化Disruptor\n\n```java\n// 事件工厂\nLongEventFactory factory = new LongEventFactory();\n\n// 定义RingBuff大小  注意：数值一定是2的幂次方\nint bufferSize = 1024;\n\n// 创建ThreadFactory\nThreadFactory threadFactory = new ThreadFactory() {\n    private int counter = 0;\n    private String prefix = \"DisruptorWorker\";\n    @Override\n    public Thread newThread(Runnable r) {\n        return new Thread(r, prefix + \"-\" + counter++);\n    }\n};\n\n/* 实例化Disruptor （官方有4个实例化方法）\n * factory 是事件工厂\n * bufferSize 是上面定义的RingBuffer的大小\n * ProducerType.MULTI 是生产者模式 有SINGL和MULTI两种\n * new BlockingWaitStrategy() 是等待阻塞策略\n */\nDisruptor<LongEvent> disruptor = new Disruptor<LongEvent>(\n    factory, \n    bufferSize, \n    threadFactory,\n    ProducerType.MULTI,\n    new BlockingWaitStrategy());\n```\n\n\n\n## 创建消费者\n\n### 单个模式\n\ndisruptor会创建2和线程，一个线程用来执行`A1Handler`，一个线程用来执行`A2Handler`.每个线程互不影响。\n\n```java\ndisruptor.handleEventsWith(new A1Handler(),new A2Handler());\n```\n\n### 池化模式\n\ndisruptor会创建4个线程，其中两个线程组成**线程池**来执行`A1Handler`，另外两个线程也组成**线程池**用来执行`A2Handler`\n\n```java\ndisruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler())\ndisruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler())\n```\n\n## 获取RingBuffer\n\n```java\nRingBuffer<LongEvent> ringBuffer = disruptor.start();\n```\n\n## 生产者发布消息\n\n这边直接使用Java8的发布方式来发布消息\n\n```java\n// 创建ByteBuffer缓冲区 \nByteBuffer bb = ByteBuffer.allocate(8);\n// 生产者发布5条消息\nfor (long l = 0; l<5; l++) {\n    // 写入消息到Bufer缓冲区\n    bb.putLong(0, l);\n    // Java8 lambda发布方式\n    ringBuffer.publishEvent((event,sequece,buffer) -> event.setId(buffer.getLong(0)),bb);\n}\nSystem.out.println(\"发布完成\");\n```\n\n\n\n## 完整的Main方法\n\n```java\npublic class DisruptorMain {\n    public static void main(String[] args) {\n        // 实例化事件工厂\n        LongEventFactory factory = new LongEventFactory();\n        // 定义RingBuffer大小\n        int bufferSize = 1024;\n        // 创建线程工厂\n        ThreadFactory threadFactory = new ThreadFactory() {\n            private int counter = 0;\n            private String prefix = \"DisruptorWorker\";\n            @Override\n            public Thread newThread(Runnable r) {\n                return new Thread(r, prefix + \"-\" + counter++);\n            }\n        };\n        // 实例化Disruptor\n        Disruptor<LongEvent> disruptor = new Disruptor<LongEvent>(\n                factory,\n                bufferSize,\n                threadFactory,\n                ProducerType.MULTI,\n                new BlockingWaitStrategy());\n\n        // 并行模式 两个Handler互不影响\n        disruptor.handleEventsWith(new A1Handler(),new A2Handler());\n\n        // 并行 每个消费端有两个线程实例 (池化模式)\n//        disruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler());\n//        disruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler());\n\n        // 获取RingBuffer\n        RingBuffer<LongEvent> ringBuffer = disruptor.start();\n        \n        // 创建ByteBuffer缓冲区\n        ByteBuffer bb = ByteBuffer.allocate(8);\n        for (long l = 0; l<5; l++) {\n            // 写入数据到缓冲区\n            bb.putLong(0, l);\n            // Java8的发布方式\n            ringBuffer.publishEvent((event,sequece,buffer) -> event.setId(buffer.getLong(0)),bb);\n        }\n        System.out.println(\"发布完成\");\n    }\n}\n\n```","source":"_posts/java/disruptor/a552f7f0-4cbe-4628-8fcf-02f8b8730b56.md","raw":"---\ntitle: Disruptor-快速开始\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-03-01 09:58:03\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Disruptor\n- Java\ncategories:\n- Java\n---\n\n## 创建一个事件实体\n\n```java\npublic class LongEvent{\n    private Long id;\n    \n    public Long getId() {\n        return id;\n    }\n\n    public void setId(Long id) {\n        this.id = id;\n    }\n}\n```\n\n\n\n## 创建一个事件实体工厂\n\n```java\npublic class LongEventFactory implements EventFactory<LongEvent> {\n\n    public LongEvent newInstance() {\n        return new LongEvent();\n    }\n}\n```\n\n\n\n## 创建两个事件处理类\n\n```java\n\n/**\n* EventHandler<LongEvent> 是没有池化的实现方式,每个消费者中只有一个示例\n* WorkHandler<LongEvent> 是池化的实现方式，每个消费者中可以以类似线程池的方式去执行这个事件\n* 实际根据业务场景 实现其中一个接口就可以\n*/\npublic class A1Handler implements EventHandler<LongEvent> , WorkHandler<LongEvent> {\n\n    public void onEvent(LongEvent longEvent, long l, boolean b) throws Exception {\n        long id = longEvent.getId();\n        id+=1;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A1Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n\n    /**\n     * 池化执行\n     * */\n    @Override\n    public void onEvent(LongEvent longEvent) throws Exception {\n        long id = longEvent.getId();\n        id+=10;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A1Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n}\n```\n\n```java\npublic class A2Handler implements EventHandler<LongEvent> , WorkHandler<LongEvent> {\n    public void onEvent(LongEvent longEvent, long l, boolean b) throws Exception {\n        long id = longEvent.getId();\n        id+=3;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A2Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n\n    /**\n     * 池化执行\n     * */\n    @Override\n    public void onEvent(LongEvent longEvent) throws Exception {\n        long id = longEvent.getId();\n        id+=30;\n        System.out.println(\"**************************\");\n        System.out.println(Thread.currentThread().getName());\n        System.out.println(System.currentTimeMillis()+\"+A2Handler:\"+id);\n        System.out.println(\"**************************\");\n    }\n}\n```\n\n\n\n\n\n## 实例化Disruptor\n\n```java\n// 事件工厂\nLongEventFactory factory = new LongEventFactory();\n\n// 定义RingBuff大小  注意：数值一定是2的幂次方\nint bufferSize = 1024;\n\n// 创建ThreadFactory\nThreadFactory threadFactory = new ThreadFactory() {\n    private int counter = 0;\n    private String prefix = \"DisruptorWorker\";\n    @Override\n    public Thread newThread(Runnable r) {\n        return new Thread(r, prefix + \"-\" + counter++);\n    }\n};\n\n/* 实例化Disruptor （官方有4个实例化方法）\n * factory 是事件工厂\n * bufferSize 是上面定义的RingBuffer的大小\n * ProducerType.MULTI 是生产者模式 有SINGL和MULTI两种\n * new BlockingWaitStrategy() 是等待阻塞策略\n */\nDisruptor<LongEvent> disruptor = new Disruptor<LongEvent>(\n    factory, \n    bufferSize, \n    threadFactory,\n    ProducerType.MULTI,\n    new BlockingWaitStrategy());\n```\n\n\n\n## 创建消费者\n\n### 单个模式\n\ndisruptor会创建2和线程，一个线程用来执行`A1Handler`，一个线程用来执行`A2Handler`.每个线程互不影响。\n\n```java\ndisruptor.handleEventsWith(new A1Handler(),new A2Handler());\n```\n\n### 池化模式\n\ndisruptor会创建4个线程，其中两个线程组成**线程池**来执行`A1Handler`，另外两个线程也组成**线程池**用来执行`A2Handler`\n\n```java\ndisruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler())\ndisruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler())\n```\n\n## 获取RingBuffer\n\n```java\nRingBuffer<LongEvent> ringBuffer = disruptor.start();\n```\n\n## 生产者发布消息\n\n这边直接使用Java8的发布方式来发布消息\n\n```java\n// 创建ByteBuffer缓冲区 \nByteBuffer bb = ByteBuffer.allocate(8);\n// 生产者发布5条消息\nfor (long l = 0; l<5; l++) {\n    // 写入消息到Bufer缓冲区\n    bb.putLong(0, l);\n    // Java8 lambda发布方式\n    ringBuffer.publishEvent((event,sequece,buffer) -> event.setId(buffer.getLong(0)),bb);\n}\nSystem.out.println(\"发布完成\");\n```\n\n\n\n## 完整的Main方法\n\n```java\npublic class DisruptorMain {\n    public static void main(String[] args) {\n        // 实例化事件工厂\n        LongEventFactory factory = new LongEventFactory();\n        // 定义RingBuffer大小\n        int bufferSize = 1024;\n        // 创建线程工厂\n        ThreadFactory threadFactory = new ThreadFactory() {\n            private int counter = 0;\n            private String prefix = \"DisruptorWorker\";\n            @Override\n            public Thread newThread(Runnable r) {\n                return new Thread(r, prefix + \"-\" + counter++);\n            }\n        };\n        // 实例化Disruptor\n        Disruptor<LongEvent> disruptor = new Disruptor<LongEvent>(\n                factory,\n                bufferSize,\n                threadFactory,\n                ProducerType.MULTI,\n                new BlockingWaitStrategy());\n\n        // 并行模式 两个Handler互不影响\n        disruptor.handleEventsWith(new A1Handler(),new A2Handler());\n\n        // 并行 每个消费端有两个线程实例 (池化模式)\n//        disruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler());\n//        disruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler());\n\n        // 获取RingBuffer\n        RingBuffer<LongEvent> ringBuffer = disruptor.start();\n        \n        // 创建ByteBuffer缓冲区\n        ByteBuffer bb = ByteBuffer.allocate(8);\n        for (long l = 0; l<5; l++) {\n            // 写入数据到缓冲区\n            bb.putLong(0, l);\n            // Java8的发布方式\n            ringBuffer.publishEvent((event,sequece,buffer) -> event.setId(buffer.getLong(0)),bb);\n        }\n        System.out.println(\"发布完成\");\n    }\n}\n\n```","slug":"java/disruptor/a552f7f0-4cbe-4628-8fcf-02f8b8730b56","published":1,"updated":"2021-03-01T01:59:16.063Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bm4008u2mg5n5q7f3kb","content":"<h2 id=\"创建一个事件实体\"><a href=\"#创建一个事件实体\" class=\"headerlink\" title=\"创建一个事件实体\"></a>创建一个事件实体</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEvent</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Long <span class=\"title\">getId</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setId</span><span class=\"params\">(Long id)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建一个事件实体工厂\"><a href=\"#创建一个事件实体工厂\" class=\"headerlink\" title=\"创建一个事件实体工厂\"></a>创建一个事件实体工厂</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEventFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventFactory</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> LongEvent <span class=\"title\">newInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> LongEvent();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建两个事件处理类\"><a href=\"#创建两个事件处理类\" class=\"headerlink\" title=\"创建两个事件处理类\"></a>创建两个事件处理类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* EventHandler&lt;LongEvent&gt; 是没有池化的实现方式,每个消费者中只有一个示例</span></span><br><span class=\"line\"><span class=\"comment\">* WorkHandler&lt;LongEvent&gt; 是池化的实现方式，每个消费者中可以以类似线程池的方式去执行这个事件</span></span><br><span class=\"line\"><span class=\"comment\">* 实际根据业务场景 实现其中一个接口就可以</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A1Handler</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; , <span class=\"title\">WorkHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent, <span class=\"keyword\">long</span> l, <span class=\"keyword\">boolean</span> b)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">1</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A1Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 池化执行</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">10</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A1Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A2Handler</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; , <span class=\"title\">WorkHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent, <span class=\"keyword\">long</span> l, <span class=\"keyword\">boolean</span> b)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">3</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A2Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 池化执行</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">30</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A2Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"实例化Disruptor\"><a href=\"#实例化Disruptor\" class=\"headerlink\" title=\"实例化Disruptor\"></a>实例化Disruptor</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 事件工厂</span></span><br><span class=\"line\">LongEventFactory factory = <span class=\"keyword\">new</span> LongEventFactory();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义RingBuff大小  注意：数值一定是2的幂次方</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> bufferSize = <span class=\"number\">1024</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建ThreadFactory</span></span><br><span class=\"line\">ThreadFactory threadFactory = <span class=\"keyword\">new</span> ThreadFactory() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String prefix = <span class=\"string\">\"DisruptorWorker\"</span>;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Thread <span class=\"title\">newThread</span><span class=\"params\">(Runnable r)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Thread(r, prefix + <span class=\"string\">\"-\"</span> + counter++);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 实例化Disruptor （官方有4个实例化方法）</span></span><br><span class=\"line\"><span class=\"comment\"> * factory 是事件工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * bufferSize 是上面定义的RingBuffer的大小</span></span><br><span class=\"line\"><span class=\"comment\"> * ProducerType.MULTI 是生产者模式 有SINGL和MULTI两种</span></span><br><span class=\"line\"><span class=\"comment\"> * new BlockingWaitStrategy() 是等待阻塞策略</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">Disruptor&lt;LongEvent&gt; disruptor = <span class=\"keyword\">new</span> Disruptor&lt;LongEvent&gt;(</span><br><span class=\"line\">    factory, </span><br><span class=\"line\">    bufferSize, </span><br><span class=\"line\">    threadFactory,</span><br><span class=\"line\">    ProducerType.MULTI,</span><br><span class=\"line\">    <span class=\"keyword\">new</span> BlockingWaitStrategy());</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建消费者\"><a href=\"#创建消费者\" class=\"headerlink\" title=\"创建消费者\"></a>创建消费者</h2><h3 id=\"单个模式\"><a href=\"#单个模式\" class=\"headerlink\" title=\"单个模式\"></a>单个模式</h3><p>disruptor会创建2和线程，一个线程用来执行<code>A1Handler</code>，一个线程用来执行<code>A2Handler</code>.每个线程互不影响。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"池化模式\"><a href=\"#池化模式\" class=\"headerlink\" title=\"池化模式\"></a>池化模式</h3><p>disruptor会创建4个线程，其中两个线程组成<strong>线程池</strong>来执行<code>A1Handler</code>，另外两个线程也组成<strong>线程池</strong>用来执行<code>A2Handler</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A1Handler())</span><br><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A2Handler(),<span class=\"keyword\">new</span> A2Handler())</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"获取RingBuffer\"><a href=\"#获取RingBuffer\" class=\"headerlink\" title=\"获取RingBuffer\"></a>获取RingBuffer</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"生产者发布消息\"><a href=\"#生产者发布消息\" class=\"headerlink\" title=\"生产者发布消息\"></a>生产者发布消息</h2><p>这边直接使用Java8的发布方式来发布消息</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 创建ByteBuffer缓冲区 </span></span><br><span class=\"line\">ByteBuffer bb = ByteBuffer.allocate(<span class=\"number\">8</span>);</span><br><span class=\"line\"><span class=\"comment\">// 生产者发布5条消息</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">long</span> l = <span class=\"number\">0</span>; l&lt;<span class=\"number\">5</span>; l++) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 写入消息到Bufer缓冲区</span></span><br><span class=\"line\">    bb.putLong(<span class=\"number\">0</span>, l);</span><br><span class=\"line\">    <span class=\"comment\">// Java8 lambda发布方式</span></span><br><span class=\"line\">    ringBuffer.publishEvent((event,sequece,buffer) -&gt; event.setId(buffer.getLong(<span class=\"number\">0</span>)),bb);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(<span class=\"string\">\"发布完成\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"完整的Main方法\"><a href=\"#完整的Main方法\" class=\"headerlink\" title=\"完整的Main方法\"></a>完整的Main方法</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DisruptorMain</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 实例化事件工厂</span></span><br><span class=\"line\">        LongEventFactory factory = <span class=\"keyword\">new</span> LongEventFactory();</span><br><span class=\"line\">        <span class=\"comment\">// 定义RingBuffer大小</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> bufferSize = <span class=\"number\">1024</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 创建线程工厂</span></span><br><span class=\"line\">        ThreadFactory threadFactory = <span class=\"keyword\">new</span> ThreadFactory() &#123;</span><br><span class=\"line\">            <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">private</span> String prefix = <span class=\"string\">\"DisruptorWorker\"</span>;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Thread <span class=\"title\">newThread</span><span class=\"params\">(Runnable r)</span> </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Thread(r, prefix + <span class=\"string\">\"-\"</span> + counter++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">// 实例化Disruptor</span></span><br><span class=\"line\">        Disruptor&lt;LongEvent&gt; disruptor = <span class=\"keyword\">new</span> Disruptor&lt;LongEvent&gt;(</span><br><span class=\"line\">                factory,</span><br><span class=\"line\">                bufferSize,</span><br><span class=\"line\">                threadFactory,</span><br><span class=\"line\">                ProducerType.MULTI,</span><br><span class=\"line\">                <span class=\"keyword\">new</span> BlockingWaitStrategy());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 并行模式 两个Handler互不影响</span></span><br><span class=\"line\">        disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 并行 每个消费端有两个线程实例 (池化模式)</span></span><br><span class=\"line\"><span class=\"comment\">//        disruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler());</span></span><br><span class=\"line\"><span class=\"comment\">//        disruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler());</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取RingBuffer</span></span><br><span class=\"line\">        RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 创建ByteBuffer缓冲区</span></span><br><span class=\"line\">        ByteBuffer bb = ByteBuffer.allocate(<span class=\"number\">8</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">long</span> l = <span class=\"number\">0</span>; l&lt;<span class=\"number\">5</span>; l++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 写入数据到缓冲区</span></span><br><span class=\"line\">            bb.putLong(<span class=\"number\">0</span>, l);</span><br><span class=\"line\">            <span class=\"comment\">// Java8的发布方式</span></span><br><span class=\"line\">            ringBuffer.publishEvent((event,sequece,buffer) -&gt; event.setId(buffer.getLong(<span class=\"number\">0</span>)),bb);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"发布完成\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"创建一个事件实体\"><a href=\"#创建一个事件实体\" class=\"headerlink\" title=\"创建一个事件实体\"></a>创建一个事件实体</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEvent</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> Long id;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Long <span class=\"title\">getId</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setId</span><span class=\"params\">(Long id)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.id = id;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建一个事件实体工厂\"><a href=\"#创建一个事件实体工厂\" class=\"headerlink\" title=\"创建一个事件实体工厂\"></a>创建一个事件实体工厂</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">LongEventFactory</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventFactory</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> LongEvent <span class=\"title\">newInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> LongEvent();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建两个事件处理类\"><a href=\"#创建两个事件处理类\" class=\"headerlink\" title=\"创建两个事件处理类\"></a>创建两个事件处理类</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">* EventHandler&lt;LongEvent&gt; 是没有池化的实现方式,每个消费者中只有一个示例</span></span><br><span class=\"line\"><span class=\"comment\">* WorkHandler&lt;LongEvent&gt; 是池化的实现方式，每个消费者中可以以类似线程池的方式去执行这个事件</span></span><br><span class=\"line\"><span class=\"comment\">* 实际根据业务场景 实现其中一个接口就可以</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A1Handler</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; , <span class=\"title\">WorkHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent, <span class=\"keyword\">long</span> l, <span class=\"keyword\">boolean</span> b)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">1</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A1Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 池化执行</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">10</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A1Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">A2Handler</span> <span class=\"keyword\">implements</span> <span class=\"title\">EventHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; , <span class=\"title\">WorkHandler</span>&lt;<span class=\"title\">LongEvent</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent, <span class=\"keyword\">long</span> l, <span class=\"keyword\">boolean</span> b)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">3</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A2Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * 池化执行</span></span><br><span class=\"line\"><span class=\"comment\">     * */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">onEvent</span><span class=\"params\">(LongEvent longEvent)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> id = longEvent.getId();</span><br><span class=\"line\">        id+=<span class=\"number\">30</span>;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">        System.out.println(Thread.currentThread().getName());</span><br><span class=\"line\">        System.out.println(System.currentTimeMillis()+<span class=\"string\">\"+A2Handler:\"</span>+id);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"**************************\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"实例化Disruptor\"><a href=\"#实例化Disruptor\" class=\"headerlink\" title=\"实例化Disruptor\"></a>实例化Disruptor</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 事件工厂</span></span><br><span class=\"line\">LongEventFactory factory = <span class=\"keyword\">new</span> LongEventFactory();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 定义RingBuff大小  注意：数值一定是2的幂次方</span></span><br><span class=\"line\"><span class=\"keyword\">int</span> bufferSize = <span class=\"number\">1024</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 创建ThreadFactory</span></span><br><span class=\"line\">ThreadFactory threadFactory = <span class=\"keyword\">new</span> ThreadFactory() &#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> String prefix = <span class=\"string\">\"DisruptorWorker\"</span>;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Thread <span class=\"title\">newThread</span><span class=\"params\">(Runnable r)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Thread(r, prefix + <span class=\"string\">\"-\"</span> + counter++);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/* 实例化Disruptor （官方有4个实例化方法）</span></span><br><span class=\"line\"><span class=\"comment\"> * factory 是事件工厂</span></span><br><span class=\"line\"><span class=\"comment\"> * bufferSize 是上面定义的RingBuffer的大小</span></span><br><span class=\"line\"><span class=\"comment\"> * ProducerType.MULTI 是生产者模式 有SINGL和MULTI两种</span></span><br><span class=\"line\"><span class=\"comment\"> * new BlockingWaitStrategy() 是等待阻塞策略</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">Disruptor&lt;LongEvent&gt; disruptor = <span class=\"keyword\">new</span> Disruptor&lt;LongEvent&gt;(</span><br><span class=\"line\">    factory, </span><br><span class=\"line\">    bufferSize, </span><br><span class=\"line\">    threadFactory,</span><br><span class=\"line\">    ProducerType.MULTI,</span><br><span class=\"line\">    <span class=\"keyword\">new</span> BlockingWaitStrategy());</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"创建消费者\"><a href=\"#创建消费者\" class=\"headerlink\" title=\"创建消费者\"></a>创建消费者</h2><h3 id=\"单个模式\"><a href=\"#单个模式\" class=\"headerlink\" title=\"单个模式\"></a>单个模式</h3><p>disruptor会创建2和线程，一个线程用来执行<code>A1Handler</code>，一个线程用来执行<code>A2Handler</code>.每个线程互不影响。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"池化模式\"><a href=\"#池化模式\" class=\"headerlink\" title=\"池化模式\"></a>池化模式</h3><p>disruptor会创建4个线程，其中两个线程组成<strong>线程池</strong>来执行<code>A1Handler</code>，另外两个线程也组成<strong>线程池</strong>用来执行<code>A2Handler</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A1Handler())</span><br><span class=\"line\">disruptor.handleEventsWithWorkerPool(<span class=\"keyword\">new</span> A2Handler(),<span class=\"keyword\">new</span> A2Handler())</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"获取RingBuffer\"><a href=\"#获取RingBuffer\" class=\"headerlink\" title=\"获取RingBuffer\"></a>获取RingBuffer</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"生产者发布消息\"><a href=\"#生产者发布消息\" class=\"headerlink\" title=\"生产者发布消息\"></a>生产者发布消息</h2><p>这边直接使用Java8的发布方式来发布消息</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 创建ByteBuffer缓冲区 </span></span><br><span class=\"line\">ByteBuffer bb = ByteBuffer.allocate(<span class=\"number\">8</span>);</span><br><span class=\"line\"><span class=\"comment\">// 生产者发布5条消息</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">long</span> l = <span class=\"number\">0</span>; l&lt;<span class=\"number\">5</span>; l++) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 写入消息到Bufer缓冲区</span></span><br><span class=\"line\">    bb.putLong(<span class=\"number\">0</span>, l);</span><br><span class=\"line\">    <span class=\"comment\">// Java8 lambda发布方式</span></span><br><span class=\"line\">    ringBuffer.publishEvent((event,sequece,buffer) -&gt; event.setId(buffer.getLong(<span class=\"number\">0</span>)),bb);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">System.out.println(<span class=\"string\">\"发布完成\"</span>);</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"完整的Main方法\"><a href=\"#完整的Main方法\" class=\"headerlink\" title=\"完整的Main方法\"></a>完整的Main方法</h2><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DisruptorMain</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 实例化事件工厂</span></span><br><span class=\"line\">        LongEventFactory factory = <span class=\"keyword\">new</span> LongEventFactory();</span><br><span class=\"line\">        <span class=\"comment\">// 定义RingBuffer大小</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> bufferSize = <span class=\"number\">1024</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 创建线程工厂</span></span><br><span class=\"line\">        ThreadFactory threadFactory = <span class=\"keyword\">new</span> ThreadFactory() &#123;</span><br><span class=\"line\">            <span class=\"keyword\">private</span> <span class=\"keyword\">int</span> counter = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">private</span> String prefix = <span class=\"string\">\"DisruptorWorker\"</span>;</span><br><span class=\"line\">            <span class=\"meta\">@Override</span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> Thread <span class=\"title\">newThread</span><span class=\"params\">(Runnable r)</span> </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Thread(r, prefix + <span class=\"string\">\"-\"</span> + counter++);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;;</span><br><span class=\"line\">        <span class=\"comment\">// 实例化Disruptor</span></span><br><span class=\"line\">        Disruptor&lt;LongEvent&gt; disruptor = <span class=\"keyword\">new</span> Disruptor&lt;LongEvent&gt;(</span><br><span class=\"line\">                factory,</span><br><span class=\"line\">                bufferSize,</span><br><span class=\"line\">                threadFactory,</span><br><span class=\"line\">                ProducerType.MULTI,</span><br><span class=\"line\">                <span class=\"keyword\">new</span> BlockingWaitStrategy());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 并行模式 两个Handler互不影响</span></span><br><span class=\"line\">        disruptor.handleEventsWith(<span class=\"keyword\">new</span> A1Handler(),<span class=\"keyword\">new</span> A2Handler());</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 并行 每个消费端有两个线程实例 (池化模式)</span></span><br><span class=\"line\"><span class=\"comment\">//        disruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler());</span></span><br><span class=\"line\"><span class=\"comment\">//        disruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler());</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// 获取RingBuffer</span></span><br><span class=\"line\">        RingBuffer&lt;LongEvent&gt; ringBuffer = disruptor.start();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 创建ByteBuffer缓冲区</span></span><br><span class=\"line\">        ByteBuffer bb = ByteBuffer.allocate(<span class=\"number\">8</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">long</span> l = <span class=\"number\">0</span>; l&lt;<span class=\"number\">5</span>; l++) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 写入数据到缓冲区</span></span><br><span class=\"line\">            bb.putLong(<span class=\"number\">0</span>, l);</span><br><span class=\"line\">            <span class=\"comment\">// Java8的发布方式</span></span><br><span class=\"line\">            ringBuffer.publishEvent((event,sequece,buffer) -&gt; event.setId(buffer.getLong(<span class=\"number\">0</span>)),bb);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"发布完成\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"JVM类加载过程","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-09-16T07:04:22.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n## 加载\n\n\n\n1. 通过一个类的全限定名(例如：`java.lang.String`)来获取定义此类的二进制字节流。\n\n2. 将这个字节流所代表的静态存储结构转化为方法区的运行时数据结构。\n\n2. 在内存中生成一个代表这个类的`java.lang.Class`对象，作为方法区这个类的各种数据的访问入口。\n\n> 对于数组类而言，情况就有所不同，数组类本身不通过类加载器创建，它是由Java虚拟机直接在内存中动态构造出来的。\n\n\n\n- 从ZIP压缩包中读取，这很常见，最终成为日后JAR、EAR、WAR格式的基础。\n\n- 从网络中获取，这种场景最典型的应用就是Web Applet。\n\n- 运行时计算生成，这种场景使用得最多的就是动态代理技术，在java.lang.reflect.Proxy中，就是用了ProxyGenerator.generateProxyClass()来为特定接口生成形式为“*$Proxy”的代理类的二进制字节流。\n\n- 由其他文件生成，典型场景是JSP应用，由JSP文件生成对应的Class文件。\n\n- 从数据库中读取，这种场景相对少见些，例如有些中间件服务器（如SAP Netweaver）可以选择把程序安装到数据库中来完成程序代码在集群间的分发。\n\n- 可以从加密文件中获取，这是典型的防Class文件被反编译的保护措施，通过加载时解密Class文件来保障程序运行逻辑不被窥探。\n\n\n\n## 验证\n\n- 文件格式验证\n  - 是否以魔数0xCAFEBABE开头。\n  - 主、次版本号是否在当前Java虚拟机接受范围之内\n  - 常量池的常量中是否有不被支持的常量类型（检查常量tag标志）。\n  - 指向常量的各种索引值中是否有指向不存在的常量或不符合类型的常量。\n  - CONSTANT_Utf8_info型的常量中是否有不符合UTF-8编码的数据。\n  - ·Class文件中各个部分及文件本身是否有被删除的或附加的其他信息\n  - ......\n- 元数据验证\n  - 这个类是否有父类（除了java.lang.Object之外，所有的类都应当有父类）。\n  - 这个类的父类是否继承了不允许被继承的类（被final修饰的类）。\n  - 如果这个类不是抽象类，是否实现了其父类或接口之中要求实现的所有方法。\n  - 类中的字段、方法是否与父类产生矛盾（例如覆盖了父类的final字段，或者出现不符合规则的方法重载，例如方法参数都一致，但返回值类型却不同等）。\n  - ......\n- 字节码验证\n  - 保证任意时刻操作数栈的数据类型与指令代码序列都能配合工作，例如不会出现类似于“在操作栈放置了一个int类型的数据，使用时却按long类型来加载入本地变量表中”这样的情况。\n  - 保证任何跳转指令都不会跳转到方法体以外的字节码指令上。\n  - 保证方法体中的类型转换总是有效的，例如可以把一个子类对象赋值给父类数据类型，这是安全的，但是把父类对象赋值给子类数据类型，甚至把对象赋值给与它毫无继承关系、完全不相干的一个数据类型，则是危险和不合法的。\n  - ......\n- 符号引用验证\n  - 符号引用中通过字符串描述的全限定名是否能找到对应的类\n  - 在指定类中是否存在符合方法的字段描述符及简单名称所描述的方法和字段。\n  - 符号引用中的类、字段、方法的可访问性（private、protected、public、<package>）是否可被当前类访问。\n  - ......\n- \n\n## 准备\n\n准备阶段是正式为类中定义的变量（即静态变量，被static修饰的变量）分配内存并设置类变量初始值的阶段\n\n例子：\n\n```java\n// 变量value在准备阶段过后的初始值为0而不是123\n// 因为这时尚未开始执行任何Java方法 value赋值为123的动作要到类的初始化阶段才会被执行\npublic static int value = 123\n```\n\n![](http://cdn.mjava.top/blog/20200726220517.jpeg)\n\n## 解析\n\n解析阶段是Java虚拟机将常量池内的`符号引用`替换为`直接引用`的过程\n\n- **符号引用（Symbolic References）**：符号引用以一组符号来描述所引用的目标，符号可以是任何形式的字面量，只要使用时能无歧义地定位到目标即可。符号引用与虚拟机实现的内存布局无关，引用的目标并不一定是已经加载到虚拟机内存当中的内容。各种虚拟机实现的内存布局可以各不相同，但是它们能接受的符号引用必须都是一致的，因为符号引用的字面量形式明确定义在《Java虚拟机规范》的Class文件格式中。\n\n  > 下面红框中的都属于符号引用\n\n  ![](http://cdn.mjava.top/blog/20200726220833.png)\n\n- **直接引用（Direct References）**：直接引用是可以直接指向目标的指针、相对偏移量或者是一个能间接定位到目标的句柄。直接引用是和虚拟机实现的内存布局直接相关的，同一个符号引用在不同虚拟机实例上翻译出来的直接引用一般不会相同。如果有了直接引用，那引用的目标必定已经在虚拟机的内存中存在。\n\n## 初始化\n\n参考：[jvm类初始化](https://mp.weixin.qq.com/s?__biz=MzAxMTc4NDUyOA==&tempkey=MTA3MV9NS1dJTVFnVDhRQkRid2hBSDB4aUE2X3Nham5Lcm9VMlpXVlIzTGd4dkk0eDNNb29iV3NlaGh0blA3Z25CcmJ6cXBLYzl5Z09zakZSakNTeFdTOUtkbUQzZnNST0pnUUNTOEhkb1J3Ul84MDhPaEw1bGZSVm9TdXNteG5DLUowSDdmUGxYajkxSWFETENkZ0h0NTY1UkJfOC0yV0laXzdyakNfVDdnfn4%3D&chksm=03a1657734d6ec6126a1c6a802506964f632a2dff53f123de74de0f865b83ef11a9b338a187d#rd)","source":"_posts/java/jvm/java-class-load-2.md","raw":"---\ntitle: JVM类加载过程\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-09-16 15:04:22\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- JVM\n- Java\ncategories:\n- JVM\n---\n\n\n\n## 加载\n\n\n\n1. 通过一个类的全限定名(例如：`java.lang.String`)来获取定义此类的二进制字节流。\n\n2. 将这个字节流所代表的静态存储结构转化为方法区的运行时数据结构。\n\n2. 在内存中生成一个代表这个类的`java.lang.Class`对象，作为方法区这个类的各种数据的访问入口。\n\n> 对于数组类而言，情况就有所不同，数组类本身不通过类加载器创建，它是由Java虚拟机直接在内存中动态构造出来的。\n\n\n\n- 从ZIP压缩包中读取，这很常见，最终成为日后JAR、EAR、WAR格式的基础。\n\n- 从网络中获取，这种场景最典型的应用就是Web Applet。\n\n- 运行时计算生成，这种场景使用得最多的就是动态代理技术，在java.lang.reflect.Proxy中，就是用了ProxyGenerator.generateProxyClass()来为特定接口生成形式为“*$Proxy”的代理类的二进制字节流。\n\n- 由其他文件生成，典型场景是JSP应用，由JSP文件生成对应的Class文件。\n\n- 从数据库中读取，这种场景相对少见些，例如有些中间件服务器（如SAP Netweaver）可以选择把程序安装到数据库中来完成程序代码在集群间的分发。\n\n- 可以从加密文件中获取，这是典型的防Class文件被反编译的保护措施，通过加载时解密Class文件来保障程序运行逻辑不被窥探。\n\n\n\n## 验证\n\n- 文件格式验证\n  - 是否以魔数0xCAFEBABE开头。\n  - 主、次版本号是否在当前Java虚拟机接受范围之内\n  - 常量池的常量中是否有不被支持的常量类型（检查常量tag标志）。\n  - 指向常量的各种索引值中是否有指向不存在的常量或不符合类型的常量。\n  - CONSTANT_Utf8_info型的常量中是否有不符合UTF-8编码的数据。\n  - ·Class文件中各个部分及文件本身是否有被删除的或附加的其他信息\n  - ......\n- 元数据验证\n  - 这个类是否有父类（除了java.lang.Object之外，所有的类都应当有父类）。\n  - 这个类的父类是否继承了不允许被继承的类（被final修饰的类）。\n  - 如果这个类不是抽象类，是否实现了其父类或接口之中要求实现的所有方法。\n  - 类中的字段、方法是否与父类产生矛盾（例如覆盖了父类的final字段，或者出现不符合规则的方法重载，例如方法参数都一致，但返回值类型却不同等）。\n  - ......\n- 字节码验证\n  - 保证任意时刻操作数栈的数据类型与指令代码序列都能配合工作，例如不会出现类似于“在操作栈放置了一个int类型的数据，使用时却按long类型来加载入本地变量表中”这样的情况。\n  - 保证任何跳转指令都不会跳转到方法体以外的字节码指令上。\n  - 保证方法体中的类型转换总是有效的，例如可以把一个子类对象赋值给父类数据类型，这是安全的，但是把父类对象赋值给子类数据类型，甚至把对象赋值给与它毫无继承关系、完全不相干的一个数据类型，则是危险和不合法的。\n  - ......\n- 符号引用验证\n  - 符号引用中通过字符串描述的全限定名是否能找到对应的类\n  - 在指定类中是否存在符合方法的字段描述符及简单名称所描述的方法和字段。\n  - 符号引用中的类、字段、方法的可访问性（private、protected、public、<package>）是否可被当前类访问。\n  - ......\n- \n\n## 准备\n\n准备阶段是正式为类中定义的变量（即静态变量，被static修饰的变量）分配内存并设置类变量初始值的阶段\n\n例子：\n\n```java\n// 变量value在准备阶段过后的初始值为0而不是123\n// 因为这时尚未开始执行任何Java方法 value赋值为123的动作要到类的初始化阶段才会被执行\npublic static int value = 123\n```\n\n![](http://cdn.mjava.top/blog/20200726220517.jpeg)\n\n## 解析\n\n解析阶段是Java虚拟机将常量池内的`符号引用`替换为`直接引用`的过程\n\n- **符号引用（Symbolic References）**：符号引用以一组符号来描述所引用的目标，符号可以是任何形式的字面量，只要使用时能无歧义地定位到目标即可。符号引用与虚拟机实现的内存布局无关，引用的目标并不一定是已经加载到虚拟机内存当中的内容。各种虚拟机实现的内存布局可以各不相同，但是它们能接受的符号引用必须都是一致的，因为符号引用的字面量形式明确定义在《Java虚拟机规范》的Class文件格式中。\n\n  > 下面红框中的都属于符号引用\n\n  ![](http://cdn.mjava.top/blog/20200726220833.png)\n\n- **直接引用（Direct References）**：直接引用是可以直接指向目标的指针、相对偏移量或者是一个能间接定位到目标的句柄。直接引用是和虚拟机实现的内存布局直接相关的，同一个符号引用在不同虚拟机实例上翻译出来的直接引用一般不会相同。如果有了直接引用，那引用的目标必定已经在虚拟机的内存中存在。\n\n## 初始化\n\n参考：[jvm类初始化](https://mp.weixin.qq.com/s?__biz=MzAxMTc4NDUyOA==&tempkey=MTA3MV9NS1dJTVFnVDhRQkRid2hBSDB4aUE2X3Nham5Lcm9VMlpXVlIzTGd4dkk0eDNNb29iV3NlaGh0blA3Z25CcmJ6cXBLYzl5Z09zakZSakNTeFdTOUtkbUQzZnNST0pnUUNTOEhkb1J3Ul84MDhPaEw1bGZSVm9TdXNteG5DLUowSDdmUGxYajkxSWFETENkZ0h0NTY1UkJfOC0yV0laXzdyakNfVDdnfn4%3D&chksm=03a1657734d6ec6126a1c6a802506964f632a2dff53f123de74de0f865b83ef11a9b338a187d#rd)","slug":"java/jvm/java-class-load-2","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bm5008w2mg5thucxsxs","content":"<h2 id=\"加载\"><a href=\"#加载\" class=\"headerlink\" title=\"加载\"></a>加载</h2><ol>\n<li><p>通过一个类的全限定名(例如：<code>java.lang.String</code>)来获取定义此类的二进制字节流。</p>\n</li>\n<li><p>将这个字节流所代表的静态存储结构转化为方法区的运行时数据结构。</p>\n</li>\n<li><p>在内存中生成一个代表这个类的<code>java.lang.Class</code>对象，作为方法区这个类的各种数据的访问入口。</p>\n</li>\n</ol>\n<blockquote>\n<p>对于数组类而言，情况就有所不同，数组类本身不通过类加载器创建，它是由Java虚拟机直接在内存中动态构造出来的。</p>\n</blockquote>\n<ul>\n<li><p>从ZIP压缩包中读取，这很常见，最终成为日后JAR、EAR、WAR格式的基础。</p>\n</li>\n<li><p>从网络中获取，这种场景最典型的应用就是Web Applet。</p>\n</li>\n<li><p>运行时计算生成，这种场景使用得最多的就是动态代理技术，在java.lang.reflect.Proxy中，就是用了ProxyGenerator.generateProxyClass()来为特定接口生成形式为“*$Proxy”的代理类的二进制字节流。</p>\n</li>\n<li><p>由其他文件生成，典型场景是JSP应用，由JSP文件生成对应的Class文件。</p>\n</li>\n<li><p>从数据库中读取，这种场景相对少见些，例如有些中间件服务器（如SAP Netweaver）可以选择把程序安装到数据库中来完成程序代码在集群间的分发。</p>\n</li>\n<li><p>可以从加密文件中获取，这是典型的防Class文件被反编译的保护措施，通过加载时解密Class文件来保障程序运行逻辑不被窥探。</p>\n</li>\n</ul>\n<h2 id=\"验证\"><a href=\"#验证\" class=\"headerlink\" title=\"验证\"></a>验证</h2><ul>\n<li>文件格式验证<ul>\n<li>是否以魔数0xCAFEBABE开头。</li>\n<li>主、次版本号是否在当前Java虚拟机接受范围之内</li>\n<li>常量池的常量中是否有不被支持的常量类型（检查常量tag标志）。</li>\n<li>指向常量的各种索引值中是否有指向不存在的常量或不符合类型的常量。</li>\n<li>CONSTANT_Utf8_info型的常量中是否有不符合UTF-8编码的数据。</li>\n<li>·Class文件中各个部分及文件本身是否有被删除的或附加的其他信息</li>\n<li>……</li>\n</ul>\n</li>\n<li>元数据验证<ul>\n<li>这个类是否有父类（除了java.lang.Object之外，所有的类都应当有父类）。</li>\n<li>这个类的父类是否继承了不允许被继承的类（被final修饰的类）。</li>\n<li>如果这个类不是抽象类，是否实现了其父类或接口之中要求实现的所有方法。</li>\n<li>类中的字段、方法是否与父类产生矛盾（例如覆盖了父类的final字段，或者出现不符合规则的方法重载，例如方法参数都一致，但返回值类型却不同等）。</li>\n<li>……</li>\n</ul>\n</li>\n<li>字节码验证<ul>\n<li>保证任意时刻操作数栈的数据类型与指令代码序列都能配合工作，例如不会出现类似于“在操作栈放置了一个int类型的数据，使用时却按long类型来加载入本地变量表中”这样的情况。</li>\n<li>保证任何跳转指令都不会跳转到方法体以外的字节码指令上。</li>\n<li>保证方法体中的类型转换总是有效的，例如可以把一个子类对象赋值给父类数据类型，这是安全的，但是把父类对象赋值给子类数据类型，甚至把对象赋值给与它毫无继承关系、完全不相干的一个数据类型，则是危险和不合法的。</li>\n<li>……</li>\n</ul>\n</li>\n<li>符号引用验证<ul>\n<li>符号引用中通过字符串描述的全限定名是否能找到对应的类</li>\n<li>在指定类中是否存在符合方法的字段描述符及简单名称所描述的方法和字段。</li>\n<li>符号引用中的类、字段、方法的可访问性（private、protected、public、<package>）是否可被当前类访问。</package></li>\n<li>……</li>\n</ul>\n</li>\n<li></li>\n</ul>\n<h2 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h2><p>准备阶段是正式为类中定义的变量（即静态变量，被static修饰的变量）分配内存并设置类变量初始值的阶段</p>\n<p>例子：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 变量value在准备阶段过后的初始值为0而不是123</span></span><br><span class=\"line\"><span class=\"comment\">// 因为这时尚未开始执行任何Java方法 value赋值为123的动作要到类的初始化阶段才会被执行</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> value = <span class=\"number\">123</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20200726220517.jpeg\" alt></p>\n<h2 id=\"解析\"><a href=\"#解析\" class=\"headerlink\" title=\"解析\"></a>解析</h2><p>解析阶段是Java虚拟机将常量池内的<code>符号引用</code>替换为<code>直接引用</code>的过程</p>\n<ul>\n<li><p><strong>符号引用（Symbolic References）</strong>：符号引用以一组符号来描述所引用的目标，符号可以是任何形式的字面量，只要使用时能无歧义地定位到目标即可。符号引用与虚拟机实现的内存布局无关，引用的目标并不一定是已经加载到虚拟机内存当中的内容。各种虚拟机实现的内存布局可以各不相同，但是它们能接受的符号引用必须都是一致的，因为符号引用的字面量形式明确定义在《Java虚拟机规范》的Class文件格式中。</p>\n<blockquote>\n<p>下面红框中的都属于符号引用</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200726220833.png\" alt></p>\n</li>\n<li><p><strong>直接引用（Direct References）</strong>：直接引用是可以直接指向目标的指针、相对偏移量或者是一个能间接定位到目标的句柄。直接引用是和虚拟机实现的内存布局直接相关的，同一个符号引用在不同虚拟机实例上翻译出来的直接引用一般不会相同。如果有了直接引用，那引用的目标必定已经在虚拟机的内存中存在。</p>\n</li>\n</ul>\n<h2 id=\"初始化\"><a href=\"#初始化\" class=\"headerlink\" title=\"初始化\"></a>初始化</h2><p>参考：<a href=\"https://mp.weixin.qq.com/s?__biz=MzAxMTc4NDUyOA==&tempkey=MTA3MV9NS1dJTVFnVDhRQkRid2hBSDB4aUE2X3Nham5Lcm9VMlpXVlIzTGd4dkk0eDNNb29iV3NlaGh0blA3Z25CcmJ6cXBLYzl5Z09zakZSakNTeFdTOUtkbUQzZnNST0pnUUNTOEhkb1J3Ul84MDhPaEw1bGZSVm9TdXNteG5DLUowSDdmUGxYajkxSWFETENkZ0h0NTY1UkJfOC0yV0laXzdyakNfVDdnfn4%3D&chksm=03a1657734d6ec6126a1c6a802506964f632a2dff53f123de74de0f865b83ef11a9b338a187d#rd\" rel=\"noopener\" target=\"_blank\">jvm类初始化</a></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"加载\"><a href=\"#加载\" class=\"headerlink\" title=\"加载\"></a>加载</h2><ol>\n<li><p>通过一个类的全限定名(例如：<code>java.lang.String</code>)来获取定义此类的二进制字节流。</p>\n</li>\n<li><p>将这个字节流所代表的静态存储结构转化为方法区的运行时数据结构。</p>\n</li>\n<li><p>在内存中生成一个代表这个类的<code>java.lang.Class</code>对象，作为方法区这个类的各种数据的访问入口。</p>\n</li>\n</ol>\n<blockquote>\n<p>对于数组类而言，情况就有所不同，数组类本身不通过类加载器创建，它是由Java虚拟机直接在内存中动态构造出来的。</p>\n</blockquote>\n<ul>\n<li><p>从ZIP压缩包中读取，这很常见，最终成为日后JAR、EAR、WAR格式的基础。</p>\n</li>\n<li><p>从网络中获取，这种场景最典型的应用就是Web Applet。</p>\n</li>\n<li><p>运行时计算生成，这种场景使用得最多的就是动态代理技术，在java.lang.reflect.Proxy中，就是用了ProxyGenerator.generateProxyClass()来为特定接口生成形式为“*$Proxy”的代理类的二进制字节流。</p>\n</li>\n<li><p>由其他文件生成，典型场景是JSP应用，由JSP文件生成对应的Class文件。</p>\n</li>\n<li><p>从数据库中读取，这种场景相对少见些，例如有些中间件服务器（如SAP Netweaver）可以选择把程序安装到数据库中来完成程序代码在集群间的分发。</p>\n</li>\n<li><p>可以从加密文件中获取，这是典型的防Class文件被反编译的保护措施，通过加载时解密Class文件来保障程序运行逻辑不被窥探。</p>\n</li>\n</ul>\n<h2 id=\"验证\"><a href=\"#验证\" class=\"headerlink\" title=\"验证\"></a>验证</h2><ul>\n<li>文件格式验证<ul>\n<li>是否以魔数0xCAFEBABE开头。</li>\n<li>主、次版本号是否在当前Java虚拟机接受范围之内</li>\n<li>常量池的常量中是否有不被支持的常量类型（检查常量tag标志）。</li>\n<li>指向常量的各种索引值中是否有指向不存在的常量或不符合类型的常量。</li>\n<li>CONSTANT_Utf8_info型的常量中是否有不符合UTF-8编码的数据。</li>\n<li>·Class文件中各个部分及文件本身是否有被删除的或附加的其他信息</li>\n<li>……</li>\n</ul>\n</li>\n<li>元数据验证<ul>\n<li>这个类是否有父类（除了java.lang.Object之外，所有的类都应当有父类）。</li>\n<li>这个类的父类是否继承了不允许被继承的类（被final修饰的类）。</li>\n<li>如果这个类不是抽象类，是否实现了其父类或接口之中要求实现的所有方法。</li>\n<li>类中的字段、方法是否与父类产生矛盾（例如覆盖了父类的final字段，或者出现不符合规则的方法重载，例如方法参数都一致，但返回值类型却不同等）。</li>\n<li>……</li>\n</ul>\n</li>\n<li>字节码验证<ul>\n<li>保证任意时刻操作数栈的数据类型与指令代码序列都能配合工作，例如不会出现类似于“在操作栈放置了一个int类型的数据，使用时却按long类型来加载入本地变量表中”这样的情况。</li>\n<li>保证任何跳转指令都不会跳转到方法体以外的字节码指令上。</li>\n<li>保证方法体中的类型转换总是有效的，例如可以把一个子类对象赋值给父类数据类型，这是安全的，但是把父类对象赋值给子类数据类型，甚至把对象赋值给与它毫无继承关系、完全不相干的一个数据类型，则是危险和不合法的。</li>\n<li>……</li>\n</ul>\n</li>\n<li>符号引用验证<ul>\n<li>符号引用中通过字符串描述的全限定名是否能找到对应的类</li>\n<li>在指定类中是否存在符合方法的字段描述符及简单名称所描述的方法和字段。</li>\n<li>符号引用中的类、字段、方法的可访问性（private、protected、public、<package>）是否可被当前类访问。</package></li>\n<li>……</li>\n</ul>\n</li>\n<li></li>\n</ul>\n<h2 id=\"准备\"><a href=\"#准备\" class=\"headerlink\" title=\"准备\"></a>准备</h2><p>准备阶段是正式为类中定义的变量（即静态变量，被static修饰的变量）分配内存并设置类变量初始值的阶段</p>\n<p>例子：</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 变量value在准备阶段过后的初始值为0而不是123</span></span><br><span class=\"line\"><span class=\"comment\">// 因为这时尚未开始执行任何Java方法 value赋值为123的动作要到类的初始化阶段才会被执行</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> value = <span class=\"number\">123</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"http://cdn.mjava.top/blog/20200726220517.jpeg\" alt></p>\n<h2 id=\"解析\"><a href=\"#解析\" class=\"headerlink\" title=\"解析\"></a>解析</h2><p>解析阶段是Java虚拟机将常量池内的<code>符号引用</code>替换为<code>直接引用</code>的过程</p>\n<ul>\n<li><p><strong>符号引用（Symbolic References）</strong>：符号引用以一组符号来描述所引用的目标，符号可以是任何形式的字面量，只要使用时能无歧义地定位到目标即可。符号引用与虚拟机实现的内存布局无关，引用的目标并不一定是已经加载到虚拟机内存当中的内容。各种虚拟机实现的内存布局可以各不相同，但是它们能接受的符号引用必须都是一致的，因为符号引用的字面量形式明确定义在《Java虚拟机规范》的Class文件格式中。</p>\n<blockquote>\n<p>下面红框中的都属于符号引用</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200726220833.png\" alt></p>\n</li>\n<li><p><strong>直接引用（Direct References）</strong>：直接引用是可以直接指向目标的指针、相对偏移量或者是一个能间接定位到目标的句柄。直接引用是和虚拟机实现的内存布局直接相关的，同一个符号引用在不同虚拟机实例上翻译出来的直接引用一般不会相同。如果有了直接引用，那引用的目标必定已经在虚拟机的内存中存在。</p>\n</li>\n</ul>\n<h2 id=\"初始化\"><a href=\"#初始化\" class=\"headerlink\" title=\"初始化\"></a>初始化</h2><p>参考：<a href=\"https://mp.weixin.qq.com/s?__biz=MzAxMTc4NDUyOA==&tempkey=MTA3MV9NS1dJTVFnVDhRQkRid2hBSDB4aUE2X3Nham5Lcm9VMlpXVlIzTGd4dkk0eDNNb29iV3NlaGh0blA3Z25CcmJ6cXBLYzl5Z09zakZSakNTeFdTOUtkbUQzZnNST0pnUUNTOEhkb1J3Ul84MDhPaEw1bGZSVm9TdXNteG5DLUowSDdmUGxYajkxSWFETENkZ0h0NTY1UkJfOC0yV0laXzdyakNfVDdnfn4%3D&chksm=03a1657734d6ec6126a1c6a802506964f632a2dff53f123de74de0f865b83ef11a9b338a187d#rd\" rel=\"noopener\" target=\"_blank\">jvm类初始化</a></p>\n"},{"title":"JVM中的双亲委派机制","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-09-16T07:02:34.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n## 四种类加载器\n\n- 启动类加载器(Bootstrap Class Loader )：加载`$JAVA_HOME/jre/lib`目录下的jar包\n- 拓展类加载器(Extension Class Loader)：加载`$JAVA_HOME/jre/lib/ext`目录下的jar包\n- 应用程序类加载器(Application Class Loader)：加载`ClassPath`目录下的jar包\n- 自定义类加载器(User Class Loader)：加载自定义指定目录下的jar包\n\n## 双亲委派机制\n\n>  如果一个类加载器收到了类加载的请求，它首先不会自己去尝试加载这个类，而是把这个请求委派给父类加载器去完成，每一个层次的类加载器都是如此，因此所有的加载请求最终都应该传送到最顶层的启动类加载器中，只有当父加载器反馈自己无法完成这个加载请求（它的搜索范围中没有找到所需的类）时，子加载器才会尝试自己去完成加载。\n\n![](http://cdn.mjava.top/blog/20200726204658.jpg)\n\n## 代码示例\n\n> 当获取`Bootstrap class loader`的时候，输出了`null`，说明**开发者无法通过引用操作启动类加载器**\n\n![](http://cdn.mjava.top/blog/20200726210142.png)\n\n\n\n## 双亲委派机制的作用\n\n每个加载器都只需要固定的加载自己管理范围内的类，这样的好处就是`保证了Java体系的稳定`，不然的话你自己定义一个`String`类的话，这样系统中就会有两个`String`类，如果没有双亲委派机制的话，系统就不知道到底该加载哪一个，这样系统就变得一片混乱了。\n\n## 破坏双亲委派机制\n\n双亲委派机制是Java设计者推荐给开发者们的类加载实现方式，并不是一个强制性约束的模型，所以也可以人为的破坏这个机制。\n\n- 源码\n\n> 源码在`java.lang.ClassLoader`有兴趣的可以去看下\n\n![](http://cdn.mjava.top/blog/20200726212038.png)\n\n可以看到，就这短短的几行代码，就实现了听起来很高大上的`双亲委派机制`，所以破坏双亲委派机制的话，就直接重写`loadClass`方法就可以了。","source":"_posts/java/jvm/java-class-load-1.md","raw":"---\ntitle: JVM中的双亲委派机制\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-09-16 15:02:34\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- JVM\n- Java\ncategories:\n- JVM\n---\n\n\n\n## 四种类加载器\n\n- 启动类加载器(Bootstrap Class Loader )：加载`$JAVA_HOME/jre/lib`目录下的jar包\n- 拓展类加载器(Extension Class Loader)：加载`$JAVA_HOME/jre/lib/ext`目录下的jar包\n- 应用程序类加载器(Application Class Loader)：加载`ClassPath`目录下的jar包\n- 自定义类加载器(User Class Loader)：加载自定义指定目录下的jar包\n\n## 双亲委派机制\n\n>  如果一个类加载器收到了类加载的请求，它首先不会自己去尝试加载这个类，而是把这个请求委派给父类加载器去完成，每一个层次的类加载器都是如此，因此所有的加载请求最终都应该传送到最顶层的启动类加载器中，只有当父加载器反馈自己无法完成这个加载请求（它的搜索范围中没有找到所需的类）时，子加载器才会尝试自己去完成加载。\n\n![](http://cdn.mjava.top/blog/20200726204658.jpg)\n\n## 代码示例\n\n> 当获取`Bootstrap class loader`的时候，输出了`null`，说明**开发者无法通过引用操作启动类加载器**\n\n![](http://cdn.mjava.top/blog/20200726210142.png)\n\n\n\n## 双亲委派机制的作用\n\n每个加载器都只需要固定的加载自己管理范围内的类，这样的好处就是`保证了Java体系的稳定`，不然的话你自己定义一个`String`类的话，这样系统中就会有两个`String`类，如果没有双亲委派机制的话，系统就不知道到底该加载哪一个，这样系统就变得一片混乱了。\n\n## 破坏双亲委派机制\n\n双亲委派机制是Java设计者推荐给开发者们的类加载实现方式，并不是一个强制性约束的模型，所以也可以人为的破坏这个机制。\n\n- 源码\n\n> 源码在`java.lang.ClassLoader`有兴趣的可以去看下\n\n![](http://cdn.mjava.top/blog/20200726212038.png)\n\n可以看到，就这短短的几行代码，就实现了听起来很高大上的`双亲委派机制`，所以破坏双亲委派机制的话，就直接重写`loadClass`方法就可以了。","slug":"java/jvm/java-class-load-1","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bm6008z2mg5gmbvo5jb","content":"<h2 id=\"四种类加载器\"><a href=\"#四种类加载器\" class=\"headerlink\" title=\"四种类加载器\"></a>四种类加载器</h2><ul>\n<li>启动类加载器(Bootstrap Class Loader )：加载<code>$JAVA_HOME/jre/lib</code>目录下的jar包</li>\n<li>拓展类加载器(Extension Class Loader)：加载<code>$JAVA_HOME/jre/lib/ext</code>目录下的jar包</li>\n<li>应用程序类加载器(Application Class Loader)：加载<code>ClassPath</code>目录下的jar包</li>\n<li>自定义类加载器(User Class Loader)：加载自定义指定目录下的jar包</li>\n</ul>\n<h2 id=\"双亲委派机制\"><a href=\"#双亲委派机制\" class=\"headerlink\" title=\"双亲委派机制\"></a>双亲委派机制</h2><blockquote>\n<p> 如果一个类加载器收到了类加载的请求，它首先不会自己去尝试加载这个类，而是把这个请求委派给父类加载器去完成，每一个层次的类加载器都是如此，因此所有的加载请求最终都应该传送到最顶层的启动类加载器中，只有当父加载器反馈自己无法完成这个加载请求（它的搜索范围中没有找到所需的类）时，子加载器才会尝试自己去完成加载。</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200726204658.jpg\" alt></p>\n<h2 id=\"代码示例\"><a href=\"#代码示例\" class=\"headerlink\" title=\"代码示例\"></a>代码示例</h2><blockquote>\n<p>当获取<code>Bootstrap class loader</code>的时候，输出了<code>null</code>，说明<strong>开发者无法通过引用操作启动类加载器</strong></p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200726210142.png\" alt></p>\n<h2 id=\"双亲委派机制的作用\"><a href=\"#双亲委派机制的作用\" class=\"headerlink\" title=\"双亲委派机制的作用\"></a>双亲委派机制的作用</h2><p>每个加载器都只需要固定的加载自己管理范围内的类，这样的好处就是<code>保证了Java体系的稳定</code>，不然的话你自己定义一个<code>String</code>类的话，这样系统中就会有两个<code>String</code>类，如果没有双亲委派机制的话，系统就不知道到底该加载哪一个，这样系统就变得一片混乱了。</p>\n<h2 id=\"破坏双亲委派机制\"><a href=\"#破坏双亲委派机制\" class=\"headerlink\" title=\"破坏双亲委派机制\"></a>破坏双亲委派机制</h2><p>双亲委派机制是Java设计者推荐给开发者们的类加载实现方式，并不是一个强制性约束的模型，所以也可以人为的破坏这个机制。</p>\n<ul>\n<li>源码</li>\n</ul>\n<blockquote>\n<p>源码在<code>java.lang.ClassLoader</code>有兴趣的可以去看下</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200726212038.png\" alt></p>\n<p>可以看到，就这短短的几行代码，就实现了听起来很高大上的<code>双亲委派机制</code>，所以破坏双亲委派机制的话，就直接重写<code>loadClass</code>方法就可以了。</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"四种类加载器\"><a href=\"#四种类加载器\" class=\"headerlink\" title=\"四种类加载器\"></a>四种类加载器</h2><ul>\n<li>启动类加载器(Bootstrap Class Loader )：加载<code>$JAVA_HOME/jre/lib</code>目录下的jar包</li>\n<li>拓展类加载器(Extension Class Loader)：加载<code>$JAVA_HOME/jre/lib/ext</code>目录下的jar包</li>\n<li>应用程序类加载器(Application Class Loader)：加载<code>ClassPath</code>目录下的jar包</li>\n<li>自定义类加载器(User Class Loader)：加载自定义指定目录下的jar包</li>\n</ul>\n<h2 id=\"双亲委派机制\"><a href=\"#双亲委派机制\" class=\"headerlink\" title=\"双亲委派机制\"></a>双亲委派机制</h2><blockquote>\n<p> 如果一个类加载器收到了类加载的请求，它首先不会自己去尝试加载这个类，而是把这个请求委派给父类加载器去完成，每一个层次的类加载器都是如此，因此所有的加载请求最终都应该传送到最顶层的启动类加载器中，只有当父加载器反馈自己无法完成这个加载请求（它的搜索范围中没有找到所需的类）时，子加载器才会尝试自己去完成加载。</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200726204658.jpg\" alt></p>\n<h2 id=\"代码示例\"><a href=\"#代码示例\" class=\"headerlink\" title=\"代码示例\"></a>代码示例</h2><blockquote>\n<p>当获取<code>Bootstrap class loader</code>的时候，输出了<code>null</code>，说明<strong>开发者无法通过引用操作启动类加载器</strong></p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200726210142.png\" alt></p>\n<h2 id=\"双亲委派机制的作用\"><a href=\"#双亲委派机制的作用\" class=\"headerlink\" title=\"双亲委派机制的作用\"></a>双亲委派机制的作用</h2><p>每个加载器都只需要固定的加载自己管理范围内的类，这样的好处就是<code>保证了Java体系的稳定</code>，不然的话你自己定义一个<code>String</code>类的话，这样系统中就会有两个<code>String</code>类，如果没有双亲委派机制的话，系统就不知道到底该加载哪一个，这样系统就变得一片混乱了。</p>\n<h2 id=\"破坏双亲委派机制\"><a href=\"#破坏双亲委派机制\" class=\"headerlink\" title=\"破坏双亲委派机制\"></a>破坏双亲委派机制</h2><p>双亲委派机制是Java设计者推荐给开发者们的类加载实现方式，并不是一个强制性约束的模型，所以也可以人为的破坏这个机制。</p>\n<ul>\n<li>源码</li>\n</ul>\n<blockquote>\n<p>源码在<code>java.lang.ClassLoader</code>有兴趣的可以去看下</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200726212038.png\" alt></p>\n<p>可以看到，就这短短的几行代码，就实现了听起来很高大上的<code>双亲委派机制</code>，所以破坏双亲委派机制的话，就直接重写<code>loadClass</code>方法就可以了。</p>\n"},{"title":"Java类初始化","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-09-16T07:01:03.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n## 代码结果？\n\n首先，我们来看看下面的代码的输出的结果，可以先试着想一下\n\n![](http://cdn.mjava.top/blog/20200725004926.png)\n\n\n\n```java\n//结果\nCode\n公众号\n```\n\n这时候有同学就会想，以前不是说类加载时，静态代码块都会加载的嘛！怎么`Test1`里的静态代码块没有加载呢？下面就来看看到底怎么回事\n\n## 类的生命周期\n\n了解类加载前，首先熟悉一下类的生命周期\n\n![](http://cdn.mjava.top/blog/20200725003859.png)\n\n这里注意几个点：\n\n- `解析阶段`可以在`初始化阶段`之后，这是为了支持Java语言的运行时绑定特性（也称为`动态绑定`或`晚期绑定`）\n- 这些阶段通常都是互相交叉地混合进行的，会在一个阶段执行的过程中调用、激活另一个阶段。\n\n## 初始化和实例化\n\n我相信很多人跟我刚开始一样，搞不清他们两个的区别，搞不清`new`一个对象，到底是对这个对象进行了初始化还是实例化呢？\n\n- `初始化`：是完成程序执行前的准备工作。在这个阶段，静态的（变量，方法，代码块）会被执行。同时在会开辟一块存储空间用来存放静态的数据。初始化只在类加载的时候执行`一次`。\n\n- `实例化`：是指创建一个对象的过程。这个过程中会在堆中开辟内存，将一些非静态的方法，变量存放在里面。在程序执行的过程中，可以创建多个对象，既多次实例化。每次实例化都会开辟一块新的内存。\n\n  ![](http://cdn.mjava.top/blog/20200725183421.png)\n\n\n\n## 类的初始化\n\n《Java虚拟机规范》中并没有对`加载`进行强制约束，这点可以交给虚拟机的具体实现来自由把握。但是对于`初始化阶段`，《Java虚拟机规范》则是严格规定了有且只有`六种情况`必须立即对类进行“初始化”（而加载、验证、准备自然需要在此之前开始）：\n\n- 遇到`new`、`getstatic`、`putstatic`或`invokestatic`这四条字节码指令时，如果类型没有进行过初始化，则需要先触发其初始化阶段。那到底什么时候能够生成这些指令呢？其实看下字节码就都明白了\n\n  ![](http://cdn.mjava.top/blog/20200725172134.png)\n\n- 使用`java.lang.reflect`包的方法对类型进行`反射调用`的时候，如果类型没有进行过初始化，则需要先触发其初始化。\n- 当初始化类的时候，如果发现其`父类`还没有进行过初始化，则需要先触发其父类的初始化。\n- 当虚拟机启动时，用户需要指定一个要执行的`主类`（包含main()方法的那个类），虚拟机会先初始化这个主类。\n- 当使用JDK 7新加入的动态语言支持时，如果一个`java.lang.invoke.MethodHandle`实例最后的解析结果为`REF_getStatic`、`REF_putStatic`、`REF_invokeStatic`、`REF_newInvokeSpecial`四种类型的方法句柄，并且这个方法句柄对应的类没有进行过初始化，则需要先触发其初始化。\n- 当一个接口中定义了`JDK 8`新加入的默认方法（被`default关键字`修饰的接口方法）时，如果有这个接口的实现类发生了初始化，那该接口要在其之前被初始化。\n\n> `java.lang.invoke.MethodHandle` 是`JDK7`中新加入类似反射功能的一个类\n\n\n\n## 被动引用\n\n对于以上这六种会触发类型进行`初始化`的场景，《Java虚拟机规范》中使用了一个非常强烈的限定语——“有且只有”，这六种场景中的行为称为对一个类型进行`主动引用`。除此之外，所有引用类型的方式都不会触发初始化，称为`被动引用。`\n\n像文章一开始的代码，就属于被动引用，对于静态字段，**只有直接定义这个字段的类才会被初始化**，因此通过其子类来引用父类中定义的静态字段，只会触发父类的初始化而不会触发子类的初始化。\n\n\n\n### 例子1--对象数组\n\n直接上图\n\n![](http://cdn.mjava.top/blog/20200725184328.png)\n\n以上代码执行后并不会输出`灰色`两个字，因为创建对象数组时并没有去初始化`Test1`这个类，而是用`anewarray`字节码指令去初始化了另外一个类，它是一个由虚拟机自动生成的、直接继承于java.lang.Object的子类。\n\n\n\n> 拓展：数组越界检查没有封装在数组元素的访问类中，而是封装在数组访问的`xaload`,`xastore`字节码指令中\n\n### 例子2--final修饰的静态字段\n\n- 被`final`修饰的静态字段\n\n![](http://cdn.mjava.top/blog/20200725194122.png)\n\n此时运行该代码时，只会输出`灰色Code`字样，`Test1`并没有触发初始化阶段。这是因为在`编译阶段`通过`常量传播优化`，已经将此常量的值`灰色Code`直接存储在`ClassLoadTest`类的常量池中，所以当`ClassLoadTest`类调用`Test1`里的`value`时，都变成了对自身常量池的调用，和`Test1`类没有任何关系。\n\n\n\n- 没有`final`修饰的静态字段\n\n  ![](http://cdn.mjava.top/blog/20200725194514.png)\n\n没有使用`final`修饰的静态变量，字节码出现了`getstatic`，所以触发`Test1`的初始化阶段，此时运行结果将会输出`灰色`和`灰色Code`","source":"_posts/java/jvm/java-class-init.md","raw":"---\ntitle: Java类初始化\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-09-16 15:01:03\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- JVM\n- Java\ncategories:\n- JVM\n---\n\n\n\n## 代码结果？\n\n首先，我们来看看下面的代码的输出的结果，可以先试着想一下\n\n![](http://cdn.mjava.top/blog/20200725004926.png)\n\n\n\n```java\n//结果\nCode\n公众号\n```\n\n这时候有同学就会想，以前不是说类加载时，静态代码块都会加载的嘛！怎么`Test1`里的静态代码块没有加载呢？下面就来看看到底怎么回事\n\n## 类的生命周期\n\n了解类加载前，首先熟悉一下类的生命周期\n\n![](http://cdn.mjava.top/blog/20200725003859.png)\n\n这里注意几个点：\n\n- `解析阶段`可以在`初始化阶段`之后，这是为了支持Java语言的运行时绑定特性（也称为`动态绑定`或`晚期绑定`）\n- 这些阶段通常都是互相交叉地混合进行的，会在一个阶段执行的过程中调用、激活另一个阶段。\n\n## 初始化和实例化\n\n我相信很多人跟我刚开始一样，搞不清他们两个的区别，搞不清`new`一个对象，到底是对这个对象进行了初始化还是实例化呢？\n\n- `初始化`：是完成程序执行前的准备工作。在这个阶段，静态的（变量，方法，代码块）会被执行。同时在会开辟一块存储空间用来存放静态的数据。初始化只在类加载的时候执行`一次`。\n\n- `实例化`：是指创建一个对象的过程。这个过程中会在堆中开辟内存，将一些非静态的方法，变量存放在里面。在程序执行的过程中，可以创建多个对象，既多次实例化。每次实例化都会开辟一块新的内存。\n\n  ![](http://cdn.mjava.top/blog/20200725183421.png)\n\n\n\n## 类的初始化\n\n《Java虚拟机规范》中并没有对`加载`进行强制约束，这点可以交给虚拟机的具体实现来自由把握。但是对于`初始化阶段`，《Java虚拟机规范》则是严格规定了有且只有`六种情况`必须立即对类进行“初始化”（而加载、验证、准备自然需要在此之前开始）：\n\n- 遇到`new`、`getstatic`、`putstatic`或`invokestatic`这四条字节码指令时，如果类型没有进行过初始化，则需要先触发其初始化阶段。那到底什么时候能够生成这些指令呢？其实看下字节码就都明白了\n\n  ![](http://cdn.mjava.top/blog/20200725172134.png)\n\n- 使用`java.lang.reflect`包的方法对类型进行`反射调用`的时候，如果类型没有进行过初始化，则需要先触发其初始化。\n- 当初始化类的时候，如果发现其`父类`还没有进行过初始化，则需要先触发其父类的初始化。\n- 当虚拟机启动时，用户需要指定一个要执行的`主类`（包含main()方法的那个类），虚拟机会先初始化这个主类。\n- 当使用JDK 7新加入的动态语言支持时，如果一个`java.lang.invoke.MethodHandle`实例最后的解析结果为`REF_getStatic`、`REF_putStatic`、`REF_invokeStatic`、`REF_newInvokeSpecial`四种类型的方法句柄，并且这个方法句柄对应的类没有进行过初始化，则需要先触发其初始化。\n- 当一个接口中定义了`JDK 8`新加入的默认方法（被`default关键字`修饰的接口方法）时，如果有这个接口的实现类发生了初始化，那该接口要在其之前被初始化。\n\n> `java.lang.invoke.MethodHandle` 是`JDK7`中新加入类似反射功能的一个类\n\n\n\n## 被动引用\n\n对于以上这六种会触发类型进行`初始化`的场景，《Java虚拟机规范》中使用了一个非常强烈的限定语——“有且只有”，这六种场景中的行为称为对一个类型进行`主动引用`。除此之外，所有引用类型的方式都不会触发初始化，称为`被动引用。`\n\n像文章一开始的代码，就属于被动引用，对于静态字段，**只有直接定义这个字段的类才会被初始化**，因此通过其子类来引用父类中定义的静态字段，只会触发父类的初始化而不会触发子类的初始化。\n\n\n\n### 例子1--对象数组\n\n直接上图\n\n![](http://cdn.mjava.top/blog/20200725184328.png)\n\n以上代码执行后并不会输出`灰色`两个字，因为创建对象数组时并没有去初始化`Test1`这个类，而是用`anewarray`字节码指令去初始化了另外一个类，它是一个由虚拟机自动生成的、直接继承于java.lang.Object的子类。\n\n\n\n> 拓展：数组越界检查没有封装在数组元素的访问类中，而是封装在数组访问的`xaload`,`xastore`字节码指令中\n\n### 例子2--final修饰的静态字段\n\n- 被`final`修饰的静态字段\n\n![](http://cdn.mjava.top/blog/20200725194122.png)\n\n此时运行该代码时，只会输出`灰色Code`字样，`Test1`并没有触发初始化阶段。这是因为在`编译阶段`通过`常量传播优化`，已经将此常量的值`灰色Code`直接存储在`ClassLoadTest`类的常量池中，所以当`ClassLoadTest`类调用`Test1`里的`value`时，都变成了对自身常量池的调用，和`Test1`类没有任何关系。\n\n\n\n- 没有`final`修饰的静态字段\n\n  ![](http://cdn.mjava.top/blog/20200725194514.png)\n\n没有使用`final`修饰的静态变量，字节码出现了`getstatic`，所以触发`Test1`的初始化阶段，此时运行结果将会输出`灰色`和`灰色Code`","slug":"java/jvm/java-class-init","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bm700932mg5gufgc1of","content":"<h2 id=\"代码结果？\"><a href=\"#代码结果？\" class=\"headerlink\" title=\"代码结果？\"></a>代码结果？</h2><p>首先，我们来看看下面的代码的输出的结果，可以先试着想一下</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725004926.png\" alt></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//结果</span></span><br><span class=\"line\">Code</span><br><span class=\"line\">公众号</span><br></pre></td></tr></table></figure>\n\n<p>这时候有同学就会想，以前不是说类加载时，静态代码块都会加载的嘛！怎么<code>Test1</code>里的静态代码块没有加载呢？下面就来看看到底怎么回事</p>\n<h2 id=\"类的生命周期\"><a href=\"#类的生命周期\" class=\"headerlink\" title=\"类的生命周期\"></a>类的生命周期</h2><p>了解类加载前，首先熟悉一下类的生命周期</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725003859.png\" alt></p>\n<p>这里注意几个点：</p>\n<ul>\n<li><code>解析阶段</code>可以在<code>初始化阶段</code>之后，这是为了支持Java语言的运行时绑定特性（也称为<code>动态绑定</code>或<code>晚期绑定</code>）</li>\n<li>这些阶段通常都是互相交叉地混合进行的，会在一个阶段执行的过程中调用、激活另一个阶段。</li>\n</ul>\n<h2 id=\"初始化和实例化\"><a href=\"#初始化和实例化\" class=\"headerlink\" title=\"初始化和实例化\"></a>初始化和实例化</h2><p>我相信很多人跟我刚开始一样，搞不清他们两个的区别，搞不清<code>new</code>一个对象，到底是对这个对象进行了初始化还是实例化呢？</p>\n<ul>\n<li><p><code>初始化</code>：是完成程序执行前的准备工作。在这个阶段，静态的（变量，方法，代码块）会被执行。同时在会开辟一块存储空间用来存放静态的数据。初始化只在类加载的时候执行<code>一次</code>。</p>\n</li>\n<li><p><code>实例化</code>：是指创建一个对象的过程。这个过程中会在堆中开辟内存，将一些非静态的方法，变量存放在里面。在程序执行的过程中，可以创建多个对象，既多次实例化。每次实例化都会开辟一块新的内存。</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725183421.png\" alt></p>\n</li>\n</ul>\n<h2 id=\"类的初始化\"><a href=\"#类的初始化\" class=\"headerlink\" title=\"类的初始化\"></a>类的初始化</h2><p>《Java虚拟机规范》中并没有对<code>加载</code>进行强制约束，这点可以交给虚拟机的具体实现来自由把握。但是对于<code>初始化阶段</code>，《Java虚拟机规范》则是严格规定了有且只有<code>六种情况</code>必须立即对类进行“初始化”（而加载、验证、准备自然需要在此之前开始）：</p>\n<ul>\n<li><p>遇到<code>new</code>、<code>getstatic</code>、<code>putstatic</code>或<code>invokestatic</code>这四条字节码指令时，如果类型没有进行过初始化，则需要先触发其初始化阶段。那到底什么时候能够生成这些指令呢？其实看下字节码就都明白了</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725172134.png\" alt></p>\n</li>\n<li><p>使用<code>java.lang.reflect</code>包的方法对类型进行<code>反射调用</code>的时候，如果类型没有进行过初始化，则需要先触发其初始化。</p>\n</li>\n<li><p>当初始化类的时候，如果发现其<code>父类</code>还没有进行过初始化，则需要先触发其父类的初始化。</p>\n</li>\n<li><p>当虚拟机启动时，用户需要指定一个要执行的<code>主类</code>（包含main()方法的那个类），虚拟机会先初始化这个主类。</p>\n</li>\n<li><p>当使用JDK 7新加入的动态语言支持时，如果一个<code>java.lang.invoke.MethodHandle</code>实例最后的解析结果为<code>REF_getStatic</code>、<code>REF_putStatic</code>、<code>REF_invokeStatic</code>、<code>REF_newInvokeSpecial</code>四种类型的方法句柄，并且这个方法句柄对应的类没有进行过初始化，则需要先触发其初始化。</p>\n</li>\n<li><p>当一个接口中定义了<code>JDK 8</code>新加入的默认方法（被<code>default关键字</code>修饰的接口方法）时，如果有这个接口的实现类发生了初始化，那该接口要在其之前被初始化。</p>\n</li>\n</ul>\n<blockquote>\n<p><code>java.lang.invoke.MethodHandle</code> 是<code>JDK7</code>中新加入类似反射功能的一个类</p>\n</blockquote>\n<h2 id=\"被动引用\"><a href=\"#被动引用\" class=\"headerlink\" title=\"被动引用\"></a>被动引用</h2><p>对于以上这六种会触发类型进行<code>初始化</code>的场景，《Java虚拟机规范》中使用了一个非常强烈的限定语——“有且只有”，这六种场景中的行为称为对一个类型进行<code>主动引用</code>。除此之外，所有引用类型的方式都不会触发初始化，称为<code>被动引用。</code></p>\n<p>像文章一开始的代码，就属于被动引用，对于静态字段，<strong>只有直接定义这个字段的类才会被初始化</strong>，因此通过其子类来引用父类中定义的静态字段，只会触发父类的初始化而不会触发子类的初始化。</p>\n<h3 id=\"例子1–对象数组\"><a href=\"#例子1–对象数组\" class=\"headerlink\" title=\"例子1–对象数组\"></a>例子1–对象数组</h3><p>直接上图</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725184328.png\" alt></p>\n<p>以上代码执行后并不会输出<code>灰色</code>两个字，因为创建对象数组时并没有去初始化<code>Test1</code>这个类，而是用<code>anewarray</code>字节码指令去初始化了另外一个类，它是一个由虚拟机自动生成的、直接继承于java.lang.Object的子类。</p>\n<blockquote>\n<p>拓展：数组越界检查没有封装在数组元素的访问类中，而是封装在数组访问的<code>xaload</code>,<code>xastore</code>字节码指令中</p>\n</blockquote>\n<h3 id=\"例子2–final修饰的静态字段\"><a href=\"#例子2–final修饰的静态字段\" class=\"headerlink\" title=\"例子2–final修饰的静态字段\"></a>例子2–final修饰的静态字段</h3><ul>\n<li>被<code>final</code>修饰的静态字段</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200725194122.png\" alt></p>\n<p>此时运行该代码时，只会输出<code>灰色Code</code>字样，<code>Test1</code>并没有触发初始化阶段。这是因为在<code>编译阶段</code>通过<code>常量传播优化</code>，已经将此常量的值<code>灰色Code</code>直接存储在<code>ClassLoadTest</code>类的常量池中，所以当<code>ClassLoadTest</code>类调用<code>Test1</code>里的<code>value</code>时，都变成了对自身常量池的调用，和<code>Test1</code>类没有任何关系。</p>\n<ul>\n<li><p>没有<code>final</code>修饰的静态字段</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725194514.png\" alt></p>\n</li>\n</ul>\n<p>没有使用<code>final</code>修饰的静态变量，字节码出现了<code>getstatic</code>，所以触发<code>Test1</code>的初始化阶段，此时运行结果将会输出<code>灰色</code>和<code>灰色Code</code></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"代码结果？\"><a href=\"#代码结果？\" class=\"headerlink\" title=\"代码结果？\"></a>代码结果？</h2><p>首先，我们来看看下面的代码的输出的结果，可以先试着想一下</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725004926.png\" alt></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//结果</span></span><br><span class=\"line\">Code</span><br><span class=\"line\">公众号</span><br></pre></td></tr></table></figure>\n\n<p>这时候有同学就会想，以前不是说类加载时，静态代码块都会加载的嘛！怎么<code>Test1</code>里的静态代码块没有加载呢？下面就来看看到底怎么回事</p>\n<h2 id=\"类的生命周期\"><a href=\"#类的生命周期\" class=\"headerlink\" title=\"类的生命周期\"></a>类的生命周期</h2><p>了解类加载前，首先熟悉一下类的生命周期</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725003859.png\" alt></p>\n<p>这里注意几个点：</p>\n<ul>\n<li><code>解析阶段</code>可以在<code>初始化阶段</code>之后，这是为了支持Java语言的运行时绑定特性（也称为<code>动态绑定</code>或<code>晚期绑定</code>）</li>\n<li>这些阶段通常都是互相交叉地混合进行的，会在一个阶段执行的过程中调用、激活另一个阶段。</li>\n</ul>\n<h2 id=\"初始化和实例化\"><a href=\"#初始化和实例化\" class=\"headerlink\" title=\"初始化和实例化\"></a>初始化和实例化</h2><p>我相信很多人跟我刚开始一样，搞不清他们两个的区别，搞不清<code>new</code>一个对象，到底是对这个对象进行了初始化还是实例化呢？</p>\n<ul>\n<li><p><code>初始化</code>：是完成程序执行前的准备工作。在这个阶段，静态的（变量，方法，代码块）会被执行。同时在会开辟一块存储空间用来存放静态的数据。初始化只在类加载的时候执行<code>一次</code>。</p>\n</li>\n<li><p><code>实例化</code>：是指创建一个对象的过程。这个过程中会在堆中开辟内存，将一些非静态的方法，变量存放在里面。在程序执行的过程中，可以创建多个对象，既多次实例化。每次实例化都会开辟一块新的内存。</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725183421.png\" alt></p>\n</li>\n</ul>\n<h2 id=\"类的初始化\"><a href=\"#类的初始化\" class=\"headerlink\" title=\"类的初始化\"></a>类的初始化</h2><p>《Java虚拟机规范》中并没有对<code>加载</code>进行强制约束，这点可以交给虚拟机的具体实现来自由把握。但是对于<code>初始化阶段</code>，《Java虚拟机规范》则是严格规定了有且只有<code>六种情况</code>必须立即对类进行“初始化”（而加载、验证、准备自然需要在此之前开始）：</p>\n<ul>\n<li><p>遇到<code>new</code>、<code>getstatic</code>、<code>putstatic</code>或<code>invokestatic</code>这四条字节码指令时，如果类型没有进行过初始化，则需要先触发其初始化阶段。那到底什么时候能够生成这些指令呢？其实看下字节码就都明白了</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725172134.png\" alt></p>\n</li>\n<li><p>使用<code>java.lang.reflect</code>包的方法对类型进行<code>反射调用</code>的时候，如果类型没有进行过初始化，则需要先触发其初始化。</p>\n</li>\n<li><p>当初始化类的时候，如果发现其<code>父类</code>还没有进行过初始化，则需要先触发其父类的初始化。</p>\n</li>\n<li><p>当虚拟机启动时，用户需要指定一个要执行的<code>主类</code>（包含main()方法的那个类），虚拟机会先初始化这个主类。</p>\n</li>\n<li><p>当使用JDK 7新加入的动态语言支持时，如果一个<code>java.lang.invoke.MethodHandle</code>实例最后的解析结果为<code>REF_getStatic</code>、<code>REF_putStatic</code>、<code>REF_invokeStatic</code>、<code>REF_newInvokeSpecial</code>四种类型的方法句柄，并且这个方法句柄对应的类没有进行过初始化，则需要先触发其初始化。</p>\n</li>\n<li><p>当一个接口中定义了<code>JDK 8</code>新加入的默认方法（被<code>default关键字</code>修饰的接口方法）时，如果有这个接口的实现类发生了初始化，那该接口要在其之前被初始化。</p>\n</li>\n</ul>\n<blockquote>\n<p><code>java.lang.invoke.MethodHandle</code> 是<code>JDK7</code>中新加入类似反射功能的一个类</p>\n</blockquote>\n<h2 id=\"被动引用\"><a href=\"#被动引用\" class=\"headerlink\" title=\"被动引用\"></a>被动引用</h2><p>对于以上这六种会触发类型进行<code>初始化</code>的场景，《Java虚拟机规范》中使用了一个非常强烈的限定语——“有且只有”，这六种场景中的行为称为对一个类型进行<code>主动引用</code>。除此之外，所有引用类型的方式都不会触发初始化，称为<code>被动引用。</code></p>\n<p>像文章一开始的代码，就属于被动引用，对于静态字段，<strong>只有直接定义这个字段的类才会被初始化</strong>，因此通过其子类来引用父类中定义的静态字段，只会触发父类的初始化而不会触发子类的初始化。</p>\n<h3 id=\"例子1–对象数组\"><a href=\"#例子1–对象数组\" class=\"headerlink\" title=\"例子1–对象数组\"></a>例子1–对象数组</h3><p>直接上图</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725184328.png\" alt></p>\n<p>以上代码执行后并不会输出<code>灰色</code>两个字，因为创建对象数组时并没有去初始化<code>Test1</code>这个类，而是用<code>anewarray</code>字节码指令去初始化了另外一个类，它是一个由虚拟机自动生成的、直接继承于java.lang.Object的子类。</p>\n<blockquote>\n<p>拓展：数组越界检查没有封装在数组元素的访问类中，而是封装在数组访问的<code>xaload</code>,<code>xastore</code>字节码指令中</p>\n</blockquote>\n<h3 id=\"例子2–final修饰的静态字段\"><a href=\"#例子2–final修饰的静态字段\" class=\"headerlink\" title=\"例子2–final修饰的静态字段\"></a>例子2–final修饰的静态字段</h3><ul>\n<li>被<code>final</code>修饰的静态字段</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200725194122.png\" alt></p>\n<p>此时运行该代码时，只会输出<code>灰色Code</code>字样，<code>Test1</code>并没有触发初始化阶段。这是因为在<code>编译阶段</code>通过<code>常量传播优化</code>，已经将此常量的值<code>灰色Code</code>直接存储在<code>ClassLoadTest</code>类的常量池中，所以当<code>ClassLoadTest</code>类调用<code>Test1</code>里的<code>value</code>时，都变成了对自身常量池的调用，和<code>Test1</code>类没有任何关系。</p>\n<ul>\n<li><p>没有<code>final</code>修饰的静态字段</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200725194514.png\" alt></p>\n</li>\n</ul>\n<p>没有使用<code>final</code>修饰的静态变量，字节码出现了<code>getstatic</code>，所以触发<code>Test1</code>的初始化阶段，此时运行结果将会输出<code>灰色</code>和<code>灰色Code</code></p>\n"},{"title":"JVM运行时栈帧","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-09-16T07:06:15.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n在JVM中，每个线程都包含n个栈帧，每一个栈帧都包括了局部变量表、操作数栈、动态连接、方法返回地址和一些额外的附加信息。\n\n栈帧的生命周期**随着方法的创建而创建，随着方法的结束而销毁，无论方法是正常完成还是异常完成（抛出了在方法内未被捕获的异常）都算方法的结束。**\n\n在某条线程执行过程中的某个时间点上，只有目前正在执行的那个方法的栈帧是活动的。这个栈帧称为**当前栈帧**，这个栈帧对应的方法称为**当前方法**，定义这个方法的类称为**当前类**。**对局部变量表和操作数栈的各种操作，通常都指的是对当前栈帧的局部变量表和操作数栈所进行的操作。**\n\n> **注意:**栈帧是线程本地私有的数据，不可能在一个栈帧 之中引用另外一个线程的栈帧\n\n![](http://cdn.mjava.top/blog/20200731162235.jpg)\n\n\n\n\n\n## 局部变量表\n\n`局部变量表（Local Variables Table）`是一组**变量值**的存储空间，用于存放**方法参数**和**方法内部定义的局部变量**。\n\n### 存储方法\n\n局部变量表的容量以`变量槽（Variable Slot）`为最小单位，一般在虚拟机中，一个Slot占用**32位**存储空间(这不是固定的，虚拟机可以自行改变每个槽占用空间的大小,但一般都是32位)。\n\nJava虚拟机通过**索引定位**的方式使用局部变量表，索引值的范围是从`0`开始至局部变量表最大的变量槽数量。如果访问的是32位数据类型的变量，索引N就代表了使用第N个变量槽，如果访问的是64位数据类型的变量，则说明会同时使用第N和N+1两个变量槽。\n\n#### eg:\n\n在Java中，`long`在内存占64位，所以局部变量表**用2个slot来存储**\n\n![](http://cdn.mjava.top/blog/20200730225516.png)\n\n\n\n对于两个相邻的共同存放一个64位数据的两个变量槽，虚拟机**不允许采用任何方式单独访问其中的某一个**，《Java虚拟机规范》中明确要求了如果遇到进行这种操作的字节码序列，虚拟机就应该在类加载的校验阶段中抛出异常。\n\n### long和double的非原子性协定\n\n> 在Java内存模型中，对于64位的数据类型（long和double），在模型中特别定义了一条宽松的规定：**允许虚拟机将没有被volatile修饰的64位数据的读写操作划分为两次32位的操作来进行**，即允许虚拟机实现自行选择是否要保证64位数据类型的load、store、read和write这四个操作的原子性，这就是所谓的**“long和double的非原子性协定”（Non-Atomic Treatment of doubleand long Variables）**。\n\n虽然有这个协定，**但是**，由于`局部变量表(Local Variable Table)`是建立在线程堆栈中的，属于**线程私有的数据**，无论读写两个连续的变量槽是否为原子操作，都**不会引起数据竞争和线程安全问题**。\n\n### 初始值问题\n\n我们已经知道**类的字段变量**有两次赋初始值的过程，一次在**准备阶段**，赋予系统初始值；另外一次在**初始化阶段**，赋予程序员定义的初始值。\n\n但**局部变量就不一样**了，如果一个局部变量定义了但**没有赋初始值**，那它是**完全不能使用**的。所以不要认为Java中任何情况下都存在诸如整型变量默认为0、布尔型变量默认为false等这样的默认值规则。\n\n#### eg：\n\n```java\n// 这个方法会报：\n// Error:(12, 28) java: variable y might not have been initialized\npublic class JVMTest {\n    public static void main(String[] args) {\n        int y;\n        int z=3;\n        System.out.println(y+z);\n    }\n}\n\n\n// 这个会正常输出 3； 因为int的初始值为0\npublic class JVMTest {\n    private static int y;\n    public static void main(String[] args) {\n        int z=3;\n        System.out.println(y+z);\n    }\n}\n```\n\n\n\n\n\n## 操作数栈\n\n`操作数栈（Operand Stack）`也常被称为`操作栈`，它是一个后入先出（Last In First Out，LIFO）栈。同局部变量表一样，操作数栈的最大深度也在编译的时候被写入到Code属性的`max_stacks`数据项之中。操作数栈的每一个元素都可以是包括long和double在内的任意Java数据类型。32位数据类型所占的栈容量为1，64位数据类型所占的栈容量为2。Javac编译器的数据流分析工作保证了在方法执行的任何时候，操作数栈的深度都不会超过在`max_stacks`数据项中设定的最大值。\n\n### eg:\n\n```java\npublic class JVMTest {\n    public static void main(String[] args) {\n        long y=9223372036854775800L;\n        int z=2;\n        long x=y+z;\n    }\n}\n```\n\n我们用`javap -verbose JVMTest`来查看他的`class`文件的字节码指令\n\n![](http://cdn.mjava.top/blog/20200730235131.png)\n\n**在操作栈中的流程大致为：**\n\n![](http://cdn.mjava.top/blog/20200731105247.jpg)\n\n## 动态链接\n\n每个栈帧都包含一个指向当前方法所在类型的`运行时常量池`的引用，持有这个引用是为了支持`方法调用`过程中的`动态连接（Dynamic Linking）`。在`Class`文件里，一个方法若要调用其他方法，或者访问成员变量，则需要通过`符号引用(symolic reference)`来表示，`动态链接`的作用就是将这些以`符号引用`所表示的方法转换为实际方法的直接引用。\n\n### 什么是符号引用？\n\n![](http://cdn.mjava.top/blog/20200731110742.png)\n\n通过查看字节码，上面的`#7`，`#8`，`#9`等等都是符号引用，他在class文件里只是个符号，就像你定义一个变量名称一样，变量名只是和`字符符号`，并不是真正的指向内存的地址指针。这些符号都指向`运行时常量池`的引用。\n\n## 方法返回地址\n\nJava在调用方法时，只有两种返回方法，一种是`正常返回`，一种是`异常返回`。\n\n### 正常返回\n\n正常返回指的就是在执行方法时，中间并没有异常抛出，或者已正确处理抛出的异常，这时就称当前`方法正常调用完成`，如果有返回值，就会给他调用者返回一个值，如果没有返回值(`void`)就正常返回。\n\n这种场景下，当前栈帧承担着恢复调用者状态的责任，**包括恢复调用者的局部变量表和操作数栈，以及正确递增程序计数器，以跳过刚才执行的调用方法指令等。**调用者的代码在被调用方法的返回值压入调用者栈帧的操作数栈后，会正常执行。\n\n### 异常返回\n\n在调用一些方法时，一些异常没有被正确捕获，就会导致方法终止，此时称`方法异常调用完成`，那一定不会有方法返回值返回给其调用者。\n\n无论采用何种退出方式，在方法退出之后，都**必须返回到最初方法被调用时的位置**，程序才能继续执行，方法返回时可能需要在栈帧中保存一些信息，用来帮助恢复它的上层主调方法的执行状态。\n\n怎么理解这个**必须返回到最初方法被调用时的位置**呢？\n\neg:\n\n![](http://cdn.mjava.top/blog/20200731164803.png)\n\n上面异常是在`13行`发生的，但是它并没有停在`13行`，而是回到了最初调用它`第10行`的位置。","source":"_posts/java/jvm/java-jvm-stack-1.md","raw":"---\ntitle: JVM运行时栈帧\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-09-16 15:06:15\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- JVM\n- Java\ncategories:\n- JVM\n---\n\n\n\n在JVM中，每个线程都包含n个栈帧，每一个栈帧都包括了局部变量表、操作数栈、动态连接、方法返回地址和一些额外的附加信息。\n\n栈帧的生命周期**随着方法的创建而创建，随着方法的结束而销毁，无论方法是正常完成还是异常完成（抛出了在方法内未被捕获的异常）都算方法的结束。**\n\n在某条线程执行过程中的某个时间点上，只有目前正在执行的那个方法的栈帧是活动的。这个栈帧称为**当前栈帧**，这个栈帧对应的方法称为**当前方法**，定义这个方法的类称为**当前类**。**对局部变量表和操作数栈的各种操作，通常都指的是对当前栈帧的局部变量表和操作数栈所进行的操作。**\n\n> **注意:**栈帧是线程本地私有的数据，不可能在一个栈帧 之中引用另外一个线程的栈帧\n\n![](http://cdn.mjava.top/blog/20200731162235.jpg)\n\n\n\n\n\n## 局部变量表\n\n`局部变量表（Local Variables Table）`是一组**变量值**的存储空间，用于存放**方法参数**和**方法内部定义的局部变量**。\n\n### 存储方法\n\n局部变量表的容量以`变量槽（Variable Slot）`为最小单位，一般在虚拟机中，一个Slot占用**32位**存储空间(这不是固定的，虚拟机可以自行改变每个槽占用空间的大小,但一般都是32位)。\n\nJava虚拟机通过**索引定位**的方式使用局部变量表，索引值的范围是从`0`开始至局部变量表最大的变量槽数量。如果访问的是32位数据类型的变量，索引N就代表了使用第N个变量槽，如果访问的是64位数据类型的变量，则说明会同时使用第N和N+1两个变量槽。\n\n#### eg:\n\n在Java中，`long`在内存占64位，所以局部变量表**用2个slot来存储**\n\n![](http://cdn.mjava.top/blog/20200730225516.png)\n\n\n\n对于两个相邻的共同存放一个64位数据的两个变量槽，虚拟机**不允许采用任何方式单独访问其中的某一个**，《Java虚拟机规范》中明确要求了如果遇到进行这种操作的字节码序列，虚拟机就应该在类加载的校验阶段中抛出异常。\n\n### long和double的非原子性协定\n\n> 在Java内存模型中，对于64位的数据类型（long和double），在模型中特别定义了一条宽松的规定：**允许虚拟机将没有被volatile修饰的64位数据的读写操作划分为两次32位的操作来进行**，即允许虚拟机实现自行选择是否要保证64位数据类型的load、store、read和write这四个操作的原子性，这就是所谓的**“long和double的非原子性协定”（Non-Atomic Treatment of doubleand long Variables）**。\n\n虽然有这个协定，**但是**，由于`局部变量表(Local Variable Table)`是建立在线程堆栈中的，属于**线程私有的数据**，无论读写两个连续的变量槽是否为原子操作，都**不会引起数据竞争和线程安全问题**。\n\n### 初始值问题\n\n我们已经知道**类的字段变量**有两次赋初始值的过程，一次在**准备阶段**，赋予系统初始值；另外一次在**初始化阶段**，赋予程序员定义的初始值。\n\n但**局部变量就不一样**了，如果一个局部变量定义了但**没有赋初始值**，那它是**完全不能使用**的。所以不要认为Java中任何情况下都存在诸如整型变量默认为0、布尔型变量默认为false等这样的默认值规则。\n\n#### eg：\n\n```java\n// 这个方法会报：\n// Error:(12, 28) java: variable y might not have been initialized\npublic class JVMTest {\n    public static void main(String[] args) {\n        int y;\n        int z=3;\n        System.out.println(y+z);\n    }\n}\n\n\n// 这个会正常输出 3； 因为int的初始值为0\npublic class JVMTest {\n    private static int y;\n    public static void main(String[] args) {\n        int z=3;\n        System.out.println(y+z);\n    }\n}\n```\n\n\n\n\n\n## 操作数栈\n\n`操作数栈（Operand Stack）`也常被称为`操作栈`，它是一个后入先出（Last In First Out，LIFO）栈。同局部变量表一样，操作数栈的最大深度也在编译的时候被写入到Code属性的`max_stacks`数据项之中。操作数栈的每一个元素都可以是包括long和double在内的任意Java数据类型。32位数据类型所占的栈容量为1，64位数据类型所占的栈容量为2。Javac编译器的数据流分析工作保证了在方法执行的任何时候，操作数栈的深度都不会超过在`max_stacks`数据项中设定的最大值。\n\n### eg:\n\n```java\npublic class JVMTest {\n    public static void main(String[] args) {\n        long y=9223372036854775800L;\n        int z=2;\n        long x=y+z;\n    }\n}\n```\n\n我们用`javap -verbose JVMTest`来查看他的`class`文件的字节码指令\n\n![](http://cdn.mjava.top/blog/20200730235131.png)\n\n**在操作栈中的流程大致为：**\n\n![](http://cdn.mjava.top/blog/20200731105247.jpg)\n\n## 动态链接\n\n每个栈帧都包含一个指向当前方法所在类型的`运行时常量池`的引用，持有这个引用是为了支持`方法调用`过程中的`动态连接（Dynamic Linking）`。在`Class`文件里，一个方法若要调用其他方法，或者访问成员变量，则需要通过`符号引用(symolic reference)`来表示，`动态链接`的作用就是将这些以`符号引用`所表示的方法转换为实际方法的直接引用。\n\n### 什么是符号引用？\n\n![](http://cdn.mjava.top/blog/20200731110742.png)\n\n通过查看字节码，上面的`#7`，`#8`，`#9`等等都是符号引用，他在class文件里只是个符号，就像你定义一个变量名称一样，变量名只是和`字符符号`，并不是真正的指向内存的地址指针。这些符号都指向`运行时常量池`的引用。\n\n## 方法返回地址\n\nJava在调用方法时，只有两种返回方法，一种是`正常返回`，一种是`异常返回`。\n\n### 正常返回\n\n正常返回指的就是在执行方法时，中间并没有异常抛出，或者已正确处理抛出的异常，这时就称当前`方法正常调用完成`，如果有返回值，就会给他调用者返回一个值，如果没有返回值(`void`)就正常返回。\n\n这种场景下，当前栈帧承担着恢复调用者状态的责任，**包括恢复调用者的局部变量表和操作数栈，以及正确递增程序计数器，以跳过刚才执行的调用方法指令等。**调用者的代码在被调用方法的返回值压入调用者栈帧的操作数栈后，会正常执行。\n\n### 异常返回\n\n在调用一些方法时，一些异常没有被正确捕获，就会导致方法终止，此时称`方法异常调用完成`，那一定不会有方法返回值返回给其调用者。\n\n无论采用何种退出方式，在方法退出之后，都**必须返回到最初方法被调用时的位置**，程序才能继续执行，方法返回时可能需要在栈帧中保存一些信息，用来帮助恢复它的上层主调方法的执行状态。\n\n怎么理解这个**必须返回到最初方法被调用时的位置**呢？\n\neg:\n\n![](http://cdn.mjava.top/blog/20200731164803.png)\n\n上面异常是在`13行`发生的，但是它并没有停在`13行`，而是回到了最初调用它`第10行`的位置。","slug":"java/jvm/java-jvm-stack-1","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bm800962mg58xp80sg6","content":"<p>在JVM中，每个线程都包含n个栈帧，每一个栈帧都包括了局部变量表、操作数栈、动态连接、方法返回地址和一些额外的附加信息。</p>\n<p>栈帧的生命周期<strong>随着方法的创建而创建，随着方法的结束而销毁，无论方法是正常完成还是异常完成（抛出了在方法内未被捕获的异常）都算方法的结束。</strong></p>\n<p>在某条线程执行过程中的某个时间点上，只有目前正在执行的那个方法的栈帧是活动的。这个栈帧称为<strong>当前栈帧</strong>，这个栈帧对应的方法称为<strong>当前方法</strong>，定义这个方法的类称为<strong>当前类</strong>。<strong>对局部变量表和操作数栈的各种操作，通常都指的是对当前栈帧的局部变量表和操作数栈所进行的操作。</strong></p>\n<blockquote>\n<p><strong>注意:</strong>栈帧是线程本地私有的数据，不可能在一个栈帧 之中引用另外一个线程的栈帧</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200731162235.jpg\" alt></p>\n<h2 id=\"局部变量表\"><a href=\"#局部变量表\" class=\"headerlink\" title=\"局部变量表\"></a>局部变量表</h2><p><code>局部变量表（Local Variables Table）</code>是一组<strong>变量值</strong>的存储空间，用于存放<strong>方法参数</strong>和<strong>方法内部定义的局部变量</strong>。</p>\n<h3 id=\"存储方法\"><a href=\"#存储方法\" class=\"headerlink\" title=\"存储方法\"></a>存储方法</h3><p>局部变量表的容量以<code>变量槽（Variable Slot）</code>为最小单位，一般在虚拟机中，一个Slot占用<strong>32位</strong>存储空间(这不是固定的，虚拟机可以自行改变每个槽占用空间的大小,但一般都是32位)。</p>\n<p>Java虚拟机通过<strong>索引定位</strong>的方式使用局部变量表，索引值的范围是从<code>0</code>开始至局部变量表最大的变量槽数量。如果访问的是32位数据类型的变量，索引N就代表了使用第N个变量槽，如果访问的是64位数据类型的变量，则说明会同时使用第N和N+1两个变量槽。</p>\n<h4 id=\"eg\"><a href=\"#eg\" class=\"headerlink\" title=\"eg:\"></a>eg:</h4><p>在Java中，<code>long</code>在内存占64位，所以局部变量表<strong>用2个slot来存储</strong></p>\n<p><img src=\"http://cdn.mjava.top/blog/20200730225516.png\" alt></p>\n<p>对于两个相邻的共同存放一个64位数据的两个变量槽，虚拟机<strong>不允许采用任何方式单独访问其中的某一个</strong>，《Java虚拟机规范》中明确要求了如果遇到进行这种操作的字节码序列，虚拟机就应该在类加载的校验阶段中抛出异常。</p>\n<h3 id=\"long和double的非原子性协定\"><a href=\"#long和double的非原子性协定\" class=\"headerlink\" title=\"long和double的非原子性协定\"></a>long和double的非原子性协定</h3><blockquote>\n<p>在Java内存模型中，对于64位的数据类型（long和double），在模型中特别定义了一条宽松的规定：<strong>允许虚拟机将没有被volatile修饰的64位数据的读写操作划分为两次32位的操作来进行</strong>，即允许虚拟机实现自行选择是否要保证64位数据类型的load、store、read和write这四个操作的原子性，这就是所谓的<strong>“long和double的非原子性协定”（Non-Atomic Treatment of doubleand long Variables）</strong>。</p>\n</blockquote>\n<p>虽然有这个协定，<strong>但是</strong>，由于<code>局部变量表(Local Variable Table)</code>是建立在线程堆栈中的，属于<strong>线程私有的数据</strong>，无论读写两个连续的变量槽是否为原子操作，都<strong>不会引起数据竞争和线程安全问题</strong>。</p>\n<h3 id=\"初始值问题\"><a href=\"#初始值问题\" class=\"headerlink\" title=\"初始值问题\"></a>初始值问题</h3><p>我们已经知道<strong>类的字段变量</strong>有两次赋初始值的过程，一次在<strong>准备阶段</strong>，赋予系统初始值；另外一次在<strong>初始化阶段</strong>，赋予程序员定义的初始值。</p>\n<p>但<strong>局部变量就不一样</strong>了，如果一个局部变量定义了但<strong>没有赋初始值</strong>，那它是<strong>完全不能使用</strong>的。所以不要认为Java中任何情况下都存在诸如整型变量默认为0、布尔型变量默认为false等这样的默认值规则。</p>\n<h4 id=\"eg：\"><a href=\"#eg：\" class=\"headerlink\" title=\"eg：\"></a>eg：</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 这个方法会报：</span></span><br><span class=\"line\"><span class=\"comment\">// Error:(12, 28) java: variable y might not have been initialized</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JVMTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> y;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> z=<span class=\"number\">3</span>;</span><br><span class=\"line\">        System.out.println(y+z);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 这个会正常输出 3； 因为int的初始值为0</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JVMTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> y;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> z=<span class=\"number\">3</span>;</span><br><span class=\"line\">        System.out.println(y+z);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"操作数栈\"><a href=\"#操作数栈\" class=\"headerlink\" title=\"操作数栈\"></a>操作数栈</h2><p><code>操作数栈（Operand Stack）</code>也常被称为<code>操作栈</code>，它是一个后入先出（Last In First Out，LIFO）栈。同局部变量表一样，操作数栈的最大深度也在编译的时候被写入到Code属性的<code>max_stacks</code>数据项之中。操作数栈的每一个元素都可以是包括long和double在内的任意Java数据类型。32位数据类型所占的栈容量为1，64位数据类型所占的栈容量为2。Javac编译器的数据流分析工作保证了在方法执行的任何时候，操作数栈的深度都不会超过在<code>max_stacks</code>数据项中设定的最大值。</p>\n<h3 id=\"eg-1\"><a href=\"#eg-1\" class=\"headerlink\" title=\"eg:\"></a>eg:</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JVMTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> y=<span class=\"number\">9223372036854775800L</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> z=<span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> x=y+z;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>我们用<code>javap -verbose JVMTest</code>来查看他的<code>class</code>文件的字节码指令</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200730235131.png\" alt></p>\n<p><strong>在操作栈中的流程大致为：</strong></p>\n<p><img src=\"http://cdn.mjava.top/blog/20200731105247.jpg\" alt></p>\n<h2 id=\"动态链接\"><a href=\"#动态链接\" class=\"headerlink\" title=\"动态链接\"></a>动态链接</h2><p>每个栈帧都包含一个指向当前方法所在类型的<code>运行时常量池</code>的引用，持有这个引用是为了支持<code>方法调用</code>过程中的<code>动态连接（Dynamic Linking）</code>。在<code>Class</code>文件里，一个方法若要调用其他方法，或者访问成员变量，则需要通过<code>符号引用(symolic reference)</code>来表示，<code>动态链接</code>的作用就是将这些以<code>符号引用</code>所表示的方法转换为实际方法的直接引用。</p>\n<h3 id=\"什么是符号引用？\"><a href=\"#什么是符号引用？\" class=\"headerlink\" title=\"什么是符号引用？\"></a>什么是符号引用？</h3><p><img src=\"http://cdn.mjava.top/blog/20200731110742.png\" alt></p>\n<p>通过查看字节码，上面的<code>#7</code>，<code>#8</code>，<code>#9</code>等等都是符号引用，他在class文件里只是个符号，就像你定义一个变量名称一样，变量名只是和<code>字符符号</code>，并不是真正的指向内存的地址指针。这些符号都指向<code>运行时常量池</code>的引用。</p>\n<h2 id=\"方法返回地址\"><a href=\"#方法返回地址\" class=\"headerlink\" title=\"方法返回地址\"></a>方法返回地址</h2><p>Java在调用方法时，只有两种返回方法，一种是<code>正常返回</code>，一种是<code>异常返回</code>。</p>\n<h3 id=\"正常返回\"><a href=\"#正常返回\" class=\"headerlink\" title=\"正常返回\"></a>正常返回</h3><p>正常返回指的就是在执行方法时，中间并没有异常抛出，或者已正确处理抛出的异常，这时就称当前<code>方法正常调用完成</code>，如果有返回值，就会给他调用者返回一个值，如果没有返回值(<code>void</code>)就正常返回。</p>\n<p>这种场景下，当前栈帧承担着恢复调用者状态的责任，<strong>包括恢复调用者的局部变量表和操作数栈，以及正确递增程序计数器，以跳过刚才执行的调用方法指令等。</strong>调用者的代码在被调用方法的返回值压入调用者栈帧的操作数栈后，会正常执行。</p>\n<h3 id=\"异常返回\"><a href=\"#异常返回\" class=\"headerlink\" title=\"异常返回\"></a>异常返回</h3><p>在调用一些方法时，一些异常没有被正确捕获，就会导致方法终止，此时称<code>方法异常调用完成</code>，那一定不会有方法返回值返回给其调用者。</p>\n<p>无论采用何种退出方式，在方法退出之后，都<strong>必须返回到最初方法被调用时的位置</strong>，程序才能继续执行，方法返回时可能需要在栈帧中保存一些信息，用来帮助恢复它的上层主调方法的执行状态。</p>\n<p>怎么理解这个<strong>必须返回到最初方法被调用时的位置</strong>呢？</p>\n<p>eg:</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200731164803.png\" alt></p>\n<p>上面异常是在<code>13行</code>发生的，但是它并没有停在<code>13行</code>，而是回到了最初调用它<code>第10行</code>的位置。</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p>在JVM中，每个线程都包含n个栈帧，每一个栈帧都包括了局部变量表、操作数栈、动态连接、方法返回地址和一些额外的附加信息。</p>\n<p>栈帧的生命周期<strong>随着方法的创建而创建，随着方法的结束而销毁，无论方法是正常完成还是异常完成（抛出了在方法内未被捕获的异常）都算方法的结束。</strong></p>\n<p>在某条线程执行过程中的某个时间点上，只有目前正在执行的那个方法的栈帧是活动的。这个栈帧称为<strong>当前栈帧</strong>，这个栈帧对应的方法称为<strong>当前方法</strong>，定义这个方法的类称为<strong>当前类</strong>。<strong>对局部变量表和操作数栈的各种操作，通常都指的是对当前栈帧的局部变量表和操作数栈所进行的操作。</strong></p>\n<blockquote>\n<p><strong>注意:</strong>栈帧是线程本地私有的数据，不可能在一个栈帧 之中引用另外一个线程的栈帧</p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200731162235.jpg\" alt></p>\n<h2 id=\"局部变量表\"><a href=\"#局部变量表\" class=\"headerlink\" title=\"局部变量表\"></a>局部变量表</h2><p><code>局部变量表（Local Variables Table）</code>是一组<strong>变量值</strong>的存储空间，用于存放<strong>方法参数</strong>和<strong>方法内部定义的局部变量</strong>。</p>\n<h3 id=\"存储方法\"><a href=\"#存储方法\" class=\"headerlink\" title=\"存储方法\"></a>存储方法</h3><p>局部变量表的容量以<code>变量槽（Variable Slot）</code>为最小单位，一般在虚拟机中，一个Slot占用<strong>32位</strong>存储空间(这不是固定的，虚拟机可以自行改变每个槽占用空间的大小,但一般都是32位)。</p>\n<p>Java虚拟机通过<strong>索引定位</strong>的方式使用局部变量表，索引值的范围是从<code>0</code>开始至局部变量表最大的变量槽数量。如果访问的是32位数据类型的变量，索引N就代表了使用第N个变量槽，如果访问的是64位数据类型的变量，则说明会同时使用第N和N+1两个变量槽。</p>\n<h4 id=\"eg\"><a href=\"#eg\" class=\"headerlink\" title=\"eg:\"></a>eg:</h4><p>在Java中，<code>long</code>在内存占64位，所以局部变量表<strong>用2个slot来存储</strong></p>\n<p><img src=\"http://cdn.mjava.top/blog/20200730225516.png\" alt></p>\n<p>对于两个相邻的共同存放一个64位数据的两个变量槽，虚拟机<strong>不允许采用任何方式单独访问其中的某一个</strong>，《Java虚拟机规范》中明确要求了如果遇到进行这种操作的字节码序列，虚拟机就应该在类加载的校验阶段中抛出异常。</p>\n<h3 id=\"long和double的非原子性协定\"><a href=\"#long和double的非原子性协定\" class=\"headerlink\" title=\"long和double的非原子性协定\"></a>long和double的非原子性协定</h3><blockquote>\n<p>在Java内存模型中，对于64位的数据类型（long和double），在模型中特别定义了一条宽松的规定：<strong>允许虚拟机将没有被volatile修饰的64位数据的读写操作划分为两次32位的操作来进行</strong>，即允许虚拟机实现自行选择是否要保证64位数据类型的load、store、read和write这四个操作的原子性，这就是所谓的<strong>“long和double的非原子性协定”（Non-Atomic Treatment of doubleand long Variables）</strong>。</p>\n</blockquote>\n<p>虽然有这个协定，<strong>但是</strong>，由于<code>局部变量表(Local Variable Table)</code>是建立在线程堆栈中的，属于<strong>线程私有的数据</strong>，无论读写两个连续的变量槽是否为原子操作，都<strong>不会引起数据竞争和线程安全问题</strong>。</p>\n<h3 id=\"初始值问题\"><a href=\"#初始值问题\" class=\"headerlink\" title=\"初始值问题\"></a>初始值问题</h3><p>我们已经知道<strong>类的字段变量</strong>有两次赋初始值的过程，一次在<strong>准备阶段</strong>，赋予系统初始值；另外一次在<strong>初始化阶段</strong>，赋予程序员定义的初始值。</p>\n<p>但<strong>局部变量就不一样</strong>了，如果一个局部变量定义了但<strong>没有赋初始值</strong>，那它是<strong>完全不能使用</strong>的。所以不要认为Java中任何情况下都存在诸如整型变量默认为0、布尔型变量默认为false等这样的默认值规则。</p>\n<h4 id=\"eg：\"><a href=\"#eg：\" class=\"headerlink\" title=\"eg：\"></a>eg：</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 这个方法会报：</span></span><br><span class=\"line\"><span class=\"comment\">// Error:(12, 28) java: variable y might not have been initialized</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JVMTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> y;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> z=<span class=\"number\">3</span>;</span><br><span class=\"line\">        System.out.println(y+z);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 这个会正常输出 3； 因为int的初始值为0</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JVMTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span> y;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> z=<span class=\"number\">3</span>;</span><br><span class=\"line\">        System.out.println(y+z);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"操作数栈\"><a href=\"#操作数栈\" class=\"headerlink\" title=\"操作数栈\"></a>操作数栈</h2><p><code>操作数栈（Operand Stack）</code>也常被称为<code>操作栈</code>，它是一个后入先出（Last In First Out，LIFO）栈。同局部变量表一样，操作数栈的最大深度也在编译的时候被写入到Code属性的<code>max_stacks</code>数据项之中。操作数栈的每一个元素都可以是包括long和double在内的任意Java数据类型。32位数据类型所占的栈容量为1，64位数据类型所占的栈容量为2。Javac编译器的数据流分析工作保证了在方法执行的任何时候，操作数栈的深度都不会超过在<code>max_stacks</code>数据项中设定的最大值。</p>\n<h3 id=\"eg-1\"><a href=\"#eg-1\" class=\"headerlink\" title=\"eg:\"></a>eg:</h3><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">JVMTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> y=<span class=\"number\">9223372036854775800L</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> z=<span class=\"number\">2</span>;</span><br><span class=\"line\">        <span class=\"keyword\">long</span> x=y+z;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>我们用<code>javap -verbose JVMTest</code>来查看他的<code>class</code>文件的字节码指令</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200730235131.png\" alt></p>\n<p><strong>在操作栈中的流程大致为：</strong></p>\n<p><img src=\"http://cdn.mjava.top/blog/20200731105247.jpg\" alt></p>\n<h2 id=\"动态链接\"><a href=\"#动态链接\" class=\"headerlink\" title=\"动态链接\"></a>动态链接</h2><p>每个栈帧都包含一个指向当前方法所在类型的<code>运行时常量池</code>的引用，持有这个引用是为了支持<code>方法调用</code>过程中的<code>动态连接（Dynamic Linking）</code>。在<code>Class</code>文件里，一个方法若要调用其他方法，或者访问成员变量，则需要通过<code>符号引用(symolic reference)</code>来表示，<code>动态链接</code>的作用就是将这些以<code>符号引用</code>所表示的方法转换为实际方法的直接引用。</p>\n<h3 id=\"什么是符号引用？\"><a href=\"#什么是符号引用？\" class=\"headerlink\" title=\"什么是符号引用？\"></a>什么是符号引用？</h3><p><img src=\"http://cdn.mjava.top/blog/20200731110742.png\" alt></p>\n<p>通过查看字节码，上面的<code>#7</code>，<code>#8</code>，<code>#9</code>等等都是符号引用，他在class文件里只是个符号，就像你定义一个变量名称一样，变量名只是和<code>字符符号</code>，并不是真正的指向内存的地址指针。这些符号都指向<code>运行时常量池</code>的引用。</p>\n<h2 id=\"方法返回地址\"><a href=\"#方法返回地址\" class=\"headerlink\" title=\"方法返回地址\"></a>方法返回地址</h2><p>Java在调用方法时，只有两种返回方法，一种是<code>正常返回</code>，一种是<code>异常返回</code>。</p>\n<h3 id=\"正常返回\"><a href=\"#正常返回\" class=\"headerlink\" title=\"正常返回\"></a>正常返回</h3><p>正常返回指的就是在执行方法时，中间并没有异常抛出，或者已正确处理抛出的异常，这时就称当前<code>方法正常调用完成</code>，如果有返回值，就会给他调用者返回一个值，如果没有返回值(<code>void</code>)就正常返回。</p>\n<p>这种场景下，当前栈帧承担着恢复调用者状态的责任，<strong>包括恢复调用者的局部变量表和操作数栈，以及正确递增程序计数器，以跳过刚才执行的调用方法指令等。</strong>调用者的代码在被调用方法的返回值压入调用者栈帧的操作数栈后，会正常执行。</p>\n<h3 id=\"异常返回\"><a href=\"#异常返回\" class=\"headerlink\" title=\"异常返回\"></a>异常返回</h3><p>在调用一些方法时，一些异常没有被正确捕获，就会导致方法终止，此时称<code>方法异常调用完成</code>，那一定不会有方法返回值返回给其调用者。</p>\n<p>无论采用何种退出方式，在方法退出之后，都<strong>必须返回到最初方法被调用时的位置</strong>，程序才能继续执行，方法返回时可能需要在栈帧中保存一些信息，用来帮助恢复它的上层主调方法的执行状态。</p>\n<p>怎么理解这个<strong>必须返回到最初方法被调用时的位置</strong>呢？</p>\n<p>eg:</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200731164803.png\" alt></p>\n<p>上面异常是在<code>13行</code>发生的，但是它并没有停在<code>13行</code>，而是回到了最初调用它<code>第10行</code>的位置。</p>\n"},{"title":"JVM逃逸分析技术","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-05-26T08:02:00.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n逃逸分析技术的日渐成熟,促使所有的Java对象实例不一定都在Java堆上分配内存\n\n简单来讲就是，Java Hotspot 虚拟机可以分析**新创建对象**的使用范围，并决定是否在 Java 堆上分配内存的一项技术。\n\n## 使用\n\n- 开启逃逸分析：-XX:+DoEscapeAnalysis\n- 关闭逃逸分析：-XX:-DoEscapeAnalysis\n- 显示分析结果：-XX:+PrintEscapeAnalysis\n- 逃逸分析技术在 Java SE 6u23+ 开始支持,并默认设置为启用状态\n\n## 逃逸程度\n\n逸分析的基本行为就是分析对象动态作用域,从**不逃逸**、**方法逃逸**到**线程逃逸**，称为对象**由低到高的不同逃逸程度**。\n\n### 方法逃逸\n\n当一个对象在**方法中**被定义后，它可能被**外部方法**所引用，例如作为调用参数传递到其他地方中，称为**方法逃逸**。\n\n ```java\n /*StringBuffer sb是一个方法内部变量，上述代码中直接将sb返回，这样这个StringBuffer有可能被其他方法所\n *改变，这样它的作用域就不只是在方法内部，虽然它是一个局部变量，称其逃逸到了方法外部。甚至还有可能被外部线\n *程访问到，譬如赋值给类变量或可以在其他线程中访问的实例变量，称为线程逃逸。\n */\n  public static StringBuffer craeteStringBuffer(String s1, String s2) {\n      StringBuffer sb = new StringBuffer();\n      sb.append(s1);\n      sb.append(s2);\n      return sb;\n  }\n  \n  //上述代码如果想要StringBuffer sb不逃出方法，可以这样写：\n  public static String createStringBuffer(String s1, String s2) {\n      StringBuffer sb = new StringBuffer();\n      sb.append(s1);\n      sb.append(s2);\n      return sb.toString();\n  }\n ```\n\n\n\n### 线程逃逸\n\n- 当一个对象在**方法中**被定义后，它可能被**外部线程**访问到，譬如赋值给可以在其他线程中访问的实例变量，这种称为**线程逃逸**。\n\n\n\n\n\n## 逃逸分析优化\n\n如果能**证明一个对象不会逃逸到方法或线程之外**（换句话说是别的方法或线程无法通过任何途径访问到这个对象），或者**逃逸程度比较低**（只逃逸出方法而不会逃逸出线程），则可能为这个对象实例**采取不同程度的优化**\n\n### 栈上分配（Stack Allocations）\n\n- 如果确定一个对象**不会逃逸出线程之外**，那让这个对象在**栈上分配内存**将会是一个很不错的主意，对象所占用的内存空间就可以**随栈帧出栈而销毁**。\n- 由于复杂度等原因，HotSpot中目前暂时还没有做这项优化，但一些其他的虚拟机（如Excelsior JET）使用了这项优化。\n- 栈上分配可以支持方法逃逸，但不能支持线程逃逸。\n\n### 标量替换（Scalar Replacement）\n\n- 若一个数据已经无法再分解成更小的数据来表示了，Java虚拟机中的原始数据类型（int、long等数值类型及reference类型等）都不能再进一步分解了，那么这些数据就可以被称为**标量**。相对的，如果一个数据可以继续分解，那它就被称为**聚合量（Aggregate）**，Java中的对象就是典型的聚合量。\n- -XX:+EliminateAllocations\t开启标量替换(jdk8默认开启)\n- -XX:+PrintEliminateAllocations    查看标量的替换情况\n- 如果把一个Java对象拆散，根据程序访问的情况，将其用到的成员变量恢复为原始类型来访问，这个过程就称为**标量替换**\n- 假如逃逸分析能够证明一个对象**不会被方法外部访问**，并且这个对象可以被拆散，那么程序真正执行的时候将**可能不去创建这个对象**，而改为直接创建它的若干个被这个方法使用的**成员变量**来代替。\n- 标量替换可以视作**栈上分配的一种特例**，实现更简单（不用考虑整个对象完整结构的分配），但对逃逸程度的要求更高，它**不允许对象逃逸出方法范围内**。\n\n### 同步消除（Synchronization Elimination）\n\n> 也叫锁消除\n\n- +XX:+EliminateLocks\t开启同步消除(jdk8默认开启)\n- 线程同步本身是一个相对耗时的过程，如果逃逸分析能够确定一个变量**不会逃逸出线程**，无法被其他线程访问，那么这个变量的读写肯定就不会有竞争，对这个变量实施的**同步措施**也就可以**安全地消除掉**。\n- 比如常用的线程安全类:`StringBuffer`,`HashTable`,`Vector`等.","source":"_posts/java/jvm/jvm-javastack-EscapeAnalysis.md","raw":"---\ntitle: JVM逃逸分析技术\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-05-26 16:02:00\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- JVM\ncategories:\n- JVM\n---\n\n\n\n逃逸分析技术的日渐成熟,促使所有的Java对象实例不一定都在Java堆上分配内存\n\n简单来讲就是，Java Hotspot 虚拟机可以分析**新创建对象**的使用范围，并决定是否在 Java 堆上分配内存的一项技术。\n\n## 使用\n\n- 开启逃逸分析：-XX:+DoEscapeAnalysis\n- 关闭逃逸分析：-XX:-DoEscapeAnalysis\n- 显示分析结果：-XX:+PrintEscapeAnalysis\n- 逃逸分析技术在 Java SE 6u23+ 开始支持,并默认设置为启用状态\n\n## 逃逸程度\n\n逸分析的基本行为就是分析对象动态作用域,从**不逃逸**、**方法逃逸**到**线程逃逸**，称为对象**由低到高的不同逃逸程度**。\n\n### 方法逃逸\n\n当一个对象在**方法中**被定义后，它可能被**外部方法**所引用，例如作为调用参数传递到其他地方中，称为**方法逃逸**。\n\n ```java\n /*StringBuffer sb是一个方法内部变量，上述代码中直接将sb返回，这样这个StringBuffer有可能被其他方法所\n *改变，这样它的作用域就不只是在方法内部，虽然它是一个局部变量，称其逃逸到了方法外部。甚至还有可能被外部线\n *程访问到，譬如赋值给类变量或可以在其他线程中访问的实例变量，称为线程逃逸。\n */\n  public static StringBuffer craeteStringBuffer(String s1, String s2) {\n      StringBuffer sb = new StringBuffer();\n      sb.append(s1);\n      sb.append(s2);\n      return sb;\n  }\n  \n  //上述代码如果想要StringBuffer sb不逃出方法，可以这样写：\n  public static String createStringBuffer(String s1, String s2) {\n      StringBuffer sb = new StringBuffer();\n      sb.append(s1);\n      sb.append(s2);\n      return sb.toString();\n  }\n ```\n\n\n\n### 线程逃逸\n\n- 当一个对象在**方法中**被定义后，它可能被**外部线程**访问到，譬如赋值给可以在其他线程中访问的实例变量，这种称为**线程逃逸**。\n\n\n\n\n\n## 逃逸分析优化\n\n如果能**证明一个对象不会逃逸到方法或线程之外**（换句话说是别的方法或线程无法通过任何途径访问到这个对象），或者**逃逸程度比较低**（只逃逸出方法而不会逃逸出线程），则可能为这个对象实例**采取不同程度的优化**\n\n### 栈上分配（Stack Allocations）\n\n- 如果确定一个对象**不会逃逸出线程之外**，那让这个对象在**栈上分配内存**将会是一个很不错的主意，对象所占用的内存空间就可以**随栈帧出栈而销毁**。\n- 由于复杂度等原因，HotSpot中目前暂时还没有做这项优化，但一些其他的虚拟机（如Excelsior JET）使用了这项优化。\n- 栈上分配可以支持方法逃逸，但不能支持线程逃逸。\n\n### 标量替换（Scalar Replacement）\n\n- 若一个数据已经无法再分解成更小的数据来表示了，Java虚拟机中的原始数据类型（int、long等数值类型及reference类型等）都不能再进一步分解了，那么这些数据就可以被称为**标量**。相对的，如果一个数据可以继续分解，那它就被称为**聚合量（Aggregate）**，Java中的对象就是典型的聚合量。\n- -XX:+EliminateAllocations\t开启标量替换(jdk8默认开启)\n- -XX:+PrintEliminateAllocations    查看标量的替换情况\n- 如果把一个Java对象拆散，根据程序访问的情况，将其用到的成员变量恢复为原始类型来访问，这个过程就称为**标量替换**\n- 假如逃逸分析能够证明一个对象**不会被方法外部访问**，并且这个对象可以被拆散，那么程序真正执行的时候将**可能不去创建这个对象**，而改为直接创建它的若干个被这个方法使用的**成员变量**来代替。\n- 标量替换可以视作**栈上分配的一种特例**，实现更简单（不用考虑整个对象完整结构的分配），但对逃逸程度的要求更高，它**不允许对象逃逸出方法范围内**。\n\n### 同步消除（Synchronization Elimination）\n\n> 也叫锁消除\n\n- +XX:+EliminateLocks\t开启同步消除(jdk8默认开启)\n- 线程同步本身是一个相对耗时的过程，如果逃逸分析能够确定一个变量**不会逃逸出线程**，无法被其他线程访问，那么这个变量的读写肯定就不会有竞争，对这个变量实施的**同步措施**也就可以**安全地消除掉**。\n- 比如常用的线程安全类:`StringBuffer`,`HashTable`,`Vector`等.","slug":"java/jvm/jvm-javastack-EscapeAnalysis","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bm900992mg5dafjfzgb","content":"<p>逃逸分析技术的日渐成熟,促使所有的Java对象实例不一定都在Java堆上分配内存</p>\n<p>简单来讲就是，Java Hotspot 虚拟机可以分析<strong>新创建对象</strong>的使用范围，并决定是否在 Java 堆上分配内存的一项技术。</p>\n<h2 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h2><ul>\n<li>开启逃逸分析：-XX:+DoEscapeAnalysis</li>\n<li>关闭逃逸分析：-XX:-DoEscapeAnalysis</li>\n<li>显示分析结果：-XX:+PrintEscapeAnalysis</li>\n<li>逃逸分析技术在 Java SE 6u23+ 开始支持,并默认设置为启用状态</li>\n</ul>\n<h2 id=\"逃逸程度\"><a href=\"#逃逸程度\" class=\"headerlink\" title=\"逃逸程度\"></a>逃逸程度</h2><p>逸分析的基本行为就是分析对象动态作用域,从<strong>不逃逸</strong>、<strong>方法逃逸</strong>到<strong>线程逃逸</strong>，称为对象<strong>由低到高的不同逃逸程度</strong>。</p>\n<h3 id=\"方法逃逸\"><a href=\"#方法逃逸\" class=\"headerlink\" title=\"方法逃逸\"></a>方法逃逸</h3><p>当一个对象在<strong>方法中</strong>被定义后，它可能被<strong>外部方法</strong>所引用，例如作为调用参数传递到其他地方中，称为<strong>方法逃逸</strong>。</p>\n <figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*StringBuffer sb是一个方法内部变量，上述代码中直接将sb返回，这样这个StringBuffer有可能被其他方法所</span></span><br><span class=\"line\"><span class=\"comment\">*改变，这样它的作用域就不只是在方法内部，虽然它是一个局部变量，称其逃逸到了方法外部。甚至还有可能被外部线</span></span><br><span class=\"line\"><span class=\"comment\">*程访问到，譬如赋值给类变量或可以在其他线程中访问的实例变量，称为线程逃逸。</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> StringBuffer <span class=\"title\">craeteStringBuffer</span><span class=\"params\">(String s1, String s2)</span> </span>&#123;</span><br><span class=\"line\">     StringBuffer sb = <span class=\"keyword\">new</span> StringBuffer();</span><br><span class=\"line\">     sb.append(s1);</span><br><span class=\"line\">     sb.append(s2);</span><br><span class=\"line\">     <span class=\"keyword\">return</span> sb;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"comment\">//上述代码如果想要StringBuffer sb不逃出方法，可以这样写：</span></span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">createStringBuffer</span><span class=\"params\">(String s1, String s2)</span> </span>&#123;</span><br><span class=\"line\">     StringBuffer sb = <span class=\"keyword\">new</span> StringBuffer();</span><br><span class=\"line\">     sb.append(s1);</span><br><span class=\"line\">     sb.append(s2);</span><br><span class=\"line\">     <span class=\"keyword\">return</span> sb.toString();</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"线程逃逸\"><a href=\"#线程逃逸\" class=\"headerlink\" title=\"线程逃逸\"></a>线程逃逸</h3><ul>\n<li>当一个对象在<strong>方法中</strong>被定义后，它可能被<strong>外部线程</strong>访问到，譬如赋值给可以在其他线程中访问的实例变量，这种称为<strong>线程逃逸</strong>。</li>\n</ul>\n<h2 id=\"逃逸分析优化\"><a href=\"#逃逸分析优化\" class=\"headerlink\" title=\"逃逸分析优化\"></a>逃逸分析优化</h2><p>如果能<strong>证明一个对象不会逃逸到方法或线程之外</strong>（换句话说是别的方法或线程无法通过任何途径访问到这个对象），或者<strong>逃逸程度比较低</strong>（只逃逸出方法而不会逃逸出线程），则可能为这个对象实例<strong>采取不同程度的优化</strong></p>\n<h3 id=\"栈上分配（Stack-Allocations）\"><a href=\"#栈上分配（Stack-Allocations）\" class=\"headerlink\" title=\"栈上分配（Stack Allocations）\"></a>栈上分配（Stack Allocations）</h3><ul>\n<li>如果确定一个对象<strong>不会逃逸出线程之外</strong>，那让这个对象在<strong>栈上分配内存</strong>将会是一个很不错的主意，对象所占用的内存空间就可以<strong>随栈帧出栈而销毁</strong>。</li>\n<li>由于复杂度等原因，HotSpot中目前暂时还没有做这项优化，但一些其他的虚拟机（如Excelsior JET）使用了这项优化。</li>\n<li>栈上分配可以支持方法逃逸，但不能支持线程逃逸。</li>\n</ul>\n<h3 id=\"标量替换（Scalar-Replacement）\"><a href=\"#标量替换（Scalar-Replacement）\" class=\"headerlink\" title=\"标量替换（Scalar Replacement）\"></a>标量替换（Scalar Replacement）</h3><ul>\n<li>若一个数据已经无法再分解成更小的数据来表示了，Java虚拟机中的原始数据类型（int、long等数值类型及reference类型等）都不能再进一步分解了，那么这些数据就可以被称为<strong>标量</strong>。相对的，如果一个数据可以继续分解，那它就被称为<strong>聚合量（Aggregate）</strong>，Java中的对象就是典型的聚合量。</li>\n<li>-XX:+EliminateAllocations    开启标量替换(jdk8默认开启)</li>\n<li>-XX:+PrintEliminateAllocations    查看标量的替换情况</li>\n<li>如果把一个Java对象拆散，根据程序访问的情况，将其用到的成员变量恢复为原始类型来访问，这个过程就称为<strong>标量替换</strong></li>\n<li>假如逃逸分析能够证明一个对象<strong>不会被方法外部访问</strong>，并且这个对象可以被拆散，那么程序真正执行的时候将<strong>可能不去创建这个对象</strong>，而改为直接创建它的若干个被这个方法使用的<strong>成员变量</strong>来代替。</li>\n<li>标量替换可以视作<strong>栈上分配的一种特例</strong>，实现更简单（不用考虑整个对象完整结构的分配），但对逃逸程度的要求更高，它<strong>不允许对象逃逸出方法范围内</strong>。</li>\n</ul>\n<h3 id=\"同步消除（Synchronization-Elimination）\"><a href=\"#同步消除（Synchronization-Elimination）\" class=\"headerlink\" title=\"同步消除（Synchronization Elimination）\"></a>同步消除（Synchronization Elimination）</h3><blockquote>\n<p>也叫锁消除</p>\n</blockquote>\n<ul>\n<li>+XX:+EliminateLocks    开启同步消除(jdk8默认开启)</li>\n<li>线程同步本身是一个相对耗时的过程，如果逃逸分析能够确定一个变量<strong>不会逃逸出线程</strong>，无法被其他线程访问，那么这个变量的读写肯定就不会有竞争，对这个变量实施的<strong>同步措施</strong>也就可以<strong>安全地消除掉</strong>。</li>\n<li>比如常用的线程安全类:<code>StringBuffer</code>,<code>HashTable</code>,<code>Vector</code>等.</li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p>逃逸分析技术的日渐成熟,促使所有的Java对象实例不一定都在Java堆上分配内存</p>\n<p>简单来讲就是，Java Hotspot 虚拟机可以分析<strong>新创建对象</strong>的使用范围，并决定是否在 Java 堆上分配内存的一项技术。</p>\n<h2 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h2><ul>\n<li>开启逃逸分析：-XX:+DoEscapeAnalysis</li>\n<li>关闭逃逸分析：-XX:-DoEscapeAnalysis</li>\n<li>显示分析结果：-XX:+PrintEscapeAnalysis</li>\n<li>逃逸分析技术在 Java SE 6u23+ 开始支持,并默认设置为启用状态</li>\n</ul>\n<h2 id=\"逃逸程度\"><a href=\"#逃逸程度\" class=\"headerlink\" title=\"逃逸程度\"></a>逃逸程度</h2><p>逸分析的基本行为就是分析对象动态作用域,从<strong>不逃逸</strong>、<strong>方法逃逸</strong>到<strong>线程逃逸</strong>，称为对象<strong>由低到高的不同逃逸程度</strong>。</p>\n<h3 id=\"方法逃逸\"><a href=\"#方法逃逸\" class=\"headerlink\" title=\"方法逃逸\"></a>方法逃逸</h3><p>当一个对象在<strong>方法中</strong>被定义后，它可能被<strong>外部方法</strong>所引用，例如作为调用参数传递到其他地方中，称为<strong>方法逃逸</strong>。</p>\n <figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*StringBuffer sb是一个方法内部变量，上述代码中直接将sb返回，这样这个StringBuffer有可能被其他方法所</span></span><br><span class=\"line\"><span class=\"comment\">*改变，这样它的作用域就不只是在方法内部，虽然它是一个局部变量，称其逃逸到了方法外部。甚至还有可能被外部线</span></span><br><span class=\"line\"><span class=\"comment\">*程访问到，譬如赋值给类变量或可以在其他线程中访问的实例变量，称为线程逃逸。</span></span><br><span class=\"line\"><span class=\"comment\">*/</span></span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> StringBuffer <span class=\"title\">craeteStringBuffer</span><span class=\"params\">(String s1, String s2)</span> </span>&#123;</span><br><span class=\"line\">     StringBuffer sb = <span class=\"keyword\">new</span> StringBuffer();</span><br><span class=\"line\">     sb.append(s1);</span><br><span class=\"line\">     sb.append(s2);</span><br><span class=\"line\">     <span class=\"keyword\">return</span> sb;</span><br><span class=\"line\"> &#125;</span><br><span class=\"line\"> </span><br><span class=\"line\"> <span class=\"comment\">//上述代码如果想要StringBuffer sb不逃出方法，可以这样写：</span></span><br><span class=\"line\"> <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> String <span class=\"title\">createStringBuffer</span><span class=\"params\">(String s1, String s2)</span> </span>&#123;</span><br><span class=\"line\">     StringBuffer sb = <span class=\"keyword\">new</span> StringBuffer();</span><br><span class=\"line\">     sb.append(s1);</span><br><span class=\"line\">     sb.append(s2);</span><br><span class=\"line\">     <span class=\"keyword\">return</span> sb.toString();</span><br><span class=\"line\"> &#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"线程逃逸\"><a href=\"#线程逃逸\" class=\"headerlink\" title=\"线程逃逸\"></a>线程逃逸</h3><ul>\n<li>当一个对象在<strong>方法中</strong>被定义后，它可能被<strong>外部线程</strong>访问到，譬如赋值给可以在其他线程中访问的实例变量，这种称为<strong>线程逃逸</strong>。</li>\n</ul>\n<h2 id=\"逃逸分析优化\"><a href=\"#逃逸分析优化\" class=\"headerlink\" title=\"逃逸分析优化\"></a>逃逸分析优化</h2><p>如果能<strong>证明一个对象不会逃逸到方法或线程之外</strong>（换句话说是别的方法或线程无法通过任何途径访问到这个对象），或者<strong>逃逸程度比较低</strong>（只逃逸出方法而不会逃逸出线程），则可能为这个对象实例<strong>采取不同程度的优化</strong></p>\n<h3 id=\"栈上分配（Stack-Allocations）\"><a href=\"#栈上分配（Stack-Allocations）\" class=\"headerlink\" title=\"栈上分配（Stack Allocations）\"></a>栈上分配（Stack Allocations）</h3><ul>\n<li>如果确定一个对象<strong>不会逃逸出线程之外</strong>，那让这个对象在<strong>栈上分配内存</strong>将会是一个很不错的主意，对象所占用的内存空间就可以<strong>随栈帧出栈而销毁</strong>。</li>\n<li>由于复杂度等原因，HotSpot中目前暂时还没有做这项优化，但一些其他的虚拟机（如Excelsior JET）使用了这项优化。</li>\n<li>栈上分配可以支持方法逃逸，但不能支持线程逃逸。</li>\n</ul>\n<h3 id=\"标量替换（Scalar-Replacement）\"><a href=\"#标量替换（Scalar-Replacement）\" class=\"headerlink\" title=\"标量替换（Scalar Replacement）\"></a>标量替换（Scalar Replacement）</h3><ul>\n<li>若一个数据已经无法再分解成更小的数据来表示了，Java虚拟机中的原始数据类型（int、long等数值类型及reference类型等）都不能再进一步分解了，那么这些数据就可以被称为<strong>标量</strong>。相对的，如果一个数据可以继续分解，那它就被称为<strong>聚合量（Aggregate）</strong>，Java中的对象就是典型的聚合量。</li>\n<li>-XX:+EliminateAllocations    开启标量替换(jdk8默认开启)</li>\n<li>-XX:+PrintEliminateAllocations    查看标量的替换情况</li>\n<li>如果把一个Java对象拆散，根据程序访问的情况，将其用到的成员变量恢复为原始类型来访问，这个过程就称为<strong>标量替换</strong></li>\n<li>假如逃逸分析能够证明一个对象<strong>不会被方法外部访问</strong>，并且这个对象可以被拆散，那么程序真正执行的时候将<strong>可能不去创建这个对象</strong>，而改为直接创建它的若干个被这个方法使用的<strong>成员变量</strong>来代替。</li>\n<li>标量替换可以视作<strong>栈上分配的一种特例</strong>，实现更简单（不用考虑整个对象完整结构的分配），但对逃逸程度的要求更高，它<strong>不允许对象逃逸出方法范围内</strong>。</li>\n</ul>\n<h3 id=\"同步消除（Synchronization-Elimination）\"><a href=\"#同步消除（Synchronization-Elimination）\" class=\"headerlink\" title=\"同步消除（Synchronization Elimination）\"></a>同步消除（Synchronization Elimination）</h3><blockquote>\n<p>也叫锁消除</p>\n</blockquote>\n<ul>\n<li>+XX:+EliminateLocks    开启同步消除(jdk8默认开启)</li>\n<li>线程同步本身是一个相对耗时的过程，如果逃逸分析能够确定一个变量<strong>不会逃逸出线程</strong>，无法被其他线程访问，那么这个变量的读写肯定就不会有竞争，对这个变量实施的<strong>同步措施</strong>也就可以<strong>安全地消除掉</strong>。</li>\n<li>比如常用的线程安全类:<code>StringBuffer</code>,<code>HashTable</code>,<code>Vector</code>等.</li>\n</ul>\n"},{"title":"JVM4种垃圾收集算法","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-05-29T02:31:30.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 简介\n\n垃圾收集算法可以划分为“引用计数式垃圾收集”（Reference Counting GC）和“追踪式垃圾收集”（Tracing GC）两大类，这两类也常被称作“直接垃圾收集”和“间接垃圾收集”。\n\n\n\n##  标记-清除算法\n\n- **标记过程**就是对象是否属于垃圾的判定过程(**采用可达分析算法GC Roots**)\n- 算法分为**“标记”**和**“清除”**两个阶段：首先标记出所有需要回收的对象，在标记完成后，统一回收掉所有被标记的对象，**也可以反过来**，标记存活的对象，统一回收所有未被标记的对象。\n\n### 缺点\n\n- 执行效率不稳定，如果Java堆中包含大量对象，而且**其中大部分是需要被回收的**，这时必须进行大量标记和清除的动作，导致标记和清除两个过程的**执行效率都随对象数量增长而降低**；\n- 第二个是内存空间的碎片化问题，标记、清除之后会**产生大量不连续的内存碎片**，空间碎片太多可能会导致当以后在程序运行过程中需要分配较大对象时**无法找到足够的连续内存**而不得不**提前触发另一次垃圾收集动作**。\n- ![](http://cdn.mjava.top/blog/20200529100358.png)\n\n![标记清除算法](http://cdn.mjava.top/blog/20200528203926.jpeg)\n\n##  标记-复制算法\n\n- **标记过程**就是对象是否属于垃圾的判定过程(**采用可达分析算法GC Roots**)\n\n- 它将可用内存按容量划分为**大小相等的两块**，每次只使用其中的一块。\n- 当这一块的内存用完了，就将还**存活着的对象复制到另外一块上面**，然后再把**已使用过的内存空间一次清理掉**。\n\n### 缺点\n\n- 如果内存中**多数对象都是存活的**，这种算法将会**产生大量的内存间复制的开销**\n- 代价是将可用内存缩小为了**原来的一半**,空间浪费未免太多了一点.\n- ![](http://cdn.mjava.top/blog/20200529100420.jpg)\n\n![标记复制算法](http://cdn.mjava.top/blog/20200528203952.jpeg)\n\n##  标记-整理算法\n\n- **标记过程**就是对象是否属于垃圾的判定过程(**采用可达分析算法GC Roots**)\n- 在**标记-清除**的算法基础上改进,后续步骤不是直接对可回收对象进行清理，而是让**所有存活的对象都向内存空间一端移动**，然后直接**清理掉边界以外的内存**，\n\n### 缺点\n\n- 在有大量存活对象的老年代区域,**移动存活对象**并**更新所有引用**这些对象的地方将会是一种**极为负重**的操作,而且这种对象移动操作**必须全程暂停用户应用程序**才能进行,比**标记-清除**算法停顿时间长.\n- ![](http://cdn.mjava.top/blog/20200529100506.jpg)\n\n![标记整理算法](http://cdn.mjava.top/blog/20200528204014.jpeg)\n\n\n\n## 分代收集算法\n\n现代商用虚拟机基于以上算法的优缺点,根据**分代收集理论**,在不同的区域采用了不同的收集算法.\n\n> <font color=red>老年代:新生代=2:1</font>\n\n![](http://cdn.mjava.top/blog/20200529101100.png)\n\n### 新生代\n\n> 堆大小默认比例:<font color=red>Eden:S0:S1=8:1:1</font>\n>\n> 采用标记-复制算法\n\n新生代分为**Eden区**和**Survior区**,而Survior区又分为**From Survior区(S0)**和**To Survior区(S1)**.此区域采用标记-复制算法.每次Minor GC/Young GC时,会把**Eden区**存活的对象复制到**S0区**,然后清空Eden区,当S0区满时,Eden区和S0区存活的对象会复制到**S1区**,然后S0和S0进行交换,永远保持S1为空状态,当新生代的对象经过一定次数的Minor GC还未被回收时,就会把这个对象移到老年代.\n\n### 老年代\n\n> 采用标记-整理法或标记-清理法\n\n当老年代Old区域满时,会触发**Full GC**,同时回收新生代和老生代的所有区域.回收后诺内存还是不足时,会引发**OOM异常**;","source":"_posts/java/jvm/jvm-gc-alg.md","raw":"---\ntitle: JVM4种垃圾收集算法\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-05-29 10:31:30\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- JVM\ncategories:\n- JVM\n---\n\n## 简介\n\n垃圾收集算法可以划分为“引用计数式垃圾收集”（Reference Counting GC）和“追踪式垃圾收集”（Tracing GC）两大类，这两类也常被称作“直接垃圾收集”和“间接垃圾收集”。\n\n\n\n##  标记-清除算法\n\n- **标记过程**就是对象是否属于垃圾的判定过程(**采用可达分析算法GC Roots**)\n- 算法分为**“标记”**和**“清除”**两个阶段：首先标记出所有需要回收的对象，在标记完成后，统一回收掉所有被标记的对象，**也可以反过来**，标记存活的对象，统一回收所有未被标记的对象。\n\n### 缺点\n\n- 执行效率不稳定，如果Java堆中包含大量对象，而且**其中大部分是需要被回收的**，这时必须进行大量标记和清除的动作，导致标记和清除两个过程的**执行效率都随对象数量增长而降低**；\n- 第二个是内存空间的碎片化问题，标记、清除之后会**产生大量不连续的内存碎片**，空间碎片太多可能会导致当以后在程序运行过程中需要分配较大对象时**无法找到足够的连续内存**而不得不**提前触发另一次垃圾收集动作**。\n- ![](http://cdn.mjava.top/blog/20200529100358.png)\n\n![标记清除算法](http://cdn.mjava.top/blog/20200528203926.jpeg)\n\n##  标记-复制算法\n\n- **标记过程**就是对象是否属于垃圾的判定过程(**采用可达分析算法GC Roots**)\n\n- 它将可用内存按容量划分为**大小相等的两块**，每次只使用其中的一块。\n- 当这一块的内存用完了，就将还**存活着的对象复制到另外一块上面**，然后再把**已使用过的内存空间一次清理掉**。\n\n### 缺点\n\n- 如果内存中**多数对象都是存活的**，这种算法将会**产生大量的内存间复制的开销**\n- 代价是将可用内存缩小为了**原来的一半**,空间浪费未免太多了一点.\n- ![](http://cdn.mjava.top/blog/20200529100420.jpg)\n\n![标记复制算法](http://cdn.mjava.top/blog/20200528203952.jpeg)\n\n##  标记-整理算法\n\n- **标记过程**就是对象是否属于垃圾的判定过程(**采用可达分析算法GC Roots**)\n- 在**标记-清除**的算法基础上改进,后续步骤不是直接对可回收对象进行清理，而是让**所有存活的对象都向内存空间一端移动**，然后直接**清理掉边界以外的内存**，\n\n### 缺点\n\n- 在有大量存活对象的老年代区域,**移动存活对象**并**更新所有引用**这些对象的地方将会是一种**极为负重**的操作,而且这种对象移动操作**必须全程暂停用户应用程序**才能进行,比**标记-清除**算法停顿时间长.\n- ![](http://cdn.mjava.top/blog/20200529100506.jpg)\n\n![标记整理算法](http://cdn.mjava.top/blog/20200528204014.jpeg)\n\n\n\n## 分代收集算法\n\n现代商用虚拟机基于以上算法的优缺点,根据**分代收集理论**,在不同的区域采用了不同的收集算法.\n\n> <font color=red>老年代:新生代=2:1</font>\n\n![](http://cdn.mjava.top/blog/20200529101100.png)\n\n### 新生代\n\n> 堆大小默认比例:<font color=red>Eden:S0:S1=8:1:1</font>\n>\n> 采用标记-复制算法\n\n新生代分为**Eden区**和**Survior区**,而Survior区又分为**From Survior区(S0)**和**To Survior区(S1)**.此区域采用标记-复制算法.每次Minor GC/Young GC时,会把**Eden区**存活的对象复制到**S0区**,然后清空Eden区,当S0区满时,Eden区和S0区存活的对象会复制到**S1区**,然后S0和S0进行交换,永远保持S1为空状态,当新生代的对象经过一定次数的Minor GC还未被回收时,就会把这个对象移到老年代.\n\n### 老年代\n\n> 采用标记-整理法或标记-清理法\n\n当老年代Old区域满时,会触发**Full GC**,同时回收新生代和老生代的所有区域.回收后诺内存还是不足时,会引发**OOM异常**;","slug":"java/jvm/jvm-gc-alg","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bma009c2mg5vfcq8qwh","content":"<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>垃圾收集算法可以划分为“引用计数式垃圾收集”（Reference Counting GC）和“追踪式垃圾收集”（Tracing GC）两大类，这两类也常被称作“直接垃圾收集”和“间接垃圾收集”。</p>\n<h2 id=\"标记-清除算法\"><a href=\"#标记-清除算法\" class=\"headerlink\" title=\"标记-清除算法\"></a>标记-清除算法</h2><ul>\n<li><strong>标记过程</strong>就是对象是否属于垃圾的判定过程(<strong>采用可达分析算法GC Roots</strong>)</li>\n<li>算法分为<strong>“标记”</strong>和<strong>“清除”</strong>两个阶段：首先标记出所有需要回收的对象，在标记完成后，统一回收掉所有被标记的对象，<strong>也可以反过来</strong>，标记存活的对象，统一回收所有未被标记的对象。</li>\n</ul>\n<h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>执行效率不稳定，如果Java堆中包含大量对象，而且<strong>其中大部分是需要被回收的</strong>，这时必须进行大量标记和清除的动作，导致标记和清除两个过程的<strong>执行效率都随对象数量增长而降低</strong>；</li>\n<li>第二个是内存空间的碎片化问题，标记、清除之后会<strong>产生大量不连续的内存碎片</strong>，空间碎片太多可能会导致当以后在程序运行过程中需要分配较大对象时<strong>无法找到足够的连续内存</strong>而不得不<strong>提前触发另一次垃圾收集动作</strong>。</li>\n<li><img src=\"http://cdn.mjava.top/blog/20200529100358.png\" alt></li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200528203926.jpeg\" alt=\"标记清除算法\"></p>\n<h2 id=\"标记-复制算法\"><a href=\"#标记-复制算法\" class=\"headerlink\" title=\"标记-复制算法\"></a>标记-复制算法</h2><ul>\n<li><p><strong>标记过程</strong>就是对象是否属于垃圾的判定过程(<strong>采用可达分析算法GC Roots</strong>)</p>\n</li>\n<li><p>它将可用内存按容量划分为<strong>大小相等的两块</strong>，每次只使用其中的一块。</p>\n</li>\n<li><p>当这一块的内存用完了，就将还<strong>存活着的对象复制到另外一块上面</strong>，然后再把<strong>已使用过的内存空间一次清理掉</strong>。</p>\n</li>\n</ul>\n<h3 id=\"缺点-1\"><a href=\"#缺点-1\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>如果内存中<strong>多数对象都是存活的</strong>，这种算法将会<strong>产生大量的内存间复制的开销</strong></li>\n<li>代价是将可用内存缩小为了<strong>原来的一半</strong>,空间浪费未免太多了一点.</li>\n<li><img src=\"http://cdn.mjava.top/blog/20200529100420.jpg\" alt></li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200528203952.jpeg\" alt=\"标记复制算法\"></p>\n<h2 id=\"标记-整理算法\"><a href=\"#标记-整理算法\" class=\"headerlink\" title=\"标记-整理算法\"></a>标记-整理算法</h2><ul>\n<li><strong>标记过程</strong>就是对象是否属于垃圾的判定过程(<strong>采用可达分析算法GC Roots</strong>)</li>\n<li>在<strong>标记-清除</strong>的算法基础上改进,后续步骤不是直接对可回收对象进行清理，而是让<strong>所有存活的对象都向内存空间一端移动</strong>，然后直接<strong>清理掉边界以外的内存</strong>，</li>\n</ul>\n<h3 id=\"缺点-2\"><a href=\"#缺点-2\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>在有大量存活对象的老年代区域,<strong>移动存活对象</strong>并<strong>更新所有引用</strong>这些对象的地方将会是一种<strong>极为负重</strong>的操作,而且这种对象移动操作<strong>必须全程暂停用户应用程序</strong>才能进行,比<strong>标记-清除</strong>算法停顿时间长.</li>\n<li><img src=\"http://cdn.mjava.top/blog/20200529100506.jpg\" alt></li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200528204014.jpeg\" alt=\"标记整理算法\"></p>\n<h2 id=\"分代收集算法\"><a href=\"#分代收集算法\" class=\"headerlink\" title=\"分代收集算法\"></a>分代收集算法</h2><p>现代商用虚拟机基于以上算法的优缺点,根据<strong>分代收集理论</strong>,在不同的区域采用了不同的收集算法.</p>\n<blockquote>\n<p><font color=\"red\">老年代:新生代=2:1</font></p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200529101100.png\" alt></p>\n<h3 id=\"新生代\"><a href=\"#新生代\" class=\"headerlink\" title=\"新生代\"></a>新生代</h3><blockquote>\n<p>堆大小默认比例:<font color=\"red\">Eden:S0:S1=8:1:1</font></p>\n<p>采用标记-复制算法</p>\n</blockquote>\n<p>新生代分为<strong>Eden区</strong>和<strong>Survior区</strong>,而Survior区又分为<strong>From Survior区(S0)</strong>和<strong>To Survior区(S1)</strong>.此区域采用标记-复制算法.每次Minor GC/Young GC时,会把<strong>Eden区</strong>存活的对象复制到<strong>S0区</strong>,然后清空Eden区,当S0区满时,Eden区和S0区存活的对象会复制到<strong>S1区</strong>,然后S0和S0进行交换,永远保持S1为空状态,当新生代的对象经过一定次数的Minor GC还未被回收时,就会把这个对象移到老年代.</p>\n<h3 id=\"老年代\"><a href=\"#老年代\" class=\"headerlink\" title=\"老年代\"></a>老年代</h3><blockquote>\n<p>采用标记-整理法或标记-清理法</p>\n</blockquote>\n<p>当老年代Old区域满时,会触发<strong>Full GC</strong>,同时回收新生代和老生代的所有区域.回收后诺内存还是不足时,会引发<strong>OOM异常</strong>;</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"简介\"><a href=\"#简介\" class=\"headerlink\" title=\"简介\"></a>简介</h2><p>垃圾收集算法可以划分为“引用计数式垃圾收集”（Reference Counting GC）和“追踪式垃圾收集”（Tracing GC）两大类，这两类也常被称作“直接垃圾收集”和“间接垃圾收集”。</p>\n<h2 id=\"标记-清除算法\"><a href=\"#标记-清除算法\" class=\"headerlink\" title=\"标记-清除算法\"></a>标记-清除算法</h2><ul>\n<li><strong>标记过程</strong>就是对象是否属于垃圾的判定过程(<strong>采用可达分析算法GC Roots</strong>)</li>\n<li>算法分为<strong>“标记”</strong>和<strong>“清除”</strong>两个阶段：首先标记出所有需要回收的对象，在标记完成后，统一回收掉所有被标记的对象，<strong>也可以反过来</strong>，标记存活的对象，统一回收所有未被标记的对象。</li>\n</ul>\n<h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>执行效率不稳定，如果Java堆中包含大量对象，而且<strong>其中大部分是需要被回收的</strong>，这时必须进行大量标记和清除的动作，导致标记和清除两个过程的<strong>执行效率都随对象数量增长而降低</strong>；</li>\n<li>第二个是内存空间的碎片化问题，标记、清除之后会<strong>产生大量不连续的内存碎片</strong>，空间碎片太多可能会导致当以后在程序运行过程中需要分配较大对象时<strong>无法找到足够的连续内存</strong>而不得不<strong>提前触发另一次垃圾收集动作</strong>。</li>\n<li><img src=\"http://cdn.mjava.top/blog/20200529100358.png\" alt></li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200528203926.jpeg\" alt=\"标记清除算法\"></p>\n<h2 id=\"标记-复制算法\"><a href=\"#标记-复制算法\" class=\"headerlink\" title=\"标记-复制算法\"></a>标记-复制算法</h2><ul>\n<li><p><strong>标记过程</strong>就是对象是否属于垃圾的判定过程(<strong>采用可达分析算法GC Roots</strong>)</p>\n</li>\n<li><p>它将可用内存按容量划分为<strong>大小相等的两块</strong>，每次只使用其中的一块。</p>\n</li>\n<li><p>当这一块的内存用完了，就将还<strong>存活着的对象复制到另外一块上面</strong>，然后再把<strong>已使用过的内存空间一次清理掉</strong>。</p>\n</li>\n</ul>\n<h3 id=\"缺点-1\"><a href=\"#缺点-1\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>如果内存中<strong>多数对象都是存活的</strong>，这种算法将会<strong>产生大量的内存间复制的开销</strong></li>\n<li>代价是将可用内存缩小为了<strong>原来的一半</strong>,空间浪费未免太多了一点.</li>\n<li><img src=\"http://cdn.mjava.top/blog/20200529100420.jpg\" alt></li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200528203952.jpeg\" alt=\"标记复制算法\"></p>\n<h2 id=\"标记-整理算法\"><a href=\"#标记-整理算法\" class=\"headerlink\" title=\"标记-整理算法\"></a>标记-整理算法</h2><ul>\n<li><strong>标记过程</strong>就是对象是否属于垃圾的判定过程(<strong>采用可达分析算法GC Roots</strong>)</li>\n<li>在<strong>标记-清除</strong>的算法基础上改进,后续步骤不是直接对可回收对象进行清理，而是让<strong>所有存活的对象都向内存空间一端移动</strong>，然后直接<strong>清理掉边界以外的内存</strong>，</li>\n</ul>\n<h3 id=\"缺点-2\"><a href=\"#缺点-2\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>在有大量存活对象的老年代区域,<strong>移动存活对象</strong>并<strong>更新所有引用</strong>这些对象的地方将会是一种<strong>极为负重</strong>的操作,而且这种对象移动操作<strong>必须全程暂停用户应用程序</strong>才能进行,比<strong>标记-清除</strong>算法停顿时间长.</li>\n<li><img src=\"http://cdn.mjava.top/blog/20200529100506.jpg\" alt></li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/20200528204014.jpeg\" alt=\"标记整理算法\"></p>\n<h2 id=\"分代收集算法\"><a href=\"#分代收集算法\" class=\"headerlink\" title=\"分代收集算法\"></a>分代收集算法</h2><p>现代商用虚拟机基于以上算法的优缺点,根据<strong>分代收集理论</strong>,在不同的区域采用了不同的收集算法.</p>\n<blockquote>\n<p><font color=\"red\">老年代:新生代=2:1</font></p>\n</blockquote>\n<p><img src=\"http://cdn.mjava.top/blog/20200529101100.png\" alt></p>\n<h3 id=\"新生代\"><a href=\"#新生代\" class=\"headerlink\" title=\"新生代\"></a>新生代</h3><blockquote>\n<p>堆大小默认比例:<font color=\"red\">Eden:S0:S1=8:1:1</font></p>\n<p>采用标记-复制算法</p>\n</blockquote>\n<p>新生代分为<strong>Eden区</strong>和<strong>Survior区</strong>,而Survior区又分为<strong>From Survior区(S0)</strong>和<strong>To Survior区(S1)</strong>.此区域采用标记-复制算法.每次Minor GC/Young GC时,会把<strong>Eden区</strong>存活的对象复制到<strong>S0区</strong>,然后清空Eden区,当S0区满时,Eden区和S0区存活的对象会复制到<strong>S1区</strong>,然后S0和S0进行交换,永远保持S1为空状态,当新生代的对象经过一定次数的Minor GC还未被回收时,就会把这个对象移到老年代.</p>\n<h3 id=\"老年代\"><a href=\"#老年代\" class=\"headerlink\" title=\"老年代\"></a>老年代</h3><blockquote>\n<p>采用标记-整理法或标记-清理法</p>\n</blockquote>\n<p>当老年代Old区域满时,会触发<strong>Full GC</strong>,同时回收新生代和老生代的所有区域.回收后诺内存还是不足时,会引发<strong>OOM异常</strong>;</p>\n"},{"title":"JAVA四种引用方法使用和对比","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-05-29T02:22:07.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n![](http://cdn.mjava.top/blog/20200526225718)\n\n## 强引用（Strongly Reference）\n\n> 无论任何情况下，只要强引用关系还存在，垃圾收集器就永远不会回收掉被引用的对象。\n>\n> <font color=red>回收时机:强引用关系不存在时</font>\n\n```java\nObject obj=new Object();\n```\n\n\n\n## 软引用（Soft Reference）\n\n> 软引用是用来描述一些还有用，但非必须的对象。只被软引用关联着的对象，在系统将要发生内存溢出异常前，会把这些对象列进回收范围之中进行第二次回收，如果这次回收还没有足够的内存，才会抛出内存溢出异常。\n>\n> <font color=red>回收时机:发送内存溢出异常前</font>\n\n```java\n//软引用\n\nSoftReference<Object> srf = new SoftReference<Object>(new Object());\n\n//or\n\nObject obj=new Object();\nSoftReference<Object> srf = new SoftReference<Object>(obj);\nobj=null;  //这种方法一定要设置obj为null,否则这个对象除了软引用可达外,还有原来强引用也可达\n```\n\n\n\n### 弱引用（Weak Reference）\n\n> 弱引用也是用来描述那些非必须对象，但是它的强度比软引用更弱一些，被弱引用关联的对象**只能生存到下一次垃圾收集发生为止**。当垃圾收集器开始工作，无论当前内存是否足够，都会回收掉只被弱引用关联的对象。\n>\n> <font color=red>回收时机:下一次垃圾回收时</font>\n\n```java\n//弱引用\n\nWeakReference<Object> wrf = new WeakReference<Object>(new Object());\n\n//or\nObject obj=new Object();\nWeakReference<Object> wrf = new WeakReference<Object>(new Object());\nobj=null;\n```\n\n\n\n### 虚引用（Phantom Reference）\n\n> 虚引用也称为“幽灵引用”或者“幻影引用”，它是最弱的一种引用关系。一个对象是否有虚引用的存在，完全不会对其生存时间构成影响，也无法通过虚引用来取得一个对象实例。\n>\n> <font color=red>回收时机:随时</font>\n\n```java\n//虚引用\nPhantomReference<Object> prf = new PhantomReference<Object>(new Object(), new ReferenceQueue<>());\n\n//or\n\nObject obj=new Object();\nPhantomReference<Object> prf = new PhantomReference<Object>(obj, new ReferenceQueue<>());\nobj=null;\n```\n","source":"_posts/java/jvm/jvm-object-four-quote.md","raw":"---\ntitle: JAVA四种引用方法使用和对比\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-05-29 10:22:07\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- JVM\n- JAVA\ncategories:\n- JVM\n- JAVA\n---\n\n\n\n![](http://cdn.mjava.top/blog/20200526225718)\n\n## 强引用（Strongly Reference）\n\n> 无论任何情况下，只要强引用关系还存在，垃圾收集器就永远不会回收掉被引用的对象。\n>\n> <font color=red>回收时机:强引用关系不存在时</font>\n\n```java\nObject obj=new Object();\n```\n\n\n\n## 软引用（Soft Reference）\n\n> 软引用是用来描述一些还有用，但非必须的对象。只被软引用关联着的对象，在系统将要发生内存溢出异常前，会把这些对象列进回收范围之中进行第二次回收，如果这次回收还没有足够的内存，才会抛出内存溢出异常。\n>\n> <font color=red>回收时机:发送内存溢出异常前</font>\n\n```java\n//软引用\n\nSoftReference<Object> srf = new SoftReference<Object>(new Object());\n\n//or\n\nObject obj=new Object();\nSoftReference<Object> srf = new SoftReference<Object>(obj);\nobj=null;  //这种方法一定要设置obj为null,否则这个对象除了软引用可达外,还有原来强引用也可达\n```\n\n\n\n### 弱引用（Weak Reference）\n\n> 弱引用也是用来描述那些非必须对象，但是它的强度比软引用更弱一些，被弱引用关联的对象**只能生存到下一次垃圾收集发生为止**。当垃圾收集器开始工作，无论当前内存是否足够，都会回收掉只被弱引用关联的对象。\n>\n> <font color=red>回收时机:下一次垃圾回收时</font>\n\n```java\n//弱引用\n\nWeakReference<Object> wrf = new WeakReference<Object>(new Object());\n\n//or\nObject obj=new Object();\nWeakReference<Object> wrf = new WeakReference<Object>(new Object());\nobj=null;\n```\n\n\n\n### 虚引用（Phantom Reference）\n\n> 虚引用也称为“幽灵引用”或者“幻影引用”，它是最弱的一种引用关系。一个对象是否有虚引用的存在，完全不会对其生存时间构成影响，也无法通过虚引用来取得一个对象实例。\n>\n> <font color=red>回收时机:随时</font>\n\n```java\n//虚引用\nPhantomReference<Object> prf = new PhantomReference<Object>(new Object(), new ReferenceQueue<>());\n\n//or\n\nObject obj=new Object();\nPhantomReference<Object> prf = new PhantomReference<Object>(obj, new ReferenceQueue<>());\nobj=null;\n```\n","slug":"java/jvm/jvm-object-four-quote","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bmb009f2mg5prhna1ul","content":"<p><img src=\"http://cdn.mjava.top/blog/20200526225718\" alt></p>\n<h2 id=\"强引用（Strongly-Reference）\"><a href=\"#强引用（Strongly-Reference）\" class=\"headerlink\" title=\"强引用（Strongly Reference）\"></a>强引用（Strongly Reference）</h2><blockquote>\n<p>无论任何情况下，只要强引用关系还存在，垃圾收集器就永远不会回收掉被引用的对象。</p>\n<p><font color=\"red\">回收时机:强引用关系不存在时</font></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Object obj=<span class=\"keyword\">new</span> Object();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"软引用（Soft-Reference）\"><a href=\"#软引用（Soft-Reference）\" class=\"headerlink\" title=\"软引用（Soft Reference）\"></a>软引用（Soft Reference）</h2><blockquote>\n<p>软引用是用来描述一些还有用，但非必须的对象。只被软引用关联着的对象，在系统将要发生内存溢出异常前，会把这些对象列进回收范围之中进行第二次回收，如果这次回收还没有足够的内存，才会抛出内存溢出异常。</p>\n<p><font color=\"red\">回收时机:发送内存溢出异常前</font></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//软引用</span></span><br><span class=\"line\"></span><br><span class=\"line\">SoftReference&lt;Object&gt; srf = <span class=\"keyword\">new</span> SoftReference&lt;Object&gt;(<span class=\"keyword\">new</span> Object());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//or</span></span><br><span class=\"line\"></span><br><span class=\"line\">Object obj=<span class=\"keyword\">new</span> Object();</span><br><span class=\"line\">SoftReference&lt;Object&gt; srf = <span class=\"keyword\">new</span> SoftReference&lt;Object&gt;(obj);</span><br><span class=\"line\">obj=<span class=\"keyword\">null</span>;  <span class=\"comment\">//这种方法一定要设置obj为null,否则这个对象除了软引用可达外,还有原来强引用也可达</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"弱引用（Weak-Reference）\"><a href=\"#弱引用（Weak-Reference）\" class=\"headerlink\" title=\"弱引用（Weak Reference）\"></a>弱引用（Weak Reference）</h3><blockquote>\n<p>弱引用也是用来描述那些非必须对象，但是它的强度比软引用更弱一些，被弱引用关联的对象<strong>只能生存到下一次垃圾收集发生为止</strong>。当垃圾收集器开始工作，无论当前内存是否足够，都会回收掉只被弱引用关联的对象。</p>\n<p><font color=\"red\">回收时机:下一次垃圾回收时</font></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//弱引用</span></span><br><span class=\"line\"></span><br><span class=\"line\">WeakReference&lt;Object&gt; wrf = <span class=\"keyword\">new</span> WeakReference&lt;Object&gt;(<span class=\"keyword\">new</span> Object());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//or</span></span><br><span class=\"line\">Object obj=<span class=\"keyword\">new</span> Object();</span><br><span class=\"line\">WeakReference&lt;Object&gt; wrf = <span class=\"keyword\">new</span> WeakReference&lt;Object&gt;(<span class=\"keyword\">new</span> Object());</span><br><span class=\"line\">obj=<span class=\"keyword\">null</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"虚引用（Phantom-Reference）\"><a href=\"#虚引用（Phantom-Reference）\" class=\"headerlink\" title=\"虚引用（Phantom Reference）\"></a>虚引用（Phantom Reference）</h3><blockquote>\n<p>虚引用也称为“幽灵引用”或者“幻影引用”，它是最弱的一种引用关系。一个对象是否有虚引用的存在，完全不会对其生存时间构成影响，也无法通过虚引用来取得一个对象实例。</p>\n<p><font color=\"red\">回收时机:随时</font></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//虚引用</span></span><br><span class=\"line\">PhantomReference&lt;Object&gt; prf = <span class=\"keyword\">new</span> PhantomReference&lt;Object&gt;(<span class=\"keyword\">new</span> Object(), <span class=\"keyword\">new</span> ReferenceQueue&lt;&gt;());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//or</span></span><br><span class=\"line\"></span><br><span class=\"line\">Object obj=<span class=\"keyword\">new</span> Object();</span><br><span class=\"line\">PhantomReference&lt;Object&gt; prf = <span class=\"keyword\">new</span> PhantomReference&lt;Object&gt;(obj, <span class=\"keyword\">new</span> ReferenceQueue&lt;&gt;());</span><br><span class=\"line\">obj=<span class=\"keyword\">null</span>;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<p><img src=\"http://cdn.mjava.top/blog/20200526225718\" alt></p>\n<h2 id=\"强引用（Strongly-Reference）\"><a href=\"#强引用（Strongly-Reference）\" class=\"headerlink\" title=\"强引用（Strongly Reference）\"></a>强引用（Strongly Reference）</h2><blockquote>\n<p>无论任何情况下，只要强引用关系还存在，垃圾收集器就永远不会回收掉被引用的对象。</p>\n<p><font color=\"red\">回收时机:强引用关系不存在时</font></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">Object obj=<span class=\"keyword\">new</span> Object();</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"软引用（Soft-Reference）\"><a href=\"#软引用（Soft-Reference）\" class=\"headerlink\" title=\"软引用（Soft Reference）\"></a>软引用（Soft Reference）</h2><blockquote>\n<p>软引用是用来描述一些还有用，但非必须的对象。只被软引用关联着的对象，在系统将要发生内存溢出异常前，会把这些对象列进回收范围之中进行第二次回收，如果这次回收还没有足够的内存，才会抛出内存溢出异常。</p>\n<p><font color=\"red\">回收时机:发送内存溢出异常前</font></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//软引用</span></span><br><span class=\"line\"></span><br><span class=\"line\">SoftReference&lt;Object&gt; srf = <span class=\"keyword\">new</span> SoftReference&lt;Object&gt;(<span class=\"keyword\">new</span> Object());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//or</span></span><br><span class=\"line\"></span><br><span class=\"line\">Object obj=<span class=\"keyword\">new</span> Object();</span><br><span class=\"line\">SoftReference&lt;Object&gt; srf = <span class=\"keyword\">new</span> SoftReference&lt;Object&gt;(obj);</span><br><span class=\"line\">obj=<span class=\"keyword\">null</span>;  <span class=\"comment\">//这种方法一定要设置obj为null,否则这个对象除了软引用可达外,还有原来强引用也可达</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"弱引用（Weak-Reference）\"><a href=\"#弱引用（Weak-Reference）\" class=\"headerlink\" title=\"弱引用（Weak Reference）\"></a>弱引用（Weak Reference）</h3><blockquote>\n<p>弱引用也是用来描述那些非必须对象，但是它的强度比软引用更弱一些，被弱引用关联的对象<strong>只能生存到下一次垃圾收集发生为止</strong>。当垃圾收集器开始工作，无论当前内存是否足够，都会回收掉只被弱引用关联的对象。</p>\n<p><font color=\"red\">回收时机:下一次垃圾回收时</font></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//弱引用</span></span><br><span class=\"line\"></span><br><span class=\"line\">WeakReference&lt;Object&gt; wrf = <span class=\"keyword\">new</span> WeakReference&lt;Object&gt;(<span class=\"keyword\">new</span> Object());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//or</span></span><br><span class=\"line\">Object obj=<span class=\"keyword\">new</span> Object();</span><br><span class=\"line\">WeakReference&lt;Object&gt; wrf = <span class=\"keyword\">new</span> WeakReference&lt;Object&gt;(<span class=\"keyword\">new</span> Object());</span><br><span class=\"line\">obj=<span class=\"keyword\">null</span>;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"虚引用（Phantom-Reference）\"><a href=\"#虚引用（Phantom-Reference）\" class=\"headerlink\" title=\"虚引用（Phantom Reference）\"></a>虚引用（Phantom Reference）</h3><blockquote>\n<p>虚引用也称为“幽灵引用”或者“幻影引用”，它是最弱的一种引用关系。一个对象是否有虚引用的存在，完全不会对其生存时间构成影响，也无法通过虚引用来取得一个对象实例。</p>\n<p><font color=\"red\">回收时机:随时</font></p>\n</blockquote>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//虚引用</span></span><br><span class=\"line\">PhantomReference&lt;Object&gt; prf = <span class=\"keyword\">new</span> PhantomReference&lt;Object&gt;(<span class=\"keyword\">new</span> Object(), <span class=\"keyword\">new</span> ReferenceQueue&lt;&gt;());</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//or</span></span><br><span class=\"line\"></span><br><span class=\"line\">Object obj=<span class=\"keyword\">new</span> Object();</span><br><span class=\"line\">PhantomReference&lt;Object&gt; prf = <span class=\"keyword\">new</span> PhantomReference&lt;Object&gt;(obj, <span class=\"keyword\">new</span> ReferenceQueue&lt;&gt;());</span><br><span class=\"line\">obj=<span class=\"keyword\">null</span>;</span><br></pre></td></tr></table></figure>\n\n"},{"title":"JVM判断对象是否还活着的两种方法","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-05-29T02:18:30.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n## 引用计数法\n\n> Java虚拟机**并不是**通过引用计数算法来判断对象是否存活的。\n\n在对象中添加一个引用计数器，每当有一个地方引用它时，计数器值就加一；当引用失效时，计数器值就减一；任何时刻计数器为零的对象就是不可能再被使用的。\n\n### 优点\n\n- 原理简单,判定效率高\n\n### 缺点\n\n- 不能用于复杂的环境中,比如对象的互相引用问题\n\n\n\n##  可达性分析算法\n\n> Java虚拟机使用此算法来判断对象是否存活\n\n这个算法的基本思路就是通过一系列称为“`GC Roots`”的根对象作为起始节点集，从这些节点开始，根据引用关系向下搜索，**搜索过程所走过的路径称为“引用链”（Reference Chain）**，如果某个对象到GCRoots间**没有任何引用链相连**，或者用图论的话来说就是**从GC Roots到这个对象不可达时**，则证明**此对象是不可能再被使用的**。\n\n![](http://cdn.mjava.top/blog/20200526224246.jpeg)\n\n\n\nJava中作为GC Roots的对象:\n\n- 在虚拟机栈（**栈帧中的本地变量表**）中引用的对象，譬如各个线程被调用的方法堆栈中使用到的参数、局部变量、临时变量等。\n- 在方法区中类静态属性引用的对象，譬如Java类的引用类型静态变量。\n- 在方法区中常量引用的对象，譬如字符串常量池（String Table）里的引用。\n- 在本地方法栈中JNI（即通常所说的Native方法）引用的对象。\n- Java虚拟机内部的引用，如基本数据类型对应的Class对象，一些常驻的异常对象（比如NullPointExcepiton、OutOfMemoryError）等，还有系统类加载器。\n- 所有被同步锁（synchronized关键字）持有的对象。\n\n- 反映Java虚拟机内部情况的JMXBean、JVMTI中注册的回调、本地代码缓存等。\n- **其他对象临时性地加入,共同构成GC Roots**","source":"_posts/java/jvm/jvm-object-is-alive.md","raw":"---\ntitle: JVM判断对象是否还活着的两种方法\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-05-29 10:18:30\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- JVM\ncategories:\n- JVM\n---\n\n\n\n## 引用计数法\n\n> Java虚拟机**并不是**通过引用计数算法来判断对象是否存活的。\n\n在对象中添加一个引用计数器，每当有一个地方引用它时，计数器值就加一；当引用失效时，计数器值就减一；任何时刻计数器为零的对象就是不可能再被使用的。\n\n### 优点\n\n- 原理简单,判定效率高\n\n### 缺点\n\n- 不能用于复杂的环境中,比如对象的互相引用问题\n\n\n\n##  可达性分析算法\n\n> Java虚拟机使用此算法来判断对象是否存活\n\n这个算法的基本思路就是通过一系列称为“`GC Roots`”的根对象作为起始节点集，从这些节点开始，根据引用关系向下搜索，**搜索过程所走过的路径称为“引用链”（Reference Chain）**，如果某个对象到GCRoots间**没有任何引用链相连**，或者用图论的话来说就是**从GC Roots到这个对象不可达时**，则证明**此对象是不可能再被使用的**。\n\n![](http://cdn.mjava.top/blog/20200526224246.jpeg)\n\n\n\nJava中作为GC Roots的对象:\n\n- 在虚拟机栈（**栈帧中的本地变量表**）中引用的对象，譬如各个线程被调用的方法堆栈中使用到的参数、局部变量、临时变量等。\n- 在方法区中类静态属性引用的对象，譬如Java类的引用类型静态变量。\n- 在方法区中常量引用的对象，譬如字符串常量池（String Table）里的引用。\n- 在本地方法栈中JNI（即通常所说的Native方法）引用的对象。\n- Java虚拟机内部的引用，如基本数据类型对应的Class对象，一些常驻的异常对象（比如NullPointExcepiton、OutOfMemoryError）等，还有系统类加载器。\n- 所有被同步锁（synchronized关键字）持有的对象。\n\n- 反映Java虚拟机内部情况的JMXBean、JVMTI中注册的回调、本地代码缓存等。\n- **其他对象临时性地加入,共同构成GC Roots**","slug":"java/jvm/jvm-object-is-alive","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bmc009j2mg5ekubg0m6","content":"<h2 id=\"引用计数法\"><a href=\"#引用计数法\" class=\"headerlink\" title=\"引用计数法\"></a>引用计数法</h2><blockquote>\n<p>Java虚拟机<strong>并不是</strong>通过引用计数算法来判断对象是否存活的。</p>\n</blockquote>\n<p>在对象中添加一个引用计数器，每当有一个地方引用它时，计数器值就加一；当引用失效时，计数器值就减一；任何时刻计数器为零的对象就是不可能再被使用的。</p>\n<h3 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h3><ul>\n<li>原理简单,判定效率高</li>\n</ul>\n<h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>不能用于复杂的环境中,比如对象的互相引用问题</li>\n</ul>\n<h2 id=\"可达性分析算法\"><a href=\"#可达性分析算法\" class=\"headerlink\" title=\"可达性分析算法\"></a>可达性分析算法</h2><blockquote>\n<p>Java虚拟机使用此算法来判断对象是否存活</p>\n</blockquote>\n<p>这个算法的基本思路就是通过一系列称为“<code>GC Roots</code>”的根对象作为起始节点集，从这些节点开始，根据引用关系向下搜索，<strong>搜索过程所走过的路径称为“引用链”（Reference Chain）</strong>，如果某个对象到GCRoots间<strong>没有任何引用链相连</strong>，或者用图论的话来说就是<strong>从GC Roots到这个对象不可达时</strong>，则证明<strong>此对象是不可能再被使用的</strong>。</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200526224246.jpeg\" alt></p>\n<p>Java中作为GC Roots的对象:</p>\n<ul>\n<li><p>在虚拟机栈（<strong>栈帧中的本地变量表</strong>）中引用的对象，譬如各个线程被调用的方法堆栈中使用到的参数、局部变量、临时变量等。</p>\n</li>\n<li><p>在方法区中类静态属性引用的对象，譬如Java类的引用类型静态变量。</p>\n</li>\n<li><p>在方法区中常量引用的对象，譬如字符串常量池（String Table）里的引用。</p>\n</li>\n<li><p>在本地方法栈中JNI（即通常所说的Native方法）引用的对象。</p>\n</li>\n<li><p>Java虚拟机内部的引用，如基本数据类型对应的Class对象，一些常驻的异常对象（比如NullPointExcepiton、OutOfMemoryError）等，还有系统类加载器。</p>\n</li>\n<li><p>所有被同步锁（synchronized关键字）持有的对象。</p>\n</li>\n<li><p>反映Java虚拟机内部情况的JMXBean、JVMTI中注册的回调、本地代码缓存等。</p>\n</li>\n<li><p><strong>其他对象临时性地加入,共同构成GC Roots</strong></p>\n</li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"引用计数法\"><a href=\"#引用计数法\" class=\"headerlink\" title=\"引用计数法\"></a>引用计数法</h2><blockquote>\n<p>Java虚拟机<strong>并不是</strong>通过引用计数算法来判断对象是否存活的。</p>\n</blockquote>\n<p>在对象中添加一个引用计数器，每当有一个地方引用它时，计数器值就加一；当引用失效时，计数器值就减一；任何时刻计数器为零的对象就是不可能再被使用的。</p>\n<h3 id=\"优点\"><a href=\"#优点\" class=\"headerlink\" title=\"优点\"></a>优点</h3><ul>\n<li>原理简单,判定效率高</li>\n</ul>\n<h3 id=\"缺点\"><a href=\"#缺点\" class=\"headerlink\" title=\"缺点\"></a>缺点</h3><ul>\n<li>不能用于复杂的环境中,比如对象的互相引用问题</li>\n</ul>\n<h2 id=\"可达性分析算法\"><a href=\"#可达性分析算法\" class=\"headerlink\" title=\"可达性分析算法\"></a>可达性分析算法</h2><blockquote>\n<p>Java虚拟机使用此算法来判断对象是否存活</p>\n</blockquote>\n<p>这个算法的基本思路就是通过一系列称为“<code>GC Roots</code>”的根对象作为起始节点集，从这些节点开始，根据引用关系向下搜索，<strong>搜索过程所走过的路径称为“引用链”（Reference Chain）</strong>，如果某个对象到GCRoots间<strong>没有任何引用链相连</strong>，或者用图论的话来说就是<strong>从GC Roots到这个对象不可达时</strong>，则证明<strong>此对象是不可能再被使用的</strong>。</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200526224246.jpeg\" alt></p>\n<p>Java中作为GC Roots的对象:</p>\n<ul>\n<li><p>在虚拟机栈（<strong>栈帧中的本地变量表</strong>）中引用的对象，譬如各个线程被调用的方法堆栈中使用到的参数、局部变量、临时变量等。</p>\n</li>\n<li><p>在方法区中类静态属性引用的对象，譬如Java类的引用类型静态变量。</p>\n</li>\n<li><p>在方法区中常量引用的对象，譬如字符串常量池（String Table）里的引用。</p>\n</li>\n<li><p>在本地方法栈中JNI（即通常所说的Native方法）引用的对象。</p>\n</li>\n<li><p>Java虚拟机内部的引用，如基本数据类型对应的Class对象，一些常驻的异常对象（比如NullPointExcepiton、OutOfMemoryError）等，还有系统类加载器。</p>\n</li>\n<li><p>所有被同步锁（synchronized关键字）持有的对象。</p>\n</li>\n<li><p>反映Java虚拟机内部情况的JMXBean、JVMTI中注册的回调、本地代码缓存等。</p>\n</li>\n<li><p><strong>其他对象临时性地加入,共同构成GC Roots</strong></p>\n</li>\n</ul>\n"},{"title":"Java的NIO编程-Selector","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-03-01T02:07:07.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 0x1 监控\n\n通道和选择器之间的关系，通过`register`（注册）的方式完成。调用通道的`Channel.register`（Selector sel, int ops）方法，可以将通道实例注册到一个选择器中。`register方法`有两个参数：第一个参数，指定通道注册到的**选择器实例**；第二个参数，指定选择器要监控的**IO事件类型**。\n\nIO事件类型有：\n\n- 可读：`SelectionKey.OP_READ`\n- 可写：`SelectionKey.OP_WRITE`\n- 连接：`SelectionKey.OP_CONNECT`\n- 接收：`SelectionKey.OP_ACCEPT`\n\n> 如果一下要监控多个事件的话可以用`位或`运算符来实现\n>\n> ```java\n> int key = SelectionKey.OP_READ | SelectionKey.OP_WRITE;\n> ```\n\n## 0x2 SelectionKey选择键\n\n选择键的功能是很强大的。通过`SelectionKey`选择键，不仅仅可以获得通道的**IO事件类型**，比方说`SelectionKey.OP_READ`；还可以获得发生**IO事件所在的通道**；另外，也可以获得选出选择键的**选择器实例**。\n\n### 常用方法\n\n- `isAcceptable()`：判断IO事件类型是否是`SelectionKey.OP_ACCEPT`\n- `isReadable()`：判断IO事件是否是`SelectionKey.OP_READ`\n- `isConnectable()`:判断IO事件是否是`SelectionKey.OP_CONNECT`\n- `isWritable()`：判断IO事件是否是`SelectionKey.OP_WRITE`\n\n## 0x3 使用条件\n\n并不是所有的`Channel`都可以使用`Selector`，判断一个通道能否被选择器监控或选择，有一个前提：判断它是否继承了抽象类`SelectableChannel`（可选择通道）。如果继承了`SelectableChannel`，则可以被选择，否则不能。\n\n简单地说，一条通道若能被选择，必须继承`SelectableChannel`类。\n\n> `FileChannel`就没有继承`SelectableChannel`类，所以不能使用`Selector`\n\n## 0x4 使用流程\n\n使用选择器，主要有以下三步：\n\n1. 获取选择器实例；\n2. 将通道注册到选择器中；\n3. 轮询感兴趣的IO就绪事件（选择键集合）。\n\n## 0x5 Demo\n\n源码地址： https://github.com/GreyCode9/nio-demo/tree/main/src/io/selector","source":"_posts/java/nio/2571330c-67ef-4d4c-8717-6c96768009c7.md","raw":"---\ntitle: Java的NIO编程-Selector\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-03-01 10:07:07\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Java\n- Nio\ncategories:\n- Java\n---\n\n## 0x1 监控\n\n通道和选择器之间的关系，通过`register`（注册）的方式完成。调用通道的`Channel.register`（Selector sel, int ops）方法，可以将通道实例注册到一个选择器中。`register方法`有两个参数：第一个参数，指定通道注册到的**选择器实例**；第二个参数，指定选择器要监控的**IO事件类型**。\n\nIO事件类型有：\n\n- 可读：`SelectionKey.OP_READ`\n- 可写：`SelectionKey.OP_WRITE`\n- 连接：`SelectionKey.OP_CONNECT`\n- 接收：`SelectionKey.OP_ACCEPT`\n\n> 如果一下要监控多个事件的话可以用`位或`运算符来实现\n>\n> ```java\n> int key = SelectionKey.OP_READ | SelectionKey.OP_WRITE;\n> ```\n\n## 0x2 SelectionKey选择键\n\n选择键的功能是很强大的。通过`SelectionKey`选择键，不仅仅可以获得通道的**IO事件类型**，比方说`SelectionKey.OP_READ`；还可以获得发生**IO事件所在的通道**；另外，也可以获得选出选择键的**选择器实例**。\n\n### 常用方法\n\n- `isAcceptable()`：判断IO事件类型是否是`SelectionKey.OP_ACCEPT`\n- `isReadable()`：判断IO事件是否是`SelectionKey.OP_READ`\n- `isConnectable()`:判断IO事件是否是`SelectionKey.OP_CONNECT`\n- `isWritable()`：判断IO事件是否是`SelectionKey.OP_WRITE`\n\n## 0x3 使用条件\n\n并不是所有的`Channel`都可以使用`Selector`，判断一个通道能否被选择器监控或选择，有一个前提：判断它是否继承了抽象类`SelectableChannel`（可选择通道）。如果继承了`SelectableChannel`，则可以被选择，否则不能。\n\n简单地说，一条通道若能被选择，必须继承`SelectableChannel`类。\n\n> `FileChannel`就没有继承`SelectableChannel`类，所以不能使用`Selector`\n\n## 0x4 使用流程\n\n使用选择器，主要有以下三步：\n\n1. 获取选择器实例；\n2. 将通道注册到选择器中；\n3. 轮询感兴趣的IO就绪事件（选择键集合）。\n\n## 0x5 Demo\n\n源码地址： https://github.com/GreyCode9/nio-demo/tree/main/src/io/selector","slug":"java/nio/2571330c-67ef-4d4c-8717-6c96768009c7","published":1,"updated":"2021-03-01T02:09:52.898Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bme009n2mg5tam6oqp8","content":"<h2 id=\"0x1-监控\"><a href=\"#0x1-监控\" class=\"headerlink\" title=\"0x1 监控\"></a>0x1 监控</h2><p>通道和选择器之间的关系，通过<code>register</code>（注册）的方式完成。调用通道的<code>Channel.register</code>（Selector sel, int ops）方法，可以将通道实例注册到一个选择器中。<code>register方法</code>有两个参数：第一个参数，指定通道注册到的<strong>选择器实例</strong>；第二个参数，指定选择器要监控的<strong>IO事件类型</strong>。</p>\n<p>IO事件类型有：</p>\n<ul>\n<li>可读：<code>SelectionKey.OP_READ</code></li>\n<li>可写：<code>SelectionKey.OP_WRITE</code></li>\n<li>连接：<code>SelectionKey.OP_CONNECT</code></li>\n<li>接收：<code>SelectionKey.OP_ACCEPT</code></li>\n</ul>\n<blockquote>\n<p>如果一下要监控多个事件的话可以用<code>位或</code>运算符来实现</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"keyword\">int</span> key = SelectionKey.OP_READ | SelectionKey.OP_WRITE;</span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<h2 id=\"0x2-SelectionKey选择键\"><a href=\"#0x2-SelectionKey选择键\" class=\"headerlink\" title=\"0x2 SelectionKey选择键\"></a>0x2 SelectionKey选择键</h2><p>选择键的功能是很强大的。通过<code>SelectionKey</code>选择键，不仅仅可以获得通道的<strong>IO事件类型</strong>，比方说<code>SelectionKey.OP_READ</code>；还可以获得发生<strong>IO事件所在的通道</strong>；另外，也可以获得选出选择键的<strong>选择器实例</strong>。</p>\n<h3 id=\"常用方法\"><a href=\"#常用方法\" class=\"headerlink\" title=\"常用方法\"></a>常用方法</h3><ul>\n<li><code>isAcceptable()</code>：判断IO事件类型是否是<code>SelectionKey.OP_ACCEPT</code></li>\n<li><code>isReadable()</code>：判断IO事件是否是<code>SelectionKey.OP_READ</code></li>\n<li><code>isConnectable()</code>:判断IO事件是否是<code>SelectionKey.OP_CONNECT</code></li>\n<li><code>isWritable()</code>：判断IO事件是否是<code>SelectionKey.OP_WRITE</code></li>\n</ul>\n<h2 id=\"0x3-使用条件\"><a href=\"#0x3-使用条件\" class=\"headerlink\" title=\"0x3 使用条件\"></a>0x3 使用条件</h2><p>并不是所有的<code>Channel</code>都可以使用<code>Selector</code>，判断一个通道能否被选择器监控或选择，有一个前提：判断它是否继承了抽象类<code>SelectableChannel</code>（可选择通道）。如果继承了<code>SelectableChannel</code>，则可以被选择，否则不能。</p>\n<p>简单地说，一条通道若能被选择，必须继承<code>SelectableChannel</code>类。</p>\n<blockquote>\n<p><code>FileChannel</code>就没有继承<code>SelectableChannel</code>类，所以不能使用<code>Selector</code></p>\n</blockquote>\n<h2 id=\"0x4-使用流程\"><a href=\"#0x4-使用流程\" class=\"headerlink\" title=\"0x4 使用流程\"></a>0x4 使用流程</h2><p>使用选择器，主要有以下三步：</p>\n<ol>\n<li>获取选择器实例；</li>\n<li>将通道注册到选择器中；</li>\n<li>轮询感兴趣的IO就绪事件（选择键集合）。</li>\n</ol>\n<h2 id=\"0x5-Demo\"><a href=\"#0x5-Demo\" class=\"headerlink\" title=\"0x5 Demo\"></a>0x5 Demo</h2><p>源码地址： <a href=\"https://github.com/GreyCode9/nio-demo/tree/main/src/io/selector\" rel=\"noopener\" target=\"_blank\">https://github.com/GreyCode9/nio-demo/tree/main/src/io/selector</a></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"0x1-监控\"><a href=\"#0x1-监控\" class=\"headerlink\" title=\"0x1 监控\"></a>0x1 监控</h2><p>通道和选择器之间的关系，通过<code>register</code>（注册）的方式完成。调用通道的<code>Channel.register</code>（Selector sel, int ops）方法，可以将通道实例注册到一个选择器中。<code>register方法</code>有两个参数：第一个参数，指定通道注册到的<strong>选择器实例</strong>；第二个参数，指定选择器要监控的<strong>IO事件类型</strong>。</p>\n<p>IO事件类型有：</p>\n<ul>\n<li>可读：<code>SelectionKey.OP_READ</code></li>\n<li>可写：<code>SelectionKey.OP_WRITE</code></li>\n<li>连接：<code>SelectionKey.OP_CONNECT</code></li>\n<li>接收：<code>SelectionKey.OP_ACCEPT</code></li>\n</ul>\n<blockquote>\n<p>如果一下要监控多个事件的话可以用<code>位或</code>运算符来实现</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"keyword\">int</span> key = SelectionKey.OP_READ | SelectionKey.OP_WRITE;</span><br><span class=\"line\">&gt;</span><br></pre></td></tr></table></figure>\n</blockquote>\n<h2 id=\"0x2-SelectionKey选择键\"><a href=\"#0x2-SelectionKey选择键\" class=\"headerlink\" title=\"0x2 SelectionKey选择键\"></a>0x2 SelectionKey选择键</h2><p>选择键的功能是很强大的。通过<code>SelectionKey</code>选择键，不仅仅可以获得通道的<strong>IO事件类型</strong>，比方说<code>SelectionKey.OP_READ</code>；还可以获得发生<strong>IO事件所在的通道</strong>；另外，也可以获得选出选择键的<strong>选择器实例</strong>。</p>\n<h3 id=\"常用方法\"><a href=\"#常用方法\" class=\"headerlink\" title=\"常用方法\"></a>常用方法</h3><ul>\n<li><code>isAcceptable()</code>：判断IO事件类型是否是<code>SelectionKey.OP_ACCEPT</code></li>\n<li><code>isReadable()</code>：判断IO事件是否是<code>SelectionKey.OP_READ</code></li>\n<li><code>isConnectable()</code>:判断IO事件是否是<code>SelectionKey.OP_CONNECT</code></li>\n<li><code>isWritable()</code>：判断IO事件是否是<code>SelectionKey.OP_WRITE</code></li>\n</ul>\n<h2 id=\"0x3-使用条件\"><a href=\"#0x3-使用条件\" class=\"headerlink\" title=\"0x3 使用条件\"></a>0x3 使用条件</h2><p>并不是所有的<code>Channel</code>都可以使用<code>Selector</code>，判断一个通道能否被选择器监控或选择，有一个前提：判断它是否继承了抽象类<code>SelectableChannel</code>（可选择通道）。如果继承了<code>SelectableChannel</code>，则可以被选择，否则不能。</p>\n<p>简单地说，一条通道若能被选择，必须继承<code>SelectableChannel</code>类。</p>\n<blockquote>\n<p><code>FileChannel</code>就没有继承<code>SelectableChannel</code>类，所以不能使用<code>Selector</code></p>\n</blockquote>\n<h2 id=\"0x4-使用流程\"><a href=\"#0x4-使用流程\" class=\"headerlink\" title=\"0x4 使用流程\"></a>0x4 使用流程</h2><p>使用选择器，主要有以下三步：</p>\n<ol>\n<li>获取选择器实例；</li>\n<li>将通道注册到选择器中；</li>\n<li>轮询感兴趣的IO就绪事件（选择键集合）。</li>\n</ol>\n<h2 id=\"0x5-Demo\"><a href=\"#0x5-Demo\" class=\"headerlink\" title=\"0x5 Demo\"></a>0x5 Demo</h2><p>源码地址： <a href=\"https://github.com/GreyCode9/nio-demo/tree/main/src/io/selector\" rel=\"noopener\" target=\"_blank\">https://github.com/GreyCode9/nio-demo/tree/main/src/io/selector</a></p>\n"},{"title":"JVM运行时数据区域","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-05-26T08:35:47.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n# JVM运行时数据区域\n\n![Java虚拟机运行时数据区](http://cdn.mjava.top/blog/20200526000623.jpeg)\n\n### 程序计数器\n\n- 线程私有\n\n- 唯一一个没有规定 OutOfMemoryError 异常 的区域\n\n- 它可以看作是当前线程所执行的字节码的行号指示器\n\n- 如果线程正在执行的是一个Java方法，这个计数器记录的是正在执行的虚拟机字节码指令的地址；如果正在执行的是本地（Native）方法，这个计数器值则应为空（Undefined）\n\n  \n\n  > (摘自网上)我们想象下，CPU是怎么知道记住之前A线程，执行到哪一处的？\n  >\n  > 答案是，CPU根本就不会记住之前执行到哪里了，它只是埋头苦干；那是什么保证了切换线程的程序可以正常执行的；答案是 ： 程序计数器 ；**程序计数器里面保存的是 当前线程执行的字节码的行号**（看着像行号，其实是指令地址）；\n  >\n  > 那么，我们需要几个程序计数器呢？如果，我们只有一个的话，切换B线程以后，程序计数器里面保存的就是B线程所执行的字节码的行号了，再切换回A线程，就蒙圈了，不知道执行到哪里了，因为，程序计数器里面保存的是B线程当前执行的字节码地址 ；因此，我们可以想象出，要为每个线程都分配一个程序计数器，因此，**程序计数器的内存空间是线程私**有的 ；这样即使线程 A 被挂起，但是线程 A 里面的程序计数器，记住了A线程当前执行到的字节码的指令地址了 ，等再次切回到A线程的时候，看一下程序计数器，就知道之前执行到哪里了！\n  >\n  > 那么程序计数器，什么时候分配内存呢？我们试想下，一个线程在执行的任何期间，都会失去CPU执行权，因此，我们要从一个线程被创建开始执行，就要无时无刻的记录着该线程当前执行到哪里了！因此，线程计数器，必须是**线程被创建开始执行的时候，就要一同被创建**； \n  >\n  > 程序计数器，保存的是当前执行的字节码的偏移地址（也就是之前说的行号，其实那不是行号，是指令的偏移地址，只是为了好理解，才说是行号的，），当执行到下一条指令的时候，改变的只是程序计数器中保存的地址，并不需要申请新的内存来保存新的指令地址；因此，永远都不可能内存溢出的；因此，jvm虚拟机规范，也就没有规定，也是**唯一一个没有规定 OutOfMemoryError 异常 的区域**;\n  >\n  > **当线程执行的是本地方法的时候，程序计数器中保存的值是空（undefined）**；原因很简单：本地方法是C++/C 写的，由系统调用，根本不会产生字节码文件，因此，程序计数器也就不会做任何记录 \n\n\n\n### Java虚拟机栈\n\n- 线程私有\n- 如果线程请求的栈深度大于虚拟机所允许的深度，将抛出`StackOverflowError异常`；\n- 如果Java虚拟机栈容量可以动态扩展，当栈扩展时无法申请到足够的内存会抛出`OutOfMemoryError异常`；(<font color=red>HotSpot虚拟机的栈容量是不可以动态扩展的，以前的Classic虚拟机倒是可以。所以在HotSpot虚拟机上是不会由于虚拟机栈无法扩展而导致OutOfMemoryError异常——只要线程申请栈空间成功了就不会有OOM，但是如果申请时就失败，仍然是会出现OOM异常的</font>)\n- **-Xss5m**:\t设置5m的栈容量\n- 每个方法执行都会创建一个**栈帧**，栈帧包含局部变量表、操作数栈、动态连接、方法出口等\n\n### 本地方法栈\n\n- 线程私有\n- 与Java虚拟机栈相似\n\n- 与Java虚拟机栈区别:\tJava虚拟机栈为虚拟机执行Java方法（也就是字节码）服务，而本地方法栈则是为虚拟机使用到的本地（Native）方法服务。\n- Hot-Spot虚拟机直接就把本地方法栈和虚拟机栈合二为一\n\n- 与虚拟机栈一样，本地方法栈也会在栈深度溢出或者栈扩展失败时分别抛出StackOverflowError和OutOfMemoryError异常\n\n### Java堆\n\n- 线程共享\n- 所有的Java对象实例不一定都在Java堆上分配内存\n- Java堆既可以被实现成固定大小的，也可以是可扩展的，不过当前主流的Java虚拟机都是按照可扩展来实现的（通过参数`-Xmx`和`-Xms`设定）。\n- 如果在Java堆中没有内存完成实例分配，并且堆也无法再扩展时，Java虚拟机将会抛出**OutOfMemoryError异常**。\n- Java堆是垃圾收集器(Garbage Collected)管理的内存区域\n\n\n\n### 方法区\n\n- 线程共享\n\n- 用于存储已被虚拟机加载的类型信息、常量、静态变量、即时编译器编译后的代码缓存等数据。\n\n- 虽然《Java虚拟机规范》中把方法区描述为堆的一个逻辑部分，但是它却有一个别名叫作**“非堆”（Non-Heap）**，目的是**与Java堆区分开来**。\n\n- 在JDK1.6及之前,使用`永久代`来实现方法区.\n\n  - -XX:MaxPermSize    设置永久代内存上限\n  - -XX:PermSize    设置永久代内存\n\n- JDK1.7把`字符串常量池`、`类的静态变量(class statics)`转移到了java heap,但是永久代还是存在,主要放一些类信息(`运算时常量池`)等.\n\n  \n\n- JDK1.8彻底移除永久代,方法区采用本地内存中实现的元空间（Meta-space）来代替,将JDK1.7中永久代的信息移到了元空间,像`字符串常量池`和`静态变量`还是存在Java Heap中\n\n- 如果方法区无法满足新的内存分配需求时，将抛出**OutOfMemoryError异常**。\n\n","source":"_posts/java/jvm/jvm-running-data-area.md","raw":"---\ntitle: JVM运行时数据区域\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-05-26 16:35:47\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- JVM\ncategories:\n- JVM\n---\n\n# JVM运行时数据区域\n\n![Java虚拟机运行时数据区](http://cdn.mjava.top/blog/20200526000623.jpeg)\n\n### 程序计数器\n\n- 线程私有\n\n- 唯一一个没有规定 OutOfMemoryError 异常 的区域\n\n- 它可以看作是当前线程所执行的字节码的行号指示器\n\n- 如果线程正在执行的是一个Java方法，这个计数器记录的是正在执行的虚拟机字节码指令的地址；如果正在执行的是本地（Native）方法，这个计数器值则应为空（Undefined）\n\n  \n\n  > (摘自网上)我们想象下，CPU是怎么知道记住之前A线程，执行到哪一处的？\n  >\n  > 答案是，CPU根本就不会记住之前执行到哪里了，它只是埋头苦干；那是什么保证了切换线程的程序可以正常执行的；答案是 ： 程序计数器 ；**程序计数器里面保存的是 当前线程执行的字节码的行号**（看着像行号，其实是指令地址）；\n  >\n  > 那么，我们需要几个程序计数器呢？如果，我们只有一个的话，切换B线程以后，程序计数器里面保存的就是B线程所执行的字节码的行号了，再切换回A线程，就蒙圈了，不知道执行到哪里了，因为，程序计数器里面保存的是B线程当前执行的字节码地址 ；因此，我们可以想象出，要为每个线程都分配一个程序计数器，因此，**程序计数器的内存空间是线程私**有的 ；这样即使线程 A 被挂起，但是线程 A 里面的程序计数器，记住了A线程当前执行到的字节码的指令地址了 ，等再次切回到A线程的时候，看一下程序计数器，就知道之前执行到哪里了！\n  >\n  > 那么程序计数器，什么时候分配内存呢？我们试想下，一个线程在执行的任何期间，都会失去CPU执行权，因此，我们要从一个线程被创建开始执行，就要无时无刻的记录着该线程当前执行到哪里了！因此，线程计数器，必须是**线程被创建开始执行的时候，就要一同被创建**； \n  >\n  > 程序计数器，保存的是当前执行的字节码的偏移地址（也就是之前说的行号，其实那不是行号，是指令的偏移地址，只是为了好理解，才说是行号的，），当执行到下一条指令的时候，改变的只是程序计数器中保存的地址，并不需要申请新的内存来保存新的指令地址；因此，永远都不可能内存溢出的；因此，jvm虚拟机规范，也就没有规定，也是**唯一一个没有规定 OutOfMemoryError 异常 的区域**;\n  >\n  > **当线程执行的是本地方法的时候，程序计数器中保存的值是空（undefined）**；原因很简单：本地方法是C++/C 写的，由系统调用，根本不会产生字节码文件，因此，程序计数器也就不会做任何记录 \n\n\n\n### Java虚拟机栈\n\n- 线程私有\n- 如果线程请求的栈深度大于虚拟机所允许的深度，将抛出`StackOverflowError异常`；\n- 如果Java虚拟机栈容量可以动态扩展，当栈扩展时无法申请到足够的内存会抛出`OutOfMemoryError异常`；(<font color=red>HotSpot虚拟机的栈容量是不可以动态扩展的，以前的Classic虚拟机倒是可以。所以在HotSpot虚拟机上是不会由于虚拟机栈无法扩展而导致OutOfMemoryError异常——只要线程申请栈空间成功了就不会有OOM，但是如果申请时就失败，仍然是会出现OOM异常的</font>)\n- **-Xss5m**:\t设置5m的栈容量\n- 每个方法执行都会创建一个**栈帧**，栈帧包含局部变量表、操作数栈、动态连接、方法出口等\n\n### 本地方法栈\n\n- 线程私有\n- 与Java虚拟机栈相似\n\n- 与Java虚拟机栈区别:\tJava虚拟机栈为虚拟机执行Java方法（也就是字节码）服务，而本地方法栈则是为虚拟机使用到的本地（Native）方法服务。\n- Hot-Spot虚拟机直接就把本地方法栈和虚拟机栈合二为一\n\n- 与虚拟机栈一样，本地方法栈也会在栈深度溢出或者栈扩展失败时分别抛出StackOverflowError和OutOfMemoryError异常\n\n### Java堆\n\n- 线程共享\n- 所有的Java对象实例不一定都在Java堆上分配内存\n- Java堆既可以被实现成固定大小的，也可以是可扩展的，不过当前主流的Java虚拟机都是按照可扩展来实现的（通过参数`-Xmx`和`-Xms`设定）。\n- 如果在Java堆中没有内存完成实例分配，并且堆也无法再扩展时，Java虚拟机将会抛出**OutOfMemoryError异常**。\n- Java堆是垃圾收集器(Garbage Collected)管理的内存区域\n\n\n\n### 方法区\n\n- 线程共享\n\n- 用于存储已被虚拟机加载的类型信息、常量、静态变量、即时编译器编译后的代码缓存等数据。\n\n- 虽然《Java虚拟机规范》中把方法区描述为堆的一个逻辑部分，但是它却有一个别名叫作**“非堆”（Non-Heap）**，目的是**与Java堆区分开来**。\n\n- 在JDK1.6及之前,使用`永久代`来实现方法区.\n\n  - -XX:MaxPermSize    设置永久代内存上限\n  - -XX:PermSize    设置永久代内存\n\n- JDK1.7把`字符串常量池`、`类的静态变量(class statics)`转移到了java heap,但是永久代还是存在,主要放一些类信息(`运算时常量池`)等.\n\n  \n\n- JDK1.8彻底移除永久代,方法区采用本地内存中实现的元空间（Meta-space）来代替,将JDK1.7中永久代的信息移到了元空间,像`字符串常量池`和`静态变量`还是存在Java Heap中\n\n- 如果方法区无法满足新的内存分配需求时，将抛出**OutOfMemoryError异常**。\n\n","slug":"java/jvm/jvm-running-data-area","published":1,"updated":"2021-01-26T09:49:03.570Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bmf009r2mg58u040y5m","content":"<h1 id=\"JVM运行时数据区域\"><a href=\"#JVM运行时数据区域\" class=\"headerlink\" title=\"JVM运行时数据区域\"></a>JVM运行时数据区域</h1><p><img src=\"http://cdn.mjava.top/blog/20200526000623.jpeg\" alt=\"Java虚拟机运行时数据区\"></p>\n<h3 id=\"程序计数器\"><a href=\"#程序计数器\" class=\"headerlink\" title=\"程序计数器\"></a>程序计数器</h3><ul>\n<li><p>线程私有</p>\n</li>\n<li><p>唯一一个没有规定 OutOfMemoryError 异常 的区域</p>\n</li>\n<li><p>它可以看作是当前线程所执行的字节码的行号指示器</p>\n</li>\n<li><p>如果线程正在执行的是一个Java方法，这个计数器记录的是正在执行的虚拟机字节码指令的地址；如果正在执行的是本地（Native）方法，这个计数器值则应为空（Undefined）</p>\n</li>\n</ul>\n<blockquote>\n<p>(摘自网上)我们想象下，CPU是怎么知道记住之前A线程，执行到哪一处的？</p>\n<p>答案是，CPU根本就不会记住之前执行到哪里了，它只是埋头苦干；那是什么保证了切换线程的程序可以正常执行的；答案是 ： 程序计数器 ；<strong>程序计数器里面保存的是 当前线程执行的字节码的行号</strong>（看着像行号，其实是指令地址）；</p>\n<p>那么，我们需要几个程序计数器呢？如果，我们只有一个的话，切换B线程以后，程序计数器里面保存的就是B线程所执行的字节码的行号了，再切换回A线程，就蒙圈了，不知道执行到哪里了，因为，程序计数器里面保存的是B线程当前执行的字节码地址 ；因此，我们可以想象出，要为每个线程都分配一个程序计数器，因此，<strong>程序计数器的内存空间是线程私</strong>有的 ；这样即使线程 A 被挂起，但是线程 A 里面的程序计数器，记住了A线程当前执行到的字节码的指令地址了 ，等再次切回到A线程的时候，看一下程序计数器，就知道之前执行到哪里了！</p>\n<p>那么程序计数器，什么时候分配内存呢？我们试想下，一个线程在执行的任何期间，都会失去CPU执行权，因此，我们要从一个线程被创建开始执行，就要无时无刻的记录着该线程当前执行到哪里了！因此，线程计数器，必须是<strong>线程被创建开始执行的时候，就要一同被创建</strong>； </p>\n<p>程序计数器，保存的是当前执行的字节码的偏移地址（也就是之前说的行号，其实那不是行号，是指令的偏移地址，只是为了好理解，才说是行号的，），当执行到下一条指令的时候，改变的只是程序计数器中保存的地址，并不需要申请新的内存来保存新的指令地址；因此，永远都不可能内存溢出的；因此，jvm虚拟机规范，也就没有规定，也是<strong>唯一一个没有规定 OutOfMemoryError 异常 的区域</strong>;</p>\n<p><strong>当线程执行的是本地方法的时候，程序计数器中保存的值是空（undefined）</strong>；原因很简单：本地方法是C++/C 写的，由系统调用，根本不会产生字节码文件，因此，程序计数器也就不会做任何记录 </p>\n</blockquote>\n<h3 id=\"Java虚拟机栈\"><a href=\"#Java虚拟机栈\" class=\"headerlink\" title=\"Java虚拟机栈\"></a>Java虚拟机栈</h3><ul>\n<li>线程私有</li>\n<li>如果线程请求的栈深度大于虚拟机所允许的深度，将抛出<code>StackOverflowError异常</code>；</li>\n<li>如果Java虚拟机栈容量可以动态扩展，当栈扩展时无法申请到足够的内存会抛出<code>OutOfMemoryError异常</code>；(<font color=\"red\">HotSpot虚拟机的栈容量是不可以动态扩展的，以前的Classic虚拟机倒是可以。所以在HotSpot虚拟机上是不会由于虚拟机栈无法扩展而导致OutOfMemoryError异常——只要线程申请栈空间成功了就不会有OOM，但是如果申请时就失败，仍然是会出现OOM异常的</font>)</li>\n<li><strong>-Xss5m</strong>:    设置5m的栈容量</li>\n<li>每个方法执行都会创建一个<strong>栈帧</strong>，栈帧包含局部变量表、操作数栈、动态连接、方法出口等</li>\n</ul>\n<h3 id=\"本地方法栈\"><a href=\"#本地方法栈\" class=\"headerlink\" title=\"本地方法栈\"></a>本地方法栈</h3><ul>\n<li><p>线程私有</p>\n</li>\n<li><p>与Java虚拟机栈相似</p>\n</li>\n<li><p>与Java虚拟机栈区别:    Java虚拟机栈为虚拟机执行Java方法（也就是字节码）服务，而本地方法栈则是为虚拟机使用到的本地（Native）方法服务。</p>\n</li>\n<li><p>Hot-Spot虚拟机直接就把本地方法栈和虚拟机栈合二为一</p>\n</li>\n<li><p>与虚拟机栈一样，本地方法栈也会在栈深度溢出或者栈扩展失败时分别抛出StackOverflowError和OutOfMemoryError异常</p>\n</li>\n</ul>\n<h3 id=\"Java堆\"><a href=\"#Java堆\" class=\"headerlink\" title=\"Java堆\"></a>Java堆</h3><ul>\n<li>线程共享</li>\n<li>所有的Java对象实例不一定都在Java堆上分配内存</li>\n<li>Java堆既可以被实现成固定大小的，也可以是可扩展的，不过当前主流的Java虚拟机都是按照可扩展来实现的（通过参数<code>-Xmx</code>和<code>-Xms</code>设定）。</li>\n<li>如果在Java堆中没有内存完成实例分配，并且堆也无法再扩展时，Java虚拟机将会抛出<strong>OutOfMemoryError异常</strong>。</li>\n<li>Java堆是垃圾收集器(Garbage Collected)管理的内存区域</li>\n</ul>\n<h3 id=\"方法区\"><a href=\"#方法区\" class=\"headerlink\" title=\"方法区\"></a>方法区</h3><ul>\n<li><p>线程共享</p>\n</li>\n<li><p>用于存储已被虚拟机加载的类型信息、常量、静态变量、即时编译器编译后的代码缓存等数据。</p>\n</li>\n<li><p>虽然《Java虚拟机规范》中把方法区描述为堆的一个逻辑部分，但是它却有一个别名叫作<strong>“非堆”（Non-Heap）</strong>，目的是<strong>与Java堆区分开来</strong>。</p>\n</li>\n<li><p>在JDK1.6及之前,使用<code>永久代</code>来实现方法区.</p>\n<ul>\n<li>-XX:MaxPermSize    设置永久代内存上限</li>\n<li>-XX:PermSize    设置永久代内存</li>\n</ul>\n</li>\n<li><p>JDK1.7把<code>字符串常量池</code>、<code>类的静态变量(class statics)</code>转移到了java heap,但是永久代还是存在,主要放一些类信息(<code>运算时常量池</code>)等.</p>\n</li>\n</ul>\n<ul>\n<li><p>JDK1.8彻底移除永久代,方法区采用本地内存中实现的元空间（Meta-space）来代替,将JDK1.7中永久代的信息移到了元空间,像<code>字符串常量池</code>和<code>静态变量</code>还是存在Java Heap中</p>\n</li>\n<li><p>如果方法区无法满足新的内存分配需求时，将抛出<strong>OutOfMemoryError异常</strong>。</p>\n</li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h1 id=\"JVM运行时数据区域\"><a href=\"#JVM运行时数据区域\" class=\"headerlink\" title=\"JVM运行时数据区域\"></a>JVM运行时数据区域</h1><p><img src=\"http://cdn.mjava.top/blog/20200526000623.jpeg\" alt=\"Java虚拟机运行时数据区\"></p>\n<h3 id=\"程序计数器\"><a href=\"#程序计数器\" class=\"headerlink\" title=\"程序计数器\"></a>程序计数器</h3><ul>\n<li><p>线程私有</p>\n</li>\n<li><p>唯一一个没有规定 OutOfMemoryError 异常 的区域</p>\n</li>\n<li><p>它可以看作是当前线程所执行的字节码的行号指示器</p>\n</li>\n<li><p>如果线程正在执行的是一个Java方法，这个计数器记录的是正在执行的虚拟机字节码指令的地址；如果正在执行的是本地（Native）方法，这个计数器值则应为空（Undefined）</p>\n</li>\n</ul>\n<blockquote>\n<p>(摘自网上)我们想象下，CPU是怎么知道记住之前A线程，执行到哪一处的？</p>\n<p>答案是，CPU根本就不会记住之前执行到哪里了，它只是埋头苦干；那是什么保证了切换线程的程序可以正常执行的；答案是 ： 程序计数器 ；<strong>程序计数器里面保存的是 当前线程执行的字节码的行号</strong>（看着像行号，其实是指令地址）；</p>\n<p>那么，我们需要几个程序计数器呢？如果，我们只有一个的话，切换B线程以后，程序计数器里面保存的就是B线程所执行的字节码的行号了，再切换回A线程，就蒙圈了，不知道执行到哪里了，因为，程序计数器里面保存的是B线程当前执行的字节码地址 ；因此，我们可以想象出，要为每个线程都分配一个程序计数器，因此，<strong>程序计数器的内存空间是线程私</strong>有的 ；这样即使线程 A 被挂起，但是线程 A 里面的程序计数器，记住了A线程当前执行到的字节码的指令地址了 ，等再次切回到A线程的时候，看一下程序计数器，就知道之前执行到哪里了！</p>\n<p>那么程序计数器，什么时候分配内存呢？我们试想下，一个线程在执行的任何期间，都会失去CPU执行权，因此，我们要从一个线程被创建开始执行，就要无时无刻的记录着该线程当前执行到哪里了！因此，线程计数器，必须是<strong>线程被创建开始执行的时候，就要一同被创建</strong>； </p>\n<p>程序计数器，保存的是当前执行的字节码的偏移地址（也就是之前说的行号，其实那不是行号，是指令的偏移地址，只是为了好理解，才说是行号的，），当执行到下一条指令的时候，改变的只是程序计数器中保存的地址，并不需要申请新的内存来保存新的指令地址；因此，永远都不可能内存溢出的；因此，jvm虚拟机规范，也就没有规定，也是<strong>唯一一个没有规定 OutOfMemoryError 异常 的区域</strong>;</p>\n<p><strong>当线程执行的是本地方法的时候，程序计数器中保存的值是空（undefined）</strong>；原因很简单：本地方法是C++/C 写的，由系统调用，根本不会产生字节码文件，因此，程序计数器也就不会做任何记录 </p>\n</blockquote>\n<h3 id=\"Java虚拟机栈\"><a href=\"#Java虚拟机栈\" class=\"headerlink\" title=\"Java虚拟机栈\"></a>Java虚拟机栈</h3><ul>\n<li>线程私有</li>\n<li>如果线程请求的栈深度大于虚拟机所允许的深度，将抛出<code>StackOverflowError异常</code>；</li>\n<li>如果Java虚拟机栈容量可以动态扩展，当栈扩展时无法申请到足够的内存会抛出<code>OutOfMemoryError异常</code>；(<font color=\"red\">HotSpot虚拟机的栈容量是不可以动态扩展的，以前的Classic虚拟机倒是可以。所以在HotSpot虚拟机上是不会由于虚拟机栈无法扩展而导致OutOfMemoryError异常——只要线程申请栈空间成功了就不会有OOM，但是如果申请时就失败，仍然是会出现OOM异常的</font>)</li>\n<li><strong>-Xss5m</strong>:    设置5m的栈容量</li>\n<li>每个方法执行都会创建一个<strong>栈帧</strong>，栈帧包含局部变量表、操作数栈、动态连接、方法出口等</li>\n</ul>\n<h3 id=\"本地方法栈\"><a href=\"#本地方法栈\" class=\"headerlink\" title=\"本地方法栈\"></a>本地方法栈</h3><ul>\n<li><p>线程私有</p>\n</li>\n<li><p>与Java虚拟机栈相似</p>\n</li>\n<li><p>与Java虚拟机栈区别:    Java虚拟机栈为虚拟机执行Java方法（也就是字节码）服务，而本地方法栈则是为虚拟机使用到的本地（Native）方法服务。</p>\n</li>\n<li><p>Hot-Spot虚拟机直接就把本地方法栈和虚拟机栈合二为一</p>\n</li>\n<li><p>与虚拟机栈一样，本地方法栈也会在栈深度溢出或者栈扩展失败时分别抛出StackOverflowError和OutOfMemoryError异常</p>\n</li>\n</ul>\n<h3 id=\"Java堆\"><a href=\"#Java堆\" class=\"headerlink\" title=\"Java堆\"></a>Java堆</h3><ul>\n<li>线程共享</li>\n<li>所有的Java对象实例不一定都在Java堆上分配内存</li>\n<li>Java堆既可以被实现成固定大小的，也可以是可扩展的，不过当前主流的Java虚拟机都是按照可扩展来实现的（通过参数<code>-Xmx</code>和<code>-Xms</code>设定）。</li>\n<li>如果在Java堆中没有内存完成实例分配，并且堆也无法再扩展时，Java虚拟机将会抛出<strong>OutOfMemoryError异常</strong>。</li>\n<li>Java堆是垃圾收集器(Garbage Collected)管理的内存区域</li>\n</ul>\n<h3 id=\"方法区\"><a href=\"#方法区\" class=\"headerlink\" title=\"方法区\"></a>方法区</h3><ul>\n<li><p>线程共享</p>\n</li>\n<li><p>用于存储已被虚拟机加载的类型信息、常量、静态变量、即时编译器编译后的代码缓存等数据。</p>\n</li>\n<li><p>虽然《Java虚拟机规范》中把方法区描述为堆的一个逻辑部分，但是它却有一个别名叫作<strong>“非堆”（Non-Heap）</strong>，目的是<strong>与Java堆区分开来</strong>。</p>\n</li>\n<li><p>在JDK1.6及之前,使用<code>永久代</code>来实现方法区.</p>\n<ul>\n<li>-XX:MaxPermSize    设置永久代内存上限</li>\n<li>-XX:PermSize    设置永久代内存</li>\n</ul>\n</li>\n<li><p>JDK1.7把<code>字符串常量池</code>、<code>类的静态变量(class statics)</code>转移到了java heap,但是永久代还是存在,主要放一些类信息(<code>运算时常量池</code>)等.</p>\n</li>\n</ul>\n<ul>\n<li><p>JDK1.8彻底移除永久代,方法区采用本地内存中实现的元空间（Meta-space）来代替,将JDK1.7中永久代的信息移到了元空间,像<code>字符串常量池</code>和<code>静态变量</code>还是存在Java Heap中</p>\n</li>\n<li><p>如果方法区无法满足新的内存分配需求时，将抛出<strong>OutOfMemoryError异常</strong>。</p>\n</li>\n</ul>\n"},{"title":"Java的NIO编程-Reactor模式","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-03-01T02:07:04.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 0x1 Reactor模型\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## 0x1 单Reactor单线程","source":"_posts/java/nio/0702ff46-16cd-4520-9d33-0794cfda4b09.md","raw":"---\ntitle: Java的NIO编程-Reactor模式\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-03-01 10:07:04\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Java\n- Nio\ncategories:\n- Java\n---\n\n## 0x1 Reactor模型\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## 0x1 单Reactor单线程","slug":"java/nio/0702ff46-16cd-4520-9d33-0794cfda4b09","published":1,"updated":"2021-03-01T02:09:24.058Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bmg009v2mg5fpawx5vb","content":"<h2 id=\"0x1-Reactor模型\"><a href=\"#0x1-Reactor模型\" class=\"headerlink\" title=\"0x1 Reactor模型\"></a>0x1 Reactor模型</h2><h2 id=\"0x1-单Reactor单线程\"><a href=\"#0x1-单Reactor单线程\" class=\"headerlink\" title=\"0x1 单Reactor单线程\"></a>0x1 单Reactor单线程</h2>","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"0x1-Reactor模型\"><a href=\"#0x1-Reactor模型\" class=\"headerlink\" title=\"0x1 Reactor模型\"></a>0x1 Reactor模型</h2><h2 id=\"0x1-单Reactor单线程\"><a href=\"#0x1-单Reactor单线程\" class=\"headerlink\" title=\"0x1 单Reactor单线程\"></a>0x1 单Reactor单线程</h2>"},{"title":"Java的NIO编程-Channel","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-03-01T02:07:09.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 0x1 主要类型\n\n在Java中有许多`NIO Channel`实现，本文只选最主要的四种`Channel`：\n\n- FileChannel：文件通道，用于文件的数据读写\n- SocketChannel：套接字通道，用于Socket套接字`TCP`连接的数据读写。\n- ServerSocketChannel：服务器嵌套字通道（或服务器监听通道），允许我们监听`TCP`连接请求，为每个监听到的请求，创建一个SocketChannel套接字通道。\n- DatagramChannel：数据报通道，用于`UDP`协议的数据读写。\n\n## 0x2 使用\n\n### FileChannel\n\n#### 读取通道数据\n\n首先在本地创建文件`/home/zheng/channeltest`，在里面编写内容：**hello,world!**\n\n```java\npublic class ChannelTest {\n\n    public static void main(String[] args) throws IOException {\n        // 创建输入流\n        File file = new File(\"/home/zheng/channeltest\");\n        FileInputStream fis = new FileInputStream(file);\n        // 获取通道\n        FileChannel fileChannel = fis.getChannel();\n        // 创建缓冲区\n        ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n        int length = -1;\n        // 读取通道数据到缓冲区\n        while ((length=fileChannel.read(byteBuffer))!=-1){\n            System.out.println(\"缓冲区size：\"+length);\n        }\n        fis.close();\n        fileChannel.close();\n        // 读取Buffer缓存数据\n        byteBuffer.flip();\n        StringBuilder str = new StringBuilder();\n        while (byteBuffer.position()!=byteBuffer.limit()){\n            char c = (char) byteBuffer.get();\n            str.append(c);\n        }\n        System.out.println(str.toString());\n    }\n}\n\n//输出\n缓冲区size：13\nhello,world!\n```\n\n#### 写入数据到通道\n\n```java\npublic class ChannelTest {\n\n    public static void main(String[] args) throws IOException {\n\t\t// 创建输入流\n        File file = new File(\"/home/zheng/channelOut\");\n        FileOutputStream fos = new FileOutputStream(file);\n        // 获取通道\n        FileChannel fileChannel = fos.getChannel();\n        // 创建缓冲区\n        ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n        byte c = 'c';\n        byte o = 'o';\n        byte d = 'd';\n        byte e = 'e';\n        byteBuffer.put(c);\n        byteBuffer.put(o);\n        byteBuffer.put(d);\n        byteBuffer.put(e);\n        int length = 0;\n        // 缓冲区转换为读模式\n        byteBuffer.flip();\n        // 向通道写入数据\n        while ((length=fileChannel.write(byteBuffer))!=0){\n            System.out.println(\"写入数据size：\"+length);\n        }\n        //强制刷盘\n        fileChannel.force(true);\n        fileChannel.close();\n    }\n}\n\n// 输出\n写入数据size：4\n```\n\n此时查看文件`/home/zheng/channelOut`，里面内容是:**code**\n\n#### SocketChannel和ServerSocketChannel\n\n- 服务端\n\n  ```java\n  public class SocketServer {\n      public static void main(String[] args) throws IOException {\n          // 打开ServerSocketChannel\n          ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n          // 绑定端口\n          serverSocketChannel.socket().bind(new InetSocketAddress(8989));\n          // 设置为非阻塞式工作模式（io多路复用）\n          serverSocketChannel.configureBlocking(false);\n          while (true){\n              // 等待客户端连接\n              SocketChannel channel = serverSocketChannel.accept();\n              if (channel!=null){\n                  System.out.println(\"==================\");\n                  System.out.println(\"客户端地址：\"+channel.getRemoteAddress());\n                  ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n                  // 读取通道的数据到缓冲区\n                  channel.read(byteBuffer);\n                  // 读取Buffer缓存数据\n                  byteBuffer.flip();\n                  StringBuilder str = new StringBuilder();\n                  while (byteBuffer.position()!=byteBuffer.limit()){\n                      char c = (char) byteBuffer.get();\n                      str.append(c);\n                  }\n                  System.out.println(\"接收到消息：\"+str.toString());\n              }\n          }\n      }\n  }\n  ```\n\n- 客户端\n\n  ```java\n  public class SocketClient {\n      public static void main(String[] args) throws IOException, InterruptedException {\n          // 打开SocketChannel\n          SocketChannel channel = SocketChannel.open();\n          // 设置为非阻塞式工作模式（io多路复用）\n          channel.configureBlocking(false);\n          // 连接\n          channel.connect(new InetSocketAddress(\"127.0.0.1\",8989));\n          while (!channel.finishConnect()){\n              System.out.println(\"连接中...\");\n              Thread.sleep(1000);\n          }\n          ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n          byteBuffer.put((byte)'s');\n          byteBuffer.flip();\n          // 从缓冲区写入数据到通道\n          channel.write(byteBuffer);\n          channel.close();\n      }\n  }\n  ```\n\n先运行服务端，然后在运行客户端，此时服务端控制台打印出：\n\n```shell\n==================\n客户端地址：/127.0.0.1:44728\n接收到消息：s\n```\n\n#### DatagramChannel\n\n- 发送端\n\n  ```java\n  public class DatagramClient {\n      public static void main(String[] args) throws IOException {\n          // 开启DatagramChannel\n          DatagramChannel channel = DatagramChannel.open();\n          // 设置为非阻塞式工作模式（io多路复用）\n          channel.configureBlocking(false);\n          // 创建缓存区\n          ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n          Scanner scanner = new Scanner(System.in);\n          System.out.println(\"请输入要发送的消息：\");\n          while (scanner.hasNext()){\n              String s = scanner.next();\n              byteBuffer.put(s.getBytes());\n              byteBuffer.flip();\n              // 发送数据\n              channel.send(byteBuffer,new InetSocketAddress(\"127.0.0.1\",8989));\n              byteBuffer.clear();\n          }\n          channel.close();\n      }\n  }\n  ```\n\n- 接收端\n\n  ```java\n  public class DatagramServer {\n      public static void main(String[] args) throws IOException {\n          // 开启DatagramChannel\n          DatagramChannel serverChannel = DatagramChannel.open();\n          // 设置为非阻塞式工作模式（io多路复用）\n          serverChannel.configureBlocking(false);\n          // 绑定监听地址\n          serverChannel.bind(new InetSocketAddress(\"127.0.0.1\",8989));\n          // 创建缓存区\n          ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n          while (true){\n              // 接收消息并保存到缓存区\n              serverChannel.receive(byteBuffer);\n              byteBuffer.flip();\n              if (byteBuffer.limit()!=0){\n                  // 读取Buffer缓存数据\n                  StringBuilder str = new StringBuilder();\n                  while (byteBuffer.position()!=byteBuffer.limit()){\n                      char c = (char) byteBuffer.get();\n                      str.append(c);\n                  }\n                  System.out.println(\"接收到消息：\"+str.toString());\n                  byteBuffer.clear();\n              }\n              byteBuffer.clear();\n          }\n      }\n  }\n  ```\n\n  \n\n源码地址：https://github.com/GreyCode9/nio-demo","source":"_posts/java/nio/534d0985-a4a0-4239-ae81-d76378f64552.md","raw":"---\ntitle: Java的NIO编程-Channel\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-03-01 10:07:09\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Java\n- Nio\ncategories:\n- Java\n---\n\n## 0x1 主要类型\n\n在Java中有许多`NIO Channel`实现，本文只选最主要的四种`Channel`：\n\n- FileChannel：文件通道，用于文件的数据读写\n- SocketChannel：套接字通道，用于Socket套接字`TCP`连接的数据读写。\n- ServerSocketChannel：服务器嵌套字通道（或服务器监听通道），允许我们监听`TCP`连接请求，为每个监听到的请求，创建一个SocketChannel套接字通道。\n- DatagramChannel：数据报通道，用于`UDP`协议的数据读写。\n\n## 0x2 使用\n\n### FileChannel\n\n#### 读取通道数据\n\n首先在本地创建文件`/home/zheng/channeltest`，在里面编写内容：**hello,world!**\n\n```java\npublic class ChannelTest {\n\n    public static void main(String[] args) throws IOException {\n        // 创建输入流\n        File file = new File(\"/home/zheng/channeltest\");\n        FileInputStream fis = new FileInputStream(file);\n        // 获取通道\n        FileChannel fileChannel = fis.getChannel();\n        // 创建缓冲区\n        ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n        int length = -1;\n        // 读取通道数据到缓冲区\n        while ((length=fileChannel.read(byteBuffer))!=-1){\n            System.out.println(\"缓冲区size：\"+length);\n        }\n        fis.close();\n        fileChannel.close();\n        // 读取Buffer缓存数据\n        byteBuffer.flip();\n        StringBuilder str = new StringBuilder();\n        while (byteBuffer.position()!=byteBuffer.limit()){\n            char c = (char) byteBuffer.get();\n            str.append(c);\n        }\n        System.out.println(str.toString());\n    }\n}\n\n//输出\n缓冲区size：13\nhello,world!\n```\n\n#### 写入数据到通道\n\n```java\npublic class ChannelTest {\n\n    public static void main(String[] args) throws IOException {\n\t\t// 创建输入流\n        File file = new File(\"/home/zheng/channelOut\");\n        FileOutputStream fos = new FileOutputStream(file);\n        // 获取通道\n        FileChannel fileChannel = fos.getChannel();\n        // 创建缓冲区\n        ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n        byte c = 'c';\n        byte o = 'o';\n        byte d = 'd';\n        byte e = 'e';\n        byteBuffer.put(c);\n        byteBuffer.put(o);\n        byteBuffer.put(d);\n        byteBuffer.put(e);\n        int length = 0;\n        // 缓冲区转换为读模式\n        byteBuffer.flip();\n        // 向通道写入数据\n        while ((length=fileChannel.write(byteBuffer))!=0){\n            System.out.println(\"写入数据size：\"+length);\n        }\n        //强制刷盘\n        fileChannel.force(true);\n        fileChannel.close();\n    }\n}\n\n// 输出\n写入数据size：4\n```\n\n此时查看文件`/home/zheng/channelOut`，里面内容是:**code**\n\n#### SocketChannel和ServerSocketChannel\n\n- 服务端\n\n  ```java\n  public class SocketServer {\n      public static void main(String[] args) throws IOException {\n          // 打开ServerSocketChannel\n          ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n          // 绑定端口\n          serverSocketChannel.socket().bind(new InetSocketAddress(8989));\n          // 设置为非阻塞式工作模式（io多路复用）\n          serverSocketChannel.configureBlocking(false);\n          while (true){\n              // 等待客户端连接\n              SocketChannel channel = serverSocketChannel.accept();\n              if (channel!=null){\n                  System.out.println(\"==================\");\n                  System.out.println(\"客户端地址：\"+channel.getRemoteAddress());\n                  ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n                  // 读取通道的数据到缓冲区\n                  channel.read(byteBuffer);\n                  // 读取Buffer缓存数据\n                  byteBuffer.flip();\n                  StringBuilder str = new StringBuilder();\n                  while (byteBuffer.position()!=byteBuffer.limit()){\n                      char c = (char) byteBuffer.get();\n                      str.append(c);\n                  }\n                  System.out.println(\"接收到消息：\"+str.toString());\n              }\n          }\n      }\n  }\n  ```\n\n- 客户端\n\n  ```java\n  public class SocketClient {\n      public static void main(String[] args) throws IOException, InterruptedException {\n          // 打开SocketChannel\n          SocketChannel channel = SocketChannel.open();\n          // 设置为非阻塞式工作模式（io多路复用）\n          channel.configureBlocking(false);\n          // 连接\n          channel.connect(new InetSocketAddress(\"127.0.0.1\",8989));\n          while (!channel.finishConnect()){\n              System.out.println(\"连接中...\");\n              Thread.sleep(1000);\n          }\n          ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n          byteBuffer.put((byte)'s');\n          byteBuffer.flip();\n          // 从缓冲区写入数据到通道\n          channel.write(byteBuffer);\n          channel.close();\n      }\n  }\n  ```\n\n先运行服务端，然后在运行客户端，此时服务端控制台打印出：\n\n```shell\n==================\n客户端地址：/127.0.0.1:44728\n接收到消息：s\n```\n\n#### DatagramChannel\n\n- 发送端\n\n  ```java\n  public class DatagramClient {\n      public static void main(String[] args) throws IOException {\n          // 开启DatagramChannel\n          DatagramChannel channel = DatagramChannel.open();\n          // 设置为非阻塞式工作模式（io多路复用）\n          channel.configureBlocking(false);\n          // 创建缓存区\n          ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n          Scanner scanner = new Scanner(System.in);\n          System.out.println(\"请输入要发送的消息：\");\n          while (scanner.hasNext()){\n              String s = scanner.next();\n              byteBuffer.put(s.getBytes());\n              byteBuffer.flip();\n              // 发送数据\n              channel.send(byteBuffer,new InetSocketAddress(\"127.0.0.1\",8989));\n              byteBuffer.clear();\n          }\n          channel.close();\n      }\n  }\n  ```\n\n- 接收端\n\n  ```java\n  public class DatagramServer {\n      public static void main(String[] args) throws IOException {\n          // 开启DatagramChannel\n          DatagramChannel serverChannel = DatagramChannel.open();\n          // 设置为非阻塞式工作模式（io多路复用）\n          serverChannel.configureBlocking(false);\n          // 绑定监听地址\n          serverChannel.bind(new InetSocketAddress(\"127.0.0.1\",8989));\n          // 创建缓存区\n          ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n          while (true){\n              // 接收消息并保存到缓存区\n              serverChannel.receive(byteBuffer);\n              byteBuffer.flip();\n              if (byteBuffer.limit()!=0){\n                  // 读取Buffer缓存数据\n                  StringBuilder str = new StringBuilder();\n                  while (byteBuffer.position()!=byteBuffer.limit()){\n                      char c = (char) byteBuffer.get();\n                      str.append(c);\n                  }\n                  System.out.println(\"接收到消息：\"+str.toString());\n                  byteBuffer.clear();\n              }\n              byteBuffer.clear();\n          }\n      }\n  }\n  ```\n\n  \n\n源码地址：https://github.com/GreyCode9/nio-demo","slug":"java/nio/534d0985-a4a0-4239-ae81-d76378f64552","published":1,"updated":"2021-03-01T02:09:57.842Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bmh009y2mg52brlr8ty","content":"<h2 id=\"0x1-主要类型\"><a href=\"#0x1-主要类型\" class=\"headerlink\" title=\"0x1 主要类型\"></a>0x1 主要类型</h2><p>在Java中有许多<code>NIO Channel</code>实现，本文只选最主要的四种<code>Channel</code>：</p>\n<ul>\n<li>FileChannel：文件通道，用于文件的数据读写</li>\n<li>SocketChannel：套接字通道，用于Socket套接字<code>TCP</code>连接的数据读写。</li>\n<li>ServerSocketChannel：服务器嵌套字通道（或服务器监听通道），允许我们监听<code>TCP</code>连接请求，为每个监听到的请求，创建一个SocketChannel套接字通道。</li>\n<li>DatagramChannel：数据报通道，用于<code>UDP</code>协议的数据读写。</li>\n</ul>\n<h2 id=\"0x2-使用\"><a href=\"#0x2-使用\" class=\"headerlink\" title=\"0x2 使用\"></a>0x2 使用</h2><h3 id=\"FileChannel\"><a href=\"#FileChannel\" class=\"headerlink\" title=\"FileChannel\"></a>FileChannel</h3><h4 id=\"读取通道数据\"><a href=\"#读取通道数据\" class=\"headerlink\" title=\"读取通道数据\"></a>读取通道数据</h4><p>首先在本地创建文件<code>/home/zheng/channeltest</code>，在里面编写内容：<strong>hello,world!</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ChannelTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 创建输入流</span></span><br><span class=\"line\">        File file = <span class=\"keyword\">new</span> File(<span class=\"string\">\"/home/zheng/channeltest\"</span>);</span><br><span class=\"line\">        FileInputStream fis = <span class=\"keyword\">new</span> FileInputStream(file);</span><br><span class=\"line\">        <span class=\"comment\">// 获取通道</span></span><br><span class=\"line\">        FileChannel fileChannel = fis.getChannel();</span><br><span class=\"line\">        <span class=\"comment\">// 创建缓冲区</span></span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> length = -<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 读取通道数据到缓冲区</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> ((length=fileChannel.read(byteBuffer))!=-<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"缓冲区size：\"</span>+length);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fis.close();</span><br><span class=\"line\">        fileChannel.close();</span><br><span class=\"line\">        <span class=\"comment\">// 读取Buffer缓存数据</span></span><br><span class=\"line\">        byteBuffer.flip();</span><br><span class=\"line\">        StringBuilder str = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (byteBuffer.position()!=byteBuffer.limit())&#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> c = (<span class=\"keyword\">char</span>) byteBuffer.get();</span><br><span class=\"line\">            str.append(c);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(str.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//输出</span></span><br><span class=\"line\">缓冲区size：<span class=\"number\">13</span></span><br><span class=\"line\">hello,world!</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"写入数据到通道\"><a href=\"#写入数据到通道\" class=\"headerlink\" title=\"写入数据到通道\"></a>写入数据到通道</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ChannelTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// 创建输入流</span></span><br><span class=\"line\">        File file = <span class=\"keyword\">new</span> File(<span class=\"string\">\"/home/zheng/channelOut\"</span>);</span><br><span class=\"line\">        FileOutputStream fos = <span class=\"keyword\">new</span> FileOutputStream(file);</span><br><span class=\"line\">        <span class=\"comment\">// 获取通道</span></span><br><span class=\"line\">        FileChannel fileChannel = fos.getChannel();</span><br><span class=\"line\">        <span class=\"comment\">// 创建缓冲区</span></span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        <span class=\"keyword\">byte</span> c = <span class=\"string\">'c'</span>;</span><br><span class=\"line\">        <span class=\"keyword\">byte</span> o = <span class=\"string\">'o'</span>;</span><br><span class=\"line\">        <span class=\"keyword\">byte</span> d = <span class=\"string\">'d'</span>;</span><br><span class=\"line\">        <span class=\"keyword\">byte</span> e = <span class=\"string\">'e'</span>;</span><br><span class=\"line\">        byteBuffer.put(c);</span><br><span class=\"line\">        byteBuffer.put(o);</span><br><span class=\"line\">        byteBuffer.put(d);</span><br><span class=\"line\">        byteBuffer.put(e);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> length = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 缓冲区转换为读模式</span></span><br><span class=\"line\">        byteBuffer.flip();</span><br><span class=\"line\">        <span class=\"comment\">// 向通道写入数据</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> ((length=fileChannel.write(byteBuffer))!=<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"写入数据size：\"</span>+length);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//强制刷盘</span></span><br><span class=\"line\">        fileChannel.force(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        fileChannel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 输出</span></span><br><span class=\"line\">写入数据size：<span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n\n<p>此时查看文件<code>/home/zheng/channelOut</code>，里面内容是:<strong>code</strong></p>\n<h4 id=\"SocketChannel和ServerSocketChannel\"><a href=\"#SocketChannel和ServerSocketChannel\" class=\"headerlink\" title=\"SocketChannel和ServerSocketChannel\"></a>SocketChannel和ServerSocketChannel</h4><ul>\n<li><p>服务端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SocketServer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 打开ServerSocketChannel</span></span><br><span class=\"line\">        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// 绑定端口</span></span><br><span class=\"line\">        serverSocketChannel.socket().bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"number\">8989</span>));</span><br><span class=\"line\">        <span class=\"comment\">// 设置为非阻塞式工作模式（io多路复用）</span></span><br><span class=\"line\">        serverSocketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>)&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 等待客户端连接</span></span><br><span class=\"line\">            SocketChannel channel = serverSocketChannel.accept();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (channel!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"==================\"</span>);</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"客户端地址：\"</span>+channel.getRemoteAddress());</span><br><span class=\"line\">                ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">                <span class=\"comment\">// 读取通道的数据到缓冲区</span></span><br><span class=\"line\">                channel.read(byteBuffer);</span><br><span class=\"line\">                <span class=\"comment\">// 读取Buffer缓存数据</span></span><br><span class=\"line\">                byteBuffer.flip();</span><br><span class=\"line\">                StringBuilder str = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (byteBuffer.position()!=byteBuffer.limit())&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">char</span> c = (<span class=\"keyword\">char</span>) byteBuffer.get();</span><br><span class=\"line\">                    str.append(c);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"接收到消息：\"</span>+str.toString());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>客户端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SocketClient</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 打开SocketChannel</span></span><br><span class=\"line\">        SocketChannel channel = SocketChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// 设置为非阻塞式工作模式（io多路复用）</span></span><br><span class=\"line\">        channel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 连接</span></span><br><span class=\"line\">        channel.connect(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"string\">\"127.0.0.1\"</span>,<span class=\"number\">8989</span>));</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!channel.finishConnect())&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"连接中...\"</span>);</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        byteBuffer.put((<span class=\"keyword\">byte</span>)<span class=\"string\">'s'</span>);</span><br><span class=\"line\">        byteBuffer.flip();</span><br><span class=\"line\">        <span class=\"comment\">// 从缓冲区写入数据到通道</span></span><br><span class=\"line\">        channel.write(byteBuffer);</span><br><span class=\"line\">        channel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>先运行服务端，然后在运行客户端，此时服务端控制台打印出：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">==================</span><br><span class=\"line\">客户端地址：/127.0.0.1:44728</span><br><span class=\"line\">接收到消息：s</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"DatagramChannel\"><a href=\"#DatagramChannel\" class=\"headerlink\" title=\"DatagramChannel\"></a>DatagramChannel</h4><ul>\n<li><p>发送端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DatagramClient</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 开启DatagramChannel</span></span><br><span class=\"line\">        DatagramChannel channel = DatagramChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// 设置为非阻塞式工作模式（io多路复用）</span></span><br><span class=\"line\">        channel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建缓存区</span></span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        Scanner scanner = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"请输入要发送的消息：\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (scanner.hasNext())&#123;</span><br><span class=\"line\">            String s = scanner.next();</span><br><span class=\"line\">            byteBuffer.put(s.getBytes());</span><br><span class=\"line\">            byteBuffer.flip();</span><br><span class=\"line\">            <span class=\"comment\">// 发送数据</span></span><br><span class=\"line\">            channel.send(byteBuffer,<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"string\">\"127.0.0.1\"</span>,<span class=\"number\">8989</span>));</span><br><span class=\"line\">            byteBuffer.clear();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        channel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>接收端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DatagramServer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 开启DatagramChannel</span></span><br><span class=\"line\">        DatagramChannel serverChannel = DatagramChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// 设置为非阻塞式工作模式（io多路复用）</span></span><br><span class=\"line\">        serverChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 绑定监听地址</span></span><br><span class=\"line\">        serverChannel.bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"string\">\"127.0.0.1\"</span>,<span class=\"number\">8989</span>));</span><br><span class=\"line\">        <span class=\"comment\">// 创建缓存区</span></span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>)&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 接收消息并保存到缓存区</span></span><br><span class=\"line\">            serverChannel.receive(byteBuffer);</span><br><span class=\"line\">            byteBuffer.flip();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (byteBuffer.limit()!=<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">                <span class=\"comment\">// 读取Buffer缓存数据</span></span><br><span class=\"line\">                StringBuilder str = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (byteBuffer.position()!=byteBuffer.limit())&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">char</span> c = (<span class=\"keyword\">char</span>) byteBuffer.get();</span><br><span class=\"line\">                    str.append(c);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"接收到消息：\"</span>+str.toString());</span><br><span class=\"line\">                byteBuffer.clear();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            byteBuffer.clear();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ul>\n<p>源码地址：<a href=\"https://github.com/GreyCode9/nio-demo\" rel=\"noopener\" target=\"_blank\">https://github.com/GreyCode9/nio-demo</a></p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"0x1-主要类型\"><a href=\"#0x1-主要类型\" class=\"headerlink\" title=\"0x1 主要类型\"></a>0x1 主要类型</h2><p>在Java中有许多<code>NIO Channel</code>实现，本文只选最主要的四种<code>Channel</code>：</p>\n<ul>\n<li>FileChannel：文件通道，用于文件的数据读写</li>\n<li>SocketChannel：套接字通道，用于Socket套接字<code>TCP</code>连接的数据读写。</li>\n<li>ServerSocketChannel：服务器嵌套字通道（或服务器监听通道），允许我们监听<code>TCP</code>连接请求，为每个监听到的请求，创建一个SocketChannel套接字通道。</li>\n<li>DatagramChannel：数据报通道，用于<code>UDP</code>协议的数据读写。</li>\n</ul>\n<h2 id=\"0x2-使用\"><a href=\"#0x2-使用\" class=\"headerlink\" title=\"0x2 使用\"></a>0x2 使用</h2><h3 id=\"FileChannel\"><a href=\"#FileChannel\" class=\"headerlink\" title=\"FileChannel\"></a>FileChannel</h3><h4 id=\"读取通道数据\"><a href=\"#读取通道数据\" class=\"headerlink\" title=\"读取通道数据\"></a>读取通道数据</h4><p>首先在本地创建文件<code>/home/zheng/channeltest</code>，在里面编写内容：<strong>hello,world!</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ChannelTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 创建输入流</span></span><br><span class=\"line\">        File file = <span class=\"keyword\">new</span> File(<span class=\"string\">\"/home/zheng/channeltest\"</span>);</span><br><span class=\"line\">        FileInputStream fis = <span class=\"keyword\">new</span> FileInputStream(file);</span><br><span class=\"line\">        <span class=\"comment\">// 获取通道</span></span><br><span class=\"line\">        FileChannel fileChannel = fis.getChannel();</span><br><span class=\"line\">        <span class=\"comment\">// 创建缓冲区</span></span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> length = -<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 读取通道数据到缓冲区</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> ((length=fileChannel.read(byteBuffer))!=-<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"缓冲区size：\"</span>+length);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        fis.close();</span><br><span class=\"line\">        fileChannel.close();</span><br><span class=\"line\">        <span class=\"comment\">// 读取Buffer缓存数据</span></span><br><span class=\"line\">        byteBuffer.flip();</span><br><span class=\"line\">        StringBuilder str = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (byteBuffer.position()!=byteBuffer.limit())&#123;</span><br><span class=\"line\">            <span class=\"keyword\">char</span> c = (<span class=\"keyword\">char</span>) byteBuffer.get();</span><br><span class=\"line\">            str.append(c);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(str.toString());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//输出</span></span><br><span class=\"line\">缓冲区size：<span class=\"number\">13</span></span><br><span class=\"line\">hello,world!</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"写入数据到通道\"><a href=\"#写入数据到通道\" class=\"headerlink\" title=\"写入数据到通道\"></a>写入数据到通道</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ChannelTest</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// 创建输入流</span></span><br><span class=\"line\">        File file = <span class=\"keyword\">new</span> File(<span class=\"string\">\"/home/zheng/channelOut\"</span>);</span><br><span class=\"line\">        FileOutputStream fos = <span class=\"keyword\">new</span> FileOutputStream(file);</span><br><span class=\"line\">        <span class=\"comment\">// 获取通道</span></span><br><span class=\"line\">        FileChannel fileChannel = fos.getChannel();</span><br><span class=\"line\">        <span class=\"comment\">// 创建缓冲区</span></span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        <span class=\"keyword\">byte</span> c = <span class=\"string\">'c'</span>;</span><br><span class=\"line\">        <span class=\"keyword\">byte</span> o = <span class=\"string\">'o'</span>;</span><br><span class=\"line\">        <span class=\"keyword\">byte</span> d = <span class=\"string\">'d'</span>;</span><br><span class=\"line\">        <span class=\"keyword\">byte</span> e = <span class=\"string\">'e'</span>;</span><br><span class=\"line\">        byteBuffer.put(c);</span><br><span class=\"line\">        byteBuffer.put(o);</span><br><span class=\"line\">        byteBuffer.put(d);</span><br><span class=\"line\">        byteBuffer.put(e);</span><br><span class=\"line\">        <span class=\"keyword\">int</span> length = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"comment\">// 缓冲区转换为读模式</span></span><br><span class=\"line\">        byteBuffer.flip();</span><br><span class=\"line\">        <span class=\"comment\">// 向通道写入数据</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> ((length=fileChannel.write(byteBuffer))!=<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"写入数据size：\"</span>+length);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//强制刷盘</span></span><br><span class=\"line\">        fileChannel.force(<span class=\"keyword\">true</span>);</span><br><span class=\"line\">        fileChannel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// 输出</span></span><br><span class=\"line\">写入数据size：<span class=\"number\">4</span></span><br></pre></td></tr></table></figure>\n\n<p>此时查看文件<code>/home/zheng/channelOut</code>，里面内容是:<strong>code</strong></p>\n<h4 id=\"SocketChannel和ServerSocketChannel\"><a href=\"#SocketChannel和ServerSocketChannel\" class=\"headerlink\" title=\"SocketChannel和ServerSocketChannel\"></a>SocketChannel和ServerSocketChannel</h4><ul>\n<li><p>服务端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SocketServer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 打开ServerSocketChannel</span></span><br><span class=\"line\">        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// 绑定端口</span></span><br><span class=\"line\">        serverSocketChannel.socket().bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"number\">8989</span>));</span><br><span class=\"line\">        <span class=\"comment\">// 设置为非阻塞式工作模式（io多路复用）</span></span><br><span class=\"line\">        serverSocketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>)&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 等待客户端连接</span></span><br><span class=\"line\">            SocketChannel channel = serverSocketChannel.accept();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (channel!=<span class=\"keyword\">null</span>)&#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"==================\"</span>);</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"客户端地址：\"</span>+channel.getRemoteAddress());</span><br><span class=\"line\">                ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">                <span class=\"comment\">// 读取通道的数据到缓冲区</span></span><br><span class=\"line\">                channel.read(byteBuffer);</span><br><span class=\"line\">                <span class=\"comment\">// 读取Buffer缓存数据</span></span><br><span class=\"line\">                byteBuffer.flip();</span><br><span class=\"line\">                StringBuilder str = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (byteBuffer.position()!=byteBuffer.limit())&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">char</span> c = (<span class=\"keyword\">char</span>) byteBuffer.get();</span><br><span class=\"line\">                    str.append(c);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"接收到消息：\"</span>+str.toString());</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>客户端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SocketClient</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException, InterruptedException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 打开SocketChannel</span></span><br><span class=\"line\">        SocketChannel channel = SocketChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// 设置为非阻塞式工作模式（io多路复用）</span></span><br><span class=\"line\">        channel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 连接</span></span><br><span class=\"line\">        channel.connect(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"string\">\"127.0.0.1\"</span>,<span class=\"number\">8989</span>));</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!channel.finishConnect())&#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"连接中...\"</span>);</span><br><span class=\"line\">            Thread.sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        byteBuffer.put((<span class=\"keyword\">byte</span>)<span class=\"string\">'s'</span>);</span><br><span class=\"line\">        byteBuffer.flip();</span><br><span class=\"line\">        <span class=\"comment\">// 从缓冲区写入数据到通道</span></span><br><span class=\"line\">        channel.write(byteBuffer);</span><br><span class=\"line\">        channel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>先运行服务端，然后在运行客户端，此时服务端控制台打印出：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">==================</span><br><span class=\"line\">客户端地址：/127.0.0.1:44728</span><br><span class=\"line\">接收到消息：s</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"DatagramChannel\"><a href=\"#DatagramChannel\" class=\"headerlink\" title=\"DatagramChannel\"></a>DatagramChannel</h4><ul>\n<li><p>发送端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DatagramClient</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 开启DatagramChannel</span></span><br><span class=\"line\">        DatagramChannel channel = DatagramChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// 设置为非阻塞式工作模式（io多路复用）</span></span><br><span class=\"line\">        channel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 创建缓存区</span></span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        Scanner scanner = <span class=\"keyword\">new</span> Scanner(System.in);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"请输入要发送的消息：\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (scanner.hasNext())&#123;</span><br><span class=\"line\">            String s = scanner.next();</span><br><span class=\"line\">            byteBuffer.put(s.getBytes());</span><br><span class=\"line\">            byteBuffer.flip();</span><br><span class=\"line\">            <span class=\"comment\">// 发送数据</span></span><br><span class=\"line\">            channel.send(byteBuffer,<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"string\">\"127.0.0.1\"</span>,<span class=\"number\">8989</span>));</span><br><span class=\"line\">            byteBuffer.clear();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        channel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>接收端</p>\n<figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DatagramServer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 开启DatagramChannel</span></span><br><span class=\"line\">        DatagramChannel serverChannel = DatagramChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// 设置为非阻塞式工作模式（io多路复用）</span></span><br><span class=\"line\">        serverChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// 绑定监听地址</span></span><br><span class=\"line\">        serverChannel.bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"string\">\"127.0.0.1\"</span>,<span class=\"number\">8989</span>));</span><br><span class=\"line\">        <span class=\"comment\">// 创建缓存区</span></span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>)&#123;</span><br><span class=\"line\">            <span class=\"comment\">// 接收消息并保存到缓存区</span></span><br><span class=\"line\">            serverChannel.receive(byteBuffer);</span><br><span class=\"line\">            byteBuffer.flip();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (byteBuffer.limit()!=<span class=\"number\">0</span>)&#123;</span><br><span class=\"line\">                <span class=\"comment\">// 读取Buffer缓存数据</span></span><br><span class=\"line\">                StringBuilder str = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">                <span class=\"keyword\">while</span> (byteBuffer.position()!=byteBuffer.limit())&#123;</span><br><span class=\"line\">                    <span class=\"keyword\">char</span> c = (<span class=\"keyword\">char</span>) byteBuffer.get();</span><br><span class=\"line\">                    str.append(c);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"接收到消息：\"</span>+str.toString());</span><br><span class=\"line\">                byteBuffer.clear();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            byteBuffer.clear();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ul>\n<p>源码地址：<a href=\"https://github.com/GreyCode9/nio-demo\" rel=\"noopener\" target=\"_blank\">https://github.com/GreyCode9/nio-demo</a></p>\n"},{"title":"Java的NIO编程-Buffer","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2021-03-01T02:07:05.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n## 0x1 子类\n\nBuffer是一个抽象类，所以一般使用他的子类来进行编程，常用的子类有：\n\n- ByteBuffer\n\n- IntBuffer\n- LongBuffer\n- CharBuffer\n- DoubleBufffer\n- FloatBuffer\n- ShortBuffer\n- MappedByteBuffer\n\n## 0x2 属性\n\nBuffer中有四个重要的属性，分别是：\n\n- capacity：Buffer类的capacity属性，表示内部容量的大小\n- position：Buffer类的position属性，表示当前的位置\n- limit：Buffer类的limit属性，表示读写的最大上限。\n- mark：暂存属性，暂时保存position的值，方便后面的重复使用position值。\n\n![](http://cdn.mjava.top/blog/epub_26174369_8)\n\n## 0x3 方法\n\nBuffer中几个重要的方法有：\n\n- allocate()：创建缓存区（BUffer创建缓存区不是用`new`，而是用这个方法来创建)\n- put()：向缓冲器插入数据\n- filp()：翻转模式，将缓冲区改为读模式（缓冲区默认模式为**写模式**）。其实就改变了`limit`，`position`，`mark`属性的值。\n- get()：从缓冲区读取数据，从`position`位置开始读\n- rewind()：倒带（重复读取），就是将`position`的位置重置为`0`\n- mark()：`mark()`方法的作用就是将当前`position`的位置暂存起来，放在`mark`属性中。\n- reset()：将`position`重置为`mark`属性的位置。\n- clean()：清空缓存区，重置`position`，`limit`，`mark`属性为初始值","source":"_posts/java/nio/8d2049e3-3eb1-46ed-a44b-57398964eb21.md","raw":"---\ntitle: Java的NIO编程-Buffer\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2021-03-01 10:07:05\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- Java\n- Nio\ncategories:\n- Java\n---\n\n## 0x1 子类\n\nBuffer是一个抽象类，所以一般使用他的子类来进行编程，常用的子类有：\n\n- ByteBuffer\n\n- IntBuffer\n- LongBuffer\n- CharBuffer\n- DoubleBufffer\n- FloatBuffer\n- ShortBuffer\n- MappedByteBuffer\n\n## 0x2 属性\n\nBuffer中有四个重要的属性，分别是：\n\n- capacity：Buffer类的capacity属性，表示内部容量的大小\n- position：Buffer类的position属性，表示当前的位置\n- limit：Buffer类的limit属性，表示读写的最大上限。\n- mark：暂存属性，暂时保存position的值，方便后面的重复使用position值。\n\n![](http://cdn.mjava.top/blog/epub_26174369_8)\n\n## 0x3 方法\n\nBuffer中几个重要的方法有：\n\n- allocate()：创建缓存区（BUffer创建缓存区不是用`new`，而是用这个方法来创建)\n- put()：向缓冲器插入数据\n- filp()：翻转模式，将缓冲区改为读模式（缓冲区默认模式为**写模式**）。其实就改变了`limit`，`position`，`mark`属性的值。\n- get()：从缓冲区读取数据，从`position`位置开始读\n- rewind()：倒带（重复读取），就是将`position`的位置重置为`0`\n- mark()：`mark()`方法的作用就是将当前`position`的位置暂存起来，放在`mark`属性中。\n- reset()：将`position`重置为`mark`属性的位置。\n- clean()：清空缓存区，重置`position`，`limit`，`mark`属性为初始值","slug":"java/nio/8d2049e3-3eb1-46ed-a44b-57398964eb21","published":1,"updated":"2021-03-01T02:10:02.410Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bmi00a22mg5vkyi32a4","content":"<h2 id=\"0x1-子类\"><a href=\"#0x1-子类\" class=\"headerlink\" title=\"0x1 子类\"></a>0x1 子类</h2><p>Buffer是一个抽象类，所以一般使用他的子类来进行编程，常用的子类有：</p>\n<ul>\n<li><p>ByteBuffer</p>\n</li>\n<li><p>IntBuffer</p>\n</li>\n<li><p>LongBuffer</p>\n</li>\n<li><p>CharBuffer</p>\n</li>\n<li><p>DoubleBufffer</p>\n</li>\n<li><p>FloatBuffer</p>\n</li>\n<li><p>ShortBuffer</p>\n</li>\n<li><p>MappedByteBuffer</p>\n</li>\n</ul>\n<h2 id=\"0x2-属性\"><a href=\"#0x2-属性\" class=\"headerlink\" title=\"0x2 属性\"></a>0x2 属性</h2><p>Buffer中有四个重要的属性，分别是：</p>\n<ul>\n<li>capacity：Buffer类的capacity属性，表示内部容量的大小</li>\n<li>position：Buffer类的position属性，表示当前的位置</li>\n<li>limit：Buffer类的limit属性，表示读写的最大上限。</li>\n<li>mark：暂存属性，暂时保存position的值，方便后面的重复使用position值。</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/epub_26174369_8\" alt></p>\n<h2 id=\"0x3-方法\"><a href=\"#0x3-方法\" class=\"headerlink\" title=\"0x3 方法\"></a>0x3 方法</h2><p>Buffer中几个重要的方法有：</p>\n<ul>\n<li>allocate()：创建缓存区（BUffer创建缓存区不是用<code>new</code>，而是用这个方法来创建)</li>\n<li>put()：向缓冲器插入数据</li>\n<li>filp()：翻转模式，将缓冲区改为读模式（缓冲区默认模式为<strong>写模式</strong>）。其实就改变了<code>limit</code>，<code>position</code>，<code>mark</code>属性的值。</li>\n<li>get()：从缓冲区读取数据，从<code>position</code>位置开始读</li>\n<li>rewind()：倒带（重复读取），就是将<code>position</code>的位置重置为<code>0</code></li>\n<li>mark()：<code>mark()</code>方法的作用就是将当前<code>position</code>的位置暂存起来，放在<code>mark</code>属性中。</li>\n<li>reset()：将<code>position</code>重置为<code>mark</code>属性的位置。</li>\n<li>clean()：清空缓存区，重置<code>position</code>，<code>limit</code>，<code>mark</code>属性为初始值</li>\n</ul>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"0x1-子类\"><a href=\"#0x1-子类\" class=\"headerlink\" title=\"0x1 子类\"></a>0x1 子类</h2><p>Buffer是一个抽象类，所以一般使用他的子类来进行编程，常用的子类有：</p>\n<ul>\n<li><p>ByteBuffer</p>\n</li>\n<li><p>IntBuffer</p>\n</li>\n<li><p>LongBuffer</p>\n</li>\n<li><p>CharBuffer</p>\n</li>\n<li><p>DoubleBufffer</p>\n</li>\n<li><p>FloatBuffer</p>\n</li>\n<li><p>ShortBuffer</p>\n</li>\n<li><p>MappedByteBuffer</p>\n</li>\n</ul>\n<h2 id=\"0x2-属性\"><a href=\"#0x2-属性\" class=\"headerlink\" title=\"0x2 属性\"></a>0x2 属性</h2><p>Buffer中有四个重要的属性，分别是：</p>\n<ul>\n<li>capacity：Buffer类的capacity属性，表示内部容量的大小</li>\n<li>position：Buffer类的position属性，表示当前的位置</li>\n<li>limit：Buffer类的limit属性，表示读写的最大上限。</li>\n<li>mark：暂存属性，暂时保存position的值，方便后面的重复使用position值。</li>\n</ul>\n<p><img src=\"http://cdn.mjava.top/blog/epub_26174369_8\" alt></p>\n<h2 id=\"0x3-方法\"><a href=\"#0x3-方法\" class=\"headerlink\" title=\"0x3 方法\"></a>0x3 方法</h2><p>Buffer中几个重要的方法有：</p>\n<ul>\n<li>allocate()：创建缓存区（BUffer创建缓存区不是用<code>new</code>，而是用这个方法来创建)</li>\n<li>put()：向缓冲器插入数据</li>\n<li>filp()：翻转模式，将缓冲区改为读模式（缓冲区默认模式为<strong>写模式</strong>）。其实就改变了<code>limit</code>，<code>position</code>，<code>mark</code>属性的值。</li>\n<li>get()：从缓冲区读取数据，从<code>position</code>位置开始读</li>\n<li>rewind()：倒带（重复读取），就是将<code>position</code>的位置重置为<code>0</code></li>\n<li>mark()：<code>mark()</code>方法的作用就是将当前<code>position</code>的位置暂存起来，放在<code>mark</code>属性中。</li>\n<li>reset()：将<code>position</code>重置为<code>mark</code>属性的位置。</li>\n<li>clean()：清空缓存区，重置<code>position</code>，<code>limit</code>，<code>mark</code>属性为初始值</li>\n</ul>\n"},{"title":"创建线程的3种方式","top":false,"cover":false,"toc":true,"mathjax":true,"date":"2020-06-22T08:29:38.000Z","password":null,"summary":null,"keywords":null,"description":null,"_content":"\n\n\n## Java线程状态变迁图\n\n![Java线程状态变迁图](http://cdn.mjava.top/blog/20200602150941.jpeg)\n\n\n\n## 构造一个线程\n\n在线程执行`start()`方法之前,首先需要初始化(NEW)一个线程,初始化的时候,可以设置线程名称,线程所属的线程组、线程优先级、是否是Daemon线程等信息。\n\n**Thread常见参数及设置方法:**\n\n- ```java\n  //线程是否是守护线程  默认false\n  private boolean     daemon = false;\n  //设置方法\n  Thread thread=new Thread();\n  thread.setDaemon(true);\n  ```\n\n- ```java\n  //线程名字\t默认\"Thread-\" + nextThreadNum()\n  private volatile String name;\n  //设置方法\n  Thread thread=new Thread();\n  thread.setName(\"myThread\"); //不能设置为null,会报异常\n  ```\n\n- ```java\n  //线程优先级  是否起作用和操作系统及虚拟机版本相关\n  private int priority;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n  //设置方法  范围:1-10  默认5\n  myThread.setPriority(1);\n  ```\n\n  \n\n### Thread源码构造方法\n\n在Thread源码中,一共提供了`9种`构造方法.\n\n![](http://cdn.mjava.top/blog/20200602151437.png)\n\n从这些构造方法中,大致可以分为`有Runnable构造参数`的,和`无Runnable构造参数`两大类,无Runnable构造参数的就需要去继承`Thread`来重写`run()`方法<font color=grey>(注:`Thread`也实现了Runnable接口)</font>,有Runnable构造参数的,就实现Runnable接口的run方法,然后通过构造参数,把实现Runnable接口的实例传入Thread.\n\n\n\n### 无返回值的线程\n\n可以看到,通过集成`Thread`类和实现`Runnable`接口的`run()`方法返回值都是`void`.这类是没有返回值的\n\n#### 方法一:继承Thread类创建一个线程\n\n```java\n//继承Thread类,重写run方法\nclass MyThread extends Thread{\n    @Override\n    public void run() {\n        System.out.println(\"继承Thread,重写run方法\");\n    }\n}\n\npublic class ThreadTest{\n    public static void main(String[] args){\n        MyThread myThread=new MyThread();\n        myThread.start();\n    }\n}\n```\n\n\n\n#### 方法二:实现Runnable接口创建线程\n\n```java\n//实现Runnable接口的run方法,然后以构造参数的形式设置Thread的target\nclass MyRun implements Runnable{\n    @Override\n    public void run() {\n        System.out.println(\"实现Runnable方法\");\n    }\n}\n\npublic class ThreadTest{\n    public static void main(String[] args){\n        MyRun myRun=new MyRun();\n        Thread thread=new Thread(myRun);\n        thread.start();\n    }\n}\n```\n\n\n\n### 有返回值的线程\t\n\n上面两个方法,都有一个共同缺点,就是**没有返回值**,当有一些特殊需求时,比如开启一个线程,用来计算一些东西,或者是处理另外一些需要返回数据的业务,这时就需要借助`FutureTask`来完成了\n\n#### 方法三:通过FutureTask创建一个线程\n\n```java\n//实现Callable接口的call方法   类似实现Runnable的run方法\nclass MyCall implements Callable<Integer>{\n    @Override\n    public Integer call() throws Exception {\n        //计算1+1\n        return 1+1;\n    }\n}\n\npublic class ThreadTest{\n    public static void main(String[] args){\n        MyCall myCall=new MyCall();\n        //创建异步任务\n        FutureTask<Integer> futureTask=new FutureTask<>(myCall);\n        Thread thread2=new Thread(futureTask);\n        thread2.start();\n        //获取线程执行结果\n        Integer res=futureTask.get();\n        System.out.println(res); //输出2\n    }\n}\n```\n\n\n\n## 总结\n\n使用继承方式的好处是方便传参，你可以在子类里面添加成员变量，通过set方法设置参数或者通过构造函数进行传递，而如果使用Runnable方式，则只能使用主线程里面被声明为final的变量。不好的地方是Java不支持多继承，如果继承了Thread类，那么子类不能再继承其他类，而Runable则没有这个限制。前两种方式都没办法拿到任务的返回结果，但是Futuretask方式可以。","source":"_posts/java/thread/create-thread-3.md","raw":"---\ntitle: 创建线程的3种方式\ntop: false\ncover: false\ntoc: true\nmathjax: true\ndate: 2020-06-22 16:29:38\npassword:\nsummary:\nkeywords:\ndescription:\ntags:\n- 多线程\ncategories:\n- JAVA\n---\n\n\n\n## Java线程状态变迁图\n\n![Java线程状态变迁图](http://cdn.mjava.top/blog/20200602150941.jpeg)\n\n\n\n## 构造一个线程\n\n在线程执行`start()`方法之前,首先需要初始化(NEW)一个线程,初始化的时候,可以设置线程名称,线程所属的线程组、线程优先级、是否是Daemon线程等信息。\n\n**Thread常见参数及设置方法:**\n\n- ```java\n  //线程是否是守护线程  默认false\n  private boolean     daemon = false;\n  //设置方法\n  Thread thread=new Thread();\n  thread.setDaemon(true);\n  ```\n\n- ```java\n  //线程名字\t默认\"Thread-\" + nextThreadNum()\n  private volatile String name;\n  //设置方法\n  Thread thread=new Thread();\n  thread.setName(\"myThread\"); //不能设置为null,会报异常\n  ```\n\n- ```java\n  //线程优先级  是否起作用和操作系统及虚拟机版本相关\n  private int priority;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n  //设置方法  范围:1-10  默认5\n  myThread.setPriority(1);\n  ```\n\n  \n\n### Thread源码构造方法\n\n在Thread源码中,一共提供了`9种`构造方法.\n\n![](http://cdn.mjava.top/blog/20200602151437.png)\n\n从这些构造方法中,大致可以分为`有Runnable构造参数`的,和`无Runnable构造参数`两大类,无Runnable构造参数的就需要去继承`Thread`来重写`run()`方法<font color=grey>(注:`Thread`也实现了Runnable接口)</font>,有Runnable构造参数的,就实现Runnable接口的run方法,然后通过构造参数,把实现Runnable接口的实例传入Thread.\n\n\n\n### 无返回值的线程\n\n可以看到,通过集成`Thread`类和实现`Runnable`接口的`run()`方法返回值都是`void`.这类是没有返回值的\n\n#### 方法一:继承Thread类创建一个线程\n\n```java\n//继承Thread类,重写run方法\nclass MyThread extends Thread{\n    @Override\n    public void run() {\n        System.out.println(\"继承Thread,重写run方法\");\n    }\n}\n\npublic class ThreadTest{\n    public static void main(String[] args){\n        MyThread myThread=new MyThread();\n        myThread.start();\n    }\n}\n```\n\n\n\n#### 方法二:实现Runnable接口创建线程\n\n```java\n//实现Runnable接口的run方法,然后以构造参数的形式设置Thread的target\nclass MyRun implements Runnable{\n    @Override\n    public void run() {\n        System.out.println(\"实现Runnable方法\");\n    }\n}\n\npublic class ThreadTest{\n    public static void main(String[] args){\n        MyRun myRun=new MyRun();\n        Thread thread=new Thread(myRun);\n        thread.start();\n    }\n}\n```\n\n\n\n### 有返回值的线程\t\n\n上面两个方法,都有一个共同缺点,就是**没有返回值**,当有一些特殊需求时,比如开启一个线程,用来计算一些东西,或者是处理另外一些需要返回数据的业务,这时就需要借助`FutureTask`来完成了\n\n#### 方法三:通过FutureTask创建一个线程\n\n```java\n//实现Callable接口的call方法   类似实现Runnable的run方法\nclass MyCall implements Callable<Integer>{\n    @Override\n    public Integer call() throws Exception {\n        //计算1+1\n        return 1+1;\n    }\n}\n\npublic class ThreadTest{\n    public static void main(String[] args){\n        MyCall myCall=new MyCall();\n        //创建异步任务\n        FutureTask<Integer> futureTask=new FutureTask<>(myCall);\n        Thread thread2=new Thread(futureTask);\n        thread2.start();\n        //获取线程执行结果\n        Integer res=futureTask.get();\n        System.out.println(res); //输出2\n    }\n}\n```\n\n\n\n## 总结\n\n使用继承方式的好处是方便传参，你可以在子类里面添加成员变量，通过set方法设置参数或者通过构造函数进行传递，而如果使用Runnable方式，则只能使用主线程里面被声明为final的变量。不好的地方是Java不支持多继承，如果继承了Thread类，那么子类不能再继承其他类，而Runable则没有这个限制。前两种方式都没办法拿到任务的返回结果，但是Futuretask方式可以。","slug":"java/thread/create-thread-3","published":1,"updated":"2021-01-26T09:49:03.574Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ckm1p5bmj00a52mg515uo49ho","content":"<h2 id=\"Java线程状态变迁图\"><a href=\"#Java线程状态变迁图\" class=\"headerlink\" title=\"Java线程状态变迁图\"></a>Java线程状态变迁图</h2><p><img src=\"http://cdn.mjava.top/blog/20200602150941.jpeg\" alt=\"Java线程状态变迁图\"></p>\n<h2 id=\"构造一个线程\"><a href=\"#构造一个线程\" class=\"headerlink\" title=\"构造一个线程\"></a>构造一个线程</h2><p>在线程执行<code>start()</code>方法之前,首先需要初始化(NEW)一个线程,初始化的时候,可以设置线程名称,线程所属的线程组、线程优先级、是否是Daemon线程等信息。</p>\n<p><strong>Thread常见参数及设置方法:</strong></p>\n<ul>\n<li><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//线程是否是守护线程  默认false</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span>     daemon = <span class=\"keyword\">false</span>;</span><br><span class=\"line\"><span class=\"comment\">//设置方法</span></span><br><span class=\"line\">Thread thread=<span class=\"keyword\">new</span> Thread();</span><br><span class=\"line\">thread.setDaemon(<span class=\"keyword\">true</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//线程名字\t默认\"Thread-\" + nextThreadNum()</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> String name;</span><br><span class=\"line\"><span class=\"comment\">//设置方法</span></span><br><span class=\"line\">Thread thread=<span class=\"keyword\">new</span> Thread();</span><br><span class=\"line\">thread.setName(<span class=\"string\">\"myThread\"</span>); <span class=\"comment\">//不能设置为null,会报异常</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//线程优先级  是否起作用和操作系统及虚拟机版本相关</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> priority;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span><br><span class=\"line\"><span class=\"comment\">//设置方法  范围:1-10  默认5</span></span><br><span class=\"line\">myThread.setPriority(<span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ul>\n<h3 id=\"Thread源码构造方法\"><a href=\"#Thread源码构造方法\" class=\"headerlink\" title=\"Thread源码构造方法\"></a>Thread源码构造方法</h3><p>在Thread源码中,一共提供了<code>9种</code>构造方法.</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200602151437.png\" alt></p>\n<p>从这些构造方法中,大致可以分为<code>有Runnable构造参数</code>的,和<code>无Runnable构造参数</code>两大类,无Runnable构造参数的就需要去继承<code>Thread</code>来重写<code>run()</code>方法<font color=\"grey\">(注:<code>Thread</code>也实现了Runnable接口)</font>,有Runnable构造参数的,就实现Runnable接口的run方法,然后通过构造参数,把实现Runnable接口的实例传入Thread.</p>\n<h3 id=\"无返回值的线程\"><a href=\"#无返回值的线程\" class=\"headerlink\" title=\"无返回值的线程\"></a>无返回值的线程</h3><p>可以看到,通过集成<code>Thread</code>类和实现<code>Runnable</code>接口的<code>run()</code>方法返回值都是<code>void</code>.这类是没有返回值的</p>\n<h4 id=\"方法一-继承Thread类创建一个线程\"><a href=\"#方法一-继承Thread类创建一个线程\" class=\"headerlink\" title=\"方法一:继承Thread类创建一个线程\"></a>方法一:继承Thread类创建一个线程</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//继承Thread类,重写run方法</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title\">Thread</span></span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"继承Thread,重写run方法\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadTest</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        MyThread myThread=<span class=\"keyword\">new</span> MyThread();</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"方法二-实现Runnable接口创建线程\"><a href=\"#方法二-实现Runnable接口创建线程\" class=\"headerlink\" title=\"方法二:实现Runnable接口创建线程\"></a>方法二:实现Runnable接口创建线程</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//实现Runnable接口的run方法,然后以构造参数的形式设置Thread的target</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyRun</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span></span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"实现Runnable方法\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadTest</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        MyRun myRun=<span class=\"keyword\">new</span> MyRun();</span><br><span class=\"line\">        Thread thread=<span class=\"keyword\">new</span> Thread(myRun);</span><br><span class=\"line\">        thread.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"有返回值的线程\"><a href=\"#有返回值的线程\" class=\"headerlink\" title=\"有返回值的线程\"></a>有返回值的线程</h3><p>上面两个方法,都有一个共同缺点,就是<strong>没有返回值</strong>,当有一些特殊需求时,比如开启一个线程,用来计算一些东西,或者是处理另外一些需要返回数据的业务,这时就需要借助<code>FutureTask</code>来完成了</p>\n<h4 id=\"方法三-通过FutureTask创建一个线程\"><a href=\"#方法三-通过FutureTask创建一个线程\" class=\"headerlink\" title=\"方法三:通过FutureTask创建一个线程\"></a>方法三:通过FutureTask创建一个线程</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//实现Callable接口的call方法   类似实现Runnable的run方法</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyCall</span> <span class=\"keyword\">implements</span> <span class=\"title\">Callable</span>&lt;<span class=\"title\">Integer</span>&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Integer <span class=\"title\">call</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//计算1+1</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>+<span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadTest</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        MyCall myCall=<span class=\"keyword\">new</span> MyCall();</span><br><span class=\"line\">        <span class=\"comment\">//创建异步任务</span></span><br><span class=\"line\">        FutureTask&lt;Integer&gt; futureTask=<span class=\"keyword\">new</span> FutureTask&lt;&gt;(myCall);</span><br><span class=\"line\">        Thread thread2=<span class=\"keyword\">new</span> Thread(futureTask);</span><br><span class=\"line\">        thread2.start();</span><br><span class=\"line\">        <span class=\"comment\">//获取线程执行结果</span></span><br><span class=\"line\">        Integer res=futureTask.get();</span><br><span class=\"line\">        System.out.println(res); <span class=\"comment\">//输出2</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>使用继承方式的好处是方便传参，你可以在子类里面添加成员变量，通过set方法设置参数或者通过构造函数进行传递，而如果使用Runnable方式，则只能使用主线程里面被声明为final的变量。不好的地方是Java不支持多继承，如果继承了Thread类，那么子类不能再继承其他类，而Runable则没有这个限制。前两种方式都没办法拿到任务的返回结果，但是Futuretask方式可以。</p>\n","site":{"data":{"url":{"url":"http://rs.mjava.top:81"},"musics":[{"name":"等你下课(with 杨瑞代)","artist":"周杰伦","url":"https://mjava.top/music/等你下课(with 杨瑞代) - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003bSL0v4bpKAx.jpg?max_age=2592000"},{"name":"告白气球","artist":"周杰伦","url":"https://mjava.top/music/告白气球 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000003RMaRI1iFoYd.jpg?max_age=2592000"},{"name":"稻香","artist":"周杰伦","url":"https://mjava.top/music/稻香 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"},{"name":"给我一首歌的时间","artist":"周杰伦","url":"https://mjava.top/music/给我一首歌的时间 - 周杰伦.mp3","cover":"http://y.gtimg.cn/music/photo_new/T002R300x300M000002Neh8l0uciQZ.jpg?max_age=2592000"}],"friends":[]}},"excerpt":"","more":"<h2 id=\"Java线程状态变迁图\"><a href=\"#Java线程状态变迁图\" class=\"headerlink\" title=\"Java线程状态变迁图\"></a>Java线程状态变迁图</h2><p><img src=\"http://cdn.mjava.top/blog/20200602150941.jpeg\" alt=\"Java线程状态变迁图\"></p>\n<h2 id=\"构造一个线程\"><a href=\"#构造一个线程\" class=\"headerlink\" title=\"构造一个线程\"></a>构造一个线程</h2><p>在线程执行<code>start()</code>方法之前,首先需要初始化(NEW)一个线程,初始化的时候,可以设置线程名称,线程所属的线程组、线程优先级、是否是Daemon线程等信息。</p>\n<p><strong>Thread常见参数及设置方法:</strong></p>\n<ul>\n<li><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//线程是否是守护线程  默认false</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span>     daemon = <span class=\"keyword\">false</span>;</span><br><span class=\"line\"><span class=\"comment\">//设置方法</span></span><br><span class=\"line\">Thread thread=<span class=\"keyword\">new</span> Thread();</span><br><span class=\"line\">thread.setDaemon(<span class=\"keyword\">true</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//线程名字\t默认\"Thread-\" + nextThreadNum()</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> String name;</span><br><span class=\"line\"><span class=\"comment\">//设置方法</span></span><br><span class=\"line\">Thread thread=<span class=\"keyword\">new</span> Thread();</span><br><span class=\"line\">thread.setName(<span class=\"string\">\"myThread\"</span>); <span class=\"comment\">//不能设置为null,会报异常</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//线程优先级  是否起作用和操作系统及虚拟机版本相关</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> priority;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span><br><span class=\"line\"><span class=\"comment\">//设置方法  范围:1-10  默认5</span></span><br><span class=\"line\">myThread.setPriority(<span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n\n\n\n</li>\n</ul>\n<h3 id=\"Thread源码构造方法\"><a href=\"#Thread源码构造方法\" class=\"headerlink\" title=\"Thread源码构造方法\"></a>Thread源码构造方法</h3><p>在Thread源码中,一共提供了<code>9种</code>构造方法.</p>\n<p><img src=\"http://cdn.mjava.top/blog/20200602151437.png\" alt></p>\n<p>从这些构造方法中,大致可以分为<code>有Runnable构造参数</code>的,和<code>无Runnable构造参数</code>两大类,无Runnable构造参数的就需要去继承<code>Thread</code>来重写<code>run()</code>方法<font color=\"grey\">(注:<code>Thread</code>也实现了Runnable接口)</font>,有Runnable构造参数的,就实现Runnable接口的run方法,然后通过构造参数,把实现Runnable接口的实例传入Thread.</p>\n<h3 id=\"无返回值的线程\"><a href=\"#无返回值的线程\" class=\"headerlink\" title=\"无返回值的线程\"></a>无返回值的线程</h3><p>可以看到,通过集成<code>Thread</code>类和实现<code>Runnable</code>接口的<code>run()</code>方法返回值都是<code>void</code>.这类是没有返回值的</p>\n<h4 id=\"方法一-继承Thread类创建一个线程\"><a href=\"#方法一-继承Thread类创建一个线程\" class=\"headerlink\" title=\"方法一:继承Thread类创建一个线程\"></a>方法一:继承Thread类创建一个线程</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//继承Thread类,重写run方法</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyThread</span> <span class=\"keyword\">extends</span> <span class=\"title\">Thread</span></span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"继承Thread,重写run方法\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadTest</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        MyThread myThread=<span class=\"keyword\">new</span> MyThread();</span><br><span class=\"line\">        myThread.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"方法二-实现Runnable接口创建线程\"><a href=\"#方法二-实现Runnable接口创建线程\" class=\"headerlink\" title=\"方法二:实现Runnable接口创建线程\"></a>方法二:实现Runnable接口创建线程</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//实现Runnable接口的run方法,然后以构造参数的形式设置Thread的target</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyRun</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span></span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"实现Runnable方法\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadTest</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        MyRun myRun=<span class=\"keyword\">new</span> MyRun();</span><br><span class=\"line\">        Thread thread=<span class=\"keyword\">new</span> Thread(myRun);</span><br><span class=\"line\">        thread.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"有返回值的线程\"><a href=\"#有返回值的线程\" class=\"headerlink\" title=\"有返回值的线程\"></a>有返回值的线程</h3><p>上面两个方法,都有一个共同缺点,就是<strong>没有返回值</strong>,当有一些特殊需求时,比如开启一个线程,用来计算一些东西,或者是处理另外一些需要返回数据的业务,这时就需要借助<code>FutureTask</code>来完成了</p>\n<h4 id=\"方法三-通过FutureTask创建一个线程\"><a href=\"#方法三-通过FutureTask创建一个线程\" class=\"headerlink\" title=\"方法三:通过FutureTask创建一个线程\"></a>方法三:通过FutureTask创建一个线程</h4><figure class=\"highlight java\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//实现Callable接口的call方法   类似实现Runnable的run方法</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">MyCall</span> <span class=\"keyword\">implements</span> <span class=\"title\">Callable</span>&lt;<span class=\"title\">Integer</span>&gt;</span>&#123;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Integer <span class=\"title\">call</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//计算1+1</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span>+<span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadTest</span></span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        MyCall myCall=<span class=\"keyword\">new</span> MyCall();</span><br><span class=\"line\">        <span class=\"comment\">//创建异步任务</span></span><br><span class=\"line\">        FutureTask&lt;Integer&gt; futureTask=<span class=\"keyword\">new</span> FutureTask&lt;&gt;(myCall);</span><br><span class=\"line\">        Thread thread2=<span class=\"keyword\">new</span> Thread(futureTask);</span><br><span class=\"line\">        thread2.start();</span><br><span class=\"line\">        <span class=\"comment\">//获取线程执行结果</span></span><br><span class=\"line\">        Integer res=futureTask.get();</span><br><span class=\"line\">        System.out.println(res); <span class=\"comment\">//输出2</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>使用继承方式的好处是方便传参，你可以在子类里面添加成员变量，通过set方法设置参数或者通过构造函数进行传递，而如果使用Runnable方式，则只能使用主线程里面被声明为final的变量。不好的地方是Java不支持多继承，如果继承了Thread类，那么子类不能再继承其他类，而Runable则没有这个限制。前两种方式都没办法拿到任务的返回结果，但是Futuretask方式可以。</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"ckm1p5bj300072mg5t4zk63o1","category_id":"ckm1p5bj700092mg5v66x2m5b","_id":"ckm1p5bjf000j2mg5g0ri42e9"},{"post_id":"ckm1p5bjb000d2mg512470703","category_id":"ckm1p5bj700092mg5v66x2m5b","_id":"ckm1p5bjg000m2mg58tndrxjj"},{"post_id":"ckm1p5bj600082mg5vcp7vn59","category_id":"ckm1p5bj700092mg5v66x2m5b","_id":"ckm1p5bjh000o2mg5sn7j2nyj"},{"post_id":"ckm1p5bja000b2mg5e2py8t26","category_id":"ckm1p5bjf000i2mg5swbh576t","_id":"ckm1p5bjj000u2mg5q6od3vhs"},{"post_id":"ckm1p5bjb000c2mg5p3x0tajr","category_id":"ckm1p5bjf000i2mg5swbh576t","_id":"ckm1p5bjl000z2mg51t4thuep"},{"post_id":"ckm1p5bjj000w2mg5kv343q9p","category_id":"ckm1p5bjj000t2mg5261viau2","_id":"ckm1p5bjn00162mg5arre8jbm"},{"post_id":"ckm1p5bjd000g2mg5dw2cvqzh","category_id":"ckm1p5bjj000t2mg5261viau2","_id":"ckm1p5bjo001a2mg5s5b2m6q2"},{"post_id":"ckm1p5bjl00122mg5g432fihm","category_id":"ckm1p5bjj000t2mg5261viau2","_id":"ckm1p5bjp001e2mg50pj488nt"},{"post_id":"ckm1p5bje000h2mg5f2v54qxd","category_id":"ckm1p5bjj000t2mg5261viau2","_id":"ckm1p5bjr001i2mg5gnz4bz78"},{"post_id":"ckm1p5bjf000l2mg5d8yrwxji","category_id":"ckm1p5bjj000t2mg5261viau2","_id":"ckm1p5bjs001n2mg5f1izcng0"},{"post_id":"ckm1p5bjg000n2mg5aoqskhqc","category_id":"ckm1p5bjj000t2mg5261viau2","_id":"ckm1p5bju001u2mg5twno9bkb"},{"post_id":"ckm1p5bjh000r2mg5w9id4zss","category_id":"ckm1p5bjj000t2mg5261viau2","_id":"ckm1p5bjw00202mg5c5cwm8ls"},{"post_id":"ckm1p5bjv001w2mg54fw61wmt","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bjy00262mg5hcf0cey0"},{"post_id":"ckm1p5bji000s2mg5b9xa3spq","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bjz002a2mg5ewb6cpmt"},{"post_id":"ckm1p5bjw00232mg5byw7u5fb","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bk0002d2mg5lskzbizn"},{"post_id":"ckm1p5bjk000y2mg5tt6s79bh","category_id":"ckm1p5bjw00222mg50rcx1ago","_id":"ckm1p5bk1002h2mg5f9ykxdnr"},{"post_id":"ckm1p5bjn00152mg53ydwdemy","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bk3002o2mg5snlyj3d3"},{"post_id":"ckm1p5bk1002f2mg54sb14ds2","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bk4002r2mg5b7edmpca"},{"post_id":"ckm1p5bjo00192mg518u2atbp","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bk6002w2mg5ni3tozks"},{"post_id":"ckm1p5bjp001d2mg5ewknpbxj","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bk800322mg5gv7jdxrc"},{"post_id":"ckm1p5bjq001h2mg55ahbgu8f","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bka00382mg591q0abm9"},{"post_id":"ckm1p5bjr001l2mg5z5jvh3al","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bkc003f2mg5s2phku39"},{"post_id":"ckm1p5bjs001p2mg5x5i8tysz","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bke003l2mg5k5jhz842"},{"post_id":"ckm1p5bkc003d2mg5nzx3wbuo","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bkf003p2mg5ikqlw12o"},{"post_id":"ckm1p5bjt001s2mg5r0k8ndn8","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bkg003r2mg5tpg2jeyu"},{"post_id":"ckm1p5bjv001y2mg50jcxzlra","category_id":"ckm1p5bke003k2mg5yvm6nrip","_id":"ckm1p5bkj003z2mg5qtjdalvq"},{"post_id":"ckm1p5bjx00252mg5hb7z6voh","category_id":"ckm1p5bke003k2mg5yvm6nrip","_id":"ckm1p5bkl00442mg5qx5tebgg"},{"post_id":"ckm1p5bjy00292mg5o5rj5zk3","category_id":"ckm1p5bke003k2mg5yvm6nrip","_id":"ckm1p5bkm00482mg55zzck6fp"},{"post_id":"ckm1p5bjz002c2mg5nhbqa8rw","category_id":"ckm1p5bke003k2mg5yvm6nrip","_id":"ckm1p5bkn004c2mg5hiwhltjt"},{"post_id":"ckm1p5bk2002j2mg5ngekpyaz","category_id":"ckm1p5bke003k2mg5yvm6nrip","_id":"ckm1p5bko004f2mg5tgjc4p50"},{"post_id":"ckm1p5bk3002m2mg5qwyy1q5z","category_id":"ckm1p5bkn004b2mg55kj1lm5a","_id":"ckm1p5bkp004k2mg55h1oa9tr"},{"post_id":"ckm1p5bk4002q2mg5vwgm5itk","category_id":"ckm1p5bkn004b2mg55kj1lm5a","_id":"ckm1p5bkr004o2mg55f3te7sl"},{"post_id":"ckm1p5bk5002u2mg57o40uo2e","category_id":"ckm1p5bkn004b2mg55kj1lm5a","_id":"ckm1p5bks004s2mg580vn0jg4"},{"post_id":"ckm1p5bk6002x2mg5bfpglmf8","category_id":"ckm1p5bke003k2mg5yvm6nrip","_id":"ckm1p5bkt004w2mg5dx77exru"},{"post_id":"ckm1p5bk700302mg51fec42wx","category_id":"ckm1p5bkn004b2mg55kj1lm5a","_id":"ckm1p5bkt004z2mg53pnmx2jp"},{"post_id":"ckm1p5bk800342mg5f9k3fsgk","category_id":"ckm1p5bkt004v2mg5r8qf1uj9","_id":"ckm1p5bku00542mg5vvm66b4a"},{"post_id":"ckm1p5bk900362mg5cic55g1p","category_id":"ckm1p5bkt004v2mg5r8qf1uj9","_id":"ckm1p5bkv00582mg5a2ocwdpl"},{"post_id":"ckm1p5bkb003a2mg5h7s9z089","category_id":"ckm1p5bkn004b2mg55kj1lm5a","_id":"ckm1p5bkv005b2mg5o9zp9yqm"},{"post_id":"ckm1p5bkd003h2mg5zis69d00","category_id":"ckm1p5bkv00572mg5dij0yyzj","_id":"ckm1p5bkw005e2mg5i5znz73w"},{"post_id":"ckm1p5bke003j2mg56pypg84j","category_id":"ckm1p5bkv005c2mg5duxy0swp","_id":"ckm1p5bkw005j2mg5eglv2ayx"},{"post_id":"ckm1p5bkf003o2mg534tjiqwv","category_id":"ckm1p5bkw005g2mg5ujj111wl","_id":"ckm1p5bkx005n2mg5a4vsodw2"},{"post_id":"ckm1p5bkg003q2mg5opittkez","category_id":"ckm1p5bkv00572mg5dij0yyzj","_id":"ckm1p5bky005r2mg58lx8wsae"},{"post_id":"ckm1p5bki003w2mg5qphyiy0y","category_id":"ckm1p5bkx005m2mg5z3s0a2on","_id":"ckm1p5bky005w2mg5exr9rywg"},{"post_id":"ckm1p5bkj00412mg59accedz6","category_id":"ckm1p5bky005t2mg5jmzetk30","_id":"ckm1p5bkz005z2mg5rq7z95tj"},{"post_id":"ckm1p5bkk00422mg58tj5npoz","category_id":"ckm1p5bkv00572mg5dij0yyzj","_id":"ckm1p5bl000632mg5s3eey77u"},{"post_id":"ckm1p5blo007w2mg5tjo6cjqf","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5blq007z2mg5rep838wo"},{"post_id":"ckm1p5blp007x2mg5bm77cnhl","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5blq00802mg50ovwuaje"},{"post_id":"ckm1p5bly008e2mg5boz5r6rg","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bm2008k2mg5yw9sc5ps"},{"post_id":"ckm1p5blv00892mg5tgytwzpm","category_id":"ckm1p5blw008b2mg5w4mmgxy4","_id":"ckm1p5bm3008o2mg5ubxpudxl"},{"post_id":"ckm1p5blz008f2mg5qfbn3ptm","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bm4008r2mg52h2xj1u8"},{"post_id":"ckm1p5bm0008i2mg5e21c4c36","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bm5008v2mg5fatwma37"},{"post_id":"ckm1p5blw008a2mg5f1ueyd6n","category_id":"ckm1p5blw008b2mg5w4mmgxy4","_id":"ckm1p5bm6008x2mg5kei416pf"},{"post_id":"ckm1p5bm1008j2mg524nu1zv5","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bm700902mg59wy3kdr5"},{"post_id":"ckm1p5bm2008n2mg5xz47npc8","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bm800942mg5ir7atg0n"},{"post_id":"ckm1p5blx008d2mg5x2nsi6p0","category_id":"ckm1p5blw008b2mg5w4mmgxy4","_id":"ckm1p5bm900972mg57u1zvqem"},{"post_id":"ckm1p5bm3008q2mg5nark2swm","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bma009b2mg5y3h0drql"},{"post_id":"ckm1p5bm4008u2mg5n5q7f3kb","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bmb009d2mg58dba6nky"},{"post_id":"ckm1p5bm800962mg58xp80sg6","category_id":"ckm1p5bm700922mg5z5dydrz5","_id":"ckm1p5bmc009h2mg58nprkuye"},{"post_id":"ckm1p5bm5008w2mg5thucxsxs","category_id":"ckm1p5bm700922mg5z5dydrz5","_id":"ckm1p5bmd009k2mg5zl1me3xe"},{"post_id":"ckm1p5bm900992mg5dafjfzgb","category_id":"ckm1p5bm700922mg5z5dydrz5","_id":"ckm1p5bme009p2mg579l6uhum"},{"post_id":"ckm1p5bma009c2mg5vfcq8qwh","category_id":"ckm1p5bm700922mg5z5dydrz5","_id":"ckm1p5bmf009s2mg5gn6f90wo"},{"post_id":"ckm1p5bm6008z2mg5gmbvo5jb","category_id":"ckm1p5bm700922mg5z5dydrz5","_id":"ckm1p5bmh009w2mg52a5003oi"},{"post_id":"ckm1p5bmc009j2mg5ekubg0m6","category_id":"ckm1p5bm700922mg5z5dydrz5","_id":"ckm1p5bmh009z2mg5653qxbno"},{"post_id":"ckm1p5bm700932mg5gufgc1of","category_id":"ckm1p5bm700922mg5z5dydrz5","_id":"ckm1p5bmj00a32mg5yfq8t78q"},{"post_id":"ckm1p5bme009n2mg5tam6oqp8","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bmk00a62mg52r749e1b"},{"post_id":"ckm1p5bmf009r2mg58u040y5m","category_id":"ckm1p5bm700922mg5z5dydrz5","_id":"ckm1p5bml00a92mg516r8rq0g"},{"post_id":"ckm1p5bmb009f2mg5prhna1ul","category_id":"ckm1p5bm700922mg5z5dydrz5","_id":"ckm1p5bml00ac2mg5nzuqhvwm"},{"post_id":"ckm1p5bmb009f2mg5prhna1ul","category_id":"ckm1p5bme009o2mg58z3y7xph","_id":"ckm1p5bmm00af2mg5n4anqmsn"},{"post_id":"ckm1p5bmg009v2mg5fpawx5vb","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bmm00ah2mg5p7zz8grh"},{"post_id":"ckm1p5bmh009y2mg52brlr8ty","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bmn00ak2mg5mu37igne"},{"post_id":"ckm1p5bmi00a22mg5vkyi32a4","category_id":"ckm1p5bju001t2mg5fta1gj72","_id":"ckm1p5bmn00am2mg5hn3dewtd"},{"post_id":"ckm1p5bmj00a52mg515uo49ho","category_id":"ckm1p5bml00ab2mg55clyqx3y","_id":"ckm1p5bmn00ap2mg5wlcwzkwu"}],"PostTag":[{"post_id":"ckm1p5bj300072mg5t4zk63o1","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bjk000x2mg5vutkr8hy"},{"post_id":"ckm1p5bj300072mg5t4zk63o1","tag_id":"ckm1p5bjc000f2mg5vaj0p0tr","_id":"ckm1p5bjl00112mg56i0x7cwc"},{"post_id":"ckm1p5bj300072mg5t4zk63o1","tag_id":"ckm1p5bjf000k2mg5ibgwh30m","_id":"ckm1p5bjm00142mg55omiovdz"},{"post_id":"ckm1p5bj300072mg5t4zk63o1","tag_id":"ckm1p5bjh000q2mg56bik3tv7","_id":"ckm1p5bjn00182mg5ksw0j0ob"},{"post_id":"ckm1p5bji000s2mg5b9xa3spq","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bjp001c2mg5w95tpsm5"},{"post_id":"ckm1p5bjn00152mg53ydwdemy","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bjq001g2mg5oe1dcxlq"},{"post_id":"ckm1p5bjp001d2mg5ewknpbxj","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bjr001k2mg5mw33ajpk"},{"post_id":"ckm1p5bjq001h2mg55ahbgu8f","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bjs001o2mg5cmumrkjq"},{"post_id":"ckm1p5bjr001l2mg5z5jvh3al","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bjt001q2mg5gsp8skx1"},{"post_id":"ckm1p5bj600082mg5vcp7vn59","tag_id":"ckm1p5bjj000v2mg55dft3we8","_id":"ckm1p5bju001v2mg5fhjheycv"},{"post_id":"ckm1p5bj600082mg5vcp7vn59","tag_id":"ckm1p5bjm00132mg5m2wsuu3b","_id":"ckm1p5bjv001x2mg5t50jjyxp"},{"post_id":"ckm1p5bj600082mg5vcp7vn59","tag_id":"ckm1p5bjo001b2mg53gvh5pqi","_id":"ckm1p5bjw00212mg5lybzg8zi"},{"post_id":"ckm1p5bj600082mg5vcp7vn59","tag_id":"ckm1p5bjr001j2mg5jlsn7ydh","_id":"ckm1p5bjx00242mg5f4nfpvd4"},{"post_id":"ckm1p5bjs001p2mg5x5i8tysz","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bjy00282mg5x3h1qsu8"},{"post_id":"ckm1p5bja000b2mg5e2py8t26","tag_id":"ckm1p5bjt001r2mg5heuhhrne","_id":"ckm1p5bk2002i2mg5naq05dw9"},{"post_id":"ckm1p5bja000b2mg5e2py8t26","tag_id":"ckm1p5bjw001z2mg5d7c1mqwq","_id":"ckm1p5bk3002k2mg5pbopfvpv"},{"post_id":"ckm1p5bja000b2mg5e2py8t26","tag_id":"ckm1p5bjy00272mg5kejhz7pb","_id":"ckm1p5bk4002p2mg5hb9t79vv"},{"post_id":"ckm1p5bk1002f2mg54sb14ds2","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bk5002s2mg5i3zkfrez"},{"post_id":"ckm1p5bk5002u2mg57o40uo2e","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bk7002y2mg5pmdp1945"},{"post_id":"ckm1p5bk5002u2mg57o40uo2e","tag_id":"ckm1p5bjy00272mg5kejhz7pb","_id":"ckm1p5bk800332mg5fpxynpqs"},{"post_id":"ckm1p5bjb000c2mg5p3x0tajr","tag_id":"ckm1p5bjw001z2mg5d7c1mqwq","_id":"ckm1p5bkb00392mg58ug2zezf"},{"post_id":"ckm1p5bjb000c2mg5p3x0tajr","tag_id":"ckm1p5bk3002l2mg5998684hr","_id":"ckm1p5bkb003b2mg5nns63kqh"},{"post_id":"ckm1p5bjb000c2mg5p3x0tajr","tag_id":"ckm1p5bjt001r2mg5heuhhrne","_id":"ckm1p5bkd003g2mg51drmnjkl"},{"post_id":"ckm1p5bjb000c2mg5p3x0tajr","tag_id":"ckm1p5bjy00272mg5kejhz7pb","_id":"ckm1p5bke003i2mg5j2yebzuz"},{"post_id":"ckm1p5bjb000d2mg512470703","tag_id":"ckm1p5bjm00132mg5m2wsuu3b","_id":"ckm1p5bkf003n2mg5uur1f7f9"},{"post_id":"ckm1p5bjd000g2mg5dw2cvqzh","tag_id":"ckm1p5bkb003c2mg586wgyn2i","_id":"ckm1p5bki003v2mg555b04yqx"},{"post_id":"ckm1p5bjd000g2mg5dw2cvqzh","tag_id":"ckm1p5bke003m2mg5tsott4ud","_id":"ckm1p5bkj003x2mg5s5jx96lx"},{"post_id":"ckm1p5bje000h2mg5f2v54qxd","tag_id":"ckm1p5bkb003c2mg586wgyn2i","_id":"ckm1p5bkm00462mg5l2te8sti"},{"post_id":"ckm1p5bje000h2mg5f2v54qxd","tag_id":"ckm1p5bkj00402mg57ppldbl0","_id":"ckm1p5bkm00492mg57cw4utu3"},{"post_id":"ckm1p5bjf000l2mg5d8yrwxji","tag_id":"ckm1p5bkl00452mg5q7eeswjj","_id":"ckm1p5bko004e2mg533xu7ass"},{"post_id":"ckm1p5bjf000l2mg5d8yrwxji","tag_id":"ckm1p5bkm004a2mg5fpaa6oku","_id":"ckm1p5bko004h2mg5y7cgcb68"},{"post_id":"ckm1p5bjg000n2mg5aoqskhqc","tag_id":"ckm1p5bkb003c2mg586wgyn2i","_id":"ckm1p5bkp004m2mg5iz8prjab"},{"post_id":"ckm1p5bjg000n2mg5aoqskhqc","tag_id":"ckm1p5bko004i2mg52vv56fhx","_id":"ckm1p5bkr004p2mg52ceedf0r"},{"post_id":"ckm1p5bjh000r2mg5w9id4zss","tag_id":"ckm1p5bkb003c2mg586wgyn2i","_id":"ckm1p5bkt004u2mg5fuiexp7f"},{"post_id":"ckm1p5bjh000r2mg5w9id4zss","tag_id":"ckm1p5bkr004q2mg596gwe2ef","_id":"ckm1p5bkt004x2mg5ibitxxds"},{"post_id":"ckm1p5bjj000w2mg5kv343q9p","tag_id":"ckm1p5bkl00452mg5q7eeswjj","_id":"ckm1p5bku00522mg5jzrq945d"},{"post_id":"ckm1p5bjj000w2mg5kv343q9p","tag_id":"ckm1p5bkt004y2mg5cf5yv1tm","_id":"ckm1p5bku00552mg5ebby3rtp"},{"post_id":"ckm1p5bjk000y2mg5tt6s79bh","tag_id":"ckm1p5bkt00512mg5beaeqyol","_id":"ckm1p5bkv00592mg5b9bj7a6g"},{"post_id":"ckm1p5bjl00122mg5g432fihm","tag_id":"ckm1p5bkb003c2mg586wgyn2i","_id":"ckm1p5bkw005f2mg59fhbkmp4"},{"post_id":"ckm1p5bjl00122mg5g432fihm","tag_id":"ckm1p5bkv005a2mg5t155w01s","_id":"ckm1p5bkw005h2mg52odxnl7h"},{"post_id":"ckm1p5bjo00192mg518u2atbp","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bkx005o2mg5h2zzqaty"},{"post_id":"ckm1p5bjo00192mg518u2atbp","tag_id":"ckm1p5bkv005d2mg5phov6wjp","_id":"ckm1p5bkx005p2mg5fwt504v2"},{"post_id":"ckm1p5bjo00192mg518u2atbp","tag_id":"ckm1p5bkw005i2mg5reawbf8k","_id":"ckm1p5bky005s2mg5lymitwtt"},{"post_id":"ckm1p5bjt001s2mg5r0k8ndn8","tag_id":"ckm1p5bkx005l2mg5rzmo8j2x","_id":"ckm1p5bky005u2mg5ar3lzyop"},{"post_id":"ckm1p5bjv001w2mg54fw61wmt","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bkz00602mg5md6zap78"},{"post_id":"ckm1p5bjv001w2mg54fw61wmt","tag_id":"ckm1p5bkx005q2mg5lhgj9e4y","_id":"ckm1p5bkz00612mg58lb0a9nk"},{"post_id":"ckm1p5bjv001w2mg54fw61wmt","tag_id":"ckm1p5bk3002l2mg5998684hr","_id":"ckm1p5bl000642mg5rc80u6ga"},{"post_id":"ckm1p5bjv001y2mg50jcxzlra","tag_id":"ckm1p5bkz005y2mg5bq2keh71","_id":"ckm1p5bl000662mg5kvezeoyk"},{"post_id":"ckm1p5bjv001y2mg50jcxzlra","tag_id":"ckm1p5bjt001r2mg5heuhhrne","_id":"ckm1p5bl000672mg53rouqfht"},{"post_id":"ckm1p5bjv001y2mg50jcxzlra","tag_id":"ckm1p5bjy00272mg5kejhz7pb","_id":"ckm1p5bl100692mg5j60llgfz"},{"post_id":"ckm1p5bjw00232mg5byw7u5fb","tag_id":"ckm1p5bl000652mg51bx6d0mn","_id":"ckm1p5bl2006b2mg595hjsrov"},{"post_id":"ckm1p5bjw00232mg5byw7u5fb","tag_id":"ckm1p5bl000682mg57cqtnppb","_id":"ckm1p5bl2006c2mg5k0dp8xpb"},{"post_id":"ckm1p5bjx00252mg5hb7z6voh","tag_id":"ckm1p5bkz005y2mg5bq2keh71","_id":"ckm1p5bl3006e2mg50ry2a4zx"},{"post_id":"ckm1p5bjy00292mg5o5rj5zk3","tag_id":"ckm1p5bkz005y2mg5bq2keh71","_id":"ckm1p5bl3006g2mg5s59xakwq"},{"post_id":"ckm1p5bjz002c2mg5nhbqa8rw","tag_id":"ckm1p5bkz005y2mg5bq2keh71","_id":"ckm1p5bl4006i2mg5pvprqd33"},{"post_id":"ckm1p5bk2002j2mg5ngekpyaz","tag_id":"ckm1p5bkz005y2mg5bq2keh71","_id":"ckm1p5bl4006k2mg5gg4ex3za"},{"post_id":"ckm1p5bk3002m2mg5qwyy1q5z","tag_id":"ckm1p5bjy00272mg5kejhz7pb","_id":"ckm1p5bl4006m2mg5u73gnc7k"},{"post_id":"ckm1p5bk3002m2mg5qwyy1q5z","tag_id":"ckm1p5bjt001r2mg5heuhhrne","_id":"ckm1p5bl4006n2mg5359cd48h"},{"post_id":"ckm1p5bk3002m2mg5qwyy1q5z","tag_id":"ckm1p5bl4006j2mg54timrg8v","_id":"ckm1p5bl5006p2mg5vrfteumc"},{"post_id":"ckm1p5bk4002q2mg5vwgm5itk","tag_id":"ckm1p5bl4006l2mg5xoguuhlx","_id":"ckm1p5bl5006q2mg5ufgzvfrf"},{"post_id":"ckm1p5bk4002q2mg5vwgm5itk","tag_id":"ckm1p5bjy00272mg5kejhz7pb","_id":"ckm1p5bl5006s2mg54v04xqkz"},{"post_id":"ckm1p5bk6002x2mg5bfpglmf8","tag_id":"ckm1p5bkz005y2mg5bq2keh71","_id":"ckm1p5bl6006u2mg5unrx5k3x"},{"post_id":"ckm1p5bk6002x2mg5bfpglmf8","tag_id":"ckm1p5bl5006r2mg53ytahxeo","_id":"ckm1p5bl6006v2mg5yqmhieoy"},{"post_id":"ckm1p5bk6002x2mg5bfpglmf8","tag_id":"ckm1p5bjt001r2mg5heuhhrne","_id":"ckm1p5bl6006x2mg5su8ls279"},{"post_id":"ckm1p5bk700302mg51fec42wx","tag_id":"ckm1p5bl5006t2mg57y3sb2ma","_id":"ckm1p5bl6006y2mg5phh28ec2"},{"post_id":"ckm1p5bk700302mg51fec42wx","tag_id":"ckm1p5bjy00272mg5kejhz7pb","_id":"ckm1p5bl700702mg56n8gttt3"},{"post_id":"ckm1p5bk800342mg5f9k3fsgk","tag_id":"ckm1p5bk3002l2mg5998684hr","_id":"ckm1p5bl700712mg5e2lsuezb"},{"post_id":"ckm1p5bk800342mg5f9k3fsgk","tag_id":"ckm1p5bl6006w2mg5vcxyaxse","_id":"ckm1p5bl700732mg50lb2yfmt"},{"post_id":"ckm1p5bk900362mg5cic55g1p","tag_id":"ckm1p5bk3002l2mg5998684hr","_id":"ckm1p5bl700742mg5kl0f8euc"},{"post_id":"ckm1p5bk900362mg5cic55g1p","tag_id":"ckm1p5bl6006w2mg5vcxyaxse","_id":"ckm1p5bl700762mg5wz7oajdg"},{"post_id":"ckm1p5bkb003a2mg5h7s9z089","tag_id":"ckm1p5bjy00272mg5kejhz7pb","_id":"ckm1p5bl800772mg5cxsgfw7s"},{"post_id":"ckm1p5bkb003a2mg5h7s9z089","tag_id":"ckm1p5bl700722mg5np6t7onn","_id":"ckm1p5bl800782mg5oxak37ts"},{"post_id":"ckm1p5bkc003d2mg5nzx3wbuo","tag_id":"ckm1p5bl700752mg5dagjr8ff","_id":"ckm1p5bl8007a2mg5y90p4t4b"},{"post_id":"ckm1p5bkd003h2mg5zis69d00","tag_id":"ckm1p5bl800792mg5w2ugtwbv","_id":"ckm1p5bl8007d2mg52hyviix2"},{"post_id":"ckm1p5bkd003h2mg5zis69d00","tag_id":"ckm1p5bl8007b2mg5ot4t6dwx","_id":"ckm1p5bl9007e2mg5k8v4zzcs"},{"post_id":"ckm1p5bke003j2mg56pypg84j","tag_id":"ckm1p5bl8007c2mg5aofkzaln","_id":"ckm1p5bl9007g2mg5u6gij50i"},{"post_id":"ckm1p5bke003j2mg56pypg84j","tag_id":"ckm1p5bjy00272mg5kejhz7pb","_id":"ckm1p5bl9007h2mg54dqp7ia2"},{"post_id":"ckm1p5bkf003o2mg534tjiqwv","tag_id":"ckm1p5bl9007f2mg5gbu0z6e3","_id":"ckm1p5bla007k2mg51nm9mnnf"},{"post_id":"ckm1p5bkf003o2mg534tjiqwv","tag_id":"ckm1p5bl9007i2mg5e71mrcy5","_id":"ckm1p5bla007l2mg5yfj2gs7z"},{"post_id":"ckm1p5bkg003q2mg5opittkez","tag_id":"ckm1p5bl9007j2mg5toxnntdq","_id":"ckm1p5bla007o2mg583e1ymzy"},{"post_id":"ckm1p5bkg003q2mg5opittkez","tag_id":"ckm1p5bla007m2mg5l99wq1yn","_id":"ckm1p5bla007p2mg5dd7ouhje"},{"post_id":"ckm1p5bki003w2mg5qphyiy0y","tag_id":"ckm1p5bl700752mg5dagjr8ff","_id":"ckm1p5blb007r2mg54bgt5qgg"},{"post_id":"ckm1p5bkj00412mg59accedz6","tag_id":"ckm1p5bla007q2mg5aabrc23q","_id":"ckm1p5blb007t2mg527l9t9nm"},{"post_id":"ckm1p5bkj00412mg59accedz6","tag_id":"ckm1p5bk3002l2mg5998684hr","_id":"ckm1p5blb007u2mg58bniagi8"},{"post_id":"ckm1p5bkk00422mg58tj5npoz","tag_id":"ckm1p5blb007s2mg5wdxx5pe6","_id":"ckm1p5blb007v2mg5w0dtdbu1"},{"post_id":"ckm1p5blo007w2mg5tjo6cjqf","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5blr00822mg5hf64375c"},{"post_id":"ckm1p5blo007w2mg5tjo6cjqf","tag_id":"ckm1p5bkw005i2mg5reawbf8k","_id":"ckm1p5blr00832mg52fvqrjs4"},{"post_id":"ckm1p5blo007w2mg5tjo6cjqf","tag_id":"ckm1p5blq007y2mg5ktfgsrdh","_id":"ckm1p5blr00852mg5yqyshhao"},{"post_id":"ckm1p5blp007x2mg5bm77cnhl","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5blr00862mg54b9pkh27"},{"post_id":"ckm1p5blp007x2mg5bm77cnhl","tag_id":"ckm1p5blq00812mg55chiw8ba","_id":"ckm1p5blr00872mg55olyxm6g"},{"post_id":"ckm1p5blp007x2mg5bm77cnhl","tag_id":"ckm1p5blr00842mg5kw97lnbs","_id":"ckm1p5blr00882mg59fio8gs7"},{"post_id":"ckm1p5blv00892mg5tgytwzpm","tag_id":"ckm1p5blw008c2mg5j6afzi9s","_id":"ckm1p5bm3008p2mg57fihlcsg"},{"post_id":"ckm1p5blv00892mg5tgytwzpm","tag_id":"ckm1p5bm0008h2mg5nj9i7gi4","_id":"ckm1p5bm4008s2mg5q2ajup2b"},{"post_id":"ckm1p5blw008a2mg5f1ueyd6n","tag_id":"ckm1p5bm2008m2mg5ppfmn050","_id":"ckm1p5bm700912mg527r1obsv"},{"post_id":"ckm1p5blw008a2mg5f1ueyd6n","tag_id":"ckm1p5bm4008t2mg5mq3ax2ga","_id":"ckm1p5bm800952mg54sf8z2tt"},{"post_id":"ckm1p5blx008d2mg5x2nsi6p0","tag_id":"ckm1p5bm6008y2mg5tbwziecs","_id":"ckm1p5bmc009i2mg5htcy1x7i"},{"post_id":"ckm1p5blx008d2mg5x2nsi6p0","tag_id":"ckm1p5bm900982mg5jir7tgjd","_id":"ckm1p5bmd009l2mg5xzp2mb9u"},{"post_id":"ckm1p5bly008e2mg5boz5r6rg","tag_id":"ckm1p5bmb009e2mg59zbdpwzs","_id":"ckm1p5bmf009q2mg505xhfugb"},{"post_id":"ckm1p5bly008e2mg5boz5r6rg","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmf009t2mg5z6yemex2"},{"post_id":"ckm1p5blz008f2mg5qfbn3ptm","tag_id":"ckm1p5bmb009e2mg59zbdpwzs","_id":"ckm1p5bmh009x2mg5f9u5n9vi"},{"post_id":"ckm1p5blz008f2mg5qfbn3ptm","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmi00a02mg5famvyho7"},{"post_id":"ckm1p5bm0008i2mg5e21c4c36","tag_id":"ckm1p5bmb009e2mg59zbdpwzs","_id":"ckm1p5bmj00a42mg5y4sncqfm"},{"post_id":"ckm1p5bm0008i2mg5e21c4c36","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmk00a72mg5vfksjuex"},{"post_id":"ckm1p5bm1008j2mg524nu1zv5","tag_id":"ckm1p5bmb009e2mg59zbdpwzs","_id":"ckm1p5bml00aa2mg561135l3l"},{"post_id":"ckm1p5bm1008j2mg524nu1zv5","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bml00ad2mg5ja8gm2lo"},{"post_id":"ckm1p5bm2008n2mg5xz47npc8","tag_id":"ckm1p5bmb009e2mg59zbdpwzs","_id":"ckm1p5bmm00ag2mg5en9k6nzn"},{"post_id":"ckm1p5bm2008n2mg5xz47npc8","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmm00ai2mg5skft4tkc"},{"post_id":"ckm1p5bm3008q2mg5nark2swm","tag_id":"ckm1p5bmb009e2mg59zbdpwzs","_id":"ckm1p5bmn00al2mg50qt9xvrr"},{"post_id":"ckm1p5bm3008q2mg5nark2swm","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmn00an2mg5rl2ymk3x"},{"post_id":"ckm1p5bm4008u2mg5n5q7f3kb","tag_id":"ckm1p5bmb009e2mg59zbdpwzs","_id":"ckm1p5bmn00aq2mg50ao6asri"},{"post_id":"ckm1p5bm4008u2mg5n5q7f3kb","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmn00ar2mg5p8lc3ia3"},{"post_id":"ckm1p5bm5008w2mg5thucxsxs","tag_id":"ckm1p5bmn00ao2mg5gdoswkbf","_id":"ckm1p5bmo00at2mg5ol230r0t"},{"post_id":"ckm1p5bm5008w2mg5thucxsxs","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmo00au2mg5u1yretbp"},{"post_id":"ckm1p5bm6008z2mg5gmbvo5jb","tag_id":"ckm1p5bmn00ao2mg5gdoswkbf","_id":"ckm1p5bmo00aw2mg5ojq95hs5"},{"post_id":"ckm1p5bm6008z2mg5gmbvo5jb","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmo00ax2mg53eowy10e"},{"post_id":"ckm1p5bm700932mg5gufgc1of","tag_id":"ckm1p5bmn00ao2mg5gdoswkbf","_id":"ckm1p5bmp00az2mg5i63hqizg"},{"post_id":"ckm1p5bm700932mg5gufgc1of","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmp00b02mg525vzv2b0"},{"post_id":"ckm1p5bm800962mg58xp80sg6","tag_id":"ckm1p5bmn00ao2mg5gdoswkbf","_id":"ckm1p5bmp00b22mg5vw6e0da3"},{"post_id":"ckm1p5bm800962mg58xp80sg6","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmp00b32mg5gzy61hzp"},{"post_id":"ckm1p5bm900992mg5dafjfzgb","tag_id":"ckm1p5bmn00ao2mg5gdoswkbf","_id":"ckm1p5bmq00b52mg5fl0utyp4"},{"post_id":"ckm1p5bma009c2mg5vfcq8qwh","tag_id":"ckm1p5bmn00ao2mg5gdoswkbf","_id":"ckm1p5bmq00b72mg5angzogar"},{"post_id":"ckm1p5bmb009f2mg5prhna1ul","tag_id":"ckm1p5bmn00ao2mg5gdoswkbf","_id":"ckm1p5bmr00ba2mg5fglztdcf"},{"post_id":"ckm1p5bmb009f2mg5prhna1ul","tag_id":"ckm1p5bmq00b82mg5xc77mocs","_id":"ckm1p5bmr00bb2mg5aqg4jpmz"},{"post_id":"ckm1p5bmc009j2mg5ekubg0m6","tag_id":"ckm1p5bmn00ao2mg5gdoswkbf","_id":"ckm1p5bmr00bd2mg511tsrcoh"},{"post_id":"ckm1p5bme009n2mg5tam6oqp8","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bms00bf2mg540ngzhf5"},{"post_id":"ckm1p5bme009n2mg5tam6oqp8","tag_id":"ckm1p5bmr00bc2mg5wbm5zye7","_id":"ckm1p5bms00bg2mg568t8khfj"},{"post_id":"ckm1p5bmf009r2mg58u040y5m","tag_id":"ckm1p5bmn00ao2mg5gdoswkbf","_id":"ckm1p5bms00bi2mg575c3hbdb"},{"post_id":"ckm1p5bmg009v2mg5fpawx5vb","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmt00bk2mg5vt05fl1p"},{"post_id":"ckm1p5bmg009v2mg5fpawx5vb","tag_id":"ckm1p5bmr00bc2mg5wbm5zye7","_id":"ckm1p5bmt00bl2mg5zuo2xdl3"},{"post_id":"ckm1p5bmh009y2mg52brlr8ty","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmt00bn2mg5yzkafxsw"},{"post_id":"ckm1p5bmh009y2mg52brlr8ty","tag_id":"ckm1p5bmr00bc2mg5wbm5zye7","_id":"ckm1p5bmt00bo2mg5unqn94i1"},{"post_id":"ckm1p5bmi00a22mg5vkyi32a4","tag_id":"ckm1p5bj9000a2mg59uqqlg6k","_id":"ckm1p5bmu00bq2mg5isa2lcdm"},{"post_id":"ckm1p5bmi00a22mg5vkyi32a4","tag_id":"ckm1p5bmr00bc2mg5wbm5zye7","_id":"ckm1p5bmu00br2mg5x77hqztc"},{"post_id":"ckm1p5bmj00a52mg515uo49ho","tag_id":"ckm1p5bmt00bp2mg5pa4r627f","_id":"ckm1p5bmu00bs2mg5tyi1b1pc"}],"Tag":[{"name":"Java","_id":"ckm1p5bj9000a2mg59uqqlg6k"},{"name":"Recursive","_id":"ckm1p5bjc000f2mg5vaj0p0tr"},{"name":"Algorithm","_id":"ckm1p5bjf000k2mg5ibgwh30m"},{"name":"Json","_id":"ckm1p5bjh000q2mg56bik3tv7"},{"name":"AVL","_id":"ckm1p5bjj000v2mg55dft3we8"},{"name":"数据结构","_id":"ckm1p5bjm00132mg5m2wsuu3b"},{"name":"平衡二叉树","_id":"ckm1p5bjo001b2mg53gvh5pqi"},{"name":"二叉树","_id":"ckm1p5bjr001j2mg5jlsn7ydh"},{"name":"Docker","_id":"ckm1p5bjt001r2mg5heuhhrne"},{"name":"Mysql","_id":"ckm1p5bjw001z2mg5d7c1mqwq"},{"name":"Linux","_id":"ckm1p5bjy00272mg5kejhz7pb"},{"name":"Pit","_id":"ckm1p5bk3002l2mg5998684hr"},{"name":"设计模式","_id":"ckm1p5bkb003c2mg586wgyn2i"},{"name":"抽象工厂模式","_id":"ckm1p5bke003m2mg5tsott4ud"},{"name":"工厂方法模式","_id":"ckm1p5bkj00402mg57ppldbl0"},{"name":"GOF","_id":"ckm1p5bkl00452mg5q7eeswjj"},{"name":"OOP","_id":"ckm1p5bkm004a2mg5fpaa6oku"},{"name":"原型模式","_id":"ckm1p5bko004i2mg52vv56fhx"},{"name":"建造者模式","_id":"ckm1p5bkr004q2mg596gwe2ef"},{"name":"Singleton","_id":"ckm1p5bkt004y2mg5cf5yv1tm"},{"name":"Dubbo","_id":"ckm1p5bkt00512mg5beaeqyol"},{"name":"模板方法模式","_id":"ckm1p5bkv005a2mg5t155w01s"},{"name":"ArrayList","_id":"ckm1p5bkv005d2mg5phov6wjp"},{"name":"源码解析","_id":"ckm1p5bkw005i2mg5reawbf8k"},{"name":"Nacos","_id":"ckm1p5bkx005l2mg5rzmo8j2x"},{"name":"Base64","_id":"ckm1p5bkx005q2mg5lhgj9e4y"},{"name":"Jenkins","_id":"ckm1p5bkz005y2mg5bq2keh71"},{"name":"Logback","_id":"ckm1p5bl000652mg51bx6d0mn"},{"name":"MDC","_id":"ckm1p5bl000682mg57cqtnppb"},{"name":"RaspberryPi","_id":"ckm1p5bl4006j2mg54timrg8v"},{"name":"Shell","_id":"ckm1p5bl4006l2mg5xoguuhlx"},{"name":"SonarQube","_id":"ckm1p5bl5006r2mg53ytahxeo"},{"name":"Github Actions","_id":"ckm1p5bl5006t2mg57y3sb2ma"},{"name":"MySQL","_id":"ckm1p5bl6006w2mg5vcxyaxse"},{"name":"fastDFS","_id":"ckm1p5bl700722mg5np6t7onn"},{"name":"Git","_id":"ckm1p5bl700752mg5dagjr8ff"},{"name":"Spring AOP","_id":"ckm1p5bl800792mg5w2ugtwbv"},{"name":"注解","_id":"ckm1p5bl8007b2mg5ot4t6dwx"},{"name":"RocketMQ","_id":"ckm1p5bl8007c2mg5aofkzaln"},{"name":"UI","_id":"ckm1p5bl9007f2mg5gbu0z6e3"},{"name":"推荐","_id":"ckm1p5bl9007i2mg5e71mrcy5"},{"name":"Fegin","_id":"ckm1p5bl9007j2mg5toxnntdq"},{"name":"Resttemplate","_id":"ckm1p5bla007m2mg5l99wq1yn"},{"name":"Vue","_id":"ckm1p5bla007q2mg5aabrc23q"},{"name":"SpringBoot","_id":"ckm1p5blb007s2mg5wdxx5pe6"},{"name":"ArrayDeque","_id":"ckm1p5blq007y2mg5ktfgsrdh"},{"name":"源码分析","_id":"ckm1p5blq00812mg55chiw8ba"},{"name":"LinkedList","_id":"ckm1p5blr00842mg5kw97lnbs"},{"name":"OAuth2.0","_id":"ckm1p5blw008c2mg5j6afzi9s"},{"name":"JWT","_id":"ckm1p5bm0008h2mg5nj9i7gi4"},{"name":"OAuth","_id":"ckm1p5bm2008m2mg5ppfmn050"},{"name":"spring-security","_id":"ckm1p5bm4008t2mg5mq3ax2ga"},{"name":"SSO","_id":"ckm1p5bm6008y2mg5tbwziecs"},{"name":"CAS框架","_id":"ckm1p5bm900982mg5jir7tgjd"},{"name":"Disruptor","_id":"ckm1p5bmb009e2mg59zbdpwzs"},{"name":"JVM","_id":"ckm1p5bmn00ao2mg5gdoswkbf"},{"name":"JAVA","_id":"ckm1p5bmq00b82mg5xc77mocs"},{"name":"Nio","_id":"ckm1p5bmr00bc2mg5wbm5zye7"},{"name":"多线程","_id":"ckm1p5bmt00bp2mg5pa4r627f"}]}}