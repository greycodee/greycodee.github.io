<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Disruptor-实例化方法 | Greycode's Blog</title><link rel=canonical href=https://blog.greycode.top/posts/b3025291-ae52-4d26-a70c-66a79bda07d7/><meta name=description content="Hello,I‘m Greycode. Please use Chrome to browse this site for a better experience."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Disruptor-实例化方法"><meta property="og:description" content="创建一个事件实体 public class LongEvent{ private Long id; public Long getId() { return id; } public void setId(Long id) { this.id = id; } } 创建一个事件实体工厂 public class LongEventFactory implements EventFactory<LongEvent> { public LongEvent newInstance() { return new LongEvent(); } } 创建两个事件处理类 /** * EventHandler<LongEvent> 是没有池化的实现方式,每个消费者中只有一个示例 * WorkHandler<LongEvent> 是池化的实现方式，每个消费者中可以以类似线程池的方式去执行这个事件 * 实际根据业务场景 实现其中一个接口就可以 */ public class A1Handler implements EventHandler<LongEvent> , WorkHandler<LongEvent> { public void onEvent(LongEvent longEvent, long l, boolean b) throws Exception { long id = longEvent."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.greycode.top/posts/b3025291-ae52-4d26-a70c-66a79bda07d7/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-03-01T09:58:05+00:00"><meta property="article:modified_time" content="2021-03-01T09:58:05+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Disruptor-实例化方法"><meta name=twitter:description content="创建一个事件实体 public class LongEvent{ private Long id; public Long getId() { return id; } public void setId(Long id) { this.id = id; } } 创建一个事件实体工厂 public class LongEventFactory implements EventFactory<LongEvent> { public LongEvent newInstance() { return new LongEvent(); } } 创建两个事件处理类 /** * EventHandler<LongEvent> 是没有池化的实现方式,每个消费者中只有一个示例 * WorkHandler<LongEvent> 是池化的实现方式，每个消费者中可以以类似线程池的方式去执行这个事件 * 实际根据业务场景 实现其中一个接口就可以 */ public class A1Handler implements EventHandler<LongEvent> , WorkHandler<LongEvent> { public void onEvent(LongEvent longEvent, long l, boolean b) throws Exception { long id = longEvent."><link rel=stylesheet href=https://blog.greycode.top/css/styles.ead642cb02ef83a72aed45f47face7d935f86a1601a35f7040ef3e010f1b7ec550ba4743998f203e4545116b293fbe7405e126c9753c036cb2db3d49e9fbc81d.css integrity="sha512-6tZCywLvg6cq7UX0f6zn2TX4ahYBo19wQO8+AQ8bfsVQukdDmY8gPkVFEWspP750BeEmyXU8A2yy2z1J6fvIHQ=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://blog.greycode.top/images/favicon.ico><script async src="https://www.googletagmanager.com/gtag/js?id=G-JVLPYZM5G1"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JVLPYZM5G1",{anonymize_ip:!1})}</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://blog.greycode.top/posts/a552f7f0-4cbe-4628-8fcf-02f8b8730b56/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://blog.greycode.top/posts/9a1bdb74-8ed3-4905-88bc-7b3b4e0a4af2/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&text=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&title=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&is_video=false&description=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95&body=Check out this article: https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&title=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&title=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&name=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95&description=%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa%e4%ba%8b%e4%bb%b6%e5%ae%9e%e4%bd%93%20public%20class%20LongEvent%7b%20private%20Long%20id%3b%20public%20Long%20getId%28%29%20%7b%20return%20id%3b%20%7d%20public%20void%20setId%28Long%20id%29%20%7b%20this.id%20%3d%20id%3b%20%7d%20%7d%20%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa%e4%ba%8b%e4%bb%b6%e5%ae%9e%e4%bd%93%e5%b7%a5%e5%8e%82%20public%20class%20LongEventFactory%20implements%20EventFactory%26lt%3bLongEvent%26gt%3b%20%7b%20public%20LongEvent%20newInstance%28%29%20%7b%20return%20new%20LongEvent%28%29%3b%20%7d%20%7d%20%e5%88%9b%e5%bb%ba%e4%b8%a4%e4%b8%aa%e4%ba%8b%e4%bb%b6%e5%a4%84%e7%90%86%e7%b1%bb%20%2f%2a%2a%20%2a%20EventHandler%26lt%3bLongEvent%26gt%3b%20%e6%98%af%e6%b2%a1%e6%9c%89%e6%b1%a0%e5%8c%96%e7%9a%84%e5%ae%9e%e7%8e%b0%e6%96%b9%e5%bc%8f%2c%e6%af%8f%e4%b8%aa%e6%b6%88%e8%b4%b9%e8%80%85%e4%b8%ad%e5%8f%aa%e6%9c%89%e4%b8%80%e4%b8%aa%e7%a4%ba%e4%be%8b%20%2a%20WorkHandler%26lt%3bLongEvent%26gt%3b%20%e6%98%af%e6%b1%a0%e5%8c%96%e7%9a%84%e5%ae%9e%e7%8e%b0%e6%96%b9%e5%bc%8f%ef%bc%8c%e6%af%8f%e4%b8%aa%e6%b6%88%e8%b4%b9%e8%80%85%e4%b8%ad%e5%8f%af%e4%bb%a5%e4%bb%a5%e7%b1%bb%e4%bc%bc%e7%ba%bf%e7%a8%8b%e6%b1%a0%e7%9a%84%e6%96%b9%e5%bc%8f%e5%8e%bb%e6%89%a7%e8%a1%8c%e8%bf%99%e4%b8%aa%e4%ba%8b%e4%bb%b6%20%2a%20%e5%ae%9e%e9%99%85%e6%a0%b9%e6%8d%ae%e4%b8%9a%e5%8a%a1%e5%9c%ba%e6%99%af%20%e5%ae%9e%e7%8e%b0%e5%85%b6%e4%b8%ad%e4%b8%80%e4%b8%aa%e6%8e%a5%e5%8f%a3%e5%b0%b1%e5%8f%af%e4%bb%a5%20%2a%2f%20public%20class%20A1Handler%20implements%20EventHandler%26lt%3bLongEvent%26gt%3b%20%2c%20WorkHandler%26lt%3bLongEvent%26gt%3b%20%7b%20public%20void%20onEvent%28LongEvent%20longEvent%2c%20long%20l%2c%20boolean%20b%29%20throws%20Exception%20%7b%20long%20id%20%3d%20longEvent." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&t=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#创建一个事件实体>创建一个事件实体</a></li><li><a href=#创建一个事件实体工厂>创建一个事件实体工厂</a></li><li><a href=#创建两个事件处理类>创建两个事件处理类</a></li><li><a href=#实例化disruptor>实例化Disruptor</a></li><li><a href=#创建消费者>创建消费者</a><ul><li><a href=#单个模式>单个模式</a></li><li><a href=#池化模式>池化模式</a></li></ul></li><li><a href=#获取ringbuffer>获取RingBuffer</a></li><li><a href=#生产者发布消息>生产者发布消息</a></li><li><a href=#完整的main方法>完整的Main方法</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Disruptor-实例化方法</h1><div class=meta><div class=postdate><time datetime="2021-03-01 09:58:05 +0000 UTC" itemprop=datePublished>2021-03-01</time></div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/categories/java>Java</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/disruptor rel=tag>Disruptor</a>
,
<a class=tag-link href=/tags/java rel=tag>Java</a></div></div></header><div class=content itemprop=articleBody><h2 id=创建一个事件实体>创建一个事件实体</h2><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#815ba4>public</span> <span style=color:#815ba4>class</span> <span style=color:#fec418>LongEvent</span><span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>private</span> Long id<span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#815ba4>public</span> Long <span style=color:#06b6ef>getId</span><span style=color:#5bc4bf>()</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>        <span style=color:#815ba4>return</span> id<span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>public</span> <span style=color:#fec418>void</span> <span style=color:#06b6ef>setId</span><span style=color:#5bc4bf>(</span>Long id<span style=color:#5bc4bf>)</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>        <span style=color:#815ba4>this</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>id</span> <span style=color:#5bc4bf>=</span> id<span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>}</span>
</span></span></code></pre></div><h2 id=创建一个事件实体工厂>创建一个事件实体工厂</h2><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#815ba4>public</span> <span style=color:#815ba4>class</span> <span style=color:#fec418>LongEventFactory</span> <span style=color:#815ba4>implements</span> EventFactory<span style=color:#5bc4bf>&lt;</span>LongEvent<span style=color:#5bc4bf>&gt;</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>public</span> LongEvent <span style=color:#06b6ef>newInstance</span><span style=color:#5bc4bf>()</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>        <span style=color:#815ba4>return</span> <span style=color:#815ba4>new</span> LongEvent<span style=color:#5bc4bf>();</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>}</span>
</span></span></code></pre></div><h2 id=创建两个事件处理类>创建两个事件处理类</h2><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687>/**
</span></span></span><span style=display:flex><span><span style=color:#8d8687>* EventHandler&lt;LongEvent&gt; 是没有池化的实现方式,每个消费者中只有一个示例
</span></span></span><span style=display:flex><span><span style=color:#8d8687>* WorkHandler&lt;LongEvent&gt; 是池化的实现方式，每个消费者中可以以类似线程池的方式去执行这个事件
</span></span></span><span style=display:flex><span><span style=color:#8d8687>* 实际根据业务场景 实现其中一个接口就可以
</span></span></span><span style=display:flex><span><span style=color:#8d8687>*/</span>
</span></span><span style=display:flex><span><span style=color:#815ba4>public</span> <span style=color:#815ba4>class</span> <span style=color:#fec418>A1Handler</span> <span style=color:#815ba4>implements</span> EventHandler<span style=color:#5bc4bf>&lt;</span>LongEvent<span style=color:#5bc4bf>&gt;</span> <span style=color:#5bc4bf>,</span> WorkHandler<span style=color:#5bc4bf>&lt;</span>LongEvent<span style=color:#5bc4bf>&gt;</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>public</span> <span style=color:#fec418>void</span> <span style=color:#06b6ef>onEvent</span><span style=color:#5bc4bf>(</span>LongEvent longEvent<span style=color:#5bc4bf>,</span> <span style=color:#fec418>long</span> l<span style=color:#5bc4bf>,</span> <span style=color:#fec418>boolean</span> b<span style=color:#5bc4bf>)</span> <span style=color:#815ba4>throws</span> Exception <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>        <span style=color:#fec418>long</span> id <span style=color:#5bc4bf>=</span> longEvent<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>getId</span><span style=color:#5bc4bf>();</span>
</span></span><span style=display:flex><span>        id<span style=color:#5bc4bf>+=</span><span style=color:#f99b15>1</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;**************************&#34;</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span>Thread<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>currentThread</span><span style=color:#5bc4bf>().</span><span style=color:#06b6ef>getName</span><span style=color:#5bc4bf>());</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span>System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>currentTimeMillis</span><span style=color:#5bc4bf>()+</span><span style=color:#48b685>&#34;+A1Handler:&#34;</span><span style=color:#5bc4bf>+</span>id<span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;**************************&#34;</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8d8687>/**
</span></span></span><span style=display:flex><span><span style=color:#8d8687>     * 池化执行
</span></span></span><span style=display:flex><span><span style=color:#8d8687>     * */</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>public</span> <span style=color:#fec418>void</span> <span style=color:#06b6ef>onEvent</span><span style=color:#5bc4bf>(</span>LongEvent longEvent<span style=color:#5bc4bf>)</span> <span style=color:#815ba4>throws</span> Exception <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>        <span style=color:#fec418>long</span> id <span style=color:#5bc4bf>=</span> longEvent<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>getId</span><span style=color:#5bc4bf>();</span>
</span></span><span style=display:flex><span>        id<span style=color:#5bc4bf>+=</span><span style=color:#f99b15>10</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;**************************&#34;</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span>Thread<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>currentThread</span><span style=color:#5bc4bf>().</span><span style=color:#06b6ef>getName</span><span style=color:#5bc4bf>());</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span>System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>currentTimeMillis</span><span style=color:#5bc4bf>()+</span><span style=color:#48b685>&#34;+A1Handler:&#34;</span><span style=color:#5bc4bf>+</span>id<span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;**************************&#34;</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#815ba4>public</span> <span style=color:#815ba4>class</span> <span style=color:#fec418>A2Handler</span> <span style=color:#815ba4>implements</span> EventHandler<span style=color:#5bc4bf>&lt;</span>LongEvent<span style=color:#5bc4bf>&gt;</span> <span style=color:#5bc4bf>,</span> WorkHandler<span style=color:#5bc4bf>&lt;</span>LongEvent<span style=color:#5bc4bf>&gt;</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>public</span> <span style=color:#fec418>void</span> <span style=color:#06b6ef>onEvent</span><span style=color:#5bc4bf>(</span>LongEvent longEvent<span style=color:#5bc4bf>,</span> <span style=color:#fec418>long</span> l<span style=color:#5bc4bf>,</span> <span style=color:#fec418>boolean</span> b<span style=color:#5bc4bf>)</span> <span style=color:#815ba4>throws</span> Exception <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>        <span style=color:#fec418>long</span> id <span style=color:#5bc4bf>=</span> longEvent<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>getId</span><span style=color:#5bc4bf>();</span>
</span></span><span style=display:flex><span>        id<span style=color:#5bc4bf>+=</span><span style=color:#f99b15>3</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;**************************&#34;</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span>Thread<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>currentThread</span><span style=color:#5bc4bf>().</span><span style=color:#06b6ef>getName</span><span style=color:#5bc4bf>());</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span>System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>currentTimeMillis</span><span style=color:#5bc4bf>()+</span><span style=color:#48b685>&#34;+A2Handler:&#34;</span><span style=color:#5bc4bf>+</span>id<span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;**************************&#34;</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8d8687>/**
</span></span></span><span style=display:flex><span><span style=color:#8d8687>     * 池化执行
</span></span></span><span style=display:flex><span><span style=color:#8d8687>     * */</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>public</span> <span style=color:#fec418>void</span> <span style=color:#06b6ef>onEvent</span><span style=color:#5bc4bf>(</span>LongEvent longEvent<span style=color:#5bc4bf>)</span> <span style=color:#815ba4>throws</span> Exception <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>        <span style=color:#fec418>long</span> id <span style=color:#5bc4bf>=</span> longEvent<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>getId</span><span style=color:#5bc4bf>();</span>
</span></span><span style=display:flex><span>        id<span style=color:#5bc4bf>+=</span><span style=color:#f99b15>30</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;**************************&#34;</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span>Thread<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>currentThread</span><span style=color:#5bc4bf>().</span><span style=color:#06b6ef>getName</span><span style=color:#5bc4bf>());</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span>System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>currentTimeMillis</span><span style=color:#5bc4bf>()+</span><span style=color:#48b685>&#34;+A2Handler:&#34;</span><span style=color:#5bc4bf>+</span>id<span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;**************************&#34;</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>}</span>
</span></span></code></pre></div><h2 id=实例化disruptor>实例化Disruptor</h2><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8d8687>// 事件工厂
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>LongEventFactory factory <span style=color:#5bc4bf>=</span> <span style=color:#815ba4>new</span> LongEventFactory<span style=color:#5bc4bf>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687>// 定义RingBuff大小  注意：数值一定是2的幂次方
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span><span style=color:#fec418>int</span> bufferSize <span style=color:#5bc4bf>=</span> <span style=color:#f99b15>1024</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687>// 创建ThreadFactory
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>ThreadFactory threadFactory <span style=color:#5bc4bf>=</span> <span style=color:#815ba4>new</span> ThreadFactory<span style=color:#5bc4bf>()</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>private</span> <span style=color:#fec418>int</span> counter <span style=color:#5bc4bf>=</span> <span style=color:#f99b15>0</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>private</span> String prefix <span style=color:#5bc4bf>=</span> <span style=color:#48b685>&#34;DisruptorWorker&#34;</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>public</span> Thread <span style=color:#06b6ef>newThread</span><span style=color:#5bc4bf>(</span>Runnable r<span style=color:#5bc4bf>)</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>        <span style=color:#815ba4>return</span> <span style=color:#815ba4>new</span> Thread<span style=color:#5bc4bf>(</span>r<span style=color:#5bc4bf>,</span> prefix <span style=color:#5bc4bf>+</span> <span style=color:#48b685>&#34;-&#34;</span> <span style=color:#5bc4bf>+</span> counter<span style=color:#5bc4bf>++);</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>};</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687>/* 实例化Disruptor （官方有4个实例化方法）
</span></span></span><span style=display:flex><span><span style=color:#8d8687> * factory 是事件工厂
</span></span></span><span style=display:flex><span><span style=color:#8d8687> * bufferSize 是上面定义的RingBuffer的大小
</span></span></span><span style=display:flex><span><span style=color:#8d8687> * ProducerType.MULTI 是生产者模式 有SINGL和MULTI两种
</span></span></span><span style=display:flex><span><span style=color:#8d8687> * new BlockingWaitStrategy() 是等待阻塞策略
</span></span></span><span style=display:flex><span><span style=color:#8d8687> */</span>
</span></span><span style=display:flex><span>Disruptor<span style=color:#5bc4bf>&lt;</span>LongEvent<span style=color:#5bc4bf>&gt;</span> disruptor <span style=color:#5bc4bf>=</span> <span style=color:#815ba4>new</span> Disruptor<span style=color:#5bc4bf>&lt;</span>LongEvent<span style=color:#5bc4bf>&gt;(</span>
</span></span><span style=display:flex><span>    factory<span style=color:#5bc4bf>,</span> 
</span></span><span style=display:flex><span>    bufferSize<span style=color:#5bc4bf>,</span> 
</span></span><span style=display:flex><span>    threadFactory<span style=color:#5bc4bf>,</span>
</span></span><span style=display:flex><span>    ProducerType<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>MULTI</span><span style=color:#5bc4bf>,</span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>new</span> BlockingWaitStrategy<span style=color:#5bc4bf>());</span>
</span></span></code></pre></div><h2 id=创建消费者>创建消费者</h2><h3 id=单个模式>单个模式</h3><p>disruptor会创建2和线程，一个线程用来执行<code>A1Handler</code>，一个线程用来执行<code>A2Handler</code>.每个线程互不影响。</p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>disruptor<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>handleEventsWith</span><span style=color:#5bc4bf>(</span><span style=color:#815ba4>new</span> A1Handler<span style=color:#5bc4bf>(),</span><span style=color:#815ba4>new</span> A2Handler<span style=color:#5bc4bf>());</span>
</span></span></code></pre></div><h3 id=池化模式>池化模式</h3><p>disruptor会创建4个线程，其中两个线程组成<strong>线程池</strong>来执行<code>A1Handler</code>，另外两个线程也组成<strong>线程池</strong>用来执行<code>A2Handler</code></p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>disruptor<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>handleEventsWithWorkerPool</span><span style=color:#5bc4bf>(</span><span style=color:#815ba4>new</span> A1Handler<span style=color:#5bc4bf>(),</span><span style=color:#815ba4>new</span> A1Handler<span style=color:#5bc4bf>())</span>
</span></span><span style=display:flex><span>disruptor<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>handleEventsWithWorkerPool</span><span style=color:#5bc4bf>(</span><span style=color:#815ba4>new</span> A2Handler<span style=color:#5bc4bf>(),</span><span style=color:#815ba4>new</span> A2Handler<span style=color:#5bc4bf>())</span>
</span></span></code></pre></div><h2 id=获取ringbuffer>获取RingBuffer</h2><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>RingBuffer<span style=color:#5bc4bf>&lt;</span>LongEvent<span style=color:#5bc4bf>&gt;</span> ringBuffer <span style=color:#5bc4bf>=</span> disruptor<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>start</span><span style=color:#5bc4bf>();</span>
</span></span></code></pre></div><h2 id=生产者发布消息>生产者发布消息</h2><p>这边直接使用Java8的发布方式来发布消息</p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#8d8687>// 创建ByteBuffer缓冲区 
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>ByteBuffer bb <span style=color:#5bc4bf>=</span> ByteBuffer<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>allocate</span><span style=color:#5bc4bf>(</span><span style=color:#f99b15>8</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span><span style=color:#8d8687>// 生产者发布5条消息
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span><span style=color:#815ba4>for</span> <span style=color:#5bc4bf>(</span><span style=color:#fec418>long</span> l <span style=color:#5bc4bf>=</span> <span style=color:#f99b15>0</span><span style=color:#5bc4bf>;</span> l<span style=color:#5bc4bf>&lt;</span><span style=color:#f99b15>5</span><span style=color:#5bc4bf>;</span> l<span style=color:#5bc4bf>++)</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>    <span style=color:#8d8687>// 写入消息到Bufer缓冲区
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>    bb<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>putLong</span><span style=color:#5bc4bf>(</span><span style=color:#f99b15>0</span><span style=color:#5bc4bf>,</span> l<span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>    <span style=color:#8d8687>// Java8 lambda发布方式
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>    ringBuffer<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>publishEvent</span><span style=color:#5bc4bf>((</span>event<span style=color:#5bc4bf>,</span>sequece<span style=color:#5bc4bf>,</span>buffer<span style=color:#5bc4bf>)</span> <span style=color:#5bc4bf>-&gt;</span> event<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>setId</span><span style=color:#5bc4bf>(</span>buffer<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>getLong</span><span style=color:#5bc4bf>(</span><span style=color:#f99b15>0</span><span style=color:#5bc4bf>)),</span>bb<span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span>System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;发布完成&#34;</span><span style=color:#5bc4bf>);</span>
</span></span></code></pre></div><h2 id=完整的main方法>完整的Main方法</h2><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#815ba4>public</span> <span style=color:#815ba4>class</span> <span style=color:#fec418>DisruptorMain</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>    <span style=color:#815ba4>public</span> <span style=color:#815ba4>static</span> <span style=color:#fec418>void</span> <span style=color:#06b6ef>main</span><span style=color:#5bc4bf>(</span>String<span style=color:#5bc4bf>[]</span> args<span style=color:#5bc4bf>)</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>        <span style=color:#8d8687>// 实例化事件工厂
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>        LongEventFactory factory <span style=color:#5bc4bf>=</span> <span style=color:#815ba4>new</span> LongEventFactory<span style=color:#5bc4bf>();</span>
</span></span><span style=display:flex><span>        <span style=color:#8d8687>// 定义RingBuffer大小
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>        <span style=color:#fec418>int</span> bufferSize <span style=color:#5bc4bf>=</span> <span style=color:#f99b15>1024</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>        <span style=color:#8d8687>// 创建线程工厂
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>        ThreadFactory threadFactory <span style=color:#5bc4bf>=</span> <span style=color:#815ba4>new</span> ThreadFactory<span style=color:#5bc4bf>()</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>            <span style=color:#815ba4>private</span> <span style=color:#fec418>int</span> counter <span style=color:#5bc4bf>=</span> <span style=color:#f99b15>0</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>            <span style=color:#815ba4>private</span> String prefix <span style=color:#5bc4bf>=</span> <span style=color:#48b685>&#34;DisruptorWorker&#34;</span><span style=color:#5bc4bf>;</span>
</span></span><span style=display:flex><span>            <span style=color:#5bc4bf>@Override</span>
</span></span><span style=display:flex><span>            <span style=color:#815ba4>public</span> Thread <span style=color:#06b6ef>newThread</span><span style=color:#5bc4bf>(</span>Runnable r<span style=color:#5bc4bf>)</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>                <span style=color:#815ba4>return</span> <span style=color:#815ba4>new</span> Thread<span style=color:#5bc4bf>(</span>r<span style=color:#5bc4bf>,</span> prefix <span style=color:#5bc4bf>+</span> <span style=color:#48b685>&#34;-&#34;</span> <span style=color:#5bc4bf>+</span> counter<span style=color:#5bc4bf>++);</span>
</span></span><span style=display:flex><span>            <span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span>        <span style=color:#5bc4bf>};</span>
</span></span><span style=display:flex><span>        <span style=color:#8d8687>// 实例化Disruptor
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>        Disruptor<span style=color:#5bc4bf>&lt;</span>LongEvent<span style=color:#5bc4bf>&gt;</span> disruptor <span style=color:#5bc4bf>=</span> <span style=color:#815ba4>new</span> Disruptor<span style=color:#5bc4bf>&lt;</span>LongEvent<span style=color:#5bc4bf>&gt;(</span>
</span></span><span style=display:flex><span>                factory<span style=color:#5bc4bf>,</span>
</span></span><span style=display:flex><span>                bufferSize<span style=color:#5bc4bf>,</span>
</span></span><span style=display:flex><span>                threadFactory<span style=color:#5bc4bf>,</span>
</span></span><span style=display:flex><span>                ProducerType<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>MULTI</span><span style=color:#5bc4bf>,</span>
</span></span><span style=display:flex><span>                <span style=color:#815ba4>new</span> BlockingWaitStrategy<span style=color:#5bc4bf>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8d8687>// 并行模式 两个Handler互不影响
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>        disruptor<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>handleEventsWith</span><span style=color:#5bc4bf>(</span><span style=color:#815ba4>new</span> A1Handler<span style=color:#5bc4bf>(),</span><span style=color:#815ba4>new</span> A2Handler<span style=color:#5bc4bf>());</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8d8687>// 并行 每个消费端有两个线程实例 (池化模式)
</span></span></span><span style=display:flex><span><span style=color:#8d8687>//        disruptor.handleEventsWithWorkerPool(new A1Handler(),new A1Handler());
</span></span></span><span style=display:flex><span><span style=color:#8d8687>//        disruptor.handleEventsWithWorkerPool(new A2Handler(),new A2Handler());
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>
</span></span><span style=display:flex><span>        <span style=color:#8d8687>// 获取RingBuffer
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>        RingBuffer<span style=color:#5bc4bf>&lt;</span>LongEvent<span style=color:#5bc4bf>&gt;</span> ringBuffer <span style=color:#5bc4bf>=</span> disruptor<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>start</span><span style=color:#5bc4bf>();</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8d8687>// 创建ByteBuffer缓冲区
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>        ByteBuffer bb <span style=color:#5bc4bf>=</span> ByteBuffer<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>allocate</span><span style=color:#5bc4bf>(</span><span style=color:#f99b15>8</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>        <span style=color:#815ba4>for</span> <span style=color:#5bc4bf>(</span><span style=color:#fec418>long</span> l <span style=color:#5bc4bf>=</span> <span style=color:#f99b15>0</span><span style=color:#5bc4bf>;</span> l<span style=color:#5bc4bf>&lt;</span><span style=color:#f99b15>5</span><span style=color:#5bc4bf>;</span> l<span style=color:#5bc4bf>++)</span> <span style=color:#5bc4bf>{</span>
</span></span><span style=display:flex><span>            <span style=color:#8d8687>// 写入数据到缓冲区
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>            bb<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>putLong</span><span style=color:#5bc4bf>(</span><span style=color:#f99b15>0</span><span style=color:#5bc4bf>,</span> l<span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>            <span style=color:#8d8687>// Java8的发布方式
</span></span></span><span style=display:flex><span><span style=color:#8d8687></span>            ringBuffer<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>publishEvent</span><span style=color:#5bc4bf>((</span>event<span style=color:#5bc4bf>,</span>sequece<span style=color:#5bc4bf>,</span>buffer<span style=color:#5bc4bf>)</span> <span style=color:#5bc4bf>-&gt;</span> event<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>setId</span><span style=color:#5bc4bf>(</span>buffer<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>getLong</span><span style=color:#5bc4bf>(</span><span style=color:#f99b15>0</span><span style=color:#5bc4bf>)),</span>bb<span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>        <span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span>        System<span style=color:#5bc4bf>.</span><span style=color:#06b6ef>out</span><span style=color:#5bc4bf>.</span><span style=color:#06b6ef>println</span><span style=color:#5bc4bf>(</span><span style=color:#48b685>&#34;发布完成&#34;</span><span style=color:#5bc4bf>);</span>
</span></span><span style=display:flex><span>    <span style=color:#5bc4bf>}</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>}</span>
</span></span></code></pre></div></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#创建一个事件实体>创建一个事件实体</a></li><li><a href=#创建一个事件实体工厂>创建一个事件实体工厂</a></li><li><a href=#创建两个事件处理类>创建两个事件处理类</a></li><li><a href=#实例化disruptor>实例化Disruptor</a></li><li><a href=#创建消费者>创建消费者</a><ul><li><a href=#单个模式>单个模式</a></li><li><a href=#池化模式>池化模式</a></li></ul></li><li><a href=#获取ringbuffer>获取RingBuffer</a></li><li><a href=#生产者发布消息>生产者发布消息</a></li><li><a href=#完整的main方法>完整的Main方法</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&text=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&title=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&is_video=false&description=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95&body=Check out this article: https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&title=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&title=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&name=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95&description=%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa%e4%ba%8b%e4%bb%b6%e5%ae%9e%e4%bd%93%20public%20class%20LongEvent%7b%20private%20Long%20id%3b%20public%20Long%20getId%28%29%20%7b%20return%20id%3b%20%7d%20public%20void%20setId%28Long%20id%29%20%7b%20this.id%20%3d%20id%3b%20%7d%20%7d%20%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa%e4%ba%8b%e4%bb%b6%e5%ae%9e%e4%bd%93%e5%b7%a5%e5%8e%82%20public%20class%20LongEventFactory%20implements%20EventFactory%26lt%3bLongEvent%26gt%3b%20%7b%20public%20LongEvent%20newInstance%28%29%20%7b%20return%20new%20LongEvent%28%29%3b%20%7d%20%7d%20%e5%88%9b%e5%bb%ba%e4%b8%a4%e4%b8%aa%e4%ba%8b%e4%bb%b6%e5%a4%84%e7%90%86%e7%b1%bb%20%2f%2a%2a%20%2a%20EventHandler%26lt%3bLongEvent%26gt%3b%20%e6%98%af%e6%b2%a1%e6%9c%89%e6%b1%a0%e5%8c%96%e7%9a%84%e5%ae%9e%e7%8e%b0%e6%96%b9%e5%bc%8f%2c%e6%af%8f%e4%b8%aa%e6%b6%88%e8%b4%b9%e8%80%85%e4%b8%ad%e5%8f%aa%e6%9c%89%e4%b8%80%e4%b8%aa%e7%a4%ba%e4%be%8b%20%2a%20WorkHandler%26lt%3bLongEvent%26gt%3b%20%e6%98%af%e6%b1%a0%e5%8c%96%e7%9a%84%e5%ae%9e%e7%8e%b0%e6%96%b9%e5%bc%8f%ef%bc%8c%e6%af%8f%e4%b8%aa%e6%b6%88%e8%b4%b9%e8%80%85%e4%b8%ad%e5%8f%af%e4%bb%a5%e4%bb%a5%e7%b1%bb%e4%bc%bc%e7%ba%bf%e7%a8%8b%e6%b1%a0%e7%9a%84%e6%96%b9%e5%bc%8f%e5%8e%bb%e6%89%a7%e8%a1%8c%e8%bf%99%e4%b8%aa%e4%ba%8b%e4%bb%b6%20%2a%20%e5%ae%9e%e9%99%85%e6%a0%b9%e6%8d%ae%e4%b8%9a%e5%8a%a1%e5%9c%ba%e6%99%af%20%e5%ae%9e%e7%8e%b0%e5%85%b6%e4%b8%ad%e4%b8%80%e4%b8%aa%e6%8e%a5%e5%8f%a3%e5%b0%b1%e5%8f%af%e4%bb%a5%20%2a%2f%20public%20class%20A1Handler%20implements%20EventHandler%26lt%3bLongEvent%26gt%3b%20%2c%20WorkHandler%26lt%3bLongEvent%26gt%3b%20%7b%20public%20void%20onEvent%28LongEvent%20longEvent%2c%20long%20l%2c%20boolean%20b%29%20throws%20Exception%20%7b%20long%20id%20%3d%20longEvent." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fblog.greycode.top%2fposts%2fb3025291-ae52-4d26-a70c-66a79bda07d7%2f&t=Disruptor-%e5%ae%9e%e4%be%8b%e5%8c%96%e6%96%b9%e6%b3%95" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2023 Greycode's Blog</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script>
<script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>