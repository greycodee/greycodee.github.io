<!doctype html><html lang=en-us><head><link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script>
<link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Redis是怎样通讯的？ | Hello,I‘m Greycode!</title><link rel=canonical href=https://greycode.top/posts/8b135153fd9d41de928df42f84ad1eca/><meta name=description content="Please use Chrome to browse this site for a better experience."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Redis是怎样通讯的？"><meta property="og:description" content="模型 Redis 协议模型就是简单的请求-响应模型，和平常的 Http 协议有点类似。客户端发送 Redis 命令，然后服务端处理命令并返回结果给客户端。Redis 官方说这可能是最简单的网络协议模型了。
有两种情况下不 不适用这个模型，一个是批量流水线命令，一个是发布/订阅功能。
协议描述 Redis 协议一般简单的分为 5 类数据结构，简单字符串、错误信息、数值、大字符串、数组。每种数据类型在第一个字节用不同的符号来区分：
 简单字符串(Simple Strings)：开头第一个符号为 +，对应 HEX 值为：0x2b 错误信息(Errors)：第一个字节符号为 -，对应 HEX 值为：0x2d 数值(Integers)：第一个字节符号为 :，对应 HEX 值为：0x3a 大字符串(Bulk Strings)：第一个字节符号为 $，对应 HEX 值为：0x24 数组(Arrays)：第一个字节符号为 *，对应 HEX 值为：0x2a  这 5 种数据类型可以组合起来使用，每种数据类型通过 CRLF 结尾，就是平常的 \r\n，对应的 HEX 值为：0x0d,0x0a。一般我们判断一种数据类型是否结束时，只要判断是否有 \r 出现就可以了。Redis 客户端和服务端之间就是通过这些规则来进行通信的。
简单字符串 一般简单字符串用于返回 Redis 服务端的系统响应，如果要响应用户存储的数据时，一般会用大字符串(Bulk Strings)的数据类型来返回。
比如说客户端发送 set 命令新增一个 Key 来存储字符串，此时客户端就会返回 +OK。这种方式返回的数据不能有空格和换行，因为空格和换行表示该类型的数据结尾。
redis:0>set name 灰灰 &#34;OK&#34;  # Redis 服务端响应数据 0000 2b 4f 4b 0d 0a +OK·· 错误信息 当我们执行的命令发生错误时，Redis 服务端就会返回错误信息"><meta property="og:type" content="article"><meta property="og:url" content="https://greycode.top/posts/8b135153fd9d41de928df42f84ad1eca/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-29T13:41:40+00:00"><meta property="article:modified_time" content="2022-03-29T13:41:40+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Redis是怎样通讯的？"><meta name=twitter:description content="模型 Redis 协议模型就是简单的请求-响应模型，和平常的 Http 协议有点类似。客户端发送 Redis 命令，然后服务端处理命令并返回结果给客户端。Redis 官方说这可能是最简单的网络协议模型了。
有两种情况下不 不适用这个模型，一个是批量流水线命令，一个是发布/订阅功能。
协议描述 Redis 协议一般简单的分为 5 类数据结构，简单字符串、错误信息、数值、大字符串、数组。每种数据类型在第一个字节用不同的符号来区分：
 简单字符串(Simple Strings)：开头第一个符号为 +，对应 HEX 值为：0x2b 错误信息(Errors)：第一个字节符号为 -，对应 HEX 值为：0x2d 数值(Integers)：第一个字节符号为 :，对应 HEX 值为：0x3a 大字符串(Bulk Strings)：第一个字节符号为 $，对应 HEX 值为：0x24 数组(Arrays)：第一个字节符号为 *，对应 HEX 值为：0x2a  这 5 种数据类型可以组合起来使用，每种数据类型通过 CRLF 结尾，就是平常的 \r\n，对应的 HEX 值为：0x0d,0x0a。一般我们判断一种数据类型是否结束时，只要判断是否有 \r 出现就可以了。Redis 客户端和服务端之间就是通过这些规则来进行通信的。
简单字符串 一般简单字符串用于返回 Redis 服务端的系统响应，如果要响应用户存储的数据时，一般会用大字符串(Bulk Strings)的数据类型来返回。
比如说客户端发送 set 命令新增一个 Key 来存储字符串，此时客户端就会返回 +OK。这种方式返回的数据不能有空格和换行，因为空格和换行表示该类型的数据结尾。
redis:0>set name 灰灰 &#34;OK&#34;  # Redis 服务端响应数据 0000 2b 4f 4b 0d 0a +OK·· 错误信息 当我们执行的命令发生错误时，Redis 服务端就会返回错误信息"><link rel=stylesheet href=https://greycode.top/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://greycode.top/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://greycode.top/posts/2852f14d7d13471798ce28c544741e89/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://greycode.top/posts/7f482d9706354a288702dccb66c81bf2/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&text=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&title=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&is_video=false&description=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f&body=Check out this article: https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&title=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&title=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&name=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f&description=%e6%a8%a1%e5%9e%8b%20Redis%20%e5%8d%8f%e8%ae%ae%e6%a8%a1%e5%9e%8b%e5%b0%b1%e6%98%af%e7%ae%80%e5%8d%95%e7%9a%84%e8%af%b7%e6%b1%82-%e5%93%8d%e5%ba%94%e6%a8%a1%e5%9e%8b%ef%bc%8c%e5%92%8c%e5%b9%b3%e5%b8%b8%e7%9a%84%20Http%20%e5%8d%8f%e8%ae%ae%e6%9c%89%e7%82%b9%e7%b1%bb%e4%bc%bc%e3%80%82%e5%ae%a2%e6%88%b7%e7%ab%af%e5%8f%91%e9%80%81%20Redis%20%e5%91%bd%e4%bb%a4%ef%bc%8c%e7%84%b6%e5%90%8e%e6%9c%8d%e5%8a%a1%e7%ab%af%e5%a4%84%e7%90%86%e5%91%bd%e4%bb%a4%e5%b9%b6%e8%bf%94%e5%9b%9e%e7%bb%93%e6%9e%9c%e7%bb%99%e5%ae%a2%e6%88%b7%e7%ab%af%e3%80%82Redis%20%e5%ae%98%e6%96%b9%e8%af%b4%e8%bf%99%e5%8f%af%e8%83%bd%e6%98%af%e6%9c%80%e7%ae%80%e5%8d%95%e7%9a%84%e7%bd%91%e7%bb%9c%e5%8d%8f%e8%ae%ae%e6%a8%a1%e5%9e%8b%e4%ba%86%e3%80%82%0a%e6%9c%89%e4%b8%a4%e7%a7%8d%e6%83%85%e5%86%b5%e4%b8%8b%e4%b8%8d%20%e4%b8%8d%e9%80%82%e7%94%a8%e8%bf%99%e4%b8%aa%e6%a8%a1%e5%9e%8b%ef%bc%8c%e4%b8%80%e4%b8%aa%e6%98%af%e6%89%b9%e9%87%8f%e6%b5%81%e6%b0%b4%e7%ba%bf%e5%91%bd%e4%bb%a4%ef%bc%8c%e4%b8%80%e4%b8%aa%e6%98%af%e5%8f%91%e5%b8%83%2f%e8%ae%a2%e9%98%85%e5%8a%9f%e8%83%bd%e3%80%82%0a%e5%8d%8f%e8%ae%ae%e6%8f%8f%e8%bf%b0%20Redis%20%e5%8d%8f%e8%ae%ae%e4%b8%80%e8%88%ac%e7%ae%80%e5%8d%95%e7%9a%84%e5%88%86%e4%b8%ba%205%20%e7%b1%bb%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%ef%bc%8c%e7%ae%80%e5%8d%95%e5%ad%97%e7%ac%a6%e4%b8%b2%e3%80%81%e9%94%99%e8%af%af%e4%bf%a1%e6%81%af%e3%80%81%e6%95%b0%e5%80%bc%e3%80%81%e5%a4%a7%e5%ad%97%e7%ac%a6%e4%b8%b2%e3%80%81%e6%95%b0%e7%bb%84%e3%80%82%e6%af%8f%e7%a7%8d%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b%e5%9c%a8%e7%ac%ac%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e7%94%a8%e4%b8%8d%e5%90%8c%e7%9a%84%e7%ac%a6%e5%8f%b7%e6%9d%a5%e5%8c%ba%e5%88%86%ef%bc%9a%0a%20%e7%ae%80%e5%8d%95%e5%ad%97%e7%ac%a6%e4%b8%b2%28Simple%20Strings%29%ef%bc%9a%e5%bc%80%e5%a4%b4%e7%ac%ac%e4%b8%80%e4%b8%aa%e7%ac%a6%e5%8f%b7%e4%b8%ba%20%2b%ef%bc%8c%e5%af%b9%e5%ba%94%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x2b%20%e9%94%99%e8%af%af%e4%bf%a1%e6%81%af%28Errors%29%ef%bc%9a%e7%ac%ac%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e7%ac%a6%e5%8f%b7%e4%b8%ba%20-%ef%bc%8c%e5%af%b9%e5%ba%94%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x2d%20%e6%95%b0%e5%80%bc%28Integers%29%ef%bc%9a%e7%ac%ac%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e7%ac%a6%e5%8f%b7%e4%b8%ba%20%3a%ef%bc%8c%e5%af%b9%e5%ba%94%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x3a%20%e5%a4%a7%e5%ad%97%e7%ac%a6%e4%b8%b2%28Bulk%20Strings%29%ef%bc%9a%e7%ac%ac%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e7%ac%a6%e5%8f%b7%e4%b8%ba%20%24%ef%bc%8c%e5%af%b9%e5%ba%94%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x24%20%e6%95%b0%e7%bb%84%28Arrays%29%ef%bc%9a%e7%ac%ac%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e7%ac%a6%e5%8f%b7%e4%b8%ba%20%2a%ef%bc%8c%e5%af%b9%e5%ba%94%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x2a%20%20%e8%bf%99%205%20%e7%a7%8d%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b%e5%8f%af%e4%bb%a5%e7%bb%84%e5%90%88%e8%b5%b7%e6%9d%a5%e4%bd%bf%e7%94%a8%ef%bc%8c%e6%af%8f%e7%a7%8d%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b%e9%80%9a%e8%bf%87%20CRLF%20%e7%bb%93%e5%b0%be%ef%bc%8c%e5%b0%b1%e6%98%af%e5%b9%b3%e5%b8%b8%e7%9a%84%20%5cr%5cn%ef%bc%8c%e5%af%b9%e5%ba%94%e7%9a%84%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x0d%2c0x0a%e3%80%82%e4%b8%80%e8%88%ac%e6%88%91%e4%bb%ac%e5%88%a4%e6%96%ad%e4%b8%80%e7%a7%8d%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b%e6%98%af%e5%90%a6%e7%bb%93%e6%9d%9f%e6%97%b6%ef%bc%8c%e5%8f%aa%e8%a6%81%e5%88%a4%e6%96%ad%e6%98%af%e5%90%a6%e6%9c%89%20%5cr%20%e5%87%ba%e7%8e%b0%e5%b0%b1%e5%8f%af%e4%bb%a5%e4%ba%86%e3%80%82Redis%20%e5%ae%a2%e6%88%b7%e7%ab%af%e5%92%8c%e6%9c%8d%e5%8a%a1%e7%ab%af%e4%b9%8b%e9%97%b4%e5%b0%b1%e6%98%af%e9%80%9a%e8%bf%87%e8%bf%99%e4%ba%9b%e8%a7%84%e5%88%99%e6%9d%a5%e8%bf%9b%e8%a1%8c%e9%80%9a%e4%bf%a1%e7%9a%84%e3%80%82%0a%e7%ae%80%e5%8d%95%e5%ad%97%e7%ac%a6%e4%b8%b2%20%e4%b8%80%e8%88%ac%e7%ae%80%e5%8d%95%e5%ad%97%e7%ac%a6%e4%b8%b2%e7%94%a8%e4%ba%8e%e8%bf%94%e5%9b%9e%20Redis%20%e6%9c%8d%e5%8a%a1%e7%ab%af%e7%9a%84%e7%b3%bb%e7%bb%9f%e5%93%8d%e5%ba%94%ef%bc%8c%e5%a6%82%e6%9e%9c%e8%a6%81%e5%93%8d%e5%ba%94%e7%94%a8%e6%88%b7%e5%ad%98%e5%82%a8%e7%9a%84%e6%95%b0%e6%8d%ae%e6%97%b6%ef%bc%8c%e4%b8%80%e8%88%ac%e4%bc%9a%e7%94%a8%e5%a4%a7%e5%ad%97%e7%ac%a6%e4%b8%b2%28Bulk%20Strings%29%e7%9a%84%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b%e6%9d%a5%e8%bf%94%e5%9b%9e%e3%80%82%0a%e6%af%94%e5%a6%82%e8%af%b4%e5%ae%a2%e6%88%b7%e7%ab%af%e5%8f%91%e9%80%81%20set%20%e5%91%bd%e4%bb%a4%e6%96%b0%e5%a2%9e%e4%b8%80%e4%b8%aa%20Key%20%e6%9d%a5%e5%ad%98%e5%82%a8%e5%ad%97%e7%ac%a6%e4%b8%b2%ef%bc%8c%e6%ad%a4%e6%97%b6%e5%ae%a2%e6%88%b7%e7%ab%af%e5%b0%b1%e4%bc%9a%e8%bf%94%e5%9b%9e%20%2bOK%e3%80%82%e8%bf%99%e7%a7%8d%e6%96%b9%e5%bc%8f%e8%bf%94%e5%9b%9e%e7%9a%84%e6%95%b0%e6%8d%ae%e4%b8%8d%e8%83%bd%e6%9c%89%e7%a9%ba%e6%a0%bc%e5%92%8c%e6%8d%a2%e8%a1%8c%ef%bc%8c%e5%9b%a0%e4%b8%ba%e7%a9%ba%e6%a0%bc%e5%92%8c%e6%8d%a2%e8%a1%8c%e8%a1%a8%e7%a4%ba%e8%af%a5%e7%b1%bb%e5%9e%8b%e7%9a%84%e6%95%b0%e6%8d%ae%e7%bb%93%e5%b0%be%e3%80%82%0aredis%3a0%26gt%3bset%20name%20%e7%81%b0%e7%81%b0%20%26%2334%3bOK%26%2334%3b%20%20%23%20Redis%20%e6%9c%8d%e5%8a%a1%e7%ab%af%e5%93%8d%e5%ba%94%e6%95%b0%e6%8d%ae%200000%202b%204f%204b%200d%200a%20%2bOK%c2%b7%c2%b7%20%e9%94%99%e8%af%af%e4%bf%a1%e6%81%af%20%e5%bd%93%e6%88%91%e4%bb%ac%e6%89%a7%e8%a1%8c%e7%9a%84%e5%91%bd%e4%bb%a4%e5%8f%91%e7%94%9f%e9%94%99%e8%af%af%e6%97%b6%ef%bc%8cRedis%20%e6%9c%8d%e5%8a%a1%e7%ab%af%e5%b0%b1%e4%bc%9a%e8%bf%94%e5%9b%9e%e9%94%99%e8%af%af%e4%bf%a1%e6%81%af" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&t=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#模型>模型</a></li><li><a href=#协议描述>协议描述</a><ul><li><a href=#简单字符串>简单字符串</a></li><li><a href=#错误信息>错误信息</a></li><li><a href=#数值>数值</a></li><li><a href=#大字符串>大字符串</a></li><li><a href=#数组>数组</a></li></ul></li><li><a href=#发送命令>发送命令</a></li><li><a href=#redis-数据结构>Redis 数据结构</a><ul><li><a href=#字符串-string>字符串 String</a></li><li><a href=#哈希表-hash>哈希表 Hash</a></li><li><a href=#列表-list>列表 List</a></li><li><a href=#集合-set>集合 Set</a></li><li><a href=#有序集合-zset>有序集合 ZSet</a></li></ul></li><li><a href=#pipeline>Pipeline</a></li><li><a href=#代码实现>代码实现</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Redis是怎样通讯的？</h1><div class=meta><div class=postdate><time datetime="2022-03-29 13:41:40 +0000 UTC" itemprop=datePublished>2022-03-29</time></div><div class=article-category><i class="fas fa-archive"></i>
<a class=category-link href=/categories/%E5%8D%8F%E8%AE%AE>协议</a></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/redis rel=tag>Redis</a>
,
<a class=tag-link href=/tags/%E5%8D%8F%E8%AE%AE rel=tag>协议</a></div></div></header><div class=content itemprop=articleBody><h2 id=模型>模型</h2><p>Redis 协议模型就是简单的请求-响应模型，和平常的 Http 协议有点类似。客户端发送 Redis 命令，然后服务端处理命令并返回结果给客户端。Redis 官方说这可能是最简单的网络协议模型了。</p><p><img src=https://cdn.jsdelivr.net/gh/greycodee/images@main/images/2022/04/15/image-20220415110028732.png alt=image-20220415110028732></p><p>有两种情况下不 不适用这个模型，一个是批量流水线命令，一个是发布/订阅功能。</p><p><img src=https://cdn.jsdelivr.net/gh/greycodee/images@main/images/2022/04/15/image-20220415110051982.png alt=image-20220415110051982></p><h2 id=协议描述>协议描述</h2><p>Redis 协议一般简单的分为 5 类数据结构，简单字符串、错误信息、数值、大字符串、数组。每种数据类型在第一个字节用不同的符号来区分：</p><ul><li><strong>简单字符串(Simple Strings)</strong>：开头第一个符号为 <code>+</code>，对应 HEX 值为：<code>0x2b</code></li><li><strong>错误信息(Errors)</strong>：第一个字节符号为 <code>-</code>，对应 HEX 值为：<code>0x2d</code></li><li><strong>数值(Integers)</strong>：第一个字节符号为 <code>:</code>，对应 HEX 值为：<code>0x3a</code></li><li><strong>大字符串(Bulk Strings)</strong>：第一个字节符号为 <code>$</code>，对应 HEX 值为：<code>0x24</code></li><li><strong>数组(Arrays)</strong>：第一个字节符号为 <code>*</code>，对应 HEX 值为：<code>0x2a</code></li></ul><p>这 5 种数据类型可以组合起来使用，每种数据类型通过 <strong>CRLF</strong> 结尾，就是平常的 <code>\r\n</code>，对应的 HEX 值为：<code>0x0d,0x0a</code>。一般我们判断一种数据类型是否结束时，只要判断是否有 <code>\r</code> 出现就可以了。Redis 客户端和服务端之间就是通过这些规则来进行通信的。</p><h3 id=简单字符串>简单字符串</h3><p>一般简单字符串用于返回 Redis 服务端的系统响应，如果要响应用户存储的数据时，一般会用大字符串(Bulk Strings)的数据类型来返回。</p><p>比如说客户端发送 set 命令新增一个 Key 来存储字符串，此时客户端就会返回 <code>+OK</code>。这种方式返回的数据不能有空格和换行，因为空格和换行表示该类型的数据结尾。</p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis:0&gt;set name 灰灰
</span></span><span style=display:flex><span><span style=color:#48b685>&#34;OK&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># Redis 服务端响应数据</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>  2b 4f 4b 0d 0a                                     +OK··
</span></span></code></pre></div><h3 id=错误信息>错误信息</h3><p>当我们执行的命令发生错误时，Redis 服务端就会返回错误信息</p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis:0&gt;incr name
</span></span><span style=display:flex><span><span style=color:#48b685>&#34;ERR value is not an integer or out of range&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># Redis 服务端响应数据</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>  2d <span style=color:#f99b15>45</span> <span style=color:#f99b15>52</span> <span style=color:#f99b15>52</span> <span style=color:#f99b15>20</span> <span style=color:#f99b15>76</span> <span style=color:#f99b15>61</span> 6c  <span style=color:#f99b15>75</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>20</span> <span style=color:#f99b15>69</span> <span style=color:#f99b15>73</span> <span style=color:#f99b15>20</span> 6e 6f   -ERR val ue is no
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>  <span style=color:#f99b15>74</span> <span style=color:#f99b15>20</span> <span style=color:#f99b15>61</span> 6e <span style=color:#f99b15>20</span> <span style=color:#f99b15>69</span> 6e <span style=color:#f99b15>74</span>  <span style=color:#f99b15>65</span> <span style=color:#f99b15>67</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>72</span> <span style=color:#f99b15>20</span> 6f <span style=color:#f99b15>72</span> <span style=color:#f99b15>20</span>   t an int eger or 
</span></span><span style=display:flex><span><span style=color:#f99b15>0020</span>  6f <span style=color:#f99b15>75</span> <span style=color:#f99b15>74</span> <span style=color:#f99b15>20</span> 6f <span style=color:#f99b15>66</span> <span style=color:#f99b15>20</span> <span style=color:#f99b15>72</span>  <span style=color:#f99b15>61</span> 6e <span style=color:#f99b15>67</span> <span style=color:#f99b15>65</span> 0d 0a         out of r ange··
</span></span></code></pre></div><h3 id=数值>数值</h3><p>返回数值的其中一种情况就是执行 <code>exists</code> 命令来判断某个 Key 存不存在，返回 1 表示存在，返回 0 表示不存在</p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis:0&gt;exists name
</span></span><span style=display:flex><span><span style=color:#48b685>&#34;1&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># Redis 服务端响应数据</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>  3a <span style=color:#f99b15>31</span> 0d 0a                                        :1··
</span></span><span style=display:flex><span>---------------------------------------------------------------
</span></span><span style=display:flex><span>redis:0&gt;exists hui
</span></span><span style=display:flex><span><span style=color:#48b685>&#34;0&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># Redis 服务端响应数据</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   3a <span style=color:#f99b15>30</span> 0d 0a                                       :0..
</span></span></code></pre></div><h3 id=大字符串>大字符串</h3><p>大字符串返回值有两部分组成，一部分是表示字符串长度的数据，一部分是字符串本身数据。它由 <code>$</code> 符号开头，后面跟着的是表示字符串长度的数据，<strong>该数值直接用字符串的形式表示</strong>，也就说读取该字节数据的时候，要用读取字符串数据的方式来读取。读取完后再转换为数值数据，然后再根据这个数值来读取相对应长度的字节数据。这样数据中就可以包含空格和换行了，因为是根据开头的长度数值来读取相对应的字节数据的，而不是通过判断 <code>\r\n</code> 符号来读取。</p><p>比如客户端获取前面设置的 Key 为 name 的数据：</p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis:0&gt;get name
</span></span><span style=display:flex><span><span style=color:#48b685>&#34;灰灰&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># Redis 服务端响应数据</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a e7 <span style=color:#f99b15>81</span> b0 e7 <span style=color:#f99b15>81</span> b0 0d 0a               <span style=color:#ef6155>$6</span>..........
</span></span></code></pre></div><p>其中 <code>e7 81 b0 e7 81 b0</code> 就是 <code>灰灰</code> 字符的字节数据</p><h3 id=数组>数组</h3><p>当服务端返回数组数据时，它由 <code>*</code> 符号开头，后面紧跟着的是这个数值的长度，和大字符串的字节长度一样，该长度也是以字符串的形式返回。数组中的每个元素再通过相对应的数据类型来表示。</p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>*2
</span></span><span style=display:flex><span>+value1
</span></span><span style=display:flex><span>+value2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># or</span>
</span></span><span style=display:flex><span>*3
</span></span><span style=display:flex><span>:22
</span></span><span style=display:flex><span>:52
</span></span><span style=display:flex><span>:99
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 当然也可以表示嵌套数组</span>
</span></span><span style=display:flex><span>*2
</span></span><span style=display:flex><span>*1
</span></span><span style=display:flex><span>:123
</span></span><span style=display:flex><span>*2
</span></span><span style=display:flex><span>:433
</span></span><span style=display:flex><span>:92
</span></span></code></pre></div><p>比如客户端设置一个 list 数据，然后获取它</p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis:0&gt;lpush mylist value1 value2
</span></span><span style=display:flex><span><span style=color:#f99b15>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 获取 list</span>
</span></span><span style=display:flex><span>redis:0&gt;lrange mylist <span style=color:#f99b15>0</span> <span style=color:#f99b15>1</span>
</span></span><span style=display:flex><span><span style=color:#5bc4bf>[</span><span style=color:#48b685>&#34;value2&#34;</span>,<span style=color:#48b685>&#34;value1&#34;</span><span style=color:#5bc4bf>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a <span style=color:#f99b15>76</span> <span style=color:#f99b15>61</span> 6c <span style=color:#f99b15>75</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>32</span> 0d 0a   *2..<span style=color:#ef6155>$6</span>..value2..
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a <span style=color:#f99b15>76</span> <span style=color:#f99b15>61</span> 6c <span style=color:#f99b15>75</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>31</span> 0d 0a               <span style=color:#ef6155>$6</span>..value1..
</span></span></code></pre></div><h2 id=发送命令>发送命令</h2><p>当客户端发送命令给服务端时，客户端一般会把命令组装成上面的<strong>数组</strong>加<strong>大字符串</strong>的数据格式再发送给服务端。比如上面的我们发送一个简单的新增一个 Key 命令：</p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis:0&gt;set name 灰灰
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 客户端发送给服务端端数据</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>33</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>33</span> 0d 0a <span style=color:#f99b15>73</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>74</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>34</span> 0d   *3..<span style=color:#ef6155>$3</span>..set..<span style=color:#ef6155>$4</span>.
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0a 6e <span style=color:#f99b15>61</span> 6d <span style=color:#f99b15>65</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a e7 <span style=color:#f99b15>81</span> b0 e7 <span style=color:#f99b15>81</span>   .name..<span style=color:#ef6155>$6</span>.......
</span></span><span style=display:flex><span><span style=color:#f99b15>0020</span>   b0 0d 0a                                          ...
</span></span></code></pre></div><h2 id=redis-数据结构>Redis 数据结构</h2><p>Redis 一般常用的有 5 种数据类型，下面看看 5 种数据类型对应的客户端和服务端之间的数据是怎么交互的。</p><h3 id=字符串-string>字符串 String</h3><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis:0&gt;set name greycode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>33</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>33</span> 0d 0a <span style=color:#f99b15>73</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>74</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>34</span> 0d   *3..<span style=color:#ef6155>$3</span>..set..<span style=color:#ef6155>$4</span>.
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0a 6e <span style=color:#f99b15>61</span> 6d <span style=color:#f99b15>65</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>38</span> 0d 0a <span style=color:#f99b15>67</span> <span style=color:#f99b15>72</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>79</span> <span style=color:#f99b15>63</span>   .name..<span style=color:#ef6155>$8</span>..greyc
</span></span><span style=display:flex><span><span style=color:#f99b15>0020</span>   6f <span style=color:#f99b15>64</span> <span style=color:#f99b15>65</span> 0d 0a                                    ode..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 响应</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2b 4f 4b 0d 0a                                    +OK..
</span></span><span style=display:flex><span>-------------------------------------------------------------------------
</span></span><span style=display:flex><span>redis:0&gt;get name
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>33</span> 0d 0a <span style=color:#f99b15>67</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>74</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>34</span> 0d   *2..<span style=color:#ef6155>$3</span>..get..<span style=color:#ef6155>$4</span>.
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0a 6e <span style=color:#f99b15>61</span> 6d <span style=color:#f99b15>65</span> 0d 0a                              .name..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 响应</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   <span style=color:#f99b15>24</span> <span style=color:#f99b15>38</span> 0d 0a <span style=color:#f99b15>67</span> <span style=color:#f99b15>72</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>79</span> <span style=color:#f99b15>63</span> 6f <span style=color:#f99b15>64</span> <span style=color:#f99b15>65</span> 0d 0a         <span style=color:#ef6155>$8</span>..greycode..
</span></span></code></pre></div><h3 id=哈希表-hash>哈希表 Hash</h3><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis:0&gt;hset myHash name huihui
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>34</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>34</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>73</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>74</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span>   *4..<span style=color:#ef6155>$4</span>..hset..<span style=color:#ef6155>$6</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0d 0a 6d <span style=color:#f99b15>79</span> <span style=color:#f99b15>48</span> <span style=color:#f99b15>61</span> <span style=color:#f99b15>73</span> <span style=color:#f99b15>68</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>34</span> 0d 0a 6e <span style=color:#f99b15>61</span>   ..myHash..<span style=color:#ef6155>$4</span>..na
</span></span><span style=display:flex><span><span style=color:#f99b15>0020</span>   6d <span style=color:#f99b15>65</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>75</span> <span style=color:#f99b15>69</span> <span style=color:#f99b15>68</span> <span style=color:#f99b15>75</span> <span style=color:#f99b15>69</span> 0d 0a   me..<span style=color:#ef6155>$6</span>..huihui..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 响应</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   3a <span style=color:#f99b15>31</span> 0d 0a                                       :1..
</span></span><span style=display:flex><span>-------------------------------------------------------------------------
</span></span><span style=display:flex><span>redis:0&gt;hget myHash name
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>33</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>34</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>67</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>74</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span>   *3..<span style=color:#ef6155>$4</span>..hget..<span style=color:#ef6155>$6</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0d 0a 6d <span style=color:#f99b15>79</span> <span style=color:#f99b15>48</span> <span style=color:#f99b15>61</span> <span style=color:#f99b15>73</span> <span style=color:#f99b15>68</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>34</span> 0d 0a 6e <span style=color:#f99b15>61</span>   ..myHash..<span style=color:#ef6155>$4</span>..na
</span></span><span style=display:flex><span><span style=color:#f99b15>0020</span>   6d <span style=color:#f99b15>65</span> 0d 0a                                       me..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 响应</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>75</span> <span style=color:#f99b15>69</span> <span style=color:#f99b15>68</span> <span style=color:#f99b15>75</span> <span style=color:#f99b15>69</span> 0d 0a               <span style=color:#ef6155>$6</span>..huihui..
</span></span><span style=display:flex><span>-------------------------------------------------------------------------
</span></span><span style=display:flex><span>redis:0&gt;hgetall myHash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>37</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>67</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>74</span> <span style=color:#f99b15>61</span> 6c 6c 0d   *2..<span style=color:#ef6155>$7</span>..hgetall.
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a 6d <span style=color:#f99b15>79</span> <span style=color:#f99b15>48</span> <span style=color:#f99b15>61</span> <span style=color:#f99b15>73</span> <span style=color:#f99b15>68</span> 0d 0a            .<span style=color:#ef6155>$6</span>..myHash..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 响应</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>34</span> 0d 0a 6e <span style=color:#f99b15>61</span> 6d <span style=color:#f99b15>65</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span>   *2..<span style=color:#ef6155>$4</span>..name..<span style=color:#ef6155>$6</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>75</span> <span style=color:#f99b15>69</span> <span style=color:#f99b15>68</span> <span style=color:#f99b15>75</span> <span style=color:#f99b15>69</span> 0d 0a                     ..huihui..
</span></span></code></pre></div><h3 id=列表-list>列表 List</h3><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis:0&gt;lpush lists huihui greycode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>34</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>35</span> 0d 0a 6c <span style=color:#f99b15>70</span> <span style=color:#f99b15>75</span> <span style=color:#f99b15>73</span> <span style=color:#f99b15>68</span> 0d 0a <span style=color:#f99b15>24</span>   *4..<span style=color:#ef6155>$5</span>..lpush..$
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   <span style=color:#f99b15>35</span> 0d 0a 6c <span style=color:#f99b15>69</span> <span style=color:#f99b15>73</span> <span style=color:#f99b15>74</span> <span style=color:#f99b15>73</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>75</span>   5..lists..<span style=color:#ef6155>$6</span>..hu
</span></span><span style=display:flex><span><span style=color:#f99b15>0020</span>   <span style=color:#f99b15>69</span> <span style=color:#f99b15>68</span> <span style=color:#f99b15>75</span> <span style=color:#f99b15>69</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>38</span> 0d 0a <span style=color:#f99b15>67</span> <span style=color:#f99b15>72</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>79</span> <span style=color:#f99b15>63</span> 6f   ihui..<span style=color:#ef6155>$8</span>..greyco
</span></span><span style=display:flex><span><span style=color:#f99b15>0030</span>   <span style=color:#f99b15>64</span> <span style=color:#f99b15>65</span> 0d 0a                                       de..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 响应</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   3a <span style=color:#f99b15>32</span> 0d 0a                                       :2..
</span></span><span style=display:flex><span>-------------------------------------------------------------------------
</span></span><span style=display:flex><span>redis:0&gt;lrange lists <span style=color:#f99b15>0</span> <span style=color:#f99b15>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>34</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a 6c <span style=color:#f99b15>72</span> <span style=color:#f99b15>61</span> 6e <span style=color:#f99b15>67</span> <span style=color:#f99b15>65</span> 0d 0a   *4..<span style=color:#ef6155>$6</span>..lrange..
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   <span style=color:#f99b15>24</span> <span style=color:#f99b15>35</span> 0d 0a 6c <span style=color:#f99b15>69</span> <span style=color:#f99b15>73</span> <span style=color:#f99b15>74</span> <span style=color:#f99b15>73</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>31</span> 0d 0a <span style=color:#f99b15>30</span>   <span style=color:#ef6155>$5</span>..lists..<span style=color:#ef6155>$1</span>..0
</span></span><span style=display:flex><span><span style=color:#f99b15>0020</span>   0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>31</span> 0d 0a <span style=color:#f99b15>31</span> 0d 0a                        ..<span style=color:#ef6155>$1</span>..1..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 响应</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>38</span> 0d 0a <span style=color:#f99b15>67</span> <span style=color:#f99b15>72</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>79</span> <span style=color:#f99b15>63</span> 6f <span style=color:#f99b15>64</span> <span style=color:#f99b15>65</span>   *2..<span style=color:#ef6155>$8</span>..greycode
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>75</span> <span style=color:#f99b15>69</span> <span style=color:#f99b15>68</span> <span style=color:#f99b15>75</span> <span style=color:#f99b15>69</span> 0d 0a         ..<span style=color:#ef6155>$6</span>..huihui..
</span></span></code></pre></div><h3 id=集合-set>集合 Set</h3><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis:0&gt;sadd myset hello hi
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>34</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>34</span> 0d 0a <span style=color:#f99b15>73</span> <span style=color:#f99b15>61</span> <span style=color:#f99b15>64</span> <span style=color:#f99b15>64</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>35</span>   *4..<span style=color:#ef6155>$4</span>..sadd..<span style=color:#ef6155>$5</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0d 0a 6d <span style=color:#f99b15>79</span> <span style=color:#f99b15>73</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>74</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>35</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>65</span> 6c   ..myset..<span style=color:#ef6155>$5</span>..hel
</span></span><span style=display:flex><span><span style=color:#f99b15>0020</span>   6c 6f 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>69</span> 0d 0a               lo..<span style=color:#ef6155>$2</span>..hi..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 响应</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   3a <span style=color:#f99b15>32</span> 0d 0a                                       :2..
</span></span><span style=display:flex><span>-------------------------------------------------------------------------
</span></span><span style=display:flex><span>redis:0&gt;smembers myset
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>38</span> 0d 0a <span style=color:#f99b15>73</span> 6d <span style=color:#f99b15>65</span> 6d <span style=color:#f99b15>62</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>72</span> <span style=color:#f99b15>73</span>   *2..<span style=color:#ef6155>$8</span>..smembers
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>35</span> 0d 0a 6d <span style=color:#f99b15>79</span> <span style=color:#f99b15>73</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>74</span> 0d 0a            ..<span style=color:#ef6155>$5</span>..myset..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687>#响应</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>35</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>65</span> 6c 6c 6f 0d 0a <span style=color:#f99b15>24</span>   *2..<span style=color:#ef6155>$5</span>..hello..$
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>69</span> 0d 0a                              2..hi..
</span></span></code></pre></div><h3 id=有序集合-zset>有序集合 ZSet</h3><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>redis:0&gt;zadd myZset <span style=color:#f99b15>1</span> hello <span style=color:#f99b15>2</span> world
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>36</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>34</span> 0d 0a 7a <span style=color:#f99b15>61</span> <span style=color:#f99b15>64</span> <span style=color:#f99b15>64</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span>   *6..<span style=color:#ef6155>$4</span>..zadd..<span style=color:#ef6155>$6</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0d 0a 6d <span style=color:#f99b15>79</span> 5a <span style=color:#f99b15>73</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>74</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>31</span> 0d 0a <span style=color:#f99b15>31</span> 0d   ..myZset..<span style=color:#ef6155>$1</span>..1.
</span></span><span style=display:flex><span><span style=color:#f99b15>0020</span>   0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>35</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>65</span> 6c 6c 6f 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>31</span> 0d 0a   .<span style=color:#ef6155>$5</span>..hello..<span style=color:#ef6155>$1</span>..
</span></span><span style=display:flex><span><span style=color:#f99b15>0030</span>   <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>35</span> 0d 0a <span style=color:#f99b15>77</span> 6f <span style=color:#f99b15>72</span> 6c <span style=color:#f99b15>64</span> 0d 0a         2..<span style=color:#ef6155>$5</span>..world..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 响应</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   3a <span style=color:#f99b15>32</span> 0d 0a                                       :2..
</span></span><span style=display:flex><span>-------------------------------------------------------------------------
</span></span><span style=display:flex><span>redis:0&gt;zrange myset <span style=color:#f99b15>0</span> -1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>34</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a 7a <span style=color:#f99b15>72</span> <span style=color:#f99b15>61</span> 6e <span style=color:#f99b15>67</span> <span style=color:#f99b15>65</span> 0d 0a   *4..<span style=color:#ef6155>$6</span>..zrange..
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   <span style=color:#f99b15>24</span> <span style=color:#f99b15>36</span> 0d 0a 6d <span style=color:#f99b15>79</span> 5a <span style=color:#f99b15>73</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>74</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>31</span> 0d 0a   <span style=color:#ef6155>$6</span>..myZset..<span style=color:#ef6155>$1</span>..
</span></span><span style=display:flex><span><span style=color:#f99b15>0020</span>   <span style=color:#f99b15>30</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>32</span> 0d 0a 2d <span style=color:#f99b15>31</span> 0d 0a                  0..<span style=color:#ef6155>$2</span>..-1..
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8d8687># 响应</span>
</span></span><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>35</span> 0d 0a <span style=color:#f99b15>68</span> <span style=color:#f99b15>65</span> 6c 6c 6f 0d 0a <span style=color:#f99b15>24</span>   *2..<span style=color:#ef6155>$5</span>..hello..$
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   <span style=color:#f99b15>35</span> 0d 0a <span style=color:#f99b15>77</span> 6f <span style=color:#f99b15>72</span> 6c <span style=color:#f99b15>64</span> 0d 0a                     5..world..
</span></span></code></pre></div><h2 id=pipeline>Pipeline</h2><p>Redis 执行 Pipeline 命令，可以一次用一个数据包发送多条命令，然后服务端在把所有命令的执行结果打包成一个数据包返回给客户端，这样在执行大量命令的时候可以减少系统开销。比如我们要执行 <code>set num 998</code> 和 <code>incr num</code> 这两条命令，那么我们就可以把这两条命令分别组装然后拼接在一起发送给服务端。</p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f99b15>0000</span>   2a <span style=color:#f99b15>33</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>33</span> 0d 0a <span style=color:#f99b15>73</span> <span style=color:#f99b15>65</span> <span style=color:#f99b15>74</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>33</span> 0d   *3..<span style=color:#ef6155>$3</span>..set..<span style=color:#ef6155>$3</span>.
</span></span><span style=display:flex><span><span style=color:#f99b15>0010</span>   0a 6e <span style=color:#f99b15>75</span> 6d 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>33</span> 0d 0a <span style=color:#f99b15>39</span> <span style=color:#f99b15>39</span> <span style=color:#f99b15>38</span> 0d 0a 2a   .num..<span style=color:#ef6155>$3</span>..998..*
</span></span><span style=display:flex><span><span style=color:#f99b15>0020</span>   <span style=color:#f99b15>32</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>34</span> 0d 0a <span style=color:#f99b15>69</span> 6e <span style=color:#f99b15>63</span> <span style=color:#f99b15>72</span> 0d 0a <span style=color:#f99b15>24</span> <span style=color:#f99b15>33</span> 0d   2..<span style=color:#ef6155>$4</span>..incr..<span style=color:#ef6155>$3</span>.
</span></span><span style=display:flex><span><span style=color:#f99b15>0030</span>   0a 6e <span style=color:#f99b15>75</span> 6d 0d 0a                                 .num..
</span></span></code></pre></div><p>服务端接收到数据包后，处理每条命令，然后把结果打包返回。</p><div class=highlight><pre tabindex=0 style=color:#2f1e2e;background-color:#e7e9db;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f99b15>0000</span>   2b 4f 4b 0d 0a 3a <span style=color:#f99b15>39</span> <span style=color:#f99b15>39</span> <span style=color:#f99b15>39</span> 0d 0a                  +OK..:999..
</span></span></code></pre></div><p>其中， <code>set num 998</code> 命令的结果为：OK</p><p><code>incr num</code> 的结果为：999</p><h2 id=代码实现>代码实现</h2><p>了解了以上交互协议的规则后，我们就可以自己手写一个 Redis 客户端来与 Redis 服务器通讯了。</p><p>完整代码地址：https://gist.github.com/greycodee/4a102aa9ae689aea1874b1fe06190192</p></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#模型>模型</a></li><li><a href=#协议描述>协议描述</a><ul><li><a href=#简单字符串>简单字符串</a></li><li><a href=#错误信息>错误信息</a></li><li><a href=#数值>数值</a></li><li><a href=#大字符串>大字符串</a></li><li><a href=#数组>数组</a></li></ul></li><li><a href=#发送命令>发送命令</a></li><li><a href=#redis-数据结构>Redis 数据结构</a><ul><li><a href=#字符串-string>字符串 String</a></li><li><a href=#哈希表-hash>哈希表 Hash</a></li><li><a href=#列表-list>列表 List</a></li><li><a href=#集合-set>集合 Set</a></li><li><a href=#有序集合-zset>有序集合 ZSet</a></li></ul></li><li><a href=#pipeline>Pipeline</a></li><li><a href=#代码实现>代码实现</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&text=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&title=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&is_video=false&description=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f&body=Check out this article: https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&title=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&title=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&name=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f&description=%e6%a8%a1%e5%9e%8b%20Redis%20%e5%8d%8f%e8%ae%ae%e6%a8%a1%e5%9e%8b%e5%b0%b1%e6%98%af%e7%ae%80%e5%8d%95%e7%9a%84%e8%af%b7%e6%b1%82-%e5%93%8d%e5%ba%94%e6%a8%a1%e5%9e%8b%ef%bc%8c%e5%92%8c%e5%b9%b3%e5%b8%b8%e7%9a%84%20Http%20%e5%8d%8f%e8%ae%ae%e6%9c%89%e7%82%b9%e7%b1%bb%e4%bc%bc%e3%80%82%e5%ae%a2%e6%88%b7%e7%ab%af%e5%8f%91%e9%80%81%20Redis%20%e5%91%bd%e4%bb%a4%ef%bc%8c%e7%84%b6%e5%90%8e%e6%9c%8d%e5%8a%a1%e7%ab%af%e5%a4%84%e7%90%86%e5%91%bd%e4%bb%a4%e5%b9%b6%e8%bf%94%e5%9b%9e%e7%bb%93%e6%9e%9c%e7%bb%99%e5%ae%a2%e6%88%b7%e7%ab%af%e3%80%82Redis%20%e5%ae%98%e6%96%b9%e8%af%b4%e8%bf%99%e5%8f%af%e8%83%bd%e6%98%af%e6%9c%80%e7%ae%80%e5%8d%95%e7%9a%84%e7%bd%91%e7%bb%9c%e5%8d%8f%e8%ae%ae%e6%a8%a1%e5%9e%8b%e4%ba%86%e3%80%82%0a%e6%9c%89%e4%b8%a4%e7%a7%8d%e6%83%85%e5%86%b5%e4%b8%8b%e4%b8%8d%20%e4%b8%8d%e9%80%82%e7%94%a8%e8%bf%99%e4%b8%aa%e6%a8%a1%e5%9e%8b%ef%bc%8c%e4%b8%80%e4%b8%aa%e6%98%af%e6%89%b9%e9%87%8f%e6%b5%81%e6%b0%b4%e7%ba%bf%e5%91%bd%e4%bb%a4%ef%bc%8c%e4%b8%80%e4%b8%aa%e6%98%af%e5%8f%91%e5%b8%83%2f%e8%ae%a2%e9%98%85%e5%8a%9f%e8%83%bd%e3%80%82%0a%e5%8d%8f%e8%ae%ae%e6%8f%8f%e8%bf%b0%20Redis%20%e5%8d%8f%e8%ae%ae%e4%b8%80%e8%88%ac%e7%ae%80%e5%8d%95%e7%9a%84%e5%88%86%e4%b8%ba%205%20%e7%b1%bb%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%ef%bc%8c%e7%ae%80%e5%8d%95%e5%ad%97%e7%ac%a6%e4%b8%b2%e3%80%81%e9%94%99%e8%af%af%e4%bf%a1%e6%81%af%e3%80%81%e6%95%b0%e5%80%bc%e3%80%81%e5%a4%a7%e5%ad%97%e7%ac%a6%e4%b8%b2%e3%80%81%e6%95%b0%e7%bb%84%e3%80%82%e6%af%8f%e7%a7%8d%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b%e5%9c%a8%e7%ac%ac%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e7%94%a8%e4%b8%8d%e5%90%8c%e7%9a%84%e7%ac%a6%e5%8f%b7%e6%9d%a5%e5%8c%ba%e5%88%86%ef%bc%9a%0a%20%e7%ae%80%e5%8d%95%e5%ad%97%e7%ac%a6%e4%b8%b2%28Simple%20Strings%29%ef%bc%9a%e5%bc%80%e5%a4%b4%e7%ac%ac%e4%b8%80%e4%b8%aa%e7%ac%a6%e5%8f%b7%e4%b8%ba%20%2b%ef%bc%8c%e5%af%b9%e5%ba%94%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x2b%20%e9%94%99%e8%af%af%e4%bf%a1%e6%81%af%28Errors%29%ef%bc%9a%e7%ac%ac%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e7%ac%a6%e5%8f%b7%e4%b8%ba%20-%ef%bc%8c%e5%af%b9%e5%ba%94%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x2d%20%e6%95%b0%e5%80%bc%28Integers%29%ef%bc%9a%e7%ac%ac%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e7%ac%a6%e5%8f%b7%e4%b8%ba%20%3a%ef%bc%8c%e5%af%b9%e5%ba%94%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x3a%20%e5%a4%a7%e5%ad%97%e7%ac%a6%e4%b8%b2%28Bulk%20Strings%29%ef%bc%9a%e7%ac%ac%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e7%ac%a6%e5%8f%b7%e4%b8%ba%20%24%ef%bc%8c%e5%af%b9%e5%ba%94%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x24%20%e6%95%b0%e7%bb%84%28Arrays%29%ef%bc%9a%e7%ac%ac%e4%b8%80%e4%b8%aa%e5%ad%97%e8%8a%82%e7%ac%a6%e5%8f%b7%e4%b8%ba%20%2a%ef%bc%8c%e5%af%b9%e5%ba%94%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x2a%20%20%e8%bf%99%205%20%e7%a7%8d%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b%e5%8f%af%e4%bb%a5%e7%bb%84%e5%90%88%e8%b5%b7%e6%9d%a5%e4%bd%bf%e7%94%a8%ef%bc%8c%e6%af%8f%e7%a7%8d%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b%e9%80%9a%e8%bf%87%20CRLF%20%e7%bb%93%e5%b0%be%ef%bc%8c%e5%b0%b1%e6%98%af%e5%b9%b3%e5%b8%b8%e7%9a%84%20%5cr%5cn%ef%bc%8c%e5%af%b9%e5%ba%94%e7%9a%84%20HEX%20%e5%80%bc%e4%b8%ba%ef%bc%9a0x0d%2c0x0a%e3%80%82%e4%b8%80%e8%88%ac%e6%88%91%e4%bb%ac%e5%88%a4%e6%96%ad%e4%b8%80%e7%a7%8d%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b%e6%98%af%e5%90%a6%e7%bb%93%e6%9d%9f%e6%97%b6%ef%bc%8c%e5%8f%aa%e8%a6%81%e5%88%a4%e6%96%ad%e6%98%af%e5%90%a6%e6%9c%89%20%5cr%20%e5%87%ba%e7%8e%b0%e5%b0%b1%e5%8f%af%e4%bb%a5%e4%ba%86%e3%80%82Redis%20%e5%ae%a2%e6%88%b7%e7%ab%af%e5%92%8c%e6%9c%8d%e5%8a%a1%e7%ab%af%e4%b9%8b%e9%97%b4%e5%b0%b1%e6%98%af%e9%80%9a%e8%bf%87%e8%bf%99%e4%ba%9b%e8%a7%84%e5%88%99%e6%9d%a5%e8%bf%9b%e8%a1%8c%e9%80%9a%e4%bf%a1%e7%9a%84%e3%80%82%0a%e7%ae%80%e5%8d%95%e5%ad%97%e7%ac%a6%e4%b8%b2%20%e4%b8%80%e8%88%ac%e7%ae%80%e5%8d%95%e5%ad%97%e7%ac%a6%e4%b8%b2%e7%94%a8%e4%ba%8e%e8%bf%94%e5%9b%9e%20Redis%20%e6%9c%8d%e5%8a%a1%e7%ab%af%e7%9a%84%e7%b3%bb%e7%bb%9f%e5%93%8d%e5%ba%94%ef%bc%8c%e5%a6%82%e6%9e%9c%e8%a6%81%e5%93%8d%e5%ba%94%e7%94%a8%e6%88%b7%e5%ad%98%e5%82%a8%e7%9a%84%e6%95%b0%e6%8d%ae%e6%97%b6%ef%bc%8c%e4%b8%80%e8%88%ac%e4%bc%9a%e7%94%a8%e5%a4%a7%e5%ad%97%e7%ac%a6%e4%b8%b2%28Bulk%20Strings%29%e7%9a%84%e6%95%b0%e6%8d%ae%e7%b1%bb%e5%9e%8b%e6%9d%a5%e8%bf%94%e5%9b%9e%e3%80%82%0a%e6%af%94%e5%a6%82%e8%af%b4%e5%ae%a2%e6%88%b7%e7%ab%af%e5%8f%91%e9%80%81%20set%20%e5%91%bd%e4%bb%a4%e6%96%b0%e5%a2%9e%e4%b8%80%e4%b8%aa%20Key%20%e6%9d%a5%e5%ad%98%e5%82%a8%e5%ad%97%e7%ac%a6%e4%b8%b2%ef%bc%8c%e6%ad%a4%e6%97%b6%e5%ae%a2%e6%88%b7%e7%ab%af%e5%b0%b1%e4%bc%9a%e8%bf%94%e5%9b%9e%20%2bOK%e3%80%82%e8%bf%99%e7%a7%8d%e6%96%b9%e5%bc%8f%e8%bf%94%e5%9b%9e%e7%9a%84%e6%95%b0%e6%8d%ae%e4%b8%8d%e8%83%bd%e6%9c%89%e7%a9%ba%e6%a0%bc%e5%92%8c%e6%8d%a2%e8%a1%8c%ef%bc%8c%e5%9b%a0%e4%b8%ba%e7%a9%ba%e6%a0%bc%e5%92%8c%e6%8d%a2%e8%a1%8c%e8%a1%a8%e7%a4%ba%e8%af%a5%e7%b1%bb%e5%9e%8b%e7%9a%84%e6%95%b0%e6%8d%ae%e7%bb%93%e5%b0%be%e3%80%82%0aredis%3a0%26gt%3bset%20name%20%e7%81%b0%e7%81%b0%20%26%2334%3bOK%26%2334%3b%20%20%23%20Redis%20%e6%9c%8d%e5%8a%a1%e7%ab%af%e5%93%8d%e5%ba%94%e6%95%b0%e6%8d%ae%200000%202b%204f%204b%200d%200a%20%2bOK%c2%b7%c2%b7%20%e9%94%99%e8%af%af%e4%bf%a1%e6%81%af%20%e5%bd%93%e6%88%91%e4%bb%ac%e6%89%a7%e8%a1%8c%e7%9a%84%e5%91%bd%e4%bb%a4%e5%8f%91%e7%94%9f%e9%94%99%e8%af%af%e6%97%b6%ef%bc%8cRedis%20%e6%9c%8d%e5%8a%a1%e7%ab%af%e5%b0%b1%e4%bc%9a%e8%bf%94%e5%9b%9e%e9%94%99%e8%af%af%e4%bf%a1%e6%81%af" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fgreycode.top%2fposts%2f8b135153fd9d41de928df42f84ad1eca%2f&t=Redis%e6%98%af%e6%80%8e%e6%a0%b7%e9%80%9a%e8%ae%af%e7%9a%84%ef%bc%9f" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2022 Hello,I‘m Greycode!</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>All posts</a></li><li><a href=/categories>Categories</a></li><li><a href=/tags>Tags</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script>
<script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></html>